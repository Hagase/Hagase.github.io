{"meta":{"title":"Shiroha","subtitle":null,"description":"Shirohaçš„ä¸ªäººåšå®¢ç½‘ç«™ã€‚","author":"Shiroha","url":""},"pages":[{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2019-08-21T22:50:08.000Z","comments":false,"path":"client/index.html","permalink":"/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2019-08-21T22:50:08.000Z","comments":true,"path":"comment/index.html","permalink":"/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2019-08-21T22:50:08.000Z","comments":false,"path":"donate/index.html","permalink":"/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2019-08-21T22:50:08.000Z","comments":false,"path":"lab/index.html","permalink":"/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2019-09-01T07:03:48.054Z","comments":false,"path":"music/index.html","permalink":"/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"","date":"2020-07-20T00:58:43.238Z","updated":"2020-07-20T00:58:43.238Z","comments":true,"path":"taotao/index.html","permalink":"/taotao/index.html","excerpt":"","text":"Oda Nobuhime Count. è·ç¦»é™†æ¡ƒå¼•é€€å·²ç» Oda Nobuhime has separated from vtuber for: Designed by æ£®ç¨³XenWayneâ€”â€”ä¼˜ç§€çš„è°¢æ‹‰å•æ¨äºº &nbsp;&nbsp;&nbsp; èŒå¨˜ç™¾ç§‘-Cierra åŸºå‡†æ—¶ï¼šåŒ—äº¬æ—¶é—´2020å¹´07æœˆ15æ—¥22:30 ï¼ˆUTC/GMT+08:00 2020/04/30 22:30ï¼‰ .snow-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:100001;}"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2019-08-21T22:50:08.000Z","comments":true,"path":"links/index.html","permalink":"/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2019-09-01T13:37:44.317Z","comments":false,"path":"bangumi/index.html","permalink":"/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2019-08-21T22:50:08.000Z","comments":true,"path":"rss/index.html","permalink":"/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2019-08-21T22:50:08.000Z","comments":true,"path":"tags/index.html","permalink":"/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2019-08-21T22:50:08.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2019-09-01T13:00:37.127Z","comments":false,"path":"about/index.html","permalink":"/about/index.html","excerpt":"","text":"[Shirohaã®å°çŸ›å±‹] ä¸&nbsp; Shiroha&nbsp; ï¼ˆ ç™½ï¼ˆã—ã‚ï¼‰ç¾½ï¼ˆã¯ï¼‰ ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2019-08-21T22:50:08.000Z","comments":false,"path":"video/index.html","permalink":"/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"},{"title":"","date":"2020-07-20T00:39:39.723Z","updated":"2020-04-30T17:16:18.421Z","comments":true,"path":"taotao/css/main.css","permalink":"/taotao/css/main.css","excerpt":"","text":"h1,h2,h3,h4,h5,h6 { color: #6cf; font-family: aleo-regular,arial; letter-spacing: 1px } h1 { font-size: 1.7em } h2 { font-size: 1.5em } h3 { font-size: 1.17em } h5 { font-size: .83em } h6 { font-size: .75em } h1,h2,h3,h4,h5,h6 { font-weight: bolder } #main { font-size: 30px; padding-top: 1%; text-align: center; font-family: Microsoft JhengHei; color: #ff6ff7; text-shadow: 0 0 15px rgba(255, 255, 255, 1.0) } .wrapper { width: 790px; margin: 0 auto } #divfoot { width: 100%; height: 20px; text-align: center; font-family: Microsoft JhengHei; color: #fff } a { color: #fff } a:hover { color: #6cf } .content { position: absolute; display: block; overflow: hidden; z-index: 9999; text-align: center } .content h1 { color: #fff; font-family: aleo-bold,arial; font-size: 56px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px } .content p { color: #fff; font-size: 16px; letter-spacing: 1px; line-height: 28px } .counter { margin-top: 40px } .time_circles { position: relative; width: 100%; height: 100% } .time_circles>div { position: absolute; text-align: center } .time_circles>div>h4 { margin: 0; padding: 0; text-align: center; text-transform: uppercase; font-family: lato-regular,Arial; color: #fff; font-weight: 400!important } .time_circles>div>span { display: block; width: 100%; text-align: center; font-family: lato-bold,Arial; margin: .25em 0 .5em; font-weight: 700; color: #fff; font-size: 40px } #web_bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; min-width: 1000px; z-index: -10; zoom:1;background-color: #fff; background-repeat: no-repeat; background-size: cover; -webkit-background-size: cover; -o-background-size: cover; background-position: center 0 }"},{"title":"","date":"2020-07-19T01:06:36.186Z","updated":"2020-02-07T12:45:30.465Z","comments":true,"path":"taotao/js/main.js","permalink":"/taotao/js/main.js","excerpt":"","text":"$(document).ready(function(){$box=$('.content');$ht=$box.height()+175;$win_ht=$(window).height();if($win_ht>$ht){$box.css({'left':'50%','top':'50%','margin-left':-$box.width()/2+'px','margin-top':-$ht/2+'px'});}else{$box.css({'left':'50%','margin-left':-$box.width()/2+'px','margin-top':'60px','margin-bottom':'60px'});} $.backstretch([\"img/bg_img.jpg\",\"img/bg_img2.jpg\",\"img/bg_img3.jpg\"],{fade:750,duration:2500});$(\".counter\").TimeCircles({\"direction\":\"Clockwise\",\"animation\":\"Tricks\",\"bg_width\":0,\"fg_width\":0.01,\"circle_bg_color\":\"rgba(255, 255, 255, 0)\",\"circle_bg_fill_color\":\"rgba(255, 255, 255, 0.1)\",\"time\":{\"Days\":{\"text\":\"Days\",\"color\":\"#ffffff\",\"show\":true},\"Hours\":{\"text\":\"Hrs\",\"color\":\"#ffffff\",\"show\":true},\"Minutes\":{\"text\":\"Mins\",\"color\":\"#ffffff\",\"show\":true},\"Seconds\":{\"text\":\"Secs\",\"color\":\"#ffffff\",\"show\":true}}});$('#sub_form').submit(function(){submit_icons('icon','loading');}) if($('#sub_form').length){$('#sub_form').ajaxChimp({callback:bcFunction});} function bcFunction(resp){if(resp.result==='success'){submit_icons('loading','icon');show_tooltip('Thank You For Subscribing To Our Email List');$('#sub_form #mc-email').val('');}else{submit_icons('loading','icon');show_tooltip('Please Enter a Correct Email');}} function submit_icons(hide,show){$('#mc_submit i').removeClass(hide);$('#mc_submit i').addClass(show);} function show_tooltip(msg){if($(\".tooltip\").length){$(\".tooltip\").remove();} $('.subscription_form').append('');var tooltip=$(\".tooltip\");tooltip.append(msg);var tipwidth=tooltip.outerWidth();var a_width=$('.subscription_form').width();var a_hegiht=$('.subscription_form').height()+10;var tipwidth=(a_width-tipwidth)/2;$('.tooltip').css({'left':tipwidth+'px','bottom':a_hegiht+'px'}).stop().animate({opacity:1},300);setTimeout(function(){hide_tooltip();},2000);} function hide_tooltip(){var tooltip=$(\".tooltip\");tooltip.animate({opacity:0},300,function(){tooltip.remove();});}});"},{"title":"","date":"2020-02-07T12:06:34.878Z","updated":"2020-02-07T12:06:34.845Z","comments":true,"path":"taotao/js/backstretch.js","permalink":"/taotao/js/backstretch.js","excerpt":"","text":"/*! Backstretch - v2.0.4 - 2013-06-19 * http://srobbin.com/jquery-plugins/backstretch/ * Copyright (c) 2013 Scott Robbin; Licensed MIT */(function(a,d,p){a.fn.backstretch=function(c,b){(c===p||0===c.length)&&a.error(\"No images were supplied for Backstretch\");0===a(d).scrollTop()&&d.scrollTo(0,0);return this.each(function(){var d=a(this),g=d.data(\"backstretch\");if(g){if(\"string\"==typeof c&&\"function\"==typeof g[c]){g[c](b);return}b=a.extend(g.options,b);g.destroy(!0)}g=new q(this,c,b);d.data(\"backstretch\",g)})};a.backstretch=function(c,b){return a(\"body\").backstretch(c,b).data(\"backstretch\")};a.expr[\":\"].backstretch=function(c){return a(c).data(\"backstretch\")!==p};a.fn.backstretch.defaults={centeredX:!0,centeredY:!0,duration:5E3,fade:0};var r={left:0,top:0,overflow:\"hidden\",margin:0,padding:0,height:\"100%\",width:\"100%\",zIndex:-999999},s={position:\"absolute\",display:\"none\",margin:0,padding:0,border:\"none\",width:\"auto\",height:\"auto\",maxHeight:\"none\",maxWidth:\"none\",zIndex:-999999},q=function(c,b,e){this.options=a.extend({},a.fn.backstretch.defaults,e||{});this.images=a.isArray(b)?b:[b];a.each(this.images,function(){a(\"\")[0].src=this});this.isBody=c===document.body;this.$container=a(c);this.$root=this.isBody?l?a(d):a(document):this.$container;c=this.$container.children(\".backstretch\").first();this.$wrap=c.length?c:a('').css(r).appendTo(this.$container);this.isBody||(c=this.$container.css(\"position\"),b=this.$container.css(\"zIndex\"),this.$container.css({position:\"static\"===c?\"relative\":c,zIndex:\"auto\"===b?0:b,background:\"none\"}),this.$wrap.css({zIndex:-999998}));this.$wrap.css({position:this.isBody&&l?\"fixed\":\"absolute\"});this.index=0;this.show(this.index);a(d).on(\"resize.backstretch\",a.proxy(this.resize,this)).on(\"orientationchange.backstretch\",a.proxy(function(){this.isBody&&0===d.pageYOffset&&(d.scrollTo(0,1),this.resize())},this))};q.prototype={resize:function(){try{var a={left:0,top:0},b=this.isBody?this.$root.width():this.$root.innerWidth(),e=b,g=this.isBody?d.innerHeight?d.innerHeight:this.$root.height():this.$root.innerHeight(),j=e/this.$img.data(\"ratio\"),f;j>=g?(f=(j-g)/2,this.options.centeredY&&(a.top=\"-\"+f+\"px\")):(j=g,e=j*this.$img.data(\"ratio\"),f=(e-b)/2,this.options.centeredX&&(a.left=\"-\"+f+\"px\"));this.$wrap.css({width:b,height:g}).find(\"img:not(.deleteable)\").css({width:e,height:j}).css(a)}catch(h){}return this},show:function(c){if(!(Math.abs(c)>this.images.length-1)){var b=this,e=b.$wrap.find(\"img\").addClass(\"deleteable\"),d={relatedTarget:b.$container[0]};b.$container.trigger(a.Event(\"backstretch.before\",d),[b,c]);this.index=c;clearInterval(b.interval);b.$img=a(\"\").css(s).bind(\"load\",function(f){var h=this.width||a(f.target).width();f=this.height||a(f.target).height();a(this).data(\"ratio\",h/f);a(this).fadeIn(b.options.speed||b.options.fade,function(){e.remove();b.paused||b.cycle();a([\"after\",\"show\"]).each(function(){b.$container.trigger(a.Event(\"backstretch.\"+this,d),[b,c])})});b.resize()}).appendTo(b.$wrap);b.$img.attr(\"src\",b.images[c]);return b}},next:function(){return this.show(this.indext||-1e||h&&6>h||\"palmGetResource\"in d&&e&&534>e||-1"},{"title":"","date":"2020-04-30T17:06:42.606Z","updated":"2020-04-30T17:06:42.606Z","comments":true,"path":"taotao/js/TimeCircles.js","permalink":"/taotao/js/TimeCircles.js","excerpt":"","text":"(function($) { var limited_mode = false; var tick_duration = 200; var debug = (location.hash === \"#debug\"); function debug_log(msg) { if (debug) { console.log(msg); } } var allUnits = [\"Days\", \"Hours\", \"Minutes\", \"Seconds\"]; var nextUnits = { Seconds: \"Minutes\", Minutes: \"Hours\", Hours: \"Days\", Days: \"Years\" }; var secondsIn = { Seconds: 1, Minutes: 60, Hours: 3600, Days: 86400, Months: 2678400, Years: 31536000 }; function hexToRgb(hex) { var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i; hex = hex.replace(shorthandRegex, function(m, r, g, b) { return r + r + g + g + b + b; }); var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex); return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null; } function isCanvasSupported() { var elem = document.createElement('canvas'); return !!(elem.getContext && elem.getContext('2d')); } function s4() { return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1); } function guid() { return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4(); } if (!Array.prototype.indexOf) { Array.prototype.indexOf = function(elt) { var len = this.length >>> 0; var from = Number(arguments[1]) || 0; from = (from < 0) ? Math.ceil(from) : Math.floor(from); if (from < 0) from += len; for (; from < len; from++) { if (from in this && this[from] === elt) return from; } return -1; } ; } function parse_date(str) { var match = str.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}\\s[0-9]{1,2}:[0-9]{2}:[0-9]{2}$/); if (match !== null && match.length > 0) { var parts = str.split(\" \"); var date = parts[0].split(\"-\"); var time = parts[1].split(\":\"); return new Date(date[0],date[1] - 1,date[2],time[0],time[1],time[2]); } var d = Date.parse(str); if (!isNaN(d)) return d; d = Date.parse(str.replace(/-/g, '/').replace('T', ' ')); if (!isNaN(d)) return d; return new Date(); } function parse_times(diff, old_diff, total_duration, units, floor) { var raw_time = {}; var raw_old_time = {}; var time = {}; var pct = {}; var old_pct = {}; var old_time = {}; var greater_unit = null; for (var i in units) { var unit = units[i]; var maxUnits; if (greater_unit === null) { maxUnits = total_duration / secondsIn[unit]; } else { maxUnits = secondsIn[greater_unit] / secondsIn[unit]; } var curUnits = (diff / secondsIn[unit]); var oldUnits = (old_diff / secondsIn[unit]); if (floor) curUnits = Math.floor(curUnits); if (floor) oldUnits = Math.floor(oldUnits); if (unit !== \"Days\") { curUnits = curUnits % maxUnits; oldUnits = oldUnits % maxUnits; } raw_time[unit] = curUnits; time[unit] = Math.abs(curUnits); raw_old_time[unit] = oldUnits; old_time[unit] = Math.abs(oldUnits); pct[unit] = Math.abs(curUnits) / maxUnits; old_pct[unit] = Math.abs(oldUnits) / maxUnits; greater_unit = unit; } return { raw_time: raw_time, raw_old_time: raw_old_time, time: time, old_time: old_time, pct: pct, old_pct: old_pct }; } var TC_Instance_List = {}; if (window !== window.top && typeof window.top.TC_Instance_List !== \"undefined\") { TC_Instance_List = window.top.TC_Instance_List; } else { window.top.TC_Instance_List = TC_Instance_List; } (function() { var vendors = ['webkit', 'moz']; for (var x = 0; x < vendors.length && !window.top.requestAnimationFrame; ++x) { window.top.requestAnimationFrame = window.top[vendors[x] + 'RequestAnimationFrame']; window.top.cancelAnimationFrame = window.top[vendors[x] + 'CancelAnimationFrame']; } if (!window.top.requestAnimationFrame || !window.top.cancelAnimationFrame) { window.top.requestAnimationFrame = function(callback, element, instance) { if (typeof instance === \"undefined\") instance = { data: { last_frame: 0 } }; var currTime = new Date().getTime(); var timeToCall = Math.max(0, 16 - (currTime - instance.data.last_frame)); var id = window.top.setTimeout(function() { callback(currTime + timeToCall); }, timeToCall); instance.data.last_frame = currTime + timeToCall; return id; } ; window.top.cancelAnimationFrame = function(id) { clearTimeout(id); } ; } } )(); var TC_Instance = function(element, options) { this.element = element; this.container; this.listeners = null; this.data = { paused: false, last_frame: 0, animation_frame: null, timer: false, total_duration: null, prev_time: null, drawn_units: [], text_elements: { Days: null, Hours: null, Minutes: null, Seconds: null }, attributes: { canvas: null, context: null, item_size: null, line_width: null, radius: null, outer_radius: null }, state: { fading: { Days: false, Hours: false, Minutes: false, Seconds: false } } }; this.config = null; this.setOptions(options); this.initialize(); }; TC_Instance.prototype.initialize = function(clear_listeners) { this.data.drawn_units = []; for (var unit in this.config.time) { if (this.config.time[unit].show) { this.data.drawn_units.push(unit); } } $(this.element).children('div.time_circles').remove(); if (typeof clear_listeners === \"undefined\") clear_listeners = true; if (clear_listeners || this.listeners === null) { this.listeners = { all: [], visible: [] }; } this.container = $(\"\"); this.container.addClass('time_circles'); this.container.appendTo(this.element); var height = this.element.offsetHeight; var width = this.element.offsetWidth; if (height === 0) height = $(this.element).height(); if (width === 0) width = $(this.element).width(); if (height === 0 && width > 0) height = width / this.data.drawn_units.length; else if (width === 0 && height > 0) width = height * this.data.drawn_units.length; var canvasElement = document.createElement('canvas'); canvasElement.width = width; canvasElement.height = height; this.data.attributes.canvas = $(canvasElement); this.data.attributes.canvas.appendTo(this.container); var canvasSupported = isCanvasSupported(); if (!canvasSupported && typeof G_vmlCanvasManager !== \"undefined\") { G_vmlCanvasManager.initElement(canvasElement); limited_mode = true; canvasSupported = true; } if (canvasSupported) { this.data.attributes.context = canvasElement.getContext('2d'); } this.data.attributes.item_size = Math.min(width / this.data.drawn_units.length, height); this.data.attributes.line_width = this.data.attributes.item_size * this.config.fg_width; this.data.attributes.radius = ((this.data.attributes.item_size * 0.8) - this.data.attributes.line_width) / 2; this.data.attributes.outer_radius = this.data.attributes.radius + 0.5 * Math.max(this.data.attributes.line_width, this.data.attributes.line_width * this.config.bg_width); var i = 0; for (var key in this.data.text_elements) { if (!this.config.time[key].show) continue; var textElement = $(\"\"); textElement.addClass('textDiv_' + key); textElement.css(\"top\", Math.round(0.35 * this.data.attributes.item_size)); textElement.css(\"left\", Math.round(i++ * this.data.attributes.item_size)); textElement.css(\"width\", this.data.attributes.item_size); var numberElement = $(\"\"); numberElement.css(\"font-size\", Math.round(0.21 * this.data.attributes.item_size)); numberElement.css(\"line-height\", Math.round(0.07 * this.data.attributes.item_size) + \"px\"); numberElement.appendTo(textElement); textElement.appendTo(this.container); var headerElement = $(\"\"); headerElement.text(this.config.time[key].text); headerElement.css(\"font-size\", Math.round(0.07 * this.data.attributes.item_size)); headerElement.css(\"line-height\", Math.round(0.07 * this.data.attributes.item_size) + \"px\"); headerElement.appendTo(textElement); this.data.text_elements[key] = numberElement; } if (this.config.start && this.data.paused === false) this.start(); } ; TC_Instance.prototype.update = function() { if (limited_mode) { this.data.attributes.context.clearRect(0, 0, this.data.attributes.canvas[0].width, this.data.attributes.canvas[0].hright); } var diff, old_diff; var prevDate = this.data.prev_time; var curDate = new Date(); this.data.prev_time = curDate; if (prevDate === null) prevDate = curDate; if (!this.config.count_past_zero) { if (curDate > this.data.attributes.ref_date) { for (var i in this.data.drawn_units) { var key = this.data.drawn_units[i]; this.data.text_elements[key].text(\"0\"); var x = (i * this.data.attributes.item_size) + (this.data.attributes.item_size / 2); var y = this.data.attributes.item_size / 2; var color = this.config.time[key].color; this.drawArc(x, y, color, 0); } this.stop(); return; } } diff = (this.data.attributes.ref_date - curDate) / 1000; old_diff = (this.data.attributes.ref_date - prevDate) / 1000; var floor = this.config.animation !== \"smooth\"; var visible_times = parse_times(diff, old_diff, this.data.total_duration, this.data.drawn_units, floor); var all_times = parse_times(diff, old_diff, secondsIn[\"Years\"], allUnits, floor); var i = 0; var j = 0; var lastKey = null; var cur_shown = this.data.drawn_units.slice(); for (var i in allUnits) { var key = allUnits[i]; if (Math.floor(all_times.raw_time[key]) !== Math.floor(all_times.raw_old_time[key])) { this.notifyListeners(key, Math.floor(all_times.time[key]), Math.floor(diff), \"all\"); } if (cur_shown.indexOf(key) < 0) continue; if (Math.floor(visible_times.raw_time[key]) !== Math.floor(visible_times.raw_old_time[key])) { this.notifyListeners(key, Math.floor(visible_times.time[key]), Math.floor(diff), \"visible\"); } if(i==0){ console.log('modify here') this.data.text_elements[key].text(Math.floor(Math.abs(visible_times.time[key])-1)); }else{ this.data.text_elements[key].text(Math.floor(Math.abs(visible_times.time[key]))); } var x = (j * this.data.attributes.item_size) + (this.data.attributes.item_size / 2); var y = this.data.attributes.item_size / 2; var color = this.config.time[key].color; if (this.config.animation === \"smooth\") { if (lastKey !== null && !limited_mode) { if (Math.floor(visible_times.time[lastKey]) > Math.floor(visible_times.old_time[lastKey])) { this.radialFade(x, y, color, 1, key); this.data.state.fading[key] = true; } else if (Math.floor(visible_times.time[lastKey]) < Math.floor(visible_times.old_time[lastKey])) { this.radialFade(x, y, color, 0, key); this.data.state.fading[key] = true; } } if (!this.data.state.fading[key]) { this.drawArc(x, y, color, visible_times.pct[key]); } } else { this.animateArc(x, y, color, visible_times.pct[key], visible_times.old_pct[key], (new Date()).getTime() + tick_duration); } lastKey = key; j++; } var _this = this; var update = function() { _this.update.call(_this); }; if (this.config.animation === \"smooth\") { this.data.animation_frame = window.top.requestAnimationFrame(update, _this.element, _this); } else { var delay = (diff % 1) * 1000; if (delay < 0) delay = 1000 + delay; delay += 50; _this.data.animation_frame = window.top.setTimeout(function() { _this.data.animation_frame = window.top.requestAnimationFrame(update, _this.element, _this); }, delay); } } ; TC_Instance.prototype.animateArc = function(x, y, color, target_pct, cur_pct, animation_end) { if (this.data.attributes.context === null) return; var diff = cur_pct - target_pct; if (Math.abs(diff) > 0.5) { if (target_pct === 0) { this.radialFade(x, y, color, 1); } else { this.radialFade(x, y, color, 0); } } else { var progress = (tick_duration - (animation_end - (new Date()).getTime())) / tick_duration; if (progress > 1) progress = 1; var pct = (cur_pct * (1 - progress)) + (target_pct * progress); this.drawArc(x, y, color, pct); if (progress >= 1) return; var _this = this; window.top.requestAnimationFrame(function() { _this.animateArc(x, y, color, target_pct, cur_pct, animation_end); }, this.element); } } ; TC_Instance.prototype.drawArc = function(x, y, color, pct) { if (this.data.attributes.context === null) return; var clear_radius = Math.max(this.data.attributes.outer_radius, this.data.attributes.item_size / 2); if (!limited_mode) { this.data.attributes.context.clearRect(x - clear_radius, y - clear_radius, clear_radius * 2, clear_radius * 2); } if (this.config.use_background) { this.data.attributes.context.beginPath(); this.data.attributes.context.arc(x, y, this.data.attributes.radius, 0, 2 * Math.PI, false); this.data.attributes.context.lineWidth = this.data.attributes.line_width * this.config.bg_width; this.data.attributes.context.fillStyle = this.config.circle_bg_fill_color; this.data.attributes.context.fill(); this.data.attributes.context.strokeStyle = this.config.circle_bg_color; this.data.attributes.context.stroke(); } var startAngle, endAngle, counterClockwise; var defaultOffset = (-0.5 * Math.PI); var fullCircle = 2 * Math.PI; startAngle = defaultOffset + (this.config.start_angle / 360 * fullCircle); var offset = (2 * pct * Math.PI); if (this.config.direction === \"Both\") { counterClockwise = false; startAngle -= (offset / 2); endAngle = startAngle + offset; } else { if (this.config.direction === \"Clockwise\") { counterClockwise = false; endAngle = startAngle + offset; } else { counterClockwise = true; endAngle = startAngle - offset; } } this.data.attributes.context.beginPath(); this.data.attributes.context.arc(x, y, this.data.attributes.radius, startAngle, endAngle, counterClockwise); this.data.attributes.context.lineWidth = this.data.attributes.line_width; this.data.attributes.context.strokeStyle = color; this.data.attributes.context.stroke(); } ; TC_Instance.prototype.radialFade = function(x, y, color, from, key) { var rgb = hexToRgb(color); var _this = this; var step = 0.2 * ((from === 1) ? -1 : 1); var i; for (i = 0; from = 0; i++) { (function() { var delay = 50 * i; var rgba = \"rgba(\" + rgb.r + \", \" + rgb.g + \", \" + rgb.b + \", \" + (Math.round(from * 10) / 10) + \")\"; window.top.setTimeout(function() { _this.drawArc(x, y, rgba, 1); }, delay); }()); from += step; } if (typeof key !== undefined) { window.top.setTimeout(function() { _this.data.state.fading[key] = false; }, 50 * i); } } ; TC_Instance.prototype.timeLeft = function() { var now = new Date(); return ((this.data.attributes.ref_date - now) / 1000); } ; TC_Instance.prototype.start = function() { window.top.cancelAnimationFrame(this.data.animation_frame); window.top.clearTimeout(this.data.animation_frame) var attr_data_date = $(this.element).data('date'); if (typeof attr_data_date === \"undefined\") { attr_data_date = $(this.element).attr('data-date'); } if (typeof attr_data_date === \"string\") { this.data.attributes.ref_date = parse_date(attr_data_date); } else if (typeof this.data.timer === \"number\") { if (this.data.paused) { this.data.attributes.ref_date = (new Date()).getTime() + (this.data.timer * 1000); } } else { var attr_data_timer = $(this.element).data('timer'); if (typeof attr_data_timer === \"undefined\") { attr_data_timer = $(this.element).attr('data-timer'); } if (typeof attr_data_timer === \"string\") { attr_data_timer = parseFloat(attr_data_timer); } if (typeof attr_data_timer === \"number\") { this.data.timer = attr_data_timer; this.data.attributes.ref_date = (new Date()).getTime() + (attr_data_timer * 1000); } else { this.data.attributes.ref_date = this.config.ref_date; } } this.data.paused = false; this.update.call(this); } ; TC_Instance.prototype.restart = function() { this.data.timer = false; this.start(); } ; TC_Instance.prototype.stop = function() { if (typeof this.data.timer === \"number\") { this.data.timer = this.timeLeft(this); } this.data.paused = true; window.top.cancelAnimationFrame(this.data.animation_frame); } ; TC_Instance.prototype.destroy = function() { this.stop(); this.container.remove(); $(this.element).removeAttr('data-tc-id'); $(this.element).removeData('tc-id'); } ; TC_Instance.prototype.setOptions = function(options) { if (this.config === null) { this.default_options.ref_date = new Date(); this.config = $.extend(true, {}, this.default_options); } $.extend(true, this.config, options); this.data.total_duration = this.config.total_duration; if (typeof this.data.total_duration === \"string\") { if (typeof secondsIn[this.data.total_duration] !== \"undefined\") { this.data.total_duration = secondsIn[this.data.total_duration]; } else if (this.data.total_duration === \"Auto\") { for (var unit in this.config.time) { if (this.config.time[unit].show) { this.data.total_duration = secondsIn[nextUnits[unit]]; this.data.total_duration-=24*3600 break; } } } else { this.data.total_duration = secondsIn[\"Years\"]; console.error(\"Valid values for TimeCircles config.total_duration are either numeric, or (string) Years, Months, Days, Hours, Minutes, Auto\"); } } } ; TC_Instance.prototype.addListener = function(f, context, type) { if (typeof f !== \"function\") return; if (typeof type === \"undefined\") type = \"visible\"; this.listeners[type].push({ func: f, scope: context }); } ; TC_Instance.prototype.notifyListeners = function(unit, value, total, type) { for (var i = 0; i < this.listeners[type].length; i++) { var listener = this.listeners[type][i]; listener.func.apply(listener.scope, [unit, value, total]); } } ; TC_Instance.prototype.default_options = { ref_date: new Date(), start: true, animation: \"smooth\", count_past_zero: true, circle_bg_color: \"#60686F\", circle_bg_fill_color: \"#ffffff\", use_background: true, fg_width: 0.1, bg_width: 1.2, total_duration: \"Auto\", direction: \"Clockwise\", start_angle: 0, time: { Days: { show: true, text: \"Days\", color: \"#FC6\" }, Hours: { show: true, text: \"Hours\", color: \"#9CF\" }, Minutes: { show: true, text: \"Minutes\", color: \"#BFB\" }, Seconds: { show: true, text: \"Seconds\", color: \"#F99\" } } }; var TC_Class = function(elements, options) { this.elements = elements; this.options = options; this.foreach(); }; TC_Class.prototype.getInstance = function(element) { var instance; var cur_id = $(element).data(\"tc-id\"); if (typeof cur_id === \"undefined\") { cur_id = guid(); $(element).attr(\"data-tc-id\", cur_id); } if (typeof TC_Instance_List[cur_id] === \"undefined\") { var options = this.options; var element_options = $(element).data('options'); if (typeof element_options === \"string\") { element_options = JSON.parse(element_options); } if (typeof element_options === \"object\") { options = $.extend(true, {}, this.options, element_options); } instance = new TC_Instance(element,options); TC_Instance_List[cur_id] = instance; } else { instance = TC_Instance_List[cur_id]; if (typeof this.options !== \"undefined\") { instance.setOptions(this.options); } } return instance; } ; TC_Class.prototype.foreach = function(callback) { var _this = this; this.elements.each(function() { var instance = _this.getInstance(this); if (typeof callback === \"function\") { callback(instance); } }); return this; } ; TC_Class.prototype.start = function() { this.foreach(function(instance) { instance.start(); }); return this; } ; TC_Class.prototype.stop = function() { this.foreach(function(instance) { instance.stop(); }); return this; } ; TC_Class.prototype.restart = function() { this.foreach(function(instance) { instance.restart(); }); return this; } ; TC_Class.prototype.rebuild = function() { this.foreach(function(instance) { instance.initialize(false); }); return this; } ; TC_Class.prototype.getTime = function() { return this.getInstance(this.elements[0]).timeLeft(); } ; TC_Class.prototype.addListener = function(f, type) { if (typeof type === \"undefined\") type = \"visible\"; var _this = this; this.foreach(function(instance) { instance.addListener(f, _this.elements, type); }); return this; } ; TC_Class.prototype.destroy = function() { this.foreach(function(instance) { instance.destroy(); }); return this; } ; TC_Class.prototype.end = function() { return this.elements; } ; $.fn.TimeCircles = function(options) { return new TC_Class(this,options); } ; }(jQuery));"},{"title":"","date":"2020-02-07T12:06:45.201Z","updated":"2020-02-07T12:06:45.176Z","comments":true,"path":"taotao/js/snowy.js","permalink":"/taotao/js/snowy.js","excerpt":"","text":"var THREE=THREE||{};if(!self.Int32Array)self.Int32Array=Array,self.Float32Array=Array;THREE.Color=function(a){a!==void 0&&this.setHex(a);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSV:function(a,b,c){var d,f,e;if(c===0)this.r=this.g=this.b=0;else switch(d=Math.floor(a*6),f=a*6-d,a=c*(1-b),e=c*(1-b*f),b=c*(1-b*(1-f)),d){case 1:this.r=e;this.g=c;this.b=a;break;case 2:this.r=a;this.g=c;this.b=b;break;case 3:this.r=a;this.g=e;this.b=c;break;case 4:this.r=b;this.g=a;this.b=c;break;case 5:this.r=c;this.g=a;this.b=e;break;case 6:case 0:this.r=c,this.g=b,this.b=a}return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},getHex:function(){return~~(this.r*255)e.getLeft()?b:e.getLeft();c=c>e.getTop()?c:e.getTop();d=d=0};this.empty=function(){h=!0;f=d=c=b=0;a()};this.isEmpty=function(){return h}};THREE.Math={clamp:function(a,b,c){return ac?c:a},clampBottom:function(a,b){return a"},{"title":"","date":"2020-02-07T12:06:41.169Z","updated":"2020-02-07T12:06:41.131Z","comments":true,"path":"taotao/js/jquery.js","permalink":"/taotao/js/jquery.js","excerpt":"","text":"/*!jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license*/!function(a,b){\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error(\"jQuery requires a window with a document\");return b(a)}:b(a)}(\"undefined\"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k=\"\".trim,l={},m=\"1.11.0\",n=function(a,b){return new n.fn.init(a,b)},o=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,p=/^-ms-/,q=/-([\\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:\"\",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for(\"boolean\"==typeof g&&(j=g,g=arguments[h]||{},h++),\"object\"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:\"jQuery\"+(m+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return\"function\"===n.type(a)},isArray:Array.isArray||function(a){return\"array\"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||\"object\"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,\"constructor\")&&!j.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?h[i.call(a)]||\"object\":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,\"ms-\").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call(\"\\ufeff\\xa0\")?function(a){return null==a?\"\":k.call(a)}:function(a){return null==a?\"\":(a+\"\").replace(o,\"\")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,\"string\"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return\"string\"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(a,b){h[\"[object \"+b+\"]\"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return\"function\"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:\"array\"===c||0===b||\"number\"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=\"sizzle\"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A=\"undefined\",B=1"}],"posts":[{"title":"åŠ¨æ¼«è¯­å½•æ”¶é›†","slug":"åŠ¨æ¼«è¯­å½•æ”¶é›†","date":"2019-10-07T15:05:34.000Z","updated":"2019-10-07T15:04:42.463Z","comments":true,"path":"2019/10/07/åŠ¨æ¼«è¯­å½•æ”¶é›†/","link":"","permalink":"/2019/10/07/åŠ¨æ¼«è¯­å½•æ”¶é›†/","excerpt":"","text":"1.è¿™æ—©å·²å¸ç©ºè§æƒ¯çš„é£æ™¯, åœ¨æˆ‘ä»¬é•¿å¤§åä¹Ÿä¼šå˜çš„é¢ç›®å…¨é. ä½†å°±ç®—æ˜¯é£äº‘å˜åŒ–, ä¹Ÿè¿˜æ˜¯æœ‰ä¸ä¼šæ”¹å˜çš„ä¸œè¥¿åœ¨è®°å¿†çš„æ·±å¤„,å¥½å¥½åœ°ä¿å­˜ç€â€¦ â€”â€”åœŸé—´åŸ‹ 2.é€‰é¡¹ä¸€ç›´éƒ½æœ‰ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬é€‰æ‹©äº†è¿™é‡Œï¼â€”â€”æ¯”å®‡å®™æ›´è¿œçš„åœ°æ–¹","categories":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}],"tags":[{"name":"åŠ¨æ¼«","slug":"åŠ¨æ¼«","permalink":"/tags/åŠ¨æ¼«/"}],"keywords":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}]},{"title":"LearnOpenGL-æ¨¡å‹åŠ è½½","slug":"LearnOpenGL-æ¨¡å‹åŠ è½½","date":"2019-10-07T15:02:03.000Z","updated":"2019-10-07T15:01:56.405Z","comments":true,"path":"2019/10/07/LearnOpenGL-æ¨¡å‹åŠ è½½/","link":"","permalink":"/2019/10/07/LearnOpenGL-æ¨¡å‹åŠ è½½/","excerpt":"","text":"@[toc] AssimpAssimpæ•°æ®ç»“æ„çš„ï¼ˆç®€åŒ–ï¼‰æ¨¡å‹å¦‚ä¸‹ï¼š å’Œæè´¨å’Œç½‘æ ¼(Mesh)ä¸€æ ·ï¼Œæ‰€æœ‰çš„åœºæ™¯/æ¨¡å‹æ•°æ®éƒ½åŒ…å«åœ¨Sceneå¯¹è±¡ä¸­.Sceneå¯¹è±¡ä¹ŸåŒ…å«äº†åœºæ™¯æ ¹èŠ‚ç‚¹çš„å¼•ç”¨. åœºæ™¯çš„Root nodeï¼ˆæ ¹èŠ‚ç‚¹ï¼‰å¯èƒ½åŒ…å«å­èŠ‚ç‚¹ï¼ˆå’Œå…¶å®ƒçš„èŠ‚ç‚¹ä¸€æ ·ï¼‰ï¼Œå®ƒä¼šæœ‰ä¸€ç³»åˆ—æŒ‡å‘åœºæ™¯å¯¹è±¡ä¸­mMeshesæ•°ç»„ä¸­å‚¨å­˜çš„ç½‘æ ¼æ•°æ®çš„ç´¢å¼•.Sceneä¸‹çš„mMeshesæ•°ç»„å‚¨å­˜äº†çœŸæ­£çš„Meshå¯¹è±¡ï¼ŒèŠ‚ç‚¹ä¸­çš„mMeshesæ•°ç»„ä¿å­˜çš„åªæ˜¯åœºæ™¯ä¸­ç½‘æ ¼æ•°ç»„çš„ç´¢å¼•. ä¸€ä¸ªMeshå¯¹è±¡æœ¬èº«åŒ…å«äº†æ¸²æŸ“æ‰€éœ€è¦çš„æ‰€æœ‰ç›¸å…³æ•°æ®ï¼Œåƒæ˜¯é¡¶ç‚¹ä½ç½®ã€æ³•å‘é‡ã€çº¹ç†åæ ‡ã€é¢(Face)å’Œç‰©ä½“çš„æè´¨. ä¸€ä¸ªç½‘æ ¼åŒ…å«äº†å¤šä¸ªé¢.Faceä»£è¡¨çš„æ˜¯ç‰©ä½“çš„æ¸²æŸ“å›¾å…ƒ(Primitive)ï¼ˆä¸‰è§’å½¢ã€æ–¹å½¢ã€ç‚¹ï¼‰.ä¸€ä¸ªé¢åŒ…å«äº†ç»„æˆå›¾å…ƒçš„é¡¶ç‚¹çš„ç´¢å¼•.ç”±äºé¡¶ç‚¹å’Œç´¢å¼•æ˜¯åˆ†å¼€çš„ï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•ç¼“å†²æ¥æ¸²æŸ“æ˜¯éå¸¸ç®€å•çš„. æœ€åï¼Œä¸€ä¸ªç½‘æ ¼ä¹ŸåŒ…å«äº†ä¸€ä¸ªMaterialå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å‡½æ•°èƒ½è®©æˆ‘ä»¬è·å–ç‰©ä½“çš„æè´¨å±æ€§ï¼Œæ¯”å¦‚è¯´é¢œè‰²å’Œçº¹ç†è´´å›¾ï¼ˆæ¯”å¦‚æ¼«åå°„å’Œé•œé¢å…‰è´´å›¾ï¼‰. æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å°†ä¸€ä¸ªç‰©ä½“åŠ è½½åˆ°Sceneå¯¹è±¡ä¸­ï¼Œéå†èŠ‚ç‚¹ï¼Œè·å–å¯¹åº”çš„Meshå¯¹è±¡ï¼ˆæˆ‘ä»¬éœ€è¦é€’å½’æœç´¢æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼‰ï¼Œå¹¶å¤„ç†æ¯ä¸ªMeshå¯¹è±¡æ¥è·å–é¡¶ç‚¹æ•°æ®ã€ç´¢å¼•ä»¥åŠå®ƒçš„æè´¨å±æ€§.æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€ç³»åˆ—çš„ç½‘æ ¼æ•°æ®ï¼Œæˆ‘ä»¬ä¼šå°†å®ƒä»¬åŒ…å«åœ¨ä¸€ä¸ªModelå¯¹è±¡ä¸­. ç½‘æ ¼å½“ä½¿ç”¨å»ºæ¨¡å·¥å…·å¯¹ç‰©ä½“å»ºæ¨¡çš„æ—¶å€™ï¼Œè‰ºæœ¯å®¶é€šå¸¸ä¸ä¼šç”¨å•ä¸ªå½¢çŠ¶åˆ›å»ºå‡ºæ•´ä¸ªæ¨¡å‹.é€šå¸¸æ¯ä¸ªæ¨¡å‹éƒ½ç”±å‡ ä¸ªå­æ¨¡å‹/å½¢çŠ¶ç»„åˆè€Œæˆ.ç»„åˆæ¨¡å‹çš„æ¯ä¸ªå•ç‹¬çš„å½¢çŠ¶å°±å«åšä¸€ä¸ªç½‘æ ¼(Mesh).æ¯”å¦‚è¯´æœ‰ä¸€ä¸ªäººå½¢çš„è§’è‰²ï¼šè‰ºæœ¯å®¶é€šå¸¸ä¼šå°†å¤´éƒ¨ã€å››è‚¢ã€è¡£æœã€æ­¦å™¨å»ºæ¨¡ä¸ºåˆ†å¼€çš„ç»„ä»¶ï¼Œå¹¶å°†è¿™äº›ç½‘æ ¼ç»„åˆè€Œæˆçš„ç»“æœè¡¨ç°ä¸ºæœ€ç»ˆçš„æ¨¡å‹ã€‚ä¸€ä¸ªç½‘æ ¼æ˜¯æˆ‘ä»¬åœ¨OpenGLä¸­ç»˜åˆ¶ç‰©ä½“æ‰€éœ€çš„æœ€å°å•ä½ï¼ˆé¡¶ç‚¹æ•°æ®ã€ç´¢å¼•å’Œæè´¨å±æ€§ï¼‰.ä¸€ä¸ªæ¨¡å‹ï¼ˆé€šå¸¸ï¼‰ä¼šåŒ…æ‹¬å¤šä¸ªç½‘æ ¼. ç½‘æ ¼é¦–å…ˆæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹æˆ‘ä»¬ç›®å‰å­¦åˆ°çš„çŸ¥è¯†ï¼Œæƒ³æƒ³ä¸€ä¸ªç½‘æ ¼æœ€å°‘éœ€è¦ä»€ä¹ˆæ•°æ®.ä¸€ä¸ªç½‘æ ¼åº”è¯¥è‡³å°‘éœ€è¦ä¸€ç³»åˆ—çš„é¡¶ç‚¹ï¼Œæ¯ä¸ªé¡¶ç‚¹åŒ…å«ä¸€ä¸ªä½ç½®å‘é‡ã€ä¸€ä¸ªæ³•å‘é‡å’Œä¸€ä¸ªçº¹ç†åæ ‡å‘é‡.ä¸€ä¸ªç½‘æ ¼è¿˜åº”è¯¥åŒ…å«ç”¨äºç´¢å¼•ç»˜åˆ¶çš„ç´¢å¼•ä»¥åŠçº¹ç†å½¢å¼çš„æè´¨æ•°æ®ï¼ˆæ¼«åå°„/é•œé¢å…‰è´´å›¾ï¼‰. æ—¢ç„¶æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç½‘æ ¼ç±»çš„æœ€ä½éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨OpenGLä¸­å®šä¹‰ä¸€ä¸ªé¡¶ç‚¹äº†ï¼š struct Vertex &#123; glm::vec3 Position; glm::vec3 Normal; glm::vec2 TexCoords;&#125;; æˆ‘ä»¬å°†æ‰€æœ‰éœ€è¦çš„å‘é‡å‚¨å­˜åˆ°ä¸€ä¸ªå«åšVertexçš„ç»“æ„ä½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ç´¢å¼•æ¯ä¸ªé¡¶ç‚¹å±æ€§.é™¤äº†Vertexç»“æ„ä½“ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†çº¹ç†æ•°æ®æ•´ç†åˆ°ä¸€ä¸ªTextureç»“æ„ä½“ä¸­.struct Texture &#123; unsigned int id; string type;&#125;; æˆ‘ä»¬å‚¨å­˜äº†çº¹ç†çš„idä»¥åŠå®ƒçš„ç±»å‹ï¼Œæ¯”å¦‚æ˜¯æ¼«åå°„è´´å›¾æˆ–è€…æ˜¯é•œé¢å…‰è´´å›¾. çŸ¥é“äº†é¡¶ç‚¹å’Œçº¹ç†çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å®šä¹‰ç½‘æ ¼ç±»çš„ç»“æ„äº†ï¼š class Mesh &#123; public: /* ç½‘æ ¼æ•°æ® */ vector&lt;Vertex&gt; vertices; vector&lt;unsigned int&gt; indices; vector&lt;Texture&gt; textures; /* å‡½æ•° */ Mesh(vector&lt;Vertex&gt; vertices, vector&lt;unsigned int&gt; indices, vector&lt;Texture&gt; textures); void Draw(Shader shader); private: /* æ¸²æŸ“æ•°æ® */ unsigned int VAO, VBO, EBO; /* å‡½æ•° */ void setupMesh();&#125;; æˆ‘ä»¬å°†æ‰€æœ‰å¿…é¡»çš„æ•°æ®èµ‹äºˆäº†ç½‘æ ¼ï¼Œæˆ‘ä»¬åœ¨setupMeshå‡½æ•°ä¸­åˆå§‹åŒ–ç¼“å†²ï¼Œå¹¶æœ€ç»ˆä½¿ç”¨Drawå‡½æ•°æ¥ç»˜åˆ¶ç½‘æ ¼.æ³¨æ„æˆ‘ä»¬å°†ä¸€ä¸ªç€è‰²å™¨ä¼ å…¥äº†Drawå‡½æ•°ä¸­ï¼Œå°†ç€è‰²å™¨ä¼ å…¥ç½‘æ ¼ç±»ä¸­å¯ä»¥è®©æˆ‘ä»¬åœ¨ç»˜åˆ¶ä¹‹å‰è®¾ç½®ä¸€äº›uniformï¼ˆåƒæ˜¯é“¾æ¥é‡‡æ ·å™¨åˆ°çº¹ç†å•å…ƒï¼‰. Meshæ„é€ å‡½æ•°ï¼šMesh(vector&lt;Vertex&gt; vertices, vector&lt;unsigned int&gt; indices, vector&lt;Texture&gt; textures)&#123; this-&gt;vertices = vertices; this-&gt;indices = indices; this-&gt;textures = textures; setupMesh();&#125; åˆå§‹åŒ–ç”±äºæœ‰äº†æ„é€ å™¨ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€å¤§åˆ—çš„ç½‘æ ¼æ•°æ®ç”¨äºæ¸²æŸ“.åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¿˜å¿…é¡»é…ç½®æ­£ç¡®çš„ç¼“å†²ï¼Œå¹¶é€šè¿‡é¡¶ç‚¹å±æ€§æŒ‡é’ˆå®šä¹‰é¡¶ç‚¹ç€è‰²å™¨çš„å¸ƒå±€.ç°åœ¨ä½ åº”è¯¥å¯¹è¿™äº›æ¦‚å¿µéƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œä½†æˆ‘ä»¬è¿™æ¬¡ä¼šç¨å¾®æœ‰ä¸€ç‚¹å˜åŠ¨ï¼Œä½¿ç”¨ç»“æ„ä½“ä¸­çš„é¡¶ç‚¹æ•°æ®ï¼švoid setupMesh()&#123; glGenVertexArrays(1, &amp;VAO); glGenBuffers(1, &amp;VBO); glGenBuffers(1, &amp;EBO); glBindVertexArray(VAO); glBindBuffer(GL_ARRAY_BUFFER, VBO); glBufferData(GL_ARRAY_BUFFER, vertices.size() * sizeof(Vertex), &amp;vertices[0], GL_STATIC_DRAW); glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO); glBufferData(GL_ELEMENT_ARRAY_BUFFER, indices.size() * sizeof(unsigned int), &amp;indices[0], GL_STATIC_DRAW); // é¡¶ç‚¹ä½ç½® glEnableVertexAttribArray(0); glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)0); // é¡¶ç‚¹æ³•çº¿ glEnableVertexAttribArray(1); glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)offsetof(Vertex, Normal)); // é¡¶ç‚¹çº¹ç†åæ ‡ glEnableVertexAttribArray(2); glVertexAttribPointer(2, 2, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)offsetof(Vertex, TexCoords)); glBindVertexArray(0);&#125; C++ç»“æ„ä½“æœ‰ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§ï¼Œå®ƒä»¬çš„å†…å­˜å¸ƒå±€æ˜¯è¿ç»­çš„(Sequential).ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å°†ç»“æ„ä½“ä½œä¸ºä¸€ä¸ªæ•°æ®æ•°ç»„ä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šä»¥é¡ºåºæ’åˆ—ç»“æ„ä½“çš„å˜é‡ï¼Œè¿™å°†ä¼šç›´æ¥è½¬æ¢ä¸ºæˆ‘ä»¬åœ¨æ•°ç»„ç¼“å†²ä¸­æ‰€éœ€è¦çš„floatï¼ˆå®é™…ä¸Šæ˜¯å­—èŠ‚ï¼‰æ•°ç»„.æ¯”å¦‚è¯´ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¡«å……åçš„Vertexç»“æ„ä½“ï¼Œé‚£ä¹ˆå®ƒçš„å†…å­˜å¸ƒå±€å°†ä¼šç­‰äºï¼š Vertex vertex;vertex.Position = glm::vec3(0.2f, 0.4f, 0.6f);vertex.Normal = glm::vec3(0.0f, 1.0f, 0.0f);vertex.TexCoords = glm::vec2(1.0f, 0.0f);// = [0.2f, 0.4f, 0.6f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f]; ç”±äºæœ‰äº†è¿™ä¸ªæœ‰ç”¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥ä¼ å…¥ä¸€å¤§åˆ—çš„Vertexç»“æ„ä½“çš„æŒ‡é’ˆä½œä¸ºç¼“å†²çš„æ•°æ®ï¼Œå®ƒä»¬å°†ä¼šå®Œç¾åœ°è½¬æ¢ä¸ºglBufferDataæ‰€èƒ½ç”¨çš„å‚æ•°ï¼š glBufferData(GL_ARRAY_BUFFER, vertices.size() * sizeof(Vertex), &amp;vertices[0], GL_STATIC_DRAW); è‡ªç„¶sizeofè¿ç®—ä¹Ÿå¯ä»¥ç”¨åœ¨ç»“æ„ä½“ä¸Šæ¥è®¡ç®—å®ƒçš„å­—èŠ‚å¤§å°.è¿™ä¸ªåº”è¯¥æ˜¯32å­—èŠ‚çš„ï¼ˆ8ä¸ªfloat * æ¯ä¸ª4å­—èŠ‚ï¼‰. ç»“æ„ä½“çš„å¦å¤–ä¸€ä¸ªå¾ˆå¥½çš„ç”¨é€”æ˜¯å®ƒçš„é¢„å¤„ç†æŒ‡ä»¤offsetof(s, m)ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¿™ä¸ªç»“æ„ä½“ä¸­å˜é‡çš„åå­—.è¿™ä¸ªå®ä¼šè¿”å›é‚£ä¸ªå˜é‡è·ç»“æ„ä½“å¤´éƒ¨çš„å­—èŠ‚åç§»é‡(Byte Offset).è¿™æ­£å¥½å¯ä»¥ç”¨åœ¨å®šä¹‰glVertexAttribPointerå‡½æ•°ä¸­çš„åç§»å‚æ•°ï¼š glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)offsetof(Vertex, Normal)); åç§»é‡ç°åœ¨æ˜¯ä½¿ç”¨offsetofæ¥å®šä¹‰äº†ï¼Œåœ¨è¿™é‡Œå®ƒä¼šå°†æ³•å‘é‡çš„å­—èŠ‚åç§»é‡è®¾ç½®ä¸ºç»“æ„ä½“ä¸­æ³•å‘é‡çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯3ä¸ªfloatï¼Œå³12å­—èŠ‚.æ³¨æ„ï¼Œæˆ‘ä»¬åŒæ ·å°†æ­¥é•¿å‚æ•°è®¾ç½®ä¸ºäº†Vertexç»“æ„ä½“çš„å¤§å°. ä½¿ç”¨è¿™æ ·çš„ä¸€ä¸ªç»“æ„ä½“ä¸ä»…èƒ½å¤Ÿæä¾›å¯è¯»æ€§æ›´é«˜çš„ä»£ç ï¼Œä¹Ÿå…è®¸æˆ‘ä»¬å¾ˆå®¹æ˜“åœ°æ‹“å±•è¿™ä¸ªç»“æ„.å¦‚æœæˆ‘ä»¬å¸Œæœ›æ·»åŠ å¦ä¸€ä¸ªé¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å®ƒæ·»åŠ åˆ°ç»“æ„ä½“ä¸­å°±å¯ä»¥äº†.ç”±äºå®ƒçš„çµæ´»æ€§ï¼Œæ¸²æŸ“çš„ä»£ç ä¸ä¼šè¢«ç ´å. æ¸²æŸ“æˆ‘ä»¬éœ€è¦ä¸ºMeshç±»å®šä¹‰æœ€åä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„Drawå‡½æ•°.åœ¨çœŸæ­£æ¸²æŸ“è¿™ä¸ªç½‘æ ¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨glDrawElementså‡½æ•°ä¹‹å‰å…ˆç»‘å®šç›¸åº”çš„çº¹ç†.ç„¶è€Œï¼Œè¿™å®é™…ä¸Šæœ‰äº›å›°éš¾ï¼Œæˆ‘ä»¬ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“è¿™ä¸ªç½‘æ ¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æœ‰å¤šå°‘çº¹ç†ã€çº¹ç†æ˜¯ä»€ä¹ˆç±»å‹çš„.æ‰€ä»¥æˆ‘ä»¬è¯¥å¦‚ä½•åœ¨ç€è‰²å™¨ä¸­è®¾ç½®çº¹ç†å•å…ƒå’Œé‡‡æ ·å™¨å‘¢ï¼Ÿ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾å®šä¸€ä¸ªå‘½åæ ‡å‡†ï¼šæ¯ä¸ªæ¼«åå°„çº¹ç†è¢«å‘½åä¸ºtexture_diffuseNï¼Œæ¯ä¸ªé•œé¢å…‰çº¹ç†åº”è¯¥è¢«å‘½åä¸ºtexture_specularNï¼Œå…¶ä¸­Nçš„èŒƒå›´æ˜¯1åˆ°çº¹ç†é‡‡æ ·å™¨æœ€å¤§å…è®¸çš„æ•°å­—.æ¯”å¦‚è¯´æˆ‘ä»¬å¯¹æŸä¸€ä¸ªç½‘æ ¼æœ‰3ä¸ªæ¼«åå°„çº¹ç†ï¼Œ2ä¸ªé•œé¢å…‰çº¹ç†ï¼Œå®ƒä»¬çš„çº¹ç†é‡‡æ ·å™¨åº”è¯¥ä¹‹åä¼šè¢«è°ƒç”¨ï¼š uniform sampler2D texture_diffuse1;uniform sampler2D texture_diffuse2;uniform sampler2D texture_diffuse3;uniform sampler2D texture_specular1;uniform sampler2D texture_specular2; æ ¹æ®è¿™ä¸ªæ ‡å‡†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç€è‰²å™¨ä¸­å®šä¹‰ä»»æ„éœ€è¦æ•°é‡çš„çº¹ç†é‡‡æ ·å™¨ï¼Œå¦‚æœä¸€ä¸ªç½‘æ ¼çœŸçš„åŒ…å«äº†ï¼ˆè¿™ä¹ˆå¤šï¼‰çº¹ç†ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çŸ¥é“å®ƒä»¬çš„åå­—æ˜¯ä»€ä¹ˆ.æ ¹æ®è¿™ä¸ªæ ‡å‡†ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½åœ¨ä¸€ä¸ªç½‘æ ¼ä¸­å¤„ç†ä»»æ„æ•°é‡çš„çº¹ç†ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥è‡ªç”±é€‰æ‹©éœ€è¦ä½¿ç”¨çš„æ•°é‡ï¼Œä»–åªéœ€è¦å®šä¹‰æ­£ç¡®çš„é‡‡æ ·å™¨å°±å¯ä»¥äº†ï¼ˆè™½ç„¶å®šä¹‰å°‘çš„è¯ä¼šæœ‰ç‚¹æµªè´¹ç»‘å®šå’Œuniformè°ƒç”¨ï¼‰. æœ€ç»ˆçš„æ¸²æŸ“ä»£ç æ˜¯è¿™æ ·çš„ï¼š void Draw(Shader shader) &#123; unsigned int diffuseNr = 1; unsigned int specularNr = 1; for(unsigned int i = 0; i &lt; textures.size(); i++) &#123; glActiveTexture(GL_TEXTURE0 + i); // åœ¨ç»‘å®šä¹‹å‰æ¿€æ´»ç›¸åº”çš„çº¹ç†å•å…ƒ // è·å–çº¹ç†åºå·ï¼ˆdiffuse_textureN ä¸­çš„ Nï¼‰ string number; string name = textures[i].type; if(name == \"texture_diffuse\") number = std::to_string(diffuseNr++); else if(name == \"texture_specular\") number = std::to_string(specularNr++); shader.setFloat((\"material.\" + name + number).c_str(), i); glBindTexture(GL_TEXTURE_2D, textures[i].id); &#125; glActiveTexture(GL_TEXTURE0); // ç»˜åˆ¶ç½‘æ ¼ glBindVertexArray(VAO); glDrawElements(GL_TRIANGLES, indices.size(), GL_UNSIGNED_INT, 0); glBindVertexArray(0);&#125; æˆ‘ä»¬é¦–å…ˆè®¡ç®—äº†æ¯ä¸ªçº¹ç†ç±»å‹çš„N-åˆ†é‡ï¼Œå¹¶å°†å…¶æ‹¼æ¥åˆ°çº¹ç†ç±»å‹å­—ç¬¦ä¸²ä¸Šï¼Œæ¥è·å–å¯¹åº”çš„uniformåç§°.æ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥æ‰¾å¯¹åº”çš„é‡‡æ ·å™¨ï¼Œå°†å®ƒçš„ä½ç½®å€¼è®¾ç½®ä¸ºå½“å‰æ¿€æ´»çš„çº¹ç†å•å…ƒï¼Œå¹¶ç»‘å®šçº¹ç†.è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨Drawå‡½æ•°ä¸­éœ€è¦ç€è‰²å™¨çš„åŸå› .æˆ‘ä»¬ä¹Ÿå°†â€material.â€æ·»åŠ åˆ°äº†æœ€ç»ˆçš„uniformåç§°ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å°†çº¹ç†å‚¨å­˜åœ¨ä¸€ä¸ªæè´¨ç»“æ„ä½“ä¸­ï¼ˆè¿™åœ¨æ¯ä¸ªå®ç°ä¸­å¯èƒ½éƒ½ä¸åŒï¼‰. æ¨¡å‹è¿™ä¸€èŠ‚æˆ‘ä»¬ä¼šä½¿ç”¨Assimpæ¥åŠ è½½æ¨¡å‹ï¼Œå¹¶å°†å®ƒè½¬æ¢(Translate)è‡³å¤šä¸ªåœ¨ä¸Šä¸€èŠ‚ä¸­åˆ›å»ºçš„Meshå¯¹è±¡.Modelçš„å®šä¹‰å¦‚ä¸‹:class Model &#123; public: /* å‡½æ•° */ Model(char *path) &#123; loadModel(path); &#125; void Draw(Shader shader); private: /* æ¨¡å‹æ•°æ® */ vector&lt;Mesh&gt; meshes; string directory; /* å‡½æ•° */ void loadModel(string path); void processNode(aiNode *node, const aiScene *scene); Mesh processMesh(aiMesh *mesh, const aiScene *scene); vector&lt;Texture&gt; loadMaterialTextures(aiMaterial *mat, aiTextureType type, string typeName);&#125;; Modelç±»åŒ…å«äº†ä¸€ä¸ªMeshå¯¹è±¡çš„vectorï¼Œæ„é€ å™¨éœ€è¦æˆ‘ä»¬ç»™å®ƒä¸€ä¸ªæ–‡ä»¶è·¯å¾„.åœ¨æ„é€ å™¨ä¸­ï¼Œå®ƒä¼šç›´æ¥é€šè¿‡loadModelæ¥åŠ è½½æ–‡ä»¶.ç§æœ‰å‡½æ•°å°†ä¼šå¤„ç†Assimpå¯¼å…¥è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šä»‹ç»å®ƒä»¬.æˆ‘ä»¬è¿˜å°†å‚¨å­˜æ–‡ä»¶è·¯å¾„çš„ç›®å½•ï¼Œåœ¨ä¹‹ååŠ è½½çº¹ç†çš„æ—¶å€™è¿˜ä¼šç”¨åˆ°å®ƒ. Drawå‡½æ•°æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯éå†äº†æ‰€æœ‰ç½‘æ ¼ï¼Œå¹¶è°ƒç”¨å®ƒä»¬å„è‡ªçš„Drawå‡½æ•°. void Draw(Shader shader)&#123; for(unsigned int i = 0; i &lt; meshes.size(); i++) meshes[i].Draw(shader);&#125; å¯¼å…¥3Dæ¨¡å‹åˆ°OpenGLè¦æƒ³å¯¼å…¥ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶å°†å®ƒè½¬æ¢åˆ°æˆ‘ä»¬è‡ªå·±çš„æ•°æ®ç»“æ„ä¸­çš„è¯ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åŒ…å«Assimpå¯¹åº”çš„å¤´æ–‡ä»¶ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¸ä¼šæŠ±æ€¨æˆ‘ä»¬äº†. #include &lt;assimp/Importer.hpp&gt;#include &lt;assimp/scene.h&gt;#include &lt;assimp/postprocess.h&gt; é¦–å…ˆéœ€è¦è°ƒç”¨çš„å‡½æ•°æ˜¯loadModelï¼Œå®ƒä¼šä»æ„é€ å™¨ä¸­ç›´æ¥è°ƒç”¨.åœ¨loadModelä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Assimpæ¥åŠ è½½æ¨¡å‹è‡³Assimpçš„ä¸€ä¸ªå«åšsceneçš„æ•°æ®ç»“æ„ä¸­.ä½ å¯èƒ½è¿˜è®°å¾—åœ¨æ¨¡å‹åŠ è½½ç« èŠ‚çš„ç¬¬ä¸€èŠ‚æ•™ç¨‹ä¸­ï¼Œè¿™æ˜¯Assimpæ•°æ®æ¥å£çš„æ ¹å¯¹è±¡.ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¿™ä¸ªåœºæ™¯å¯¹è±¡ï¼Œæˆ‘ä»¬å°±èƒ½è®¿é—®åˆ°åŠ è½½åçš„æ¨¡å‹ä¸­æ‰€æœ‰æ‰€éœ€çš„æ•°æ®äº†. Assimpå¾ˆæ£’çš„ä¸€ç‚¹åœ¨äºï¼Œå®ƒæŠ½è±¡æ‰äº†åŠ è½½ä¸åŒæ–‡ä»¶æ ¼å¼çš„æ‰€æœ‰æŠ€æœ¯ç»†èŠ‚ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç å°±èƒ½å®Œæˆæ‰€æœ‰çš„å·¥ä½œï¼š Assimp::Importer importer;const aiScene *scene = importer.ReadFile(path, aiProcess_Triangulate | aiProcess_FlipUVs); æˆ‘ä»¬é¦–å…ˆå£°æ˜äº†Assimpå‘½åç©ºé—´å†…çš„ä¸€ä¸ªImporterï¼Œä¹‹åè°ƒç”¨äº†å®ƒçš„ReadFileå‡½æ•°.è¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€äº›åæœŸå¤„ç†(Post-processing)çš„é€‰é¡¹ã€‚é™¤äº†åŠ è½½æ–‡ä»¶ä¹‹å¤–ï¼ŒAssimpå…è®¸æˆ‘ä»¬è®¾å®šä¸€äº›é€‰é¡¹æ¥å¼ºåˆ¶å®ƒå¯¹å¯¼å…¥çš„æ•°æ®åšä¸€äº›é¢å¤–çš„è®¡ç®—æˆ–æ“ä½œã€‚é€šè¿‡è®¾å®šaiProcess_Triangulateï¼Œæˆ‘ä»¬å‘Šè¯‰Assimpï¼Œå¦‚æœæ¨¡å‹ä¸æ˜¯ï¼ˆå…¨éƒ¨ï¼‰ç”±ä¸‰è§’å½¢ç»„æˆï¼Œå®ƒéœ€è¦å°†æ¨¡å‹æ‰€æœ‰çš„å›¾å…ƒå½¢çŠ¶å˜æ¢ä¸ºä¸‰è§’å½¢.aiProcess_FlipUVså°†åœ¨å¤„ç†çš„æ—¶å€™ç¿»è½¬yè½´çš„çº¹ç†åæ ‡ï¼ˆä½ å¯èƒ½è¿˜è®°å¾—æˆ‘ä»¬åœ¨çº¹ç†æ•™ç¨‹ä¸­è¯´è¿‡ï¼Œåœ¨OpenGLä¸­å¤§éƒ¨åˆ†çš„å›¾åƒçš„yè½´éƒ½æ˜¯åçš„ï¼Œæ‰€ä»¥è¿™ä¸ªåæœŸå¤„ç†é€‰é¡¹å°†ä¼šä¿®å¤è¿™ä¸ªï¼‰.å…¶å®ƒä¸€äº›æ¯”è¾ƒæœ‰ç”¨çš„é€‰é¡¹æœ‰ï¼š aiProcess_GenNormalsï¼šå¦‚æœæ¨¡å‹ä¸åŒ…å«æ³•å‘é‡çš„è¯ï¼Œå°±ä¸ºæ¯ä¸ªé¡¶ç‚¹åˆ›å»ºæ³•çº¿. aiProcess_SplitLargeMeshesï¼šå°†æ¯”è¾ƒå¤§çš„ç½‘æ ¼åˆ†å‰²æˆæ›´å°çš„å­ç½‘æ ¼ï¼Œå¦‚æœä½ çš„æ¸²æŸ“æœ‰æœ€å¤§é¡¶ç‚¹æ•°é™åˆ¶ï¼Œåªèƒ½æ¸²æŸ“è¾ƒå°çš„ç½‘æ ¼ï¼Œé‚£ä¹ˆå®ƒä¼šéå¸¸æœ‰ç”¨. aiProcess_OptimizeMeshesï¼šå’Œä¸Šä¸ªé€‰é¡¹ç›¸åï¼Œå®ƒä¼šå°†å¤šä¸ªå°ç½‘æ ¼æ‹¼æ¥ä¸ºä¸€ä¸ªå¤§çš„ç½‘æ ¼ï¼Œå‡å°‘ç»˜åˆ¶è°ƒç”¨ä»è€Œè¿›è¡Œä¼˜åŒ–. Assimpæä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„åæœŸå¤„ç†æŒ‡ä»¤ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å…¨éƒ¨çš„æŒ‡ä»¤.å®é™…ä¸Šä½¿ç”¨AssimpåŠ è½½æ¨¡å‹æ˜¯éå¸¸å®¹æ˜“çš„ï¼ˆä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼‰.å›°éš¾çš„æ˜¯ä¹‹åä½¿ç”¨è¿”å›çš„åœºæ™¯å¯¹è±¡å°†åŠ è½½çš„æ•°æ®è½¬æ¢åˆ°ä¸€ä¸ªMeshå¯¹è±¡çš„æ•°ç»„. å®Œæ•´çš„loadModelå‡½æ•°å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š void loadModel(string path)&#123; Assimp::Importer import; const aiScene *scene = import.ReadFile(path, aiProcess_Triangulate | aiProcess_FlipUVs); if(!scene || scene-&gt;mFlags &amp; AI_SCENE_FLAGS_INCOMPLETE || !scene-&gt;mRootNode) &#123; cout &lt;&lt; \"ERROR::ASSIMP::\" &lt;&lt; import.GetErrorString() &lt;&lt; endl; return; &#125; directory = path.substr(0, path.find_last_of('/')); processNode(scene-&gt;mRootNode, scene);&#125; åœ¨æˆ‘ä»¬åŠ è½½äº†æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥åœºæ™¯å’Œå…¶æ ¹èŠ‚ç‚¹ä¸ä¸ºnullï¼Œå¹¶ä¸”æ£€æŸ¥äº†å®ƒçš„ä¸€ä¸ªæ ‡è®°(Flag)ï¼Œæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®æ˜¯ä¸æ˜¯ä¸å®Œæ•´çš„.å¦‚æœé‡åˆ°äº†ä»»ä½•é”™è¯¯ï¼Œæˆ‘ä»¬éƒ½ä¼šé€šè¿‡å¯¼å…¥å™¨çš„GetErrorStringå‡½æ•°æ¥æŠ¥å‘Šé”™è¯¯å¹¶è¿”å›.æˆ‘ä»¬ä¹Ÿè·å–äº†æ–‡ä»¶è·¯å¾„çš„ç›®å½•è·¯å¾„. å¦‚æœä»€ä¹ˆé”™è¯¯éƒ½æ²¡æœ‰å‘ç”Ÿï¼Œæˆ‘ä»¬å¸Œæœ›å¤„ç†åœºæ™¯ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ä¼ å…¥äº†é€’å½’çš„processNodeå‡½æ•°.å› ä¸ºæ¯ä¸ªèŠ‚ç‚¹ï¼ˆå¯èƒ½ï¼‰åŒ…å«æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¸Œæœ›é¦–å…ˆå¤„ç†å‚æ•°ä¸­çš„èŠ‚ç‚¹ï¼Œå†ç»§ç»­å¤„ç†è¯¥èŠ‚ç‚¹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨.è¿™æ­£ç¬¦åˆä¸€ä¸ªé€’å½’ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•°.é€’å½’å‡½æ•°åœ¨åšä¸€äº›å¤„ç†ä¹‹åï¼Œä½¿ç”¨ä¸åŒçš„å‚æ•°é€’å½’è°ƒç”¨è¿™ä¸ªå‡½æ•°è‡ªèº«ï¼Œç›´åˆ°æŸä¸ªæ¡ä»¶è¢«æ»¡è¶³åœæ­¢é€’å½’.åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­é€€å‡ºæ¡ä»¶(Exit Condition)æ˜¯æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è¢«å¤„ç†å®Œæ¯•ã€‚ ä½ å¯èƒ½è¿˜è®°å¾—Assimpçš„ç»“æ„ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«äº†ä¸€ç³»åˆ—çš„ç½‘æ ¼ç´¢å¼•ï¼Œæ¯ä¸ªç´¢å¼•æŒ‡å‘åœºæ™¯å¯¹è±¡ä¸­çš„é‚£ä¸ªç‰¹å®šç½‘æ ¼.æˆ‘ä»¬æ¥ä¸‹æ¥å°±æƒ³å»è·å–è¿™äº›ç½‘æ ¼ç´¢å¼•ï¼Œè·å–æ¯ä¸ªç½‘æ ¼ï¼Œå¤„ç†æ¯ä¸ªç½‘æ ¼ï¼Œæ¥ç€å¯¹æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹é‡å¤è¿™ä¸€è¿‡ç¨‹ã€‚processNodeå‡½æ•°çš„å†…å®¹å¦‚ä¸‹ï¼švoid processNode(aiNode *node, const aiScene *scene)&#123; // å¤„ç†èŠ‚ç‚¹æ‰€æœ‰çš„ç½‘æ ¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ for(unsigned int i = 0; i &lt; node-&gt;mNumMeshes; i++) &#123; aiMesh *mesh = scene-&gt;mMeshes[node-&gt;mMeshes[i]]; meshes.push_back(processMesh(mesh, scene)); &#125; // æ¥ä¸‹æ¥å¯¹å®ƒçš„å­èŠ‚ç‚¹é‡å¤è¿™ä¸€è¿‡ç¨‹ for(unsigned int i = 0; i &lt; node-&gt;mNumChildren; i++) &#123; processNode(node-&gt;mChildren[i], scene); &#125;&#125; æˆ‘ä»¬é¦–å…ˆæ£€æŸ¥æ¯ä¸ªèŠ‚ç‚¹çš„ç½‘æ ¼ç´¢å¼•ï¼Œå¹¶ç´¢å¼•åœºæ™¯çš„mMeshesæ•°ç»„æ¥è·å–å¯¹åº”çš„ç½‘æ ¼.è¿”å›çš„ç½‘æ ¼å°†ä¼šä¼ é€’åˆ°processMeshå‡½æ•°ä¸­ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªMeshå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒå­˜å‚¨åœ¨meshesåˆ—è¡¨/vector. æ‰€æœ‰ç½‘æ ¼éƒ½è¢«å¤„ç†ä¹‹åï¼Œæˆ‘ä»¬ä¼šéå†èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶å¯¹å®ƒä»¬è°ƒç”¨ç›¸åŒçš„processMeshå‡½æ•°.å½“ä¸€ä¸ªèŠ‚ç‚¹ä¸å†æœ‰ä»»ä½•å­èŠ‚ç‚¹ä¹‹åï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šåœæ­¢æ‰§è¡Œ. è®¤çœŸçš„è¯»è€…å¯èƒ½ä¼šå‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥åŸºæœ¬ä¸Šå¿˜æ‰å¤„ç†ä»»ä½•çš„èŠ‚ç‚¹ï¼Œåªéœ€è¦éå†åœºæ™¯å¯¹è±¡çš„æ‰€æœ‰ç½‘æ ¼ï¼Œå°±ä¸éœ€è¦ä¸ºäº†ç´¢å¼•åšè¿™ä¸€å †å¤æ‚çš„ä¸œè¥¿äº†.æˆ‘ä»¬ä»è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼Œä½¿ç”¨èŠ‚ç‚¹çš„æœ€åˆæƒ³æ³•æ˜¯å°†ç½‘æ ¼ä¹‹é—´å®šä¹‰ä¸€ä¸ªçˆ¶å­å…³ç³».é€šè¿‡è¿™æ ·é€’å½’åœ°éå†è¿™å±‚å…³ç³»ï¼Œæˆ‘ä»¬å°±èƒ½å°†æŸä¸ªç½‘æ ¼å®šä¹‰ä¸ºå¦ä¸€ä¸ªç½‘æ ¼çš„çˆ¶ç½‘æ ¼äº†.è¿™ä¸ªç³»ç»Ÿçš„ä¸€ä¸ªä½¿ç”¨æ¡ˆä¾‹æ˜¯ï¼Œå½“ä½ æƒ³ä½ç§»ä¸€ä¸ªæ±½è½¦çš„ç½‘æ ¼æ—¶ï¼Œä½ å¯ä»¥ä¿è¯å®ƒçš„æ‰€æœ‰å­ç½‘æ ¼ï¼ˆæ¯”å¦‚å¼•æ“ç½‘æ ¼ã€æ–¹å‘ç›˜ç½‘æ ¼ã€è½®èƒç½‘æ ¼ï¼‰éƒ½ä¼šéšç€ä¸€èµ·ä½ç§»ã€‚è¿™æ ·çš„ç³»ç»Ÿèƒ½å¤Ÿç”¨çˆ¶å­å…³ç³»å¾ˆå®¹æ˜“åœ°åˆ›å»ºå‡ºæ¥.ç„¶è€Œï¼Œç°åœ¨æˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨è¿™æ ·ä¸€ç§ç³»ç»Ÿï¼Œä½†å¦‚æœä½ æƒ³å¯¹ä½ çš„ç½‘æ ¼æ•°æ®æœ‰æ›´å¤šçš„æ§åˆ¶ï¼Œé€šå¸¸éƒ½æ˜¯å»ºè®®ä½¿ç”¨è¿™ä¸€ç§æ–¹æ³•çš„ã€‚è¿™ç§ç±»èŠ‚ç‚¹çš„å…³ç³»æ¯•ç«Ÿæ˜¯ç”±åˆ›å»ºäº†è¿™ä¸ªæ¨¡å‹çš„è‰ºæœ¯å®¶æ‰€å®šä¹‰. ä»Assimpåˆ°ç½‘æ ¼å°†ä¸€ä¸ªaiMeshå¯¹è±¡è½¬åŒ–ä¸ºæˆ‘ä»¬è‡ªå·±çš„ç½‘æ ¼å¯¹è±¡ä¸æ˜¯é‚£ä¹ˆå›°éš¾.æˆ‘ä»¬è¦åšçš„åªæ˜¯è®¿é—®ç½‘æ ¼çš„ç›¸å…³å±æ€§å¹¶å°†å®ƒä»¬å‚¨å­˜åˆ°æˆ‘ä»¬è‡ªå·±çš„å¯¹è±¡ä¸­.processMeshå‡½æ•°çš„å¤§ä½“ç»“æ„å¦‚ä¸‹ï¼š Mesh processMesh(aiMesh *mesh, const aiScene *scene)&#123; vector&lt;Vertex&gt; vertices; vector&lt;unsigned int&gt; indices; vector&lt;Texture&gt; textures; for(unsigned int i = 0; i &lt; mesh-&gt;mNumVertices; i++) &#123; Vertex vertex; // å¤„ç†é¡¶ç‚¹ä½ç½®ã€æ³•çº¿å’Œçº¹ç†åæ ‡ ... vertices.push_back(vertex); &#125; // å¤„ç†ç´¢å¼• ... // å¤„ç†æè´¨ if(mesh-&gt;mMaterialIndex &gt;= 0) &#123; ... &#125; return Mesh(vertices, indices, textures);&#125; å¤„ç†ç½‘æ ¼çš„è¿‡ç¨‹ä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ï¼šè·å–æ‰€æœ‰çš„é¡¶ç‚¹æ•°æ®ï¼Œè·å–å®ƒä»¬çš„ç½‘æ ¼ç´¢å¼•ï¼Œå¹¶è·å–ç›¸å…³çš„æè´¨æ•°æ®.å¤„ç†åçš„æ•°æ®å°†ä¼šå‚¨å­˜åœ¨ä¸‰ä¸ªvectorå½“ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨å®ƒä»¬æ„å»ºä¸€ä¸ªMeshå¯¹è±¡ï¼Œå¹¶è¿”å›å®ƒåˆ°å‡½æ•°çš„è°ƒç”¨è€…é‚£é‡Œ. è·å–é¡¶ç‚¹æ•°æ®éå¸¸ç®€å•ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªVertexç»“æ„ä½“ï¼Œæˆ‘ä»¬å°†åœ¨æ¯ä¸ªè¿­ä»£ä¹‹åå°†å®ƒåŠ åˆ°verticesæ•°ç»„ä¸­.æˆ‘ä»¬ä¼šéå†ç½‘æ ¼ä¸­çš„æ‰€æœ‰é¡¶ç‚¹ï¼ˆä½¿ç”¨mesh-&gt;mNumVerticesæ¥è·å–ï¼‰.åœ¨æ¯ä¸ªè¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ‰€æœ‰çš„ç›¸å…³æ•°æ®å¡«å……è¿™ä¸ªç»“æ„ä½“ã€‚é¡¶ç‚¹çš„ä½ç½®æ˜¯è¿™æ ·å¤„ç†çš„ï¼š glm::vec3 vector; vector.x = mesh-&gt;mVertices[i].x;vector.y = mesh-&gt;mVertices[i].y;vector.z = mesh-&gt;mVertices[i].z; vertex.Position = vector; æ³¨æ„æˆ‘ä»¬ä¸ºäº†ä¼ è¾“Assimpçš„æ•°æ®ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªvec3çš„ä¸´æ—¶å˜é‡.ä½¿ç”¨è¿™æ ·ä¸€ä¸ªä¸´æ—¶å˜é‡çš„åŸå› æ˜¯Assimpå¯¹å‘é‡ã€çŸ©é˜µã€å­—ç¬¦ä¸²ç­‰éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—æ•°æ®ç±»å‹ï¼Œå®ƒä»¬å¹¶ä¸èƒ½å®Œç¾åœ°è½¬æ¢åˆ°GLMçš„æ•°æ®ç±»å‹ä¸­. Assimpå°†å®ƒçš„é¡¶ç‚¹ä½ç½®æ•°ç»„å«åšmVerticesï¼Œè¿™å…¶å®å¹¶ä¸æ˜¯é‚£ä¹ˆç›´è§‚. å¤„ç†æ³•çº¿çš„æ­¥éª¤ä¹Ÿæ˜¯å·®ä¸å¤šçš„ï¼š vector.x = mesh-&gt;mNormals[i].x;vector.y = mesh-&gt;mNormals[i].y;vector.z = mesh-&gt;mNormals[i].z;vertex.Normal = vector; çº¹ç†åæ ‡çš„å¤„ç†ä¹Ÿå¤§ä½“ç›¸ä¼¼ï¼Œä½†Assimpå…è®¸ä¸€ä¸ªæ¨¡å‹åœ¨ä¸€ä¸ªé¡¶ç‚¹ä¸Šæœ‰æœ€å¤š8ä¸ªä¸åŒçš„çº¹ç†åæ ‡ï¼Œæˆ‘ä»¬ä¸ä¼šç”¨åˆ°é‚£ä¹ˆå¤šï¼Œæˆ‘ä»¬åªå…³å¿ƒç¬¬ä¸€ç»„çº¹ç†åæ ‡.æˆ‘ä»¬åŒæ ·ä¹Ÿæƒ³æ£€æŸ¥ç½‘æ ¼æ˜¯å¦çœŸçš„åŒ…å«äº†çº¹ç†åæ ‡ï¼ˆå¯èƒ½å¹¶ä¸ä¼šä¸€ç›´å¦‚æ­¤ï¼‰. if(mesh-&gt;mTextureCoords[0]) // ç½‘æ ¼æ˜¯å¦æœ‰çº¹ç†åæ ‡ï¼Ÿ&#123; glm::vec2 vec; vec.x = mesh-&gt;mTextureCoords[0][i].x; vec.y = mesh-&gt;mTextureCoords[0][i].y; vertex.TexCoords = vec;&#125;else vertex.TexCoords = glm::vec2(0.0f, 0.0f); vertexç»“æ„ä½“ç°åœ¨å·²ç»å¡«å……å¥½äº†éœ€è¦çš„é¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿­ä»£çš„æœ€åå°†å®ƒå‹å…¥verticesè¿™ä¸ªvectorçš„å°¾éƒ¨.è¿™ä¸ªè¿‡ç¨‹ä¼šå¯¹æ¯ä¸ªç½‘æ ¼çš„é¡¶ç‚¹éƒ½é‡å¤ä¸€é. ç´¢å¼•Assimpçš„æ¥å£å®šä¹‰äº†æ¯ä¸ªç½‘æ ¼éƒ½æœ‰ä¸€ä¸ªé¢(Face)æ•°ç»„ï¼Œæ¯ä¸ªé¢ä»£è¡¨äº†ä¸€ä¸ªå›¾å…ƒï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ˆç”±äºä½¿ç”¨äº†aiProcess_Triangulateé€‰é¡¹ï¼‰å®ƒæ€»æ˜¯ä¸‰è§’å½¢.ä¸€ä¸ªé¢åŒ…å«äº†å¤šä¸ªç´¢å¼•ï¼Œå®ƒä»¬å®šä¹‰äº†åœ¨æ¯ä¸ªå›¾å…ƒä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ç»˜åˆ¶å“ªä¸ªé¡¶ç‚¹ï¼Œå¹¶ä»¥ä»€ä¹ˆé¡ºåºç»˜åˆ¶ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬éå†äº†æ‰€æœ‰çš„é¢ï¼Œå¹¶å‚¨å­˜äº†é¢çš„ç´¢å¼•åˆ°indicesè¿™ä¸ªvectorä¸­å°±å¯ä»¥äº†. for(unsigned int i = 0; i &lt; mesh-&gt;mNumFaces; i++)&#123; aiFace face = mesh-&gt;mFaces[i]; for(unsigned int j = 0; j &lt; face.mNumIndices; j++) indices.push_back(face.mIndices[j]);&#125; æ‰€æœ‰çš„å¤–éƒ¨å¾ªç¯éƒ½ç»“æŸäº†ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ç³»åˆ—çš„é¡¶ç‚¹å’Œç´¢å¼•æ•°æ®ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥é€šè¿‡glDrawElementså‡½æ•°æ¥ç»˜åˆ¶ç½‘æ ¼.ç„¶è€Œï¼Œä¸ºäº†ç»“æŸè¿™ä¸ªè¯é¢˜ï¼Œå¹¶ä¸”å¯¹ç½‘æ ¼æä¾›ä¸€äº›ç»†èŠ‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†ç½‘æ ¼çš„æè´¨. æè´¨å’ŒèŠ‚ç‚¹ä¸€æ ·ï¼Œä¸€ä¸ªç½‘æ ¼åªåŒ…å«äº†ä¸€ä¸ªæŒ‡å‘æè´¨å¯¹è±¡çš„ç´¢å¼•.å¦‚æœæƒ³è¦è·å–ç½‘æ ¼çœŸæ­£çš„æè´¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç´¢å¼•åœºæ™¯çš„mMaterialsæ•°ç»„.ç½‘æ ¼æè´¨ç´¢å¼•ä½äºå®ƒçš„mMaterialIndexå±æ€§ä¸­ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ç”¨å®ƒæ¥æ£€æµ‹ä¸€ä¸ªç½‘æ ¼æ˜¯å¦åŒ…å«æœ‰æè´¨ï¼š if(mesh-&gt;mMaterialIndex &gt;= 0)&#123; aiMaterial *material = scene-&gt;mMaterials[mesh-&gt;mMaterialIndex]; vector&lt;Texture&gt; diffuseMaps = loadMaterialTextures(material, aiTextureType_DIFFUSE, \"texture_diffuse\"); textures.insert(textures.end(), diffuseMaps.begin(), diffuseMaps.end()); vector&lt;Texture&gt; specularMaps = loadMaterialTextures(material, aiTextureType_SPECULAR, \"texture_specular\"); textures.insert(textures.end(), specularMaps.begin(), specularMaps.end());&#125; æˆ‘ä»¬é¦–å…ˆä»åœºæ™¯çš„mMaterialsæ•°ç»„ä¸­è·å–aiMaterialå¯¹è±¡.æ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›åŠ è½½ç½‘æ ¼çš„æ¼«åå°„å’Œ/æˆ–é•œé¢å…‰è´´å›¾.ä¸€ä¸ªæè´¨å¯¹è±¡çš„å†…éƒ¨å¯¹æ¯ç§çº¹ç†ç±»å‹éƒ½å­˜å‚¨äº†ä¸€ä¸ªçº¹ç†ä½ç½®æ•°ç»„.ä¸åŒçš„çº¹ç†ç±»å‹éƒ½ä»¥aiTextureType_ä¸ºå‰ç¼€.æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå«åšloadMaterialTexturesçš„å·¥å…·å‡½æ•°æ¥ä»æè´¨ä¸­è·å–çº¹ç†.è¿™ä¸ªå‡½æ•°å°†ä¼šè¿”å›ä¸€ä¸ªTextureç»“æ„ä½“çš„vectorï¼Œæˆ‘ä»¬å°†åœ¨æ¨¡å‹çš„textures vectorçš„å°¾éƒ¨ä¹‹åå­˜å‚¨å®ƒ. loadMaterialTextureså‡½æ•°éå†äº†ç»™å®šçº¹ç†ç±»å‹çš„æ‰€æœ‰çº¹ç†ä½ç½®ï¼Œè·å–äº†çº¹ç†çš„æ–‡ä»¶ä½ç½®ï¼Œå¹¶åŠ è½½å¹¶å’Œç”Ÿæˆäº†çº¹ç†ï¼Œå°†ä¿¡æ¯å‚¨å­˜åœ¨äº†ä¸€ä¸ªVertexç»“æ„ä½“ä¸­ã€‚å®ƒçœ‹èµ·æ¥ä¼šåƒè¿™æ ·ï¼š vector&lt;Texture&gt; loadMaterialTextures(aiMaterial *mat, aiTextureType type, string typeName)&#123; vector&lt;Texture&gt; textures; for(unsigned int i = 0; i &lt; mat-&gt;GetTextureCount(type); i++) &#123; aiString str; mat-&gt;GetTexture(type, i, &amp;str); Texture texture; texture.id = TextureFromFile(str.C_Str(), directory); texture.type = typeName; texture.path = str; textures.push_back(texture); &#125; return textures;&#125; æˆ‘ä»¬é¦–å…ˆé€šè¿‡GetTextureCountå‡½æ•°æ£€æŸ¥å‚¨å­˜åœ¨æè´¨ä¸­çº¹ç†çš„æ•°é‡ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªçº¹ç†ç±»å‹ã€‚æˆ‘ä»¬ä¼šä½¿ç”¨GetTextureè·å–æ¯ä¸ªçº¹ç†çš„æ–‡ä»¶ä½ç½®ï¼Œå®ƒä¼šå°†ç»“æœå‚¨å­˜åœ¨ä¸€ä¸ªaiStringä¸­.æˆ‘ä»¬æ¥ä¸‹æ¥ä½¿ç”¨å¦å¤–ä¸€ä¸ªå«åšTextureFromFileçš„å·¥å…·å‡½æ•°ï¼Œå®ƒå°†ä¼šï¼ˆç”¨stb_image.hï¼‰åŠ è½½ä¸€ä¸ªçº¹ç†å¹¶è¿”å›è¯¥çº¹ç†çš„ID. æ³¨æ„ï¼Œæˆ‘ä»¬å‡è®¾äº†æ¨¡å‹æ–‡ä»¶ä¸­çº¹ç†æ–‡ä»¶çš„è·¯å¾„æ˜¯ç›¸å¯¹äºæ¨¡å‹æ–‡ä»¶çš„æœ¬åœ°(Local)è·¯å¾„ï¼Œæ¯”å¦‚è¯´ä¸æ¨¡å‹æ–‡ä»¶å¤„äºåŒä¸€ç›®å½•ä¸‹.æˆ‘ä»¬å¯ä»¥å°†çº¹ç†ä½ç½®å­—ç¬¦ä¸²æ‹¼æ¥åˆ°ä¹‹å‰ï¼ˆåœ¨loadModelä¸­ï¼‰è·å–çš„ç›®å½•å­—ç¬¦ä¸²ä¸Šï¼Œæ¥è·å–å®Œæ•´çš„çº¹ç†è·¯å¾„ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆGetTextureå‡½æ•°ä¹Ÿéœ€è¦ä¸€ä¸ªç›®å½•å­—ç¬¦ä¸²ï¼‰.åœ¨ç½‘ç»œä¸Šæ‰¾åˆ°çš„æŸäº›æ¨¡å‹ä¼šå¯¹çº¹ç†ä½ç½®ä½¿ç”¨ç»å¯¹(Absolute)è·¯å¾„ï¼Œè¿™å°±ä¸èƒ½åœ¨æ¯å°æœºå™¨ä¸Šéƒ½å·¥ä½œäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šéœ€è¦æ‰‹åŠ¨ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼Œæ¥è®©å®ƒå¯¹çº¹ç†ä½¿ç”¨æœ¬åœ°è·¯å¾„ï¼ˆå¦‚æœå¯èƒ½çš„è¯ï¼‰. é‡å¤§ä¼˜åŒ–å¤§å¤šæ•°åœºæ™¯éƒ½ä¼šåœ¨å¤šä¸ªç½‘æ ¼ä¸­é‡ç”¨éƒ¨åˆ†çº¹ç†.è¿˜æ˜¯æƒ³æƒ³ä¸€ä¸ªæˆ¿å­ï¼Œå®ƒçš„å¢™å£æœ‰ç€èŠ±å²—å²©çš„çº¹ç†.è¿™ä¸ªçº¹ç†ä¹Ÿå¯ä»¥è¢«åº”ç”¨åˆ°åœ°æ¿ã€å¤©èŠ±æ¿ã€æ¥¼æ¢¯ã€æ¡Œå­ï¼Œç”šè‡³æ˜¯é™„è¿‘çš„ä¸€å£äº•ä¸Š.åŠ è½½çº¹ç†å¹¶ä¸æ˜¯ä¸€ä¸ªå¼€é”€ä¸å¤§çš„æ“ä½œï¼Œåœ¨æˆ‘ä»¬å½“å‰çš„å®ç°ä¸­ï¼Œå³ä¾¿åŒæ ·çš„çº¹ç†å·²ç»è¢«åŠ è½½è¿‡å¾ˆå¤šéäº†ï¼Œå¯¹æ¯ä¸ªç½‘æ ¼ä»ä¼šåŠ è½½å¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„çº¹ç†.è¿™å¾ˆå¿«å°±ä¼šå˜æˆæ¨¡å‹åŠ è½½å®ç°çš„æ€§èƒ½ç“¶é¢ˆ. æ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹æ¨¡å‹çš„ä»£ç è¿›è¡Œè°ƒæ•´ï¼Œå°†æ‰€æœ‰åŠ è½½è¿‡çš„çº¹ç†å…¨å±€å‚¨å­˜ï¼Œæ¯å½“æˆ‘ä»¬æƒ³åŠ è½½ä¸€ä¸ªçº¹ç†çš„æ—¶å€™ï¼Œé¦–å…ˆå»æ£€æŸ¥å®ƒæœ‰æ²¡æœ‰è¢«åŠ è½½è¿‡.å¦‚æœæœ‰çš„è¯ï¼Œæˆ‘ä»¬ä¼šç›´æ¥ä½¿ç”¨é‚£ä¸ªçº¹ç†ï¼Œå¹¶è·³è¿‡æ•´ä¸ªåŠ è½½æµç¨‹ï¼Œæ¥ä¸ºæˆ‘ä»¬çœä¸‹å¾ˆå¤šå¤„ç†èƒ½åŠ›.ä¸ºäº†èƒ½å¤Ÿæ¯”è¾ƒçº¹ç†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‚¨å­˜å®ƒä»¬çš„è·¯å¾„ï¼š struct Texture &#123; unsigned int id; string type; aiString path; // æˆ‘ä»¬å‚¨å­˜çº¹ç†çš„è·¯å¾„ç”¨äºä¸å…¶å®ƒçº¹ç†è¿›è¡Œæ¯”è¾ƒ&#125;; æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ‰€æœ‰åŠ è½½è¿‡çš„çº¹ç†å‚¨å­˜åœ¨å¦ä¸€ä¸ªvectorä¸­ï¼Œåœ¨æ¨¡å‹ç±»çš„é¡¶éƒ¨å£°æ˜ä¸ºä¸€ä¸ªç§æœ‰å˜é‡ï¼š vector&lt;Texture&gt; textures_loaded; ä¹‹åï¼Œåœ¨loadMaterialTextureså‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å°†çº¹ç†çš„è·¯å¾„ä¸å‚¨å­˜åœ¨textures_loadedè¿™ä¸ªvectorä¸­çš„æ‰€æœ‰çº¹ç†è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹çœ‹å½“å‰çº¹ç†çš„è·¯å¾„æ˜¯å¦ä¸å…¶ä¸­çš„ä¸€ä¸ªç›¸åŒ.å¦‚æœæ˜¯çš„è¯ï¼Œåˆ™è·³è¿‡çº¹ç†åŠ è½½/ç”Ÿæˆçš„éƒ¨åˆ†ï¼Œç›´æ¥ä½¿ç”¨å®šä½åˆ°çš„çº¹ç†ç»“æ„ä½“ä¸ºç½‘æ ¼çš„çº¹ç†.æ›´æ–°åçš„å‡½æ•°å¦‚ä¸‹ï¼š vector&lt;Texture&gt; loadMaterialTextures(aiMaterial *mat, aiTextureType type, string typeName)&#123; vector&lt;Texture&gt; textures; for(unsigned int i = 0; i &lt; mat-&gt;GetTextureCount(type); i++) &#123; aiString str; mat-&gt;GetTexture(type, i, &amp;str); bool skip = false; for(unsigned int j = 0; j &lt; textures_loaded.size(); j++) &#123; if(std::strcmp(textures_loaded[j].path.data(), str.C_Str()) == 0) &#123; textures.push_back(textures_loaded[j]); skip = true; break; &#125; &#125; if(!skip) &#123; // å¦‚æœçº¹ç†è¿˜æ²¡æœ‰è¢«åŠ è½½ï¼Œåˆ™åŠ è½½å®ƒ Texture texture; texture.id = TextureFromFile(str.C_Str(), directory); texture.type = typeName; texture.path = str.C_Str(); textures.push_back(texture); textures_loaded.push_back(texture); // æ·»åŠ åˆ°å·²åŠ è½½çš„çº¹ç†ä¸­ &#125; &#125; return textures;&#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"OpenGL","slug":"OpenGL","permalink":"/tags/OpenGL/"},{"name":"è®¡ç®—æœºå›¾å½¢å­¦","slug":"è®¡ç®—æœºå›¾å½¢å­¦","permalink":"/tags/è®¡ç®—æœºå›¾å½¢å­¦/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"LearnOpenGL-å…‰ç…§","slug":"LearnOpenGL-å…‰ç…§","date":"2019-10-07T15:01:03.000Z","updated":"2019-10-07T15:02:36.295Z","comments":true,"path":"2019/10/07/LearnOpenGL-å…‰ç…§/","link":"","permalink":"/2019/10/07/LearnOpenGL-å…‰ç…§/","excerpt":"","text":"@[toc] é¢œè‰²å½“æˆ‘ä»¬ä¿®æ”¹é¡¶ç‚¹æˆ–è€…ç‰‡æ®µç€è‰²å™¨åï¼Œç¯çš„ä½ç½®æˆ–é¢œè‰²ä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ.æˆ‘ä»¬ä¸å¸Œæœ›ç¯çš„é¢œè‰²åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­å› å…‰ç…§è®¡ç®—çš„ç»“æœè€Œå—åˆ°å½±å“ï¼Œè€Œæ˜¯å¸Œæœ›å®ƒèƒ½å¤Ÿä¸å…¶å®ƒçš„è®¡ç®—åˆ†ç¦».æˆ‘ä»¬å¸Œæœ›ç¯ä¸€ç›´ä¿æŒæ˜äº®ï¼Œä¸å—å…¶å®ƒé¢œè‰²å˜åŒ–çš„å½±å“ï¼ˆè¿™æ ·å®ƒæ‰æ›´åƒæ˜¯ä¸€ä¸ªçœŸå®çš„å…‰æºï¼‰. ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç¯çš„ç»˜åˆ¶åˆ›å»ºå¦å¤–çš„ä¸€å¥—ç€è‰²å™¨ï¼Œä»è€Œèƒ½ä¿è¯å®ƒèƒ½å¤Ÿåœ¨å…¶å®ƒå…‰ç…§ç€è‰²å™¨å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ä¸å—å½±å“.é¡¶ç‚¹ç€è‰²å™¨ä¸æˆ‘ä»¬å½“å‰çš„é¡¶ç‚¹ç€è‰²å™¨æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç›´æ¥æŠŠç°åœ¨çš„é¡¶ç‚¹ç€è‰²å™¨ç”¨åœ¨ç¯ä¸Š.ç¯çš„ç‰‡æ®µç€è‰²å™¨ç»™ç¯å®šä¹‰äº†ä¸€ä¸ªä¸å˜çš„å¸¸é‡ç™½è‰²ï¼Œä¿è¯äº†ç¯çš„é¢œè‰²ä¸€ç›´æ˜¯äº®çš„ï¼š #version 330 coreout vec4 FragColor;void main()&#123; FragColor = vec4(1.0); // å°†å‘é‡çš„å››ä¸ªåˆ†é‡å…¨éƒ¨è®¾ç½®ä¸º1.0&#125; å½“æˆ‘ä»¬æƒ³è¦ç»˜åˆ¶æˆ‘ä»¬çš„ç‰©ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆšåˆšå®šä¹‰çš„å…‰ç…§ç€è‰²å™¨æ¥ç»˜åˆ¶ç®±å­ï¼ˆæˆ–è€…å¯èƒ½æ˜¯å…¶å®ƒçš„ç‰©ä½“ï¼‰.å½“æˆ‘ä»¬æƒ³è¦ç»˜åˆ¶ç¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç¯çš„ç€è‰²å™¨.åœ¨ä¹‹åçš„æ•™ç¨‹é‡Œæˆ‘ä»¬ä¼šé€æ­¥æ›´æ–°è¿™ä¸ªå…‰ç…§ç€è‰²å™¨ï¼Œä»è€Œèƒ½å¤Ÿæ…¢æ…¢åœ°å®ç°æ›´çœŸå®çš„æ•ˆæœ. ä½¿ç”¨è¿™ä¸ªç¯ç«‹æ–¹ä½“çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬çŸ¥é“å…‰æºåœ¨åœºæ™¯ä¸­çš„å…·ä½“ä½ç½®ã€‚æˆ‘ä»¬é€šå¸¸åœ¨åœºæ™¯ä¸­å®šä¹‰ä¸€ä¸ªå…‰æºçš„ä½ç½®ï¼Œä½†è¿™åªæ˜¯ä¸€ä¸ªä½ç½®ï¼Œå®ƒå¹¶æ²¡æœ‰è§†è§‰æ„ä¹‰.ä¸ºäº†æ˜¾ç¤ºçœŸæ­£çš„ç¯ï¼Œæˆ‘ä»¬å°†è¡¨ç¤ºå…‰æºçš„ç«‹æ–¹ä½“ç»˜åˆ¶åœ¨ä¸å…‰æºç›¸åŒçš„ä½ç½®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬ä¸ºå®ƒæ–°å»ºçš„ç‰‡æ®µç€è‰²å™¨æ¥ç»˜åˆ¶å®ƒï¼Œè®©å®ƒä¸€ç›´å¤„äºç™½è‰²çš„çŠ¶æ€ï¼Œä¸å—åœºæ™¯ä¸­çš„å…‰ç…§å½±å“. æˆ‘ä»¬å£°æ˜ä¸€ä¸ªå…¨å±€vec3å˜é‡æ¥è¡¨ç¤ºå…‰æºåœ¨åœºæ™¯çš„ä¸–ç•Œç©ºé—´åæ ‡ä¸­çš„ä½ç½®ï¼š glm::vec3 lightPos(1.2f, 1.0f, 2.0f); ç„¶åæˆ‘ä»¬æŠŠç¯ä½ç§»åˆ°è¿™é‡Œï¼Œç„¶åå°†å®ƒç¼©å°ä¸€ç‚¹ï¼Œè®©å®ƒä¸é‚£ä¹ˆæ˜æ˜¾ï¼š model = glm::mat4();model = glm::translate(model, lightPos);model = glm::scale(model, glm::vec3(0.2f)); ç»˜åˆ¶ç¯ç«‹æ–¹ä½“çš„ä»£ç åº”è¯¥ä¸ä¸‹é¢çš„ç±»ä¼¼ï¼š lampShader.use();// è®¾ç½®æ¨¡å‹ã€è§†å›¾å’ŒæŠ•å½±çŸ©é˜µuniform...// ç»˜åˆ¶ç¯ç«‹æ–¹ä½“å¯¹è±¡glBindVertexArray(lightVAO);glDrawArrays(GL_TRIANGLES, 0, 36); åŸºç¡€å…‰ç…§å…‰çš„æ–¹å‘å‘é‡æ˜¯å…‰æºä½ç½®å‘é‡ä¸ç‰‡æ®µä½ç½®å‘é‡ä¹‹é—´çš„å‘é‡å·®.ä½ å¯èƒ½è®°å¾—åœ¨å˜æ¢æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç®€å•åœ°é€šè¿‡è®©ä¸¤ä¸ªå‘é‡ç›¸å‡çš„æ–¹å¼è®¡ç®—å‘é‡å·®.æˆ‘ä»¬åŒæ ·å¸Œæœ›ç¡®ä¿æ‰€æœ‰ç›¸å…³å‘é‡æœ€åéƒ½è½¬æ¢ä¸ºå•ä½å‘é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ³•çº¿å’Œæœ€ç»ˆçš„æ–¹å‘å‘é‡éƒ½è¿›è¡Œæ ‡å‡†åŒ–ï¼š vec3 norm = normalize(Normal);vec3 lightDir = normalize(lightPos - FragPos); ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯¹normå’ŒlightDirå‘é‡è¿›è¡Œç‚¹ä¹˜ï¼Œè®¡ç®—å…‰æºå¯¹å½“å‰ç‰‡æ®µå®é™…çš„æ¼«å‘å°„å½±å“.ç»“æœå€¼å†ä¹˜ä»¥å…‰çš„é¢œè‰²ï¼Œå¾—åˆ°æ¼«åå°„åˆ†é‡.ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦è¶Šå¤§ï¼Œæ¼«åå°„åˆ†é‡å°±ä¼šè¶Šå°ï¼š float diff = max(dot(norm, lightDir), 0.0);vec3 diffuse = diff * lightColor; å¦‚æœä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦å¤§äº90åº¦ï¼Œç‚¹ä¹˜çš„ç»“æœå°±ä¼šå˜æˆè´Ÿæ•°ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ¼«åå°„åˆ†é‡å˜ä¸ºè´Ÿæ•°.ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨maxå‡½æ•°è¿”å›ä¸¤ä¸ªå‚æ•°ä¹‹é—´è¾ƒå¤§çš„å‚æ•°ï¼Œä»è€Œä¿è¯æ¼«åå°„åˆ†é‡ä¸ä¼šå˜æˆè´Ÿæ•°.è´Ÿæ•°é¢œè‰²çš„å…‰ç…§æ˜¯æ²¡æœ‰å®šä¹‰çš„ï¼Œæ‰€ä»¥æœ€å¥½é¿å…å®ƒï¼Œé™¤éä½ æ˜¯é‚£ç§å¤æ€ªçš„è‰ºæœ¯å®¶. ç§»é™¤æ³•çº¿ä½ç§»ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠæ³•å‘é‡ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ åˆ°äº†ç‰‡æ®µç€è‰²å™¨.å¯æ˜¯ï¼Œç›®å‰ç‰‡æ®µç€è‰²å™¨é‡Œçš„è®¡ç®—éƒ½æ˜¯åœ¨ä¸–ç•Œç©ºé—´åæ ‡ä¸­è¿›è¡Œçš„.æ‰€ä»¥ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯åº”è¯¥æŠŠæ³•å‘é‡ä¹Ÿè½¬æ¢ä¸ºä¸–ç•Œç©ºé—´åæ ‡ï¼ŸåŸºæœ¬æ­£ç¡®ï¼Œä½†æ˜¯è¿™ä¸æ˜¯ç®€å•åœ°æŠŠå®ƒä¹˜ä»¥ä¸€ä¸ªæ¨¡å‹çŸ©é˜µå°±èƒ½æå®šçš„. é¦–å…ˆï¼Œæ³•å‘é‡åªæ˜¯ä¸€ä¸ªæ–¹å‘å‘é‡ï¼Œä¸èƒ½è¡¨è¾¾ç©ºé—´ä¸­çš„ç‰¹å®šä½ç½®.åŒæ—¶ï¼Œæ³•å‘é‡æ²¡æœ‰é½æ¬¡åæ ‡ï¼ˆé¡¶ç‚¹ä½ç½®ä¸­çš„wåˆ†é‡ï¼‰.è¿™æ„å‘³ç€ï¼Œä½ç§»ä¸åº”è¯¥å½±å“åˆ°æ³•å‘é‡.å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æ‰“ç®—æŠŠæ³•å‘é‡ä¹˜ä»¥ä¸€ä¸ªæ¨¡å‹çŸ©é˜µï¼Œæˆ‘ä»¬å°±è¦ä»çŸ©é˜µä¸­ç§»é™¤ä½ç§»éƒ¨åˆ†ï¼Œåªé€‰ç”¨æ¨¡å‹çŸ©é˜µå·¦ä¸Šè§’3Ã—3çš„çŸ©é˜µï¼ˆæ³¨æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ³•å‘é‡çš„wåˆ†é‡è®¾ç½®ä¸º0ï¼Œå†ä¹˜ä»¥4Ã—4çŸ©é˜µï¼›è¿™åŒæ ·å¯ä»¥ç§»é™¤ä½ç§»ï¼‰.å¯¹äºæ³•å‘é‡ï¼Œæˆ‘ä»¬åªå¸Œæœ›å¯¹å®ƒå®æ–½ç¼©æ”¾å’Œæ—‹è½¬å˜æ¢. å…¶æ¬¡ï¼Œå¦‚æœæ¨¡å‹çŸ©é˜µæ‰§è¡Œäº†ä¸ç­‰æ¯”ç¼©æ”¾ï¼Œé¡¶ç‚¹çš„æ”¹å˜ä¼šå¯¼è‡´æ³•å‘é‡ä¸å†å‚ç›´äºè¡¨é¢äº†.å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½ç”¨è¿™æ ·çš„æ¨¡å‹çŸ©é˜µæ¥å˜æ¢æ³•å‘é‡.ä¸‹é¢çš„å›¾å±•ç¤ºäº†åº”ç”¨äº†ä¸ç­‰æ¯”ç¼©æ”¾çš„æ¨¡å‹çŸ©é˜µå¯¹æ³•å‘é‡çš„å½±å“ï¼šä¿®å¤è¿™ä¸ªè¡Œä¸ºçš„è¯€çªæ˜¯ä½¿ç”¨ä¸€ä¸ªä¸ºæ³•å‘é‡ä¸“é—¨å®šåˆ¶çš„æ¨¡å‹çŸ©é˜µ.è¿™ä¸ªçŸ©é˜µç§°ä¹‹ä¸ºæ³•çº¿çŸ©é˜µ(Normal Matrix)ï¼Œå®ƒä½¿ç”¨äº†ä¸€äº›çº¿æ€§ä»£æ•°çš„æ“ä½œæ¥ç§»é™¤å¯¹æ³•å‘é‡é”™è¯¯ç¼©æ”¾çš„å½±å“. æ³•çº¿çŸ©é˜µè¢«å®šä¹‰ä¸ºã€Œæ¨¡å‹çŸ©é˜µå·¦ä¸Šè§’çš„é€†çŸ©é˜µçš„è½¬ç½®çŸ©é˜µã€.çœŸæ˜¯æ‹—å£ï¼Œå¦‚æœä½ ä¸æ˜ç™½è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è®¨è®ºé€†çŸ©é˜µ(Inverse Matrix)å’Œè½¬ç½®çŸ©é˜µ(Transpose Matrix).æ³¨æ„ï¼Œå¤§éƒ¨åˆ†çš„èµ„æºéƒ½ä¼šå°†æ³•çº¿çŸ©é˜µå®šä¹‰ä¸ºåº”ç”¨åˆ°æ¨¡å‹-è§‚å¯ŸçŸ©é˜µ(Model-view Matrix)ä¸Šçš„æ“ä½œï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬åªåœ¨ä¸–ç•Œç©ºé—´ä¸­è¿›è¡Œæ“ä½œï¼ˆä¸æ˜¯åœ¨è§‚å¯Ÿç©ºé—´ï¼‰ï¼Œæˆ‘ä»¬åªä½¿ç”¨æ¨¡å‹çŸ©é˜µ. åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨inverseå’Œtransposeå‡½æ•°è‡ªå·±ç”Ÿæˆè¿™ä¸ªæ³•çº¿çŸ©é˜µï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å¯¹æ‰€æœ‰ç±»å‹çŸ©é˜µéƒ½æœ‰æ•ˆ.æ³¨æ„æˆ‘ä»¬è¿˜è¦æŠŠè¢«å¤„ç†è¿‡çš„çŸ©é˜µå¼ºåˆ¶è½¬æ¢ä¸º3Ã—3çŸ©é˜µï¼Œæ¥ä¿è¯å®ƒå¤±å»äº†ä½ç§»å±æ€§ä»¥åŠèƒ½å¤Ÿä¹˜ä»¥vec3çš„æ³•å‘é‡. Normal = mat3(transpose(inverse(model))) * aNormal; åœ¨æ¼«åå°„å…‰ç…§éƒ¨åˆ†ï¼Œå…‰ç…§è¡¨ç°å¹¶æ²¡æœ‰é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¯¹ç‰©ä½“æœ¬èº«æ‰§è¡Œä»»ä½•ç¼©æ”¾æ“ä½œï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯å¿…é¡»è¦ä½¿ç”¨ä¸€ä¸ªæ³•çº¿çŸ©é˜µï¼Œä»…ä»…è®©æ¨¡å‹çŸ©é˜µä¹˜ä»¥æ³•çº¿ä¹Ÿå¯ä»¥.å¯æ˜¯ï¼Œå¦‚æœä½ è¿›è¡Œäº†ä¸ç­‰æ¯”ç¼©æ”¾ï¼Œä½¿ç”¨æ³•çº¿çŸ©é˜µå»ä¹˜ä»¥æ³•å‘é‡å°±æ˜¯å¿…ä¸å¯å°‘çš„äº†. å³ä½¿æ˜¯å¯¹äºç€è‰²å™¨æ¥è¯´ï¼Œé€†çŸ©é˜µä¹Ÿæ˜¯ä¸€ä¸ªå¼€é”€æ¯”è¾ƒå¤§çš„è¿ç®—ï¼Œå› æ­¤ï¼Œåªè¦å¯èƒ½å°±åº”è¯¥é¿å…åœ¨ç€è‰²å™¨ä¸­è¿›è¡Œé€†çŸ©é˜µè¿ç®—ï¼Œå®ƒä»¬å¿…é¡»ä¸ºä½ åœºæ™¯ä¸­çš„æ¯ä¸ªé¡¶ç‚¹éƒ½è¿›è¡Œè¿™æ ·çš„å¤„ç†.ç”¨ä½œå­¦ä¹ ç›®è¿™æ ·åšæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªå¯¹æ•ˆç‡æœ‰è¦æ±‚çš„åº”ç”¨æ¥è¯´ï¼Œåœ¨ç»˜åˆ¶ä¹‹å‰ä½ æœ€å¥½ç”¨CPUè®¡ç®—å‡ºæ³•çº¿çŸ©é˜µï¼Œç„¶åé€šè¿‡uniformæŠŠå€¼ä¼ é€’ç»™ç€è‰²å™¨ï¼ˆåƒæ¨¡å‹çŸ©é˜µä¸€æ ·ï¼‰. é•œé¢åˆ†é‡ç°åœ¨æˆ‘ä»¬å·²ç»è·å¾—æ‰€æœ‰éœ€è¦çš„å˜é‡ï¼Œå¯ä»¥è®¡ç®—é«˜å…‰å¼ºåº¦äº†.é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé•œé¢å¼ºåº¦(Specular Intensity)å˜é‡ï¼Œç»™é•œé¢é«˜å…‰ä¸€ä¸ªä¸­ç­‰äº®åº¦é¢œè‰²ï¼Œè®©å®ƒä¸è¦äº§ç”Ÿè¿‡åº¦çš„å½±å“. float specularStrength = 0.5; ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è®¡ç®—è§†çº¿æ–¹å‘å‘é‡ï¼Œå’Œå¯¹åº”çš„æ²¿ç€æ³•çº¿è½´çš„åå°„å‘é‡ï¼š vec3 viewDir = normalize(viewPos - FragPos);vec3 reflectDir = reflect(-lightDir, norm); éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å¯¹lightDirå‘é‡è¿›è¡Œäº†å–å.reflectå‡½æ•°è¦æ±‚ç¬¬ä¸€ä¸ªå‘é‡æ˜¯ä»å…‰æºæŒ‡å‘ç‰‡æ®µä½ç½®çš„å‘é‡ï¼Œä½†æ˜¯lightDirå½“å‰æ­£å¥½ç›¸åï¼Œæ˜¯ä»ç‰‡æ®µæŒ‡å‘å…‰æºï¼ˆç”±å…ˆå‰æˆ‘ä»¬è®¡ç®—lightDirå‘é‡æ—¶ï¼Œå‡æ³•çš„é¡ºåºå†³å®šï¼‰.ä¸ºäº†ä¿è¯æˆ‘ä»¬å¾—åˆ°æ­£ç¡®çš„reflectå‘é‡ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹lightDirå‘é‡å–åæ¥è·å¾—ç›¸åçš„æ–¹å‘.ç¬¬äºŒä¸ªå‚æ•°è¦æ±‚æ˜¯ä¸€ä¸ªæ³•å‘é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬æä¾›çš„æ˜¯å·²æ ‡å‡†åŒ–çš„normå‘é‡. float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32);vec3 specular = specularStrength * spec * lightColor; æˆ‘ä»¬å…ˆè®¡ç®—è§†çº¿æ–¹å‘ä¸åå°„æ–¹å‘çš„ç‚¹ä¹˜ï¼ˆå¹¶ç¡®ä¿å®ƒä¸æ˜¯è´Ÿå€¼ï¼‰ï¼Œç„¶åå–å®ƒçš„32æ¬¡å¹‚ã€‚è¿™ä¸ª32æ˜¯é«˜å…‰çš„åå…‰åº¦(Shininess).ä¸€ä¸ªç‰©ä½“çš„åå…‰åº¦è¶Šé«˜ï¼Œåå°„å…‰çš„èƒ½åŠ›è¶Šå¼ºï¼Œæ•£å°„å¾—è¶Šå°‘ï¼Œé«˜å…‰ç‚¹å°±ä¼šè¶Šå°.åœ¨ä¸‹é¢çš„å›¾ç‰‡é‡Œï¼Œä½ ä¼šçœ‹åˆ°ä¸åŒåå…‰åº¦çš„è§†è§‰æ•ˆæœå½±å“ï¼šå‰©ä¸‹çš„æœ€åä¸€ä»¶äº‹æƒ…æ˜¯æŠŠå®ƒåŠ åˆ°ç¯å¢ƒå…‰åˆ†é‡å’Œæ¼«åå°„åˆ†é‡é‡Œï¼Œå†ç”¨ç»“æœä¹˜ä»¥ç‰©ä½“çš„é¢œè‰²ï¼švec3 result = (ambient + diffuse + specular) * objectColor;FragColor = vec4(result, 1.0); æè´¨å½“æè¿°ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸‰ä¸ªåˆ†é‡æ¥å®šä¹‰ä¸€ä¸ªæè´¨é¢œè‰²(Material Color)ï¼šç¯å¢ƒå…‰ç…§(Ambient Lighting)ã€æ¼«åå°„å…‰ç…§(Diffuse Lighting)å’Œé•œé¢å…‰ç…§(Specular Lighting).é€šè¿‡ä¸ºæ¯ä¸ªåˆ†é‡æŒ‡å®šä¸€ä¸ªé¢œè‰²ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå¯¹ç‰©ä½“çš„é¢œè‰²è¾“å‡ºæœ‰ç€ç²¾ç»†çš„æ§åˆ¶äº†.ç°åœ¨ï¼Œæˆ‘ä»¬å†æ·»åŠ åå…‰åº¦(Shininess)è¿™ä¸ªåˆ†é‡åˆ°ä¸Šè¿°çš„ä¸‰ä¸ªé¢œè‰²ä¸­ï¼Œè¿™å°±æœ‰æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰æè´¨å±æ€§äº†ï¼š #version 330 corestruct Material &#123; vec3 ambient; vec3 diffuse; vec3 specular; float shininess;&#125;; uniform Material material; ambientæè´¨å‘é‡å®šä¹‰äº†åœ¨ç¯å¢ƒå…‰ç…§ä¸‹è¿™ä¸ªç‰©ä½“åå°„å¾—æ˜¯ä»€ä¹ˆé¢œè‰²ï¼Œé€šå¸¸è¿™æ˜¯å’Œç‰©ä½“é¢œè‰²ç›¸åŒçš„é¢œè‰².diffuseæè´¨å‘é‡å®šä¹‰äº†åœ¨æ¼«åå°„å…‰ç…§ä¸‹ç‰©ä½“çš„é¢œè‰².ï¼ˆå’Œç¯å¢ƒå…‰ç…§ä¸€æ ·ï¼‰æ¼«åå°„é¢œè‰²ä¹Ÿè¦è®¾ç½®ä¸ºæˆ‘ä»¬éœ€è¦çš„ç‰©ä½“é¢œè‰².specularæè´¨å‘é‡è®¾ç½®çš„æ˜¯é•œé¢å…‰ç…§å¯¹ç‰©ä½“çš„é¢œè‰²å½±å“ï¼ˆæˆ–è€…ç”šè‡³å¯èƒ½åå°„ä¸€ä¸ªç‰©ä½“ç‰¹å®šçš„é•œé¢é«˜å…‰é¢œè‰²ï¼‰.æœ€åï¼Œshininesså½±å“é•œé¢é«˜å…‰çš„æ•£å°„/åŠå¾„. è¿™å››ä¸ªå…ƒç´ å®šä¹‰äº†ä¸€ä¸ªç‰©ä½“çš„æè´¨ï¼Œé€šè¿‡å®ƒä»¬æˆ‘ä»¬èƒ½å¤Ÿæ¨¡æ‹Ÿå¾ˆå¤šç°å®ä¸–ç•Œä¸­çš„æè´¨.devernay.free.frä¸Šçš„ä¸€ä¸ªè¡¨æ ¼å±•ç¤ºäº†å‡ ç§æè´¨å±æ€§ï¼Œå®ƒä»¬æ¨¡æ‹Ÿäº†ç°å®ä¸–ç•Œä¸­çš„çœŸå®æè´¨.ä¸‹é¢çš„å›¾ç‰‡å±•ç¤ºäº†å‡ ç§ç°å®ä¸–ç•Œçš„æè´¨å¯¹æˆ‘ä»¬çš„ç«‹æ–¹ä½“çš„å½±å“ï¼š è®¾ç½®æè´¨void main()&#123; // ç¯å¢ƒå…‰ vec3 ambient = lightColor * material.ambient; // æ¼«åå°„ vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - FragPos); float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = lightColor * (diff * material.diffuse); // é•œé¢å…‰ vec3 viewDir = normalize(viewPos - FragPos); vec3 reflectDir = reflect(-lightDir, norm); float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess); vec3 specular = lightColor * (spec * material.specular); vec3 result = ambient + diffuse + specular; FragColor = vec4(result, 1.0);&#125; æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨ç¨‹åºä¸­è®¾ç½®é€‚å½“çš„uniformï¼Œå¯¹ç‰©ä½“è®¾ç½®æè´¨äº†.GLSLä¸­çš„ç»“æ„ä½“åœ¨è®¾ç½®uniformæ—¶å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„.ç»“æ„ä½“åªæ˜¯ä½œä¸ºuniformå˜é‡çš„ä¸€ä¸ªå°è£…ï¼Œæ‰€ä»¥å¦‚æœæƒ³å¡«å……è¿™ä¸ªç»“æ„ä½“çš„è¯ï¼Œæˆ‘ä»¬ä»éœ€è¦å¯¹æ¯ä¸ªå•ç‹¬çš„uniformè¿›è¡Œè®¾ç½®ï¼Œä½†è¿™æ¬¡è¦å¸¦ä¸Šç»“æ„ä½“åçš„å‰ç¼€ï¼š lightingShader.setVec3(\"material.ambient\", 1.0f, 0.5f, 0.31f);lightingShader.setVec3(\"material.diffuse\", 1.0f, 0.5f, 0.31f);lightingShader.setVec3(\"material.specular\", 0.5f, 0.5f, 0.5f);lightingShader.setFloat(\"material.shininess\", 32.0f); å…‰çš„å±æ€§ç‰©ä½“è¿‡äº®çš„åŸå› æ˜¯ç¯å¢ƒå…‰ã€æ¼«åå°„å’Œé•œé¢å…‰è¿™ä¸‰ä¸ªé¢œè‰²å¯¹ä»»ä½•ä¸€ä¸ªå…‰æºéƒ½ä¼šå»å…¨åŠ›åå°„.å…‰æºå¯¹ç¯å¢ƒå…‰ã€æ¼«åå°„å’Œé•œé¢å…‰åˆ†é‡ä¹Ÿå…·æœ‰ç€ä¸åŒçš„å¼ºåº¦ã€‚å‰é¢çš„æ•™ç¨‹ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå¼ºåº¦å€¼æ”¹å˜ç¯å¢ƒå…‰å’Œé•œé¢å…‰å¼ºåº¦çš„æ–¹å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜.æˆ‘ä»¬æƒ³åšä¸€ä¸ªç±»ä¼¼çš„ç³»ç»Ÿï¼Œä½†æ˜¯è¿™æ¬¡æ˜¯è¦ä¸ºæ¯ä¸ªå…‰ç…§åˆ†é‡éƒ½æŒ‡å®šä¸€ä¸ªå¼ºåº¦å‘é‡. vec3 ambient = vec3(0.1) * material.ambient; ä¸€ä¸ªå…‰æºå¯¹å®ƒçš„ambientã€diffuseå’Œspecularå…‰ç…§æœ‰ç€ä¸åŒçš„å¼ºåº¦.ç¯å¢ƒå…‰ç…§é€šå¸¸ä¼šè®¾ç½®ä¸ºä¸€ä¸ªæ¯”è¾ƒä½çš„å¼ºåº¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ç¯å¢ƒå…‰é¢œè‰²å¤ªè¿‡æ˜¾çœ¼.å…‰æºçš„æ¼«åå°„åˆ†é‡é€šå¸¸è®¾ç½®ä¸ºå…‰æ‰€å…·æœ‰çš„é¢œè‰²ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ˜äº®çš„ç™½è‰².é•œé¢å…‰åˆ†é‡é€šå¸¸ä¼šä¿æŒä¸ºvec3(1.0)ï¼Œä»¥æœ€å¤§å¼ºåº¦å‘å…‰. lightingShader.setVec3(\"light.ambient\", 0.2f, 0.2f, 0.2f);lightingShader.setVec3(\"light.diffuse\", 0.5f, 0.5f, 0.5f); // å°†å…‰ç…§è°ƒæš—äº†ä¸€äº›ä»¥æ­é…åœºæ™¯lightingShader.setVec3(\"light.specular\", 1.0f, 1.0f, 1.0f ä¸åŒçš„å…‰æºé¢œè‰²æˆ‘ä»¬å¯ä»¥åˆ©ç”¨sinå’ŒglfwGetTimeå‡½æ•°æ”¹å˜å…‰æºçš„ç¯å¢ƒå…‰å’Œæ¼«åå°„é¢œè‰²ï¼Œä»è€Œå¾ˆå®¹æ˜“åœ°è®©å…‰æºçš„é¢œè‰²éšç€æ—¶é—´å˜åŒ–ï¼š glm::vec3 lightColor;lightColor.x = sin(glfwGetTime() * 2.0f);lightColor.y = sin(glfwGetTime() * 0.7f);lightColor.z = sin(glfwGetTime() * 1.3f);glm::vec3 diffuseColor = lightColor * glm::vec3(0.5f); // é™ä½å½±å“glm::vec3 ambientColor = diffuseColor * glm::vec3(0.2f); // å¾ˆä½çš„å½±å“lightingShader.setVec3(\"light.ambient\", ambientColor);lightingShader.setVec3(\"light.diffuse\", diffuseColor); å…‰ç…§è´´å›¾åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ•´ä¸ªç‰©ä½“çš„æè´¨å®šä¹‰ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä½†ç°å®ä¸–ç•Œä¸­çš„ç‰©ä½“é€šå¸¸å¹¶ä¸åªåŒ…å«æœ‰ä¸€ç§æè´¨ï¼Œè€Œæ˜¯ç”±å¤šç§æè´¨æ‰€ç»„æˆ.æƒ³æƒ³ä¸€è¾†æ±½è½¦ï¼šå®ƒçš„å¤–å£³éå¸¸æœ‰å…‰æ³½ï¼Œè½¦çª—ä¼šéƒ¨åˆ†åå°„å‘¨å›´çš„ç¯å¢ƒï¼Œè½®èƒä¸ä¼šé‚£ä¹ˆæœ‰å…‰æ³½ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰é•œé¢é«˜å…‰ï¼Œè½®æ¯‚éå¸¸é—ªäº®ï¼ˆå¦‚æœä½ æ´—è½¦äº†çš„è¯ï¼‰.æ±½è½¦åŒæ ·ä¼šæœ‰æ¼«åå°„å’Œç¯å¢ƒå…‰é¢œè‰²ï¼Œå®ƒä»¬åœ¨æ•´ä¸ªç‰©ä½“ä¸Šä¹Ÿä¸ä¼šæ˜¯ä¸€æ ·çš„ï¼Œæ±½è½¦æœ‰ç€è®¸å¤šç§ä¸åŒçš„ç¯å¢ƒå…‰/æ¼«åå°„é¢œè‰².æ€»ä¹‹ï¼Œè¿™æ ·çš„ç‰©ä½“åœ¨ä¸åŒçš„éƒ¨ä»¶ä¸Šéƒ½æœ‰ä¸åŒçš„æè´¨å±æ€§. æ‰€ä»¥ï¼Œä¸Šä¸€èŠ‚ä¸­çš„é‚£ä¸ªæè´¨ç³»ç»Ÿæ˜¯è‚¯å®šä¸å¤Ÿçš„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæœ€ç®€å•çš„æ¨¡å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‹“å±•ä¹‹å‰çš„ç³»ç»Ÿï¼Œå¼•å…¥æ¼«åå°„å’Œé•œé¢å…‰è´´å›¾(Map).è¿™å…è®¸æˆ‘ä»¬å¯¹ç‰©ä½“çš„æ¼«åå°„åˆ†é‡ï¼ˆä»¥åŠé—´æ¥åœ°å¯¹ç¯å¢ƒå…‰åˆ†é‡ï¼Œå®ƒä»¬å‡ ä¹æ€»æ˜¯ä¸€æ ·çš„ï¼‰å’Œé•œé¢å…‰åˆ†é‡æœ‰ç€æ›´ç²¾ç¡®çš„æ§åˆ¶. æ¼«åå°„è´´å›¾ æ³¨æ„sampler2Dæ˜¯æ‰€è°“çš„ä¸é€æ˜ç±»å‹(Opaque Type)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸èƒ½å°†å®ƒå®ä¾‹åŒ–ï¼Œåªèƒ½é€šè¿‡uniformæ¥å®šä¹‰å®ƒ.å¦‚æœæˆ‘ä»¬ä½¿ç”¨é™¤uniformä»¥å¤–çš„æ–¹æ³•ï¼ˆæ¯”å¦‚å‡½æ•°çš„å‚æ•°ï¼‰å®ä¾‹åŒ–è¿™ä¸ªç»“æ„ä½“ï¼ŒGLSLä¼šæŠ›å‡ºä¸€äº›å¥‡æ€ªçš„é”™è¯¯.è¿™åŒæ ·ä¹Ÿé€‚ç”¨äºä»»ä½•å°è£…äº†ä¸é€æ˜ç±»å‹çš„ç»“æ„ä½“. æˆ‘ä»¬ä¹Ÿç§»é™¤äº†ç¯å¢ƒå…‰æè´¨é¢œè‰²å‘é‡ï¼Œå› ä¸ºç¯å¢ƒå…‰é¢œè‰²åœ¨å‡ ä¹æ‰€æœ‰æƒ…å†µä¸‹éƒ½ç­‰äºæ¼«åå°„é¢œè‰²ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å°†å®ƒä»¬åˆ†å¼€å‚¨å­˜ï¼š struct Material &#123; sampler2D diffuse; vec3 specular; float shininess;&#125;; ...in vec2 TexCoords; é•œé¢å…‰è´´å›¾ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œé•œé¢é«˜å…‰çœ‹èµ·æ¥æœ‰äº›å¥‡æ€ªï¼Œå› ä¸ºæˆ‘ä»¬çš„ç‰©ä½“å¤§éƒ¨åˆ†éƒ½æ˜¯æœ¨å¤´ï¼Œæˆ‘ä»¬çŸ¥é“æœ¨å¤´ä¸åº”è¯¥æœ‰è¿™ä¹ˆå¼ºçš„é•œé¢é«˜å…‰çš„ã€‚æˆ‘ä»¬å¯ä»¥å°†ç‰©ä½“çš„é•œé¢å…‰æè´¨è®¾ç½®ä¸ºvec3(0.0)æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ç®±å­é’¢åˆ¶çš„è¾¹æ¡†å°†ä¸å†èƒ½å¤Ÿæ˜¾ç¤ºé•œé¢é«˜å…‰äº†ï¼Œæˆ‘ä»¬çŸ¥é“é’¢é“åº”è¯¥æ˜¯æœ‰ä¸€äº›é•œé¢é«˜å…‰çš„.æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³è¦è®©ç‰©ä½“çš„æŸäº›éƒ¨åˆ†ä»¥ä¸åŒçš„å¼ºåº¦æ˜¾ç¤ºé•œé¢é«˜å…‰.è¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥å’Œæ¼«åå°„è´´å›¾éå¸¸ç›¸ä¼¼. æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸“é—¨ç”¨äºé•œé¢é«˜å…‰çš„çº¹ç†è´´å›¾.è¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªé»‘ç™½çš„ï¼ˆå¦‚æœä½ æƒ³å¾—è¯ä¹Ÿå¯ä»¥æ˜¯å½©è‰²çš„ï¼‰çº¹ç†ï¼Œæ¥å®šä¹‰ç‰©ä½“æ¯éƒ¨åˆ†çš„é•œé¢å…‰å¼ºåº¦ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé•œé¢å…‰è´´å›¾(Specular Map)çš„ä¾‹å­ï¼šé•œé¢é«˜å…‰çš„å¼ºåº¦å¯ä»¥é€šè¿‡å›¾åƒæ¯ä¸ªåƒç´ çš„äº®åº¦æ¥è·å–.é•œé¢å…‰è´´å›¾ä¸Šçš„æ¯ä¸ªåƒç´ éƒ½å¯ä»¥ç”±ä¸€ä¸ªé¢œè‰²å‘é‡æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚è¯´é»‘è‰²ä»£è¡¨é¢œè‰²å‘é‡vec3(0.0)ï¼Œç°è‰²ä»£è¡¨é¢œè‰²å‘é‡vec3(0.5).åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šå–æ ·å¯¹åº”çš„é¢œè‰²å€¼å¹¶å°†å®ƒä¹˜ä»¥å…‰æºçš„é•œé¢å¼ºåº¦.ä¸€ä¸ªåƒç´ è¶Šã€Œç™½ã€ï¼Œä¹˜ç§¯å°±ä¼šè¶Šå¤§ï¼Œç‰©ä½“çš„é•œé¢å…‰åˆ†é‡å°±ä¼šè¶Šäº®. ç”±äºç®±å­å¤§éƒ¨åˆ†éƒ½ç”±æœ¨å¤´æ‰€ç»„æˆï¼Œè€Œä¸”æœ¨å¤´æè´¨åº”è¯¥æ²¡æœ‰é•œé¢é«˜å…‰ï¼Œæ‰€ä»¥æ¼«åå°„çº¹ç†çš„æ•´ä¸ªæœ¨å¤´éƒ¨åˆ†å…¨éƒ¨éƒ½è½¬æ¢æˆäº†é»‘è‰².ç®±å­é’¢åˆ¶è¾¹æ¡†çš„é•œé¢å…‰å¼ºåº¦æ˜¯æœ‰ç»†å¾®å˜åŒ–çš„ï¼Œé’¢é“æœ¬èº«ä¼šæ¯”è¾ƒå®¹æ˜“å—åˆ°é•œé¢é«˜å…‰çš„å½±å“ï¼Œè€Œè£‚ç¼åˆ™ä¸ä¼š. é‡‡æ ·é•œé¢å…‰è´´å›¾ç”±äºæˆ‘ä»¬æ­£åœ¨åŒä¸€ä¸ªç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨å¦ä¸€ä¸ªçº¹ç†é‡‡æ ·å™¨ï¼Œæˆ‘ä»¬å¿…é¡»è¦å¯¹é•œé¢å…‰è´´å›¾ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„çº¹ç†å•å…ƒï¼ˆGL_TEXTURE1ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ¸²æŸ“ä¹‹å‰å…ˆæŠŠå®ƒç»‘å®šåˆ°åˆé€‚çš„çº¹ç†å•å…ƒä¸Šï¼šlightingShader.setInt(\"material.specular\", 1);...glActiveTexture(GL_TEXTURE1);glBindTexture(GL_TEXTURE_2D, specularMap); æ¥ä¸‹æ¥æ›´æ–°ç‰‡æ®µç€è‰²å™¨çš„æè´¨å±æ€§ï¼Œè®©å…¶æ¥å—ä¸€ä¸ªsampler2Dè€Œä¸æ˜¯vec3ä½œä¸ºé•œé¢å…‰åˆ†é‡ï¼š struct Material &#123; sampler2D diffuse; sampler2D specular; float shininess;&#125;; æœ€åæˆ‘ä»¬å¸Œæœ›é‡‡æ ·é•œé¢å…‰è´´å›¾ï¼Œæ¥è·å–ç‰‡æ®µæ‰€å¯¹åº”çš„é•œé¢å…‰å¼ºåº¦ï¼š vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords));vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords)); vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords));FragColor = vec4(ambient + diffuse + specular, 1.0); é€šè¿‡ä½¿ç”¨é•œé¢å…‰è´´å›¾æˆ‘ä»¬å¯ä»¥å¯ä»¥å¯¹ç‰©ä½“è®¾ç½®å¤§é‡çš„ç»†èŠ‚ï¼Œæ¯”å¦‚ç‰©ä½“çš„å“ªäº›éƒ¨åˆ†éœ€è¦æœ‰é—ªé—ªå‘å…‰çš„å±æ€§ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥è®¾ç½®å®ƒä»¬å¯¹åº”çš„å¼ºåº¦.é•œé¢å…‰è´´å›¾èƒ½å¤Ÿåœ¨æ¼«åå°„è´´å›¾ä¹‹ä¸Šç»™äºˆæˆ‘ä»¬æ›´é«˜ä¸€å±‚çš„æ§åˆ¶. æŠ•å…‰ç‰©å¹³è¡Œå…‰å½“æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå‡è®¾å…‰æºå¤„äºæ— é™è¿œå¤„çš„æ¨¡å‹æ—¶ï¼Œå®ƒå°±è¢«ç§°ä¸ºå®šå‘å…‰ï¼Œå› ä¸ºå®ƒçš„æ‰€æœ‰å…‰çº¿éƒ½æœ‰ç€ç›¸åŒçš„æ–¹å‘ï¼Œå®ƒä¸å…‰æºçš„ä½ç½®æ˜¯æ²¡æœ‰å…³ç³»çš„. æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå…‰çº¿æ–¹å‘å‘é‡è€Œä¸æ˜¯ä½ç½®å‘é‡æ¥æ¨¡æ‹Ÿä¸€ä¸ªå®šå‘å…‰.ç€è‰²å™¨çš„è®¡ç®—åŸºæœ¬ä¿æŒä¸å˜ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬å°†ç›´æ¥ä½¿ç”¨å…‰çš„directionå‘é‡è€Œä¸æ˜¯é€šè¿‡directionæ¥è®¡ç®—lightDirå‘é‡. struct Light &#123; // vec3 position; // ä½¿ç”¨å®šå‘å…‰å°±ä¸å†éœ€è¦äº† vec3 direction; vec3 ambient; vec3 diffuse; vec3 specular;&#125;;...void main()&#123; vec3 lightDir = normalize(-light.direction); ...&#125; æ³¨æ„æˆ‘ä»¬é¦–å…ˆå¯¹light.directionå‘é‡å–å.æˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„å…‰ç…§è®¡ç®—éœ€æ±‚ä¸€ä¸ªä»ç‰‡æ®µè‡³å…‰æºçš„å…‰çº¿æ–¹å‘ï¼Œä½†äººä»¬æ›´ä¹ æƒ¯å®šä¹‰å®šå‘å…‰ä¸ºä¸€ä¸ªä»å…‰æºå‡ºå‘çš„å…¨å±€æ–¹å‘ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å…¨å±€å…‰ç…§æ–¹å‘å‘é‡å–åæ¥æ”¹å˜å®ƒçš„æ–¹å‘ï¼Œå®ƒç°åœ¨æ˜¯ä¸€ä¸ªæŒ‡å‘å…‰æºçš„æ–¹å‘å‘é‡äº†.è€Œä¸”ï¼Œè®°å¾—å¯¹å‘é‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå‡è®¾è¾“å…¥å‘é‡ä¸ºä¸€ä¸ªå•ä½å‘é‡æ˜¯å¾ˆä¸æ˜æ™ºçš„. for(unsigned int i = 0; i &lt; 10; i++)&#123; glm::mat4 model; model = glm::translate(model, cubePositions[i]); float angle = 20.0f * i; model = glm::rotate(model, glm::radians(angle), glm::vec3(1.0f, 0.3f, 0.5f)); lightingShader.setMat4(\"model\", model); glDrawArrays(GL_TRIANGLES, 0, 36);&#125; åŒæ—¶ï¼Œä¸è¦å¿˜è®°å®šä¹‰å…‰æºçš„æ–¹å‘ï¼ˆæ³¨æ„æˆ‘ä»¬å°†æ–¹å‘å®šä¹‰ä¸ºä»å…‰æºå‡ºå‘çš„æ–¹å‘ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“çœ‹åˆ°å…‰çš„æ–¹å‘æœä¸‹ï¼‰. lightingShader.setVec3(\"light.direction\", -0.2f, -1.0f, -0.3f); æˆ‘ä»¬ä¸€ç›´å°†å…‰çš„ä½ç½®å’Œä½ç½®å‘é‡å®šä¹‰ä¸ºvec3ï¼Œä½†ä¸€äº›äººä¼šå–œæ¬¢å°†æ‰€æœ‰çš„å‘é‡éƒ½å®šä¹‰ä¸ºvec4.å½“æˆ‘ä»¬å°†ä½ç½®å‘é‡å®šä¹‰ä¸ºä¸€ä¸ªvec4æ—¶ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¦å°†wåˆ†é‡è®¾ç½®ä¸º1.0ï¼Œè¿™æ ·å˜æ¢å’ŒæŠ•å½±æ‰èƒ½æ­£ç¡®åº”ç”¨ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–¹å‘å‘é‡ä¸ºvec4çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³è®©ä½ç§»æœ‰ä»»ä½•çš„æ•ˆæœï¼ˆå› ä¸ºå®ƒä»…ä»…ä»£è¡¨çš„æ˜¯æ–¹å‘ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†wåˆ†é‡è®¾ç½®ä¸º0.0.æ–¹å‘å‘é‡å°±ä¼šåƒè¿™æ ·æ¥è¡¨ç¤ºï¼švec4(0.2f, 1.0f, 0.3f, 0.0f)ã€‚è¿™ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå¿«é€Ÿæ£€æµ‹å…‰ç…§ç±»å‹çš„å·¥å…·ï¼šä½ å¯ä»¥æ£€æµ‹wåˆ†é‡æ˜¯å¦ç­‰äº1.0ï¼Œæ¥æ£€æµ‹å®ƒæ˜¯å¦æ˜¯å…‰çš„ä½ç½®å‘é‡ï¼›wåˆ†é‡ç­‰äº0.0ï¼Œåˆ™å®ƒæ˜¯å…‰çš„æ–¹å‘å‘é‡ï¼Œè¿™æ ·å°±èƒ½æ ¹æ®è¿™ä¸ªæ¥è°ƒæ•´å…‰ç…§è®¡ç®—äº†ï¼šif(lightVector.w == 0.0) // æ³¨æ„æµ®ç‚¹æ•°æ®ç±»å‹çš„è¯¯å·® // æ‰§è¡Œå®šå‘å…‰ç…§è®¡ç®—else if(lightVector.w == 1.0) // æ ¹æ®å…‰æºçš„ä½ç½®åšå…‰ç…§è®¡ç®—ï¼ˆä¸ä¸Šä¸€èŠ‚ä¸€æ ·ï¼‰ ç‚¹å…‰æºå®šå‘å…‰å¯¹äºç…§äº®æ•´ä¸ªåœºæ™¯çš„å…¨å±€å…‰æºæ˜¯éå¸¸æ£’çš„ï¼Œä½†é™¤äº†å®šå‘å…‰ä¹‹å¤–æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€äº›åˆ†æ•£åœ¨åœºæ™¯ä¸­çš„ç‚¹å…‰æº(Point Light).ç‚¹å…‰æºæ˜¯å¤„äºä¸–ç•Œä¸­æŸä¸€ä¸ªä½ç½®çš„å…‰æºï¼Œå®ƒä¼šæœç€æ‰€æœ‰æ–¹å‘å‘å…‰ï¼Œä½†å…‰çº¿ä¼šéšç€è·ç¦»é€æ¸è¡°å‡.æƒ³è±¡ä½œä¸ºæŠ•å…‰ç‰©çš„ç¯æ³¡å’Œç«æŠŠï¼Œå®ƒä»¬éƒ½æ˜¯ç‚¹å…‰æº. ç„¶è€Œï¼Œæˆ‘ä»¬å®šä¹‰çš„å…‰æºæ¨¡æ‹Ÿçš„æ˜¯æ°¸è¿œä¸ä¼šè¡°å‡çš„å…‰çº¿ï¼Œè¿™çœ‹èµ·æ¥åƒæ˜¯å…‰æºäº®åº¦éå¸¸çš„å¼º.åœ¨å¤§éƒ¨åˆ†çš„3Dæ¨¡æ‹Ÿä¸­ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›æ¨¡æ‹Ÿçš„å…‰æºä»…ç…§äº®å…‰æºé™„è¿‘çš„åŒºåŸŸè€Œä¸æ˜¯æ•´ä¸ªåœºæ™¯ã€‚ å¦‚æœä½ å°†10ä¸ªç®±å­åŠ å…¥åˆ°ä¸Šä¸€èŠ‚å…‰ç…§åœºæ™¯ä¸­ï¼Œä½ ä¼šæ³¨æ„åˆ°åœ¨æœ€åé¢çš„ç®±å­å’Œåœ¨ç¯é¢å‰çš„ç®±å­éƒ½ä»¥ç›¸åŒçš„å¼ºåº¦è¢«ç…§äº®ï¼Œå¹¶æ²¡æœ‰å®šä¹‰ä¸€ä¸ªå…¬å¼æ¥å°†å…‰éšè·ç¦»è¡°å‡.æˆ‘ä»¬å¸Œæœ›åœ¨åæ’çš„ç®±å­ä¸å‰æ’çš„ç®±å­ç›¸æ¯”ä»…ä»…æ˜¯è¢«è½»å¾®åœ°ç…§äº®. è¡°å‡ä¸‹é¢è¿™ä¸ªå…¬å¼æ ¹æ®ç‰‡æ®µè·å…‰æºçš„è·ç¦»è®¡ç®—äº†è¡°å‡å€¼ï¼Œä¹‹åæˆ‘ä»¬ä¼šå°†å®ƒä¹˜ä»¥å…‰çš„å¼ºåº¦å‘é‡ï¼šåœ¨è¿™é‡Œdä»£è¡¨äº†ç‰‡æ®µè·å…‰æºçš„è·ç¦»ã€‚æ¥ä¸‹æ¥ä¸ºäº†è®¡ç®—è¡°å‡å€¼ï¼Œæˆ‘ä»¬å®šä¹‰3ä¸ªï¼ˆå¯é…ç½®çš„ï¼‰é¡¹ï¼šå¸¸æ•°é¡¹Kcã€ä¸€æ¬¡é¡¹Klå’ŒäºŒæ¬¡é¡¹Kq. å¸¸æ•°é¡¹é€šå¸¸ä¿æŒä¸º1.0ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åˆ†æ¯æ°¸è¿œä¸ä¼šæ¯”1å°ï¼Œå¦åˆ™çš„è¯åœ¨æŸäº›è·ç¦»ä¸Šå®ƒåè€Œä¼šå¢åŠ å¼ºåº¦ï¼Œè¿™è‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ. ä¸€æ¬¡é¡¹ä¼šä¸è·ç¦»å€¼ç›¸ä¹˜ï¼Œä»¥çº¿æ€§çš„æ–¹å¼å‡å°‘å¼ºåº¦. äºŒæ¬¡é¡¹ä¼šä¸è·ç¦»çš„å¹³æ–¹ç›¸ä¹˜ï¼Œè®©å…‰æºä»¥äºŒæ¬¡é€’å‡çš„æ–¹å¼å‡å°‘å¼ºåº¦.äºŒæ¬¡é¡¹åœ¨è·ç¦»æ¯”è¾ƒå°çš„æ—¶å€™å½±å“ä¼šæ¯”ä¸€æ¬¡é¡¹å°å¾ˆå¤šï¼Œä½†å½“è·ç¦»å€¼æ¯”è¾ƒå¤§çš„æ—¶å€™å®ƒå°±ä¼šæ¯”ä¸€æ¬¡é¡¹æ›´å¤§äº†. ç”±äºäºŒæ¬¡é¡¹çš„å­˜åœ¨ï¼Œå…‰çº¿ä¼šåœ¨å¤§éƒ¨åˆ†æ—¶å€™ä»¥çº¿æ€§çš„æ–¹å¼è¡°é€€ï¼Œç›´åˆ°è·ç¦»å˜å¾—è¶³å¤Ÿå¤§ï¼Œè®©äºŒæ¬¡é¡¹è¶…è¿‡ä¸€æ¬¡é¡¹ï¼Œå…‰çš„å¼ºåº¦ä¼šä»¥æ›´å¿«çš„é€Ÿåº¦ä¸‹é™ã€‚è¿™æ ·çš„ç»“æœå°±æ˜¯ï¼Œå…‰åœ¨è¿‘è·ç¦»æ—¶äº®åº¦å¾ˆé«˜ï¼Œä½†éšç€è·ç¦»å˜è¿œäº®åº¦è¿…é€Ÿé™ä½ï¼Œæœ€åä¼šä»¥æ›´æ…¢çš„é€Ÿåº¦å‡å°‘äº®åº¦.ä¸‹é¢è¿™å¼ å›¾æ˜¾ç¤ºäº†åœ¨100çš„è·ç¦»å†…è¡°å‡çš„æ•ˆæœï¼š é€‰æ‹©æ­£ç¡®çš„å€¼æ­£ç¡®åœ°è®¾å®šå®ƒä»¬çš„å€¼å–å†³äºå¾ˆå¤šå› ç´ ï¼šç¯å¢ƒã€å¸Œæœ›å…‰è¦†ç›–çš„è·ç¦»ã€å…‰çš„ç±»å‹ç­‰.åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™éƒ½æ˜¯ç»éªŒçš„é—®é¢˜ï¼Œä»¥åŠé€‚é‡çš„è°ƒæ•´.ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ˜¾ç¤ºäº†æ¨¡æ‹Ÿä¸€ä¸ªï¼ˆå¤§æ¦‚ï¼‰çœŸå®çš„ï¼Œè¦†ç›–ç‰¹å®šåŠå¾„ï¼ˆè·ç¦»ï¼‰çš„å…‰æºæ—¶ï¼Œè¿™äº›é¡¹å¯èƒ½å–çš„ä¸€äº›å€¼.ç¬¬ä¸€åˆ—æŒ‡å®šçš„æ˜¯åœ¨ç»™å®šçš„ä¸‰é¡¹æ—¶å…‰æ‰€èƒ½è¦†ç›–çš„è·ç¦».è¿™äº›å€¼æ˜¯å¤§å¤šæ•°å…‰æºå¾ˆå¥½çš„èµ·å§‹ç‚¹ï¼Œå®ƒä»¬ç”±Ogre3Dçš„Wikiæ‰€æä¾›ï¼šå¸¸æ•°é¡¹Kcåœ¨æ‰€æœ‰çš„æƒ…å†µä¸‹éƒ½æ˜¯1.0.ä¸€æ¬¡é¡¹Klä¸ºäº†è¦†ç›–æ›´è¿œçš„è·ç¦»é€šå¸¸éƒ½å¾ˆå°ï¼ŒäºŒæ¬¡é¡¹Kqç”šè‡³æ›´å°.å°è¯•å¯¹è¿™äº›å€¼è¿›è¡Œå®éªŒï¼Œçœ‹çœ‹å®ƒä»¬åœ¨ä½ çš„å®ç°ä¸­æœ‰ä»€ä¹ˆæ•ˆæœ.åœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­ï¼Œ32åˆ°100çš„è·ç¦»å¯¹å¤§å¤šæ•°çš„å…‰æºéƒ½è¶³å¤Ÿäº†. å®ç°è¡°å‡ä¸ºäº†å®ç°è¡°å‡ï¼Œåœ¨ç‰‡æ®µç€è‰²å™¨ä¸­æˆ‘ä»¬è¿˜éœ€è¦ä¸‰ä¸ªé¢å¤–çš„å€¼ï¼šä¹Ÿå°±æ˜¯å…¬å¼ä¸­çš„å¸¸æ•°é¡¹ã€ä¸€æ¬¡é¡¹å’ŒäºŒæ¬¡é¡¹.å®ƒä»¬æœ€å¥½å‚¨å­˜åœ¨ä¹‹å‰å®šä¹‰çš„Lightç»“æ„ä½“ä¸­.æ³¨æ„æˆ‘ä»¬ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­è®¡ç®—lightDirçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä¸Šé¢å®šå‘å…‰éƒ¨åˆ†çš„. struct Light &#123; vec3 position; vec3 ambient; vec3 diffuse; vec3 specular; float constant; float linear; float quadratic;&#125;; ç„¶åæˆ‘ä»¬å°†åœ¨OpenGLä¸­è®¾ç½®è¿™äº›é¡¹ï¼šæˆ‘ä»¬å¸Œæœ›å…‰æºèƒ½å¤Ÿè¦†ç›–50çš„è·ç¦»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä½¿ç”¨è¡¨æ ¼ä¸­å¯¹åº”çš„å¸¸æ•°é¡¹ã€ä¸€æ¬¡é¡¹å’ŒäºŒæ¬¡é¡¹ï¼š lightingShader.setFloat(\"light.constant\", 1.0f);lightingShader.setFloat(\"light.linear\", 0.09f);lightingShader.setFloat(\"light.quadratic\", 0.032f); åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å®ç°è¡°å‡è¿˜æ˜¯æ¯”è¾ƒç›´æ¥çš„ï¼šæˆ‘ä»¬æ ¹æ®å…¬å¼è®¡ç®—è¡°å‡å€¼ï¼Œä¹‹åå†åˆ†åˆ«ä¹˜ä»¥ç¯å¢ƒå…‰ã€æ¼«åå°„å’Œé•œé¢å…‰åˆ†é‡. æˆ‘ä»¬ä»éœ€è¦å…¬å¼ä¸­è·å…‰æºçš„è·ç¦»ï¼Œè¿˜è®°å¾—æˆ‘ä»¬æ˜¯æ€ä¹ˆè®¡ç®—ä¸€ä¸ªå‘é‡çš„é•¿åº¦çš„å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡è·å–ç‰‡æ®µå’Œå…‰æºä¹‹é—´çš„å‘é‡å·®ï¼Œå¹¶è·å–ç»“æœå‘é‡çš„é•¿åº¦ä½œä¸ºè·ç¦»é¡¹.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨GLSLå†…å»ºçš„lengthå‡½æ•°æ¥å®Œæˆè¿™ä¸€ç‚¹ï¼š float distance = length(light.position - FragPos);float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));ambient *= attenuation; diffuse *= attenuation;specular *= attenuation; å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰å‰æ’çš„ç®±å­è¢«ç…§äº®çš„ï¼Œè·ç¦»æœ€è¿‘çš„ç®±å­æ˜¯æœ€äº®çš„.åæ’çš„ç®±å­ä¸€ç‚¹éƒ½æ²¡æœ‰ç…§äº®ï¼Œå› ä¸ºå®ƒä»¬ç¦»å…‰æºå®åœ¨æ˜¯å¤ªè¿œäº†. èšå…‰èšå…‰(Spotlight)æ˜¯ä½äºç¯å¢ƒä¸­æŸä¸ªä½ç½®çš„å…‰æºï¼Œå®ƒåªæœä¸€ä¸ªç‰¹å®šæ–¹å‘è€Œä¸æ˜¯æ‰€æœ‰æ–¹å‘ç…§å°„å…‰çº¿.è¿™æ ·çš„ç»“æœå°±æ˜¯åªæœ‰åœ¨èšå…‰æ–¹å‘çš„ç‰¹å®šåŠå¾„å†…çš„ç‰©ä½“æ‰ä¼šè¢«ç…§äº®ï¼Œå…¶å®ƒçš„ç‰©ä½“éƒ½ä¼šä¿æŒé»‘æš—ã€‚èšå…‰å¾ˆå¥½çš„ä¾‹å­å°±æ˜¯è·¯ç¯æˆ–æ‰‹ç”µç­’. OpenGLä¸­èšå…‰æ˜¯ç”¨ä¸€ä¸ªä¸–ç•Œç©ºé—´ä½ç½®ã€ä¸€ä¸ªæ–¹å‘å’Œä¸€ä¸ªåˆ‡å…‰è§’(Cutoff Angle)æ¥è¡¨ç¤ºçš„ï¼Œåˆ‡å…‰è§’æŒ‡å®šäº†èšå…‰çš„åŠå¾„ï¼ˆè¯‘æ³¨ï¼šæ˜¯åœ†é”¥çš„åŠå¾„ä¸æ˜¯è·å…‰æºè·ç¦»é‚£ä¸ªåŠå¾„ï¼‰.å¯¹äºæ¯ä¸ªç‰‡æ®µï¼Œæˆ‘ä»¬ä¼šè®¡ç®—ç‰‡æ®µæ˜¯å¦ä½äºèšå…‰çš„åˆ‡å…‰æ–¹å‘ä¹‹é—´ï¼ˆä¹Ÿå°±æ˜¯åœ¨é”¥å½¢å†…ï¼‰ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œæˆ‘ä»¬å°±ä¼šç›¸åº”åœ°ç…§äº®ç‰‡æ®µã€‚ä¸‹é¢è¿™å¼ å›¾ä¼šè®©ä½ æ˜ç™½èšå…‰æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š LightDirï¼šä»ç‰‡æ®µæŒ‡å‘å…‰æºçš„å‘é‡. SpotDirï¼šèšå…‰æ‰€æŒ‡å‘çš„æ–¹å‘. PhiÏ•ï¼šæŒ‡å®šäº†èšå…‰åŠå¾„çš„åˆ‡å…‰è§’.è½åœ¨è¿™ä¸ªè§’åº¦ä¹‹å¤–çš„ç‰©ä½“éƒ½ä¸ä¼šè¢«è¿™ä¸ªèšå…‰æ‰€ç…§äº®. ThetaÎ¸ï¼šLightDirå‘é‡å’ŒSpotDirå‘é‡ä¹‹é—´çš„å¤¹è§’.åœ¨èšå…‰å†…éƒ¨çš„è¯Î¸å€¼åº”è¯¥æ¯”Ï•å€¼å°. æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®¡ç®—LightDirå‘é‡å’ŒSpotDirå‘é‡ä¹‹é—´çš„ç‚¹ç§¯ï¼ˆè¿˜è®°å¾—å®ƒä¼šè¿”å›ä¸¤ä¸ªå•ä½å‘é‡å¤¹è§’çš„ä½™å¼¦å€¼å—ï¼Ÿï¼‰ï¼Œå¹¶å°†å®ƒä¸åˆ‡å…‰è§’Ï•å€¼å¯¹æ¯”.ä½ ç°åœ¨åº”è¯¥äº†è§£èšå…‰ç©¶ç«Ÿæ˜¯ä»€ä¹ˆäº†ï¼Œä¸‹é¢æˆ‘ä»¬å°†ä»¥æ‰‹ç”µç­’çš„å½¢å¼åˆ›å»ºä¸€ä¸ªèšå…‰. æ‰‹ç”µç­’æ‰‹ç”µç­’(Flashlight)æ˜¯ä¸€ä¸ªä½äºè§‚å¯Ÿè€…ä½ç½®çš„èšå…‰ï¼Œé€šå¸¸å®ƒéƒ½ä¼šç„å‡†ç©å®¶è§†è§’çš„æ­£å‰æ–¹.åŸºæœ¬ä¸Šè¯´ï¼Œæ‰‹ç”µç­’å°±æ˜¯æ™®é€šçš„èšå…‰ï¼Œä½†å®ƒçš„ä½ç½®å’Œæ–¹å‘ä¼šéšç€ç©å®¶çš„ä½ç½®å’Œæœå‘ä¸æ–­æ›´æ–°. æ‰€ä»¥ï¼Œåœ¨ç‰‡æ®µç€è‰²å™¨ä¸­æˆ‘ä»¬éœ€è¦çš„å€¼æœ‰èšå…‰çš„ä½ç½®å‘é‡ï¼ˆæ¥è®¡ç®—å…‰çš„æ–¹å‘å‘é‡ï¼‰ã€èšå…‰çš„æ–¹å‘å‘é‡å’Œä¸€ä¸ªåˆ‡å…‰è§’.æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬å‚¨å­˜åœ¨Lightç»“æ„ä½“ä¸­ï¼šstruct Light &#123; vec3 position; vec3 direction; float cutOff; ...&#125;; æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆé€‚çš„å€¼ä¼ åˆ°ç€è‰²å™¨ä¸­ï¼š lightingShader.setVec3(\"light.position\", camera.Position);lightingShader.setVec3(\"light.direction\", camera.Front);lightingShader.setFloat(\"light.cutOff\", glm::cos(glm::radians(12.5f))); ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç»™åˆ‡å…‰è§’è®¾ç½®ä¸€ä¸ªè§’åº¦å€¼ï¼Œåè€Œæ˜¯ç”¨è§’åº¦å€¼è®¡ç®—äº†ä¸€ä¸ªä½™å¼¦å€¼ï¼Œå°†ä½™å¼¦ç»“æœä¼ é€’åˆ°ç‰‡æ®µç€è‰²å™¨ä¸­.è¿™æ ·åšçš„åŸå› æ˜¯åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—LightDirå’ŒSpotDirå‘é‡çš„ç‚¹ç§¯ï¼Œè¿™ä¸ªç‚¹ç§¯è¿”å›çš„å°†æ˜¯ä¸€ä¸ªä½™å¼¦å€¼è€Œä¸æ˜¯è§’åº¦å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨è§’åº¦å€¼å’Œä½™å¼¦å€¼è¿›è¡Œæ¯”è¾ƒ.ä¸ºäº†è·å–è§’åº¦å€¼æˆ‘ä»¬éœ€è¦è®¡ç®—ç‚¹ç§¯ç»“æœçš„åä½™å¼¦ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€é”€å¾ˆå¤§çš„è®¡ç®—.æ‰€ä»¥ä¸ºäº†èŠ‚çº¦ä¸€ç‚¹æ€§èƒ½å¼€é”€ï¼Œæˆ‘ä»¬å°†ä¼šè®¡ç®—åˆ‡å…‰è§’å¯¹åº”çš„ä½™å¼¦å€¼ï¼Œå¹¶å°†å®ƒçš„ç»“æœä¼ å…¥ç‰‡æ®µç€è‰²å™¨ä¸­.ç”±äºè¿™ä¸¤ä¸ªè§’åº¦ç°åœ¨éƒ½ç”±ä½™å¼¦è§’æ¥è¡¨ç¤ºäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹å®ƒä»¬è¿›è¡Œæ¯”è¾ƒè€Œä¸ç”¨è¿›è¡Œä»»ä½•å¼€é”€é«˜æ˜‚çš„è®¡ç®—. æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—Î¸å€¼ï¼Œå¹¶å°†å®ƒå’Œåˆ‡å…‰è§’Ï•å¯¹æ¯”ï¼Œæ¥å†³å®šæ˜¯å¦åœ¨èšå…‰çš„å†…éƒ¨ï¼š float theta = dot(lightDir, normalize(-light.direction));if(theta &gt; light.cutOff) &#123; // æ‰§è¡Œå…‰ç…§è®¡ç®—&#125;else // å¦åˆ™ï¼Œä½¿ç”¨ç¯å¢ƒå…‰ï¼Œè®©åœºæ™¯åœ¨èšå…‰ä¹‹å¤–æ—¶ä¸è‡³äºå®Œå…¨é»‘æš— color = vec4(light.ambient * vec3(texture(material.diffuse, TexCoords)), 1.0); æˆ‘ä»¬é¦–å…ˆè®¡ç®—äº†lightDirå’Œå–åçš„directionå‘é‡ï¼ˆå–åçš„æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³è®©å‘é‡æŒ‡å‘å…‰æºè€Œä¸æ˜¯ä»å…‰æºå‡ºå‘ï¼‰ä¹‹é—´çš„ç‚¹ç§¯.è®°ä½è¦å¯¹æ‰€æœ‰çš„ç›¸å…³å‘é‡æ ‡å‡†åŒ–. è¿™ä»çœ‹èµ·æ¥æœ‰äº›å‡ï¼Œä¸»è¦æ˜¯å› ä¸ºèšå…‰æœ‰ä¸€åœˆç¡¬è¾¹.å½“ä¸€ä¸ªç‰‡æ®µé‡åˆ°èšå…‰åœ†é”¥çš„è¾¹ç¼˜æ—¶ï¼Œå®ƒä¼šå®Œå…¨å˜æš—ï¼Œæ²¡æœ‰ä¸€ç‚¹å¹³æ»‘çš„è¿‡æ¸¡.ä¸€ä¸ªçœŸå®çš„èšå…‰å°†ä¼šåœ¨è¾¹ç¼˜å¤„é€æ¸å‡å°‘äº®åº¦. å¹³æ»‘/è½¯åŒ–è¾¹ç¼˜ä¸ºäº†åˆ›å»ºä¸€ç§çœ‹èµ·æ¥è¾¹ç¼˜å¹³æ»‘çš„èšå…‰ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿèšå…‰æœ‰ä¸€ä¸ªå†…åœ†é”¥(Inner Cone)å’Œä¸€ä¸ªå¤–åœ†é”¥(Outer Cone).æˆ‘ä»¬å¯ä»¥å°†å†…åœ†é”¥è®¾ç½®ä¸ºä¸Šä¸€éƒ¨åˆ†ä¸­çš„é‚£ä¸ªåœ†é”¥ï¼Œä½†æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ä¸ªå¤–åœ†é”¥ï¼Œæ¥è®©å…‰ä»å†…åœ†é”¥é€æ¸å‡æš—ï¼Œç›´åˆ°å¤–åœ†é”¥çš„è¾¹ç•Œ. ä¸ºäº†åˆ›å»ºä¸€ä¸ªå¤–åœ†é”¥ï¼Œæˆ‘ä»¬åªéœ€è¦å†å®šä¹‰ä¸€ä¸ªä½™å¼¦å€¼æ¥ä»£è¡¨èšå…‰æ–¹å‘å‘é‡å’Œå¤–åœ†é”¥å‘é‡ï¼ˆç­‰äºå®ƒçš„åŠå¾„ï¼‰çš„å¤¹è§’.ç„¶åï¼Œå¦‚æœä¸€ä¸ªç‰‡æ®µå¤„äºå†…å¤–åœ†é”¥ä¹‹é—´ï¼Œå°†ä¼šç»™å®ƒè®¡ç®—å‡ºä¸€ä¸ª0.0åˆ°1.0ä¹‹é—´çš„å¼ºåº¦å€¼.å¦‚æœç‰‡æ®µåœ¨å†…åœ†é”¥ä¹‹å†…ï¼Œå®ƒçš„å¼ºåº¦å°±æ˜¯1.0ï¼Œå¦‚æœåœ¨å¤–åœ†é”¥ä¹‹å¤–å¼ºåº¦å€¼å°±æ˜¯0.0. æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå…¬å¼æ¥è®¡ç®—è¿™ä¸ªå€¼ï¼šè¿™é‡ŒÏµ(Epsilon)æ˜¯å†…ï¼ˆÏ•ï¼‰å’Œå¤–åœ†é”¥ï¼ˆÎ³ï¼‰ä¹‹é—´çš„ä½™å¼¦å€¼å·®ï¼ˆÏµ=Ï•âˆ’Î³ï¼‰.æœ€ç»ˆçš„Iå€¼å°±æ˜¯åœ¨å½“å‰ç‰‡æ®µèšå…‰çš„å¼ºåº¦. å¾ˆéš¾å»è¡¨ç°è¿™ä¸ªå…¬å¼æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€äº›å®ä¾‹å€¼æ¥çœ‹çœ‹ï¼šä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åŸºæœ¬æ˜¯åœ¨å†…å¤–ä½™å¼¦å€¼ä¹‹é—´æ ¹æ®Î¸æ’å€¼.å¦‚æœä½ ä»ä¸æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸å¿…æ‹…å¿ƒï¼Œåªéœ€è¦è®°ä½è¿™ä¸ªå…¬å¼å°±å¥½äº†ï¼Œåœ¨ä½ æ›´èªæ˜çš„æ—¶å€™å†å›æ¥çœ‹çœ‹ã€‚ æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªåœ¨èšå…‰å¤–æ˜¯è´Ÿçš„ï¼Œåœ¨å†…åœ†é”¥å†…å¤§äº1.0çš„ï¼Œåœ¨è¾¹ç¼˜å¤„äºä¸¤è€…ä¹‹é—´çš„å¼ºåº¦å€¼äº†.å¦‚æœæˆ‘ä»¬æ­£ç¡®åœ°çº¦æŸ(Clamp)è¿™ä¸ªå€¼ï¼Œåœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å°±ä¸å†éœ€è¦if-elseäº†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨è®¡ç®—å‡ºæ¥çš„å¼ºåº¦å€¼ç›´æ¥ä¹˜ä»¥å…‰ç…§åˆ†é‡ï¼š float theta = dot(lightDir, normalize(-light.direction));float epsilon = light.cutOff - light.outerCutOff;float intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0); ...// å°†ä¸å¯¹ç¯å¢ƒå…‰åšå‡ºå½±å“ï¼Œè®©å®ƒæ€»æ˜¯èƒ½æœ‰ä¸€ç‚¹å…‰diffuse *= intensity;specular *= intensity;... æ³¨æ„æˆ‘ä»¬ä½¿ç”¨äº†clampå‡½æ•°ï¼Œå®ƒæŠŠç¬¬ä¸€ä¸ªå‚æ•°çº¦æŸ(Clamp)åœ¨äº†0.0åˆ°1.0ä¹‹é—´.è¿™ä¿è¯å¼ºåº¦å€¼ä¸ä¼šåœ¨[0, 1]åŒºé—´ä¹‹å¤–. å¤šå…‰æºä¸ºäº†åœ¨åœºæ™¯ä¸­ä½¿ç”¨å¤šä¸ªå…‰æºï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…‰ç…§è®¡ç®—å°è£…åˆ°GLSLå‡½æ•°ä¸­.è¿™æ ·åšçš„åŸå› æ˜¯ï¼Œæ¯ä¸€ç§å…‰æºéƒ½éœ€è¦ä¸€ç§ä¸åŒçš„è®¡ç®—æ–¹æ³•ï¼Œè€Œä¸€æ—¦æˆ‘ä»¬æƒ³å¯¹å¤šä¸ªå…‰æºè¿›è¡Œå…‰ç…§è®¡ç®—æ—¶ï¼Œä»£ç å¾ˆå¿«å°±ä¼šå˜å¾—éå¸¸å¤æ‚.å¦‚æœæˆ‘ä»¬åªåœ¨mainå‡½æ•°ä¸­è¿›è¡Œæ‰€æœ‰çš„è¿™äº›è®¡ç®—ï¼Œä»£ç å¾ˆå¿«å°±ä¼šå˜å¾—éš¾ä»¥ç†è§£. å½“æˆ‘ä»¬åœ¨åœºæ™¯ä¸­ä½¿ç”¨å¤šä¸ªå…‰æºæ—¶ï¼Œé€šå¸¸ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼šæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªå•ç‹¬çš„é¢œè‰²å‘é‡ä»£è¡¨ç‰‡æ®µçš„è¾“å‡ºé¢œè‰².å¯¹äºæ¯ä¸€ä¸ªå…‰æºï¼Œå®ƒå¯¹ç‰‡æ®µçš„è´¡çŒ®é¢œè‰²å°†ä¼šåŠ åˆ°ç‰‡æ®µçš„è¾“å‡ºé¢œè‰²å‘é‡ä¸Š.æ‰€ä»¥åœºæ™¯ä¸­çš„æ¯ä¸ªå…‰æºéƒ½ä¼šè®¡ç®—å®ƒä»¬å„è‡ªå¯¹ç‰‡æ®µçš„å½±å“ï¼Œå¹¶ç»“åˆä¸ºä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºé¢œè‰².å¤§ä½“çš„ç»“æ„ä¼šåƒæ˜¯è¿™æ ·ï¼š out vec4 FragColor;void main()&#123; // å®šä¹‰ä¸€ä¸ªè¾“å‡ºé¢œè‰²å€¼ vec3 output; // å°†å®šå‘å…‰çš„è´¡çŒ®åŠ åˆ°è¾“å‡ºä¸­ output += someFunctionToCalculateDirectionalLight(); // å¯¹æ‰€æœ‰çš„ç‚¹å…‰æºä¹Ÿåšç›¸åŒçš„äº‹æƒ… for(int i = 0; i &lt; nr_of_point_lights; i++) output += someFunctionToCalculatePointLight(); // ä¹ŸåŠ ä¸Šå…¶å®ƒçš„å…‰æºï¼ˆæ¯”å¦‚èšå…‰ï¼‰ output += someFunctionToCalculateSpotLight(); FragColor = vec4(output, 1.0);&#125; å®é™…çš„ä»£ç å¯¹æ¯ä¸€ç§å®ç°éƒ½å¯èƒ½ä¸åŒï¼Œä½†å¤§ä½“çš„ç»“æ„éƒ½æ˜¯å·®ä¸å¤šçš„.æˆ‘ä»¬å®šä¹‰äº†å‡ ä¸ªå‡½æ•°ï¼Œç”¨æ¥è®¡ç®—æ¯ä¸ªå…‰æºçš„å½±å“ï¼Œå¹¶å°†æœ€ç»ˆçš„ç»“æœé¢œè‰²åŠ åˆ°è¾“å‡ºé¢œè‰²å‘é‡ä¸Š.ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªå…‰æºéƒ½å¾ˆé è¿‘ä¸€ä¸ªç‰‡æ®µï¼Œé‚£ä¹ˆå®ƒä»¬æ‰€ç»“åˆçš„è´¡çŒ®å°†ä¼šå½¢æˆä¸€ä¸ªæ¯”å•ä¸ªå…‰æºç…§äº®æ—¶æ›´åŠ æ˜äº®çš„ç‰‡æ®µ. å®šå‘å…‰æˆ‘ä»¬éœ€è¦åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å®šå‘å…‰å¯¹ç›¸åº”ç‰‡æ®µçš„è´¡çŒ®ï¼šå®ƒæ¥å—ä¸€äº›å‚æ•°å¹¶è®¡ç®—ä¸€ä¸ªå®šå‘å…‰ç…§é¢œè‰². é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªå®šå‘å…‰æºæœ€å°‘æ‰€éœ€è¦çš„å˜é‡.æˆ‘ä»¬å¯ä»¥å°†è¿™äº›å˜é‡å‚¨å­˜åœ¨ä¸€ä¸ªå«åšDirLightçš„ç»“æ„ä½“ä¸­ï¼Œå¹¶å°†å®ƒå®šä¹‰ä¸ºä¸€ä¸ªuniform.éœ€è¦çš„å˜é‡åœ¨ä¸Šä¸€èŠ‚ä¸­éƒ½ä»‹ç»è¿‡ï¼š struct DirLight &#123; vec3 direction; vec3 ambient; vec3 diffuse; vec3 specular;&#125;; uniform DirLight dirLight; æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥å°†dirLightä¼ å…¥ä¸€ä¸ªæœ‰ç€ä¸€ä¸‹åŸå‹çš„å‡½æ•°: vec3 CalcDirLight(DirLight light, vec3 normal, vec3 viewDir); ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ä¸ªDirLightç»“æ„ä½“å’Œå…¶å®ƒä¸¤ä¸ªå‘é‡æ¥è¿›è¡Œè®¡ç®—.vec3 CalcDirLight(DirLight light, vec3 normal, vec3 viewDir)&#123; vec3 lightDir = normalize(-light.direction); // æ¼«åå°„ç€è‰² float diff = max(dot(normal, lightDir), 0.0); // é•œé¢å…‰ç€è‰² vec3 reflectDir = reflect(-lightDir, normal); float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess); // åˆå¹¶ç»“æœ vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords)); vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords)); vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords)); return (ambient + diffuse + specular);&#125; ç‚¹å…‰æºå’Œå®šå‘å…‰ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›å®šä¹‰ä¸€ä¸ªç”¨äºè®¡ç®—ç‚¹å…‰æºå¯¹ç›¸åº”ç‰‡æ®µè´¡çŒ®ï¼Œä»¥åŠè¡°å‡çš„å‡½æ•°.åŒæ ·ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ…å«äº†ç‚¹å…‰æºæ‰€éœ€æ‰€æœ‰å˜é‡çš„ç»“æ„ä½“ï¼šstruct PointLight &#123; vec3 position; float constant; float linear; float quadratic; vec3 ambient; vec3 diffuse; vec3 specular;&#125;; #define NR_POINT_LIGHTS 4uniform PointLight pointLights[NR_POINT_LIGHTS]; ç‚¹å…‰æºå‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼š vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir); è¿™ä¸ªå‡½æ•°ä»å‚æ•°ä¸­è·å–æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ªä»£è¡¨è¯¥ç‚¹å…‰æºå¯¹ç‰‡æ®µçš„é¢œè‰²è´¡çŒ®çš„vec3. vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir)&#123; vec3 lightDir = normalize(light.position - fragPos); // æ¼«åå°„ç€è‰² float diff = max(dot(normal, lightDir), 0.0); // é•œé¢å…‰ç€è‰² vec3 reflectDir = reflect(-lightDir, normal); float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess); // è¡°å‡ float distance = length(light.position - fragPos); float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance)); // åˆå¹¶ç»“æœ vec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords)); vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords)); vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords)); ambient *= attenuation; diffuse *= attenuation; specular *= attenuation; return (ambient + diffuse + specular);&#125; åœ¨mainå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸€ä¸ªå¾ªç¯ï¼Œéå†æ•´ä¸ªç‚¹å…‰æºæ•°ç»„ï¼Œå¯¹æ¯ä¸ªç‚¹å…‰æºè°ƒç”¨CalcPointLightå°±å¯ä»¥äº†. åˆå¹¶ç»“æœvoid main()&#123; // å±æ€§ vec3 norm = normalize(Normal); vec3 viewDir = normalize(viewPos - FragPos); // ç¬¬ä¸€é˜¶æ®µï¼šå®šå‘å…‰ç…§ vec3 result = CalcDirLight(dirLight, norm, viewDir); // ç¬¬äºŒé˜¶æ®µï¼šç‚¹å…‰æº for(int i = 0; i &lt; NR_POINT_LIGHTS; i++) result += CalcPointLight(pointLights[i], norm, FragPos, viewDir); // ç¬¬ä¸‰é˜¶æ®µï¼šèšå…‰ //result += CalcSpotLight(spotLight, norm, FragPos, viewDir); FragColor = vec4(result, 1.0);&#125; è®¾ç½®ä¸€ä¸ªç»“æ„ä½“æ•°ç»„çš„uniformå’Œè®¾ç½®ä¸€ä¸ªç»“æ„ä½“çš„uniformæ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡åœ¨è®¿é—®uniformä½ç½®çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡å€¼ï¼š lightingShader.setFloat(\"pointLights[0].constant\", 1.0f); æˆ‘ä»¬ä¼šå®šä¹‰å¦ä¸€ä¸ªglm::vec3æ•°ç»„æ¥åŒ…å«ç‚¹å…‰æºçš„ä½ç½®ï¼šglm::vec3 pointLightPositions[] = &#123; glm::vec3( 0.7f, 0.2f, 2.0f), glm::vec3( 2.3f, -3.3f, -4.0f), glm::vec3(-4.0f, 2.0f, -12.0f), glm::vec3( 0.0f, 0.0f, -3.0f)&#125;; æ¥ä¸‹æ¥æˆ‘ä»¬ä»pointLightsæ•°ç»„ä¸­ç´¢å¼•å¯¹åº”çš„PointLightï¼Œå°†å®ƒçš„positionå€¼è®¾ç½®ä¸ºåˆšåˆšå®šä¹‰çš„ä½ç½®å€¼æ•°ç»„ä¸­çš„å…¶ä¸­ä¸€ä¸ª.åŒæ—¶æˆ‘ä»¬è¿˜è¦ä¿è¯ç°åœ¨ç»˜åˆ¶çš„æ˜¯å››ä¸ªç¯ç«‹æ–¹ä½“è€Œä¸æ˜¯ä»…ä»…ä¸€ä¸ª.åªè¦å¯¹æ¯ä¸ªç¯ç‰©ä½“åˆ›å»ºä¸€ä¸ªä¸åŒçš„æ¨¡å‹çŸ©é˜µå°±å¯ä»¥äº†ï¼Œå’Œæˆ‘ä»¬ä¹‹å‰å¯¹ç®±å­çš„å¤„ç†ç±»ä¼¼. å¦‚æœä½ è¿˜ä½¿ç”¨äº†æ‰‹ç”µç­’çš„è¯ï¼Œæ‰€æœ‰å…‰æºç»„åˆçš„æ•ˆæœå°†çœ‹èµ·æ¥å’Œä¸‹å›¾å·®ä¸å¤šï¼š","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"OpenGL","slug":"OpenGL","permalink":"/tags/OpenGL/"},{"name":"è®¡ç®—æœºå›¾å½¢å­¦","slug":"è®¡ç®—æœºå›¾å½¢å­¦","permalink":"/tags/è®¡ç®—æœºå›¾å½¢å­¦/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"LearnOpenGL-å…¥é—¨","slug":"LearnOpenGL-å…¥é—¨","date":"2019-10-07T15:00:03.000Z","updated":"2019-10-07T15:00:06.867Z","comments":true,"path":"2019/10/07/LearnOpenGL-å…¥é—¨/","link":"","permalink":"/2019/10/07/LearnOpenGL-å…¥é—¨/","excerpt":"","text":"@[toc] OpenGLå½“æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé€šå¸¸çœ‹èµ·æ¥åƒå¦‚ä¸‹ä¸€æ ·ï¼ˆæŠŠOpenGLä¸Šä¸‹æ–‡çœ‹ä½œä¸€ä¸ªå¤§çš„ç»“æ„ä½“ï¼‰ï¼š // OpenGLçš„çŠ¶æ€struct OpenGL_Context &#123; ... object* object_Window_Target; ... &#125;; è¿™ä¸€å°æ®µä»£ç å±•ç°äº†ä½ ä»¥åä½¿ç”¨OpenGLæ—¶å¸¸è§çš„å·¥ä½œæµã€‚æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åç”¨ä¸€ä¸ªidä¿å­˜å®ƒçš„å¼•ç”¨ï¼ˆå®é™…æ•°æ®è¢«å‚¨å­˜åœ¨åå°ï¼‰ã€‚ç„¶åæˆ‘ä»¬å°†å¯¹è±¡ç»‘å®šè‡³ä¸Šä¸‹æ–‡çš„ç›®æ ‡ä½ç½®ï¼ˆä¾‹å­ä¸­çª—å£å¯¹è±¡ç›®æ ‡çš„ä½ç½®è¢«å®šä¹‰æˆGL_WINDOW_TARGETï¼‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è®¾ç½®çª—å£çš„é€‰é¡¹ã€‚æœ€åæˆ‘ä»¬å°†ç›®æ ‡ä½ç½®çš„å¯¹è±¡idè®¾å›0ï¼Œè§£ç»‘è¿™ä¸ªå¯¹è±¡ã€‚è®¾ç½®çš„é€‰é¡¹å°†è¢«ä¿å­˜åœ¨objectIdæ‰€å¼•ç”¨çš„å¯¹è±¡ä¸­ï¼Œä¸€æ—¦æˆ‘ä»¬é‡æ–°ç»‘å®šè¿™ä¸ªå¯¹è±¡åˆ°GL_WINDOW_TARGETä½ç½®ï¼Œè¿™äº›é€‰é¡¹å°±ä¼šé‡æ–°ç”Ÿæ•ˆã€‚// åˆ›å»ºå¯¹è±¡unsigned int objectId = 0;glGenObject(1, &amp;objectId);// ç»‘å®šå¯¹è±¡è‡³ä¸Šä¸‹æ–‡glBindObject(GL_WINDOW_TARGET, objectId);// è®¾ç½®å½“å‰ç»‘å®šåˆ° GL_WINDOW_TARGET çš„å¯¹è±¡çš„ä¸€äº›é€‰é¡¹glSetObjectOption(GL_WINDOW_TARGET, GL_OPTION_WINDOW_WIDTH, 800);glSetObjectOption(GL_WINDOW_TARGET, GL_OPTION_WINDOW_HEIGHT, 600);// å°†ä¸Šä¸‹æ–‡å¯¹è±¡è®¾å›é»˜è®¤glBindObject(GL_WINDOW_TARGET, 0); åˆ›å»ºçª—å£å¯¹äºç”¨GCCç¼–è¯‘çš„Linuxç”¨æˆ·å»ºè®®ä½¿ç”¨è¿™ä¸ªå‘½ä»¤è¡Œé€‰é¡¹-lGLEW -lglfw3 -lGL -lX11 -lpthread -lXrandr -lXi.æ²¡æœ‰æ­£ç¡®é“¾æ¥ç›¸åº”çš„åº“ä¼šäº§ç”Ÿ undefined reference (æœªå®šä¹‰çš„å¼•ç”¨) è¿™ä¸ªé”™è¯¯ã€‚ ä½ å¥½,çª—å£é…ç½®æ³¨:glad.céœ€è¦æ”¾åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹#include &lt;glad/glad.h&gt;#include &lt;GLFW/glfw3.h&gt;int main()&#123; glfwInit(); glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3); glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3); glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); //glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE); return 0;&#125; //CMakeLists.txtcmake_minimum_required(VERSION 3.14)project(hellow,windows)set(CMAKE_CXX_STANDARD 14)set(SOURCE_FILES main.cpp glad.c)add_executable(main $&#123;SOURCE_FILES&#125;)target_link_libraries(main glfw3 GL m Xrandr Xi X11 Xxf86vm pthread dl Xinerama Xcursor) é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨mainå‡½æ•°ä¸­è°ƒç”¨glfwInitå‡½æ•°æ¥åˆå§‹åŒ–GLFWï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨glfwWindowHintå‡½æ•°æ¥é…ç½®GLFWã€‚glfwWindowHintå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨é€‰é¡¹çš„åç§°ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¾ˆå¤šä»¥GLFW_å¼€å¤´çš„æšä¸¾å€¼ä¸­é€‰æ‹©ï¼›ç¬¬äºŒä¸ªå‚æ•°æ¥å—ä¸€ä¸ªæ•´å‹ï¼Œç”¨æ¥è®¾ç½®è¿™ä¸ªé€‰é¡¹çš„å€¼ã€‚è¯¥å‡½æ•°çš„æ‰€æœ‰çš„é€‰é¡¹ä»¥åŠå¯¹åº”çš„å€¼éƒ½å¯ä»¥åœ¨ GLFWâ€™s window handling è¿™ç¯‡æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚å¦‚æœä½ ç°åœ¨ç¼–è¯‘ä½ çš„cppæ–‡ä»¶ä¼šå¾—åˆ°å¤§é‡çš„ undefined reference (æœªå®šä¹‰çš„å¼•ç”¨)é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¹¶æœªé¡ºåˆ©åœ°é“¾æ¥GLFWåº“. GLADGLADæ˜¯ç”¨æ¥ç®¡ç†OpenGLçš„å‡½æ•°æŒ‡é’ˆçš„ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨ä»»ä½•OpenGLçš„å‡½æ•°ä¹‹å‰æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–GLAD. if (!gladLoadGLLoader((GLADloadproc)glfwGetProcAddress))&#123; std::cout &lt;&lt; \"Failed to initialize GLAD\" &lt;&lt; std::endl; return -1;&#125; æˆ‘ä»¬ç»™GLADä¼ å…¥äº†ç”¨æ¥åŠ è½½ç³»ç»Ÿç›¸å…³çš„OpenGLå‡½æ•°æŒ‡é’ˆåœ°å€çš„å‡½æ•°ã€‚GLFWç»™æˆ‘ä»¬çš„æ˜¯glfwGetProcAddressï¼Œå®ƒæ ¹æ®æˆ‘ä»¬ç¼–è¯‘çš„ç³»ç»Ÿå®šä¹‰äº†æ­£ç¡®çš„å‡½æ•°. è§†å£åœ¨æˆ‘ä»¬å¼€å§‹æ¸²æŸ“ä¹‹å‰è¿˜æœ‰ä¸€ä»¶é‡è¦çš„äº‹æƒ…è¦åšï¼Œæˆ‘ä»¬å¿…é¡»å‘Šè¯‰OpenGLæ¸²æŸ“çª—å£çš„å°ºå¯¸å¤§å°ï¼Œå³è§†å£(Viewport)ï¼Œè¿™æ ·OpenGLæ‰åªèƒ½çŸ¥é“æ€æ ·æ ¹æ®çª—å£å¤§å°æ˜¾ç¤ºæ•°æ®å’Œåæ ‡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨glViewportå‡½æ•°æ¥è®¾ç½®çª—å£çš„ç»´åº¦(Dimension)ï¼š glViewport(0, 0, 800, 600); glViewportå‡½æ•°å‰ä¸¤ä¸ªå‚æ•°æ§åˆ¶çª—å£å·¦ä¸‹è§’çš„ä½ç½®ã€‚ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå‚æ•°æ§åˆ¶æ¸²æŸ“çª—å£çš„å®½åº¦å’Œé«˜åº¦ï¼ˆåƒç´ ï¼‰ã€‚æˆ‘ä»¬å®é™…ä¸Šä¹Ÿå¯ä»¥å°†è§†å£çš„ç»´åº¦è®¾ç½®ä¸ºæ¯”GLFWçš„ç»´åº¦å°ï¼Œè¿™æ ·å­ä¹‹åæ‰€æœ‰çš„OpenGLæ¸²æŸ“å°†ä¼šåœ¨ä¸€ä¸ªæ›´å°çš„çª—å£ä¸­æ˜¾ç¤ºï¼Œè¿™æ ·å­çš„è¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸€äº›å…¶å®ƒå…ƒç´ æ˜¾ç¤ºåœ¨OpenGLè§†å£ä¹‹å¤–. OpenGLå¹•åä½¿ç”¨glViewportä¸­å®šä¹‰çš„ä½ç½®å’Œå®½é«˜è¿›è¡Œ2Dåæ ‡çš„è½¬æ¢ï¼Œå°†OpenGLä¸­çš„ä½ç½®åæ ‡è½¬æ¢ä¸ºä½ çš„å±å¹•åæ ‡ã€‚ä¾‹å¦‚ï¼ŒOpenGLä¸­çš„åæ ‡(-0.5, 0.5)æœ‰å¯èƒ½ï¼ˆæœ€ç»ˆï¼‰è¢«æ˜ å°„ä¸ºå±å¹•ä¸­çš„åæ ‡(200,450)ã€‚æ³¨æ„ï¼Œå¤„ç†è¿‡çš„OpenGLåæ ‡èŒƒå›´åªä¸º-1åˆ°1ï¼Œå› æ­¤æˆ‘ä»¬äº‹å®ä¸Šå°†(-1åˆ°1)èŒƒå›´å†…çš„åæ ‡æ˜ å°„åˆ°(0, 800)å’Œ(0, 600). ç„¶è€Œï¼Œå½“ç”¨æˆ·æ”¹å˜çª—å£çš„å¤§å°çš„æ—¶å€™ï¼Œè§†å£ä¹Ÿåº”è¯¥è¢«è°ƒæ•´ã€‚æˆ‘ä»¬å¯ä»¥å¯¹çª—å£æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°(Callback Function)ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡çª—å£å¤§å°è¢«è°ƒæ•´çš„æ—¶å€™è¢«è°ƒç”¨ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼š void framebuffer_size_callback(GLFWwindow* window, int width, int height); è¿™ä¸ªå¸§ç¼“å†²å¤§å°å‡½æ•°éœ€è¦ä¸€ä¸ªGLFWwindowä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥åŠä¸¤ä¸ªæ•´æ•°è¡¨ç¤ºçª—å£çš„æ–°ç»´åº¦ã€‚æ¯å½“çª—å£æ”¹å˜å¤§å°ï¼ŒGLFWä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶å¡«å……ç›¸åº”çš„å‚æ•°ä¾›ä½ å¤„ç†. void framebuffer_size_callback(GLFWwindow* window, int width, int height)&#123; glViewport(0, 0, width, height);&#125; æˆ‘ä»¬è¿˜éœ€è¦æ³¨å†Œè¿™ä¸ªå‡½æ•°ï¼Œå‘Šè¯‰GLFWæˆ‘ä»¬å¸Œæœ›æ¯å½“çª—å£è°ƒæ•´å¤§å°çš„æ—¶å€™è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼š glfwSetFramebufferSizeCallback(window, framebuffer_size_callback); å½“çª—å£è¢«ç¬¬ä¸€æ¬¡æ˜¾ç¤ºçš„æ—¶å€™framebuffer_size_callbackä¹Ÿä¼šè¢«è°ƒç”¨ã€‚å¯¹äºè§†ç½‘è†œ(Retina)æ˜¾ç¤ºå±ï¼Œwidthå’Œheightéƒ½ä¼šæ˜æ˜¾æ¯”åŸè¾“å…¥å€¼æ›´é«˜ä¸€ç‚¹ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥å°†æˆ‘ä»¬çš„å‡½æ•°æ³¨å†Œåˆ°å…¶å®ƒå¾ˆå¤šçš„å›è°ƒå‡½æ•°ä¸­ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†æ‰‹æŸ„è¾“å…¥å˜åŒ–ï¼Œå¤„ç†é”™è¯¯æ¶ˆæ¯ç­‰ã€‚æˆ‘ä»¬ä¼šåœ¨åˆ›å»ºçª—å£ä¹‹åï¼Œæ¸²æŸ“å¾ªç¯åˆå§‹åŒ–ä¹‹å‰æ³¨å†Œè¿™äº›å›è°ƒå‡½æ•°ã€‚ å‡†å¤‡å¥½ä½ çš„å¼•æ“æˆ‘ä»¬å¯ä¸å¸Œæœ›åªç»˜åˆ¶ä¸€ä¸ªå›¾åƒä¹‹åæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°±ç«‹å³é€€å‡ºå¹¶å…³é—­çª—å£ã€‚æˆ‘ä»¬å¸Œæœ›ç¨‹åºåœ¨æˆ‘ä»¬ä¸»åŠ¨å…³é—­å®ƒä¹‹å‰ä¸æ–­ç»˜åˆ¶å›¾åƒå¹¶èƒ½å¤Ÿæ¥å—ç”¨æˆ·è¾“å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æ·»åŠ ä¸€ä¸ªwhileå¾ªç¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒç§°ä¹‹ä¸ºæ¸²æŸ“å¾ªç¯(Render Loop)ï¼Œå®ƒèƒ½åœ¨æˆ‘ä»¬è®©GLFWé€€å‡ºå‰ä¸€ç›´ä¿æŒè¿è¡Œã€‚ä¸‹é¢å‡ è¡Œçš„ä»£ç å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„æ¸²æŸ“å¾ªç¯ï¼š while(!glfwWindowShouldClose(window))&#123; glfwSwapBuffers(window); glfwPollEvents(); &#125; glfwWindowShouldCloseå‡½æ•°åœ¨æˆ‘ä»¬æ¯æ¬¡å¾ªç¯çš„å¼€å§‹å‰æ£€æŸ¥ä¸€æ¬¡GLFWæ˜¯å¦è¢«è¦æ±‚é€€å‡ºï¼Œå¦‚æœæ˜¯çš„è¯è¯¥å‡½æ•°è¿”å›trueç„¶åæ¸²æŸ“å¾ªç¯ä¾¿ç»“æŸäº†ï¼Œä¹‹åä¸ºæˆ‘ä»¬å°±å¯ä»¥å…³é—­åº”ç”¨ç¨‹åºäº†. glfwPollEventså‡½æ•°æ£€æŸ¥æœ‰æ²¡æœ‰è§¦å‘ä»€ä¹ˆäº‹ä»¶ï¼ˆæ¯”å¦‚é”®ç›˜è¾“å…¥ã€é¼ æ ‡ç§»åŠ¨ç­‰ï¼‰ã€æ›´æ–°çª—å£çŠ¶æ€ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„å›è°ƒå‡½æ•°(å¯ä»¥é€šè¿‡å›è°ƒæ–¹æ³•æ‰‹åŠ¨è®¾ç½®). glfwSwapBufferså‡½æ•°ä¼šäº¤æ¢é¢œè‰²ç¼“å†²ï¼ˆå®ƒæ˜¯ä¸€ä¸ªå‚¨å­˜ç€GLFWçª—å£æ¯ä¸€ä¸ªåƒç´ é¢œè‰²å€¼çš„å¤§ç¼“å†²ï¼‰ï¼Œå®ƒåœ¨è¿™ä¸€è¿­ä»£ä¸­è¢«ç”¨æ¥ç»˜åˆ¶ï¼Œå¹¶ä¸”å°†ä¼šä½œä¸ºè¾“å‡ºæ˜¾ç¤ºåœ¨å±å¹•ä¸Š. åŒç¼“å†²(Double Buffer)åº”ç”¨ç¨‹åºä½¿ç”¨å•ç¼“å†²ç»˜å›¾æ—¶å¯èƒ½ä¼šå­˜åœ¨å›¾åƒé—ªçƒçš„é—®é¢˜ã€‚ è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„å›¾åƒä¸æ˜¯ä¸€ä¸‹å­è¢«ç»˜åˆ¶å‡ºæ¥çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä»å·¦åˆ°å³ï¼Œç”±ä¸Šè€Œä¸‹é€åƒç´ åœ°ç»˜åˆ¶è€Œæˆçš„ã€‚æœ€ç»ˆå›¾åƒä¸æ˜¯åœ¨ç¬é—´æ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œè€Œæ˜¯é€šè¿‡ä¸€æ­¥ä¸€æ­¥ç”Ÿæˆçš„ï¼Œè¿™ä¼šå¯¼è‡´æ¸²æŸ“çš„ç»“æœå¾ˆä¸çœŸå®ã€‚ä¸ºäº†è§„é¿è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬åº”ç”¨åŒç¼“å†²æ¸²æŸ“çª—å£åº”ç”¨ç¨‹åºã€‚å‰ç¼“å†²ä¿å­˜ç€æœ€ç»ˆè¾“å‡ºçš„å›¾åƒï¼Œå®ƒä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼›è€Œæ‰€æœ‰çš„çš„æ¸²æŸ“æŒ‡ä»¤éƒ½ä¼šåœ¨åç¼“å†²ä¸Šç»˜åˆ¶ã€‚å½“æ‰€æœ‰çš„æ¸²æŸ“æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬äº¤æ¢(Swap)å‰ç¼“å†²å’Œåç¼“å†²ï¼Œè¿™æ ·å›¾åƒå°±ç«‹å³å‘ˆæ˜¾å‡ºæ¥ï¼Œä¹‹å‰æåˆ°çš„ä¸çœŸå®æ„Ÿå°±æ¶ˆé™¤äº†. æœ€åä¸€ä»¶äº‹å½“æ¸²æŸ“å¾ªç¯ç»“æŸåæˆ‘ä»¬éœ€è¦æ­£ç¡®é‡Šæ”¾/åˆ é™¤ä¹‹å‰çš„åˆ†é…çš„æ‰€æœ‰èµ„æºã€‚æˆ‘ä»¬å¯ä»¥åœ¨mainå‡½æ•°çš„æœ€åè°ƒç”¨glfwTerminateå‡½æ•°æ¥å®Œæˆ: glfwTerminate();return 0; è¿™æ ·ä¾¿èƒ½æ¸…ç†æ‰€æœ‰çš„èµ„æºå¹¶æ­£ç¡®åœ°é€€å‡ºåº”ç”¨ç¨‹åºã€‚ç°åœ¨ä½ å¯ä»¥å°è¯•ç¼–è¯‘å¹¶è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºäº†ï¼Œå¦‚æœæ²¡åšé”™çš„è¯ï¼Œä½ å°†ä¼šçœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºï¼š è¾“å…¥æˆ‘ä»¬åŒæ ·ä¹Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨GLFWä¸­å®ç°ä¸€äº›è¾“å…¥æ§åˆ¶ï¼Œè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨GLFWçš„å‡ ä¸ªè¾“å…¥å‡½æ•°æ¥å®Œæˆã€‚æˆ‘ä»¬å°†ä¼šä½¿ç”¨GLFWçš„glfwGetKeyå‡½æ•°ï¼Œå®ƒéœ€è¦ä¸€ä¸ªçª—å£ä»¥åŠä¸€ä¸ªæŒ‰é”®ä½œä¸ºè¾“å…¥ã€‚è¿™ä¸ªå‡½æ•°å°†ä¼šè¿”å›è¿™ä¸ªæŒ‰é”®æ˜¯å¦æ­£åœ¨è¢«æŒ‰ä¸‹ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªprocessInputå‡½æ•°æ¥è®©æ‰€æœ‰çš„è¾“å…¥ä»£ç ä¿æŒæ•´æ´. void processInput(GLFWwindow *window)&#123; if(glfwGetKey(window, GLFW_KEY_ESCAPE) == GLFW_PRESS) glfwSetWindowShouldClose(window, true);&#125; è¿™é‡Œæˆ‘ä»¬æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æŒ‰ä¸‹äº†è¿”å›é”®(Esc)ï¼ˆå¦‚æœæ²¡æœ‰æŒ‰ä¸‹ï¼ŒglfwGetKeyå°†ä¼šè¿”å›GLFW_RELEASE.å¦‚æœç”¨æˆ·çš„ç¡®æŒ‰ä¸‹äº†è¿”å›é”®ï¼Œæˆ‘ä»¬å°†é€šè¿‡glfwSetwindowShouldCloseä½¿ç”¨æŠŠWindowShouldCloseå±æ€§è®¾ç½®ä¸º trueçš„æ–¹æ³•å…³é—­GLFW.ä¸‹ä¸€æ¬¡whileå¾ªç¯çš„æ¡ä»¶æ£€æµ‹å°†ä¼šå¤±è´¥ï¼Œç¨‹åºå°†ä¼šå…³é—­.æˆ‘ä»¬æ¥ä¸‹æ¥åœ¨æ¸²æŸ“å¾ªç¯çš„æ¯ä¸€ä¸ªè¿­ä»£ä¸­è°ƒç”¨processInputï¼š while (!glfwWindowShouldClose(window))&#123; processInput(window); glfwSwapBuffers(window); glfwPollEvents();&#125; è¿™å°±ç»™æˆ‘ä»¬ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹å¼æ¥æ£€æµ‹ç‰¹å®šçš„é”®æ˜¯å¦è¢«æŒ‰ä¸‹ï¼Œå¹¶åœ¨æ¯ä¸€å¸§åšå‡ºå¤„ç†. æ¸²æŸ“æˆ‘ä»¬è¦æŠŠæ‰€æœ‰çš„æ¸²æŸ“(Rendering)æ“ä½œæ”¾åˆ°æ¸²æŸ“å¾ªç¯ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è®©è¿™äº›æ¸²æŸ“æŒ‡ä»¤åœ¨æ¯æ¬¡æ¸²æŸ“å¾ªç¯è¿­ä»£çš„æ—¶å€™éƒ½èƒ½è¢«æ‰§è¡Œã€‚ä»£ç å°†ä¼šæ˜¯è¿™æ ·çš„ï¼š // æ¸²æŸ“å¾ªç¯while(!glfwWindowShouldClose(window))&#123; // è¾“å…¥ processInput(window); // æ¸²æŸ“æŒ‡ä»¤ ... // æ£€æŸ¥å¹¶è°ƒç”¨äº‹ä»¶ï¼Œäº¤æ¢ç¼“å†² glfwPollEvents(); glfwSwapBuffers(window);&#125; ä¸ºäº†æµ‹è¯•ä¸€åˆ‡éƒ½æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„é¢œè‰²æ¸…ç©ºå±å¹•ã€‚åœ¨æ¯ä¸ªæ–°çš„æ¸²æŸ“è¿­ä»£å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬æ€»æ˜¯å¸Œæœ›æ¸…å±ï¼Œå¦åˆ™æˆ‘ä»¬ä»èƒ½çœ‹è§ä¸Šä¸€æ¬¡è¿­ä»£çš„æ¸²æŸ“ç»“æœï¼ˆè¿™å¯èƒ½æ˜¯ä½ æƒ³è¦çš„æ•ˆæœï¼Œä½†é€šå¸¸è¿™ä¸æ˜¯ï¼‰.æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨glClearå‡½æ•°æ¥æ¸…ç©ºå±å¹•çš„é¢œè‰²ç¼“å†²ï¼Œå®ƒæ¥å—ä¸€ä¸ªç¼“å†²ä½(Buffer Bit)æ¥æŒ‡å®šè¦æ¸…ç©ºçš„ç¼“å†²ï¼Œå¯èƒ½çš„ç¼“å†²ä½æœ‰GL_COLOR_BUFFER_BITï¼ŒGL_DEPTH_BUFFER_BITå’ŒGL_STENCIL_BUFFER_BITã€‚ç”±äºç°åœ¨æˆ‘ä»¬åªå…³å¿ƒé¢œè‰²å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ¸…ç©ºé¢œè‰²ç¼“å†². glClearColor(0.2f, 0.3f, 0.3f, 1.0f);glClear(GL_COLOR_BUFFER_BIT); æ³¨æ„ï¼Œé™¤äº†glClearä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è°ƒç”¨äº†glClearColoræ¥è®¾ç½®æ¸…ç©ºå±å¹•æ‰€ç”¨çš„é¢œè‰²ã€‚å½“è°ƒç”¨glClearå‡½æ•°ï¼Œæ¸…é™¤é¢œè‰²ç¼“å†²ä¹‹åï¼Œæ•´ä¸ªé¢œè‰²ç¼“å†²éƒ½ä¼šè¢«å¡«å……ä¸ºglClearColoré‡Œæ‰€è®¾ç½®çš„é¢œè‰²ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å±å¹•è®¾ç½®ä¸ºäº†ç±»ä¼¼é»‘æ¿çš„æ·±è“ç»¿è‰². ä½ åº”è¯¥èƒ½å¤Ÿå›å¿†èµ·æ¥æˆ‘ä»¬åœ¨ OpenGL è¿™èŠ‚æ•™ç¨‹çš„å†…å®¹ï¼ŒglClearColorå‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€è®¾ç½®å‡½æ•°ï¼Œè€ŒglClearå‡½æ•°åˆ™æ˜¯ä¸€ä¸ªçŠ¶æ€ä½¿ç”¨çš„å‡½æ•°ï¼Œå®ƒä½¿ç”¨äº†å½“å‰çš„çŠ¶æ€æ¥è·å–åº”è¯¥æ¸…é™¤ä¸ºçš„é¢œè‰² //CMakeLists.txtcmake_minimum_required(VERSION 3.14)project(hellow,windows)set(CMAKE_CXX_STANDARD 14)set(SOURCE_FILES main.cpp glad.c)add_executable(main $&#123;SOURCE_FILES&#125;)target_link_libraries(main glfw3 GL m Xrandr Xi X11 Xxf86vm pthread dl Xinerama Xcursor) ä½ å¥½,ä¸‰è§’å½¢ åœ¨å­¦ä¹ æ­¤èŠ‚ä¹‹å‰ï¼Œå»ºè®®å°†è¿™ä¸‰ä¸ªå•è¯å…ˆè®°ä¸‹æ¥ï¼šé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼šVertex Array Objectï¼ŒVAOé¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼šVertex Buffer Objectï¼ŒVBOç´¢å¼•ç¼“å†²å¯¹è±¡ï¼šElement Buffer Objectï¼ŒEBOæˆ–Index Buffer Objectï¼ŒIBOå½“æŒ‡ä»£è¿™ä¸‰ä¸ªä¸œè¥¿çš„æ—¶å€™ï¼Œå¯èƒ½ä½¿ç”¨çš„æ˜¯å…¨ç§°ï¼Œä¹Ÿå¯èƒ½ç”¨çš„æ˜¯è‹±æ–‡ç¼©å†™ï¼Œç¿»è¯‘çš„æ—¶å€™å’ŒåŸæ–‡ä¿æŒçš„ä¸€è‡´ã€‚ç”±äºæ²¡æœ‰è‹±æ–‡é‚£æ ·çš„åˆ†è¯é—´éš”ï¼Œä¸­æ–‡å…¨ç§°çš„éƒ¨åˆ†å¯èƒ½ä¸å¤ªå®¹æ˜“æ³¨æ„ã€‚ä½†è¯·è®°ä½ï¼Œç¼©å†™å’Œä¸­æ–‡å…¨ç§°æŒ‡ä»£çš„æ˜¯ä¸€ä¸ªä¸œè¥¿. åœ¨OpenGLä¸­ï¼Œä»»ä½•äº‹ç‰©éƒ½åœ¨3Dç©ºé—´ä¸­ï¼Œè€Œå±å¹•å’Œçª—å£å´æ˜¯2Dåƒç´ æ•°ç»„ï¼Œè¿™å¯¼è‡´OpenGLçš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯å…³äºæŠŠ3Dåæ ‡è½¬å˜ä¸ºé€‚åº”ä½ å±å¹•çš„2Dåƒç´ ã€‚3Dåæ ‡è½¬ä¸º2Dåæ ‡çš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±OpenGLçš„å›¾å½¢æ¸²æŸ“ç®¡çº¿ï¼ˆGraphics Pipelineï¼Œå¤§å¤šè¯‘ä¸ºç®¡çº¿ï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯ä¸€å †åŸå§‹å›¾å½¢æ•°æ®é€”ç»ä¸€ä¸ªè¾“é€ç®¡é“ï¼ŒæœŸé—´ç»è¿‡å„ç§å˜åŒ–å¤„ç†æœ€ç»ˆå‡ºç°åœ¨å±å¹•çš„è¿‡ç¨‹ï¼‰ç®¡ç†çš„.å›¾å½¢æ¸²æŸ“ç®¡çº¿å¯ä»¥è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æŠŠä½ çš„3Dåæ ‡è½¬æ¢ä¸º2Dåæ ‡ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æŠŠ2Dåæ ‡è½¬å˜ä¸ºå®é™…çš„æœ‰é¢œè‰²çš„åƒç´ .è¿™ä¸ªæ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¼šç®€å•åœ°è®¨è®ºä¸€ä¸‹å›¾å½¢æ¸²æŸ“ç®¡çº¿ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒåˆ›å»ºä¸€äº›æ¼‚äº®çš„åƒç´ . 2Dåæ ‡å’Œåƒç´ ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œ2Dåæ ‡ç²¾ç¡®è¡¨ç¤ºä¸€ä¸ªç‚¹åœ¨2Dç©ºé—´ä¸­çš„ä½ç½®ï¼Œè€Œ2Dåƒç´ æ˜¯è¿™ä¸ªç‚¹çš„è¿‘ä¼¼å€¼ï¼Œ2Dåƒç´ å—åˆ°ä½ çš„å±å¹•/çª—å£åˆ†è¾¨ç‡çš„é™åˆ¶ å›¾å½¢æ¸²æŸ“ç®¡çº¿æ¥å—ä¸€ç»„3Dåæ ‡ï¼Œç„¶åæŠŠå®ƒä»¬è½¬å˜ä¸ºä½ å±å¹•ä¸Šçš„æœ‰è‰²2Dåƒç´ è¾“å‡º.å›¾å½¢æ¸²æŸ“ç®¡çº¿å¯ä»¥è¢«åˆ’åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µå°†ä¼šæŠŠå‰ä¸€ä¸ªé˜¶æ®µçš„è¾“å‡ºä½œä¸ºè¾“å…¥.æ‰€æœ‰è¿™äº›é˜¶æ®µéƒ½æ˜¯é«˜åº¦ä¸“é—¨åŒ–çš„ï¼ˆå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„å‡½æ•°ï¼‰ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å¹¶è¡Œæ‰§è¡Œ.æ­£æ˜¯ç”±äºå®ƒä»¬å…·æœ‰å¹¶è¡Œæ‰§è¡Œçš„ç‰¹æ€§ï¼Œå½“ä»Šå¤§å¤šæ•°æ˜¾å¡éƒ½æœ‰æˆåƒä¸Šä¸‡çš„å°å¤„ç†æ ¸å¿ƒï¼Œå®ƒä»¬åœ¨GPUä¸Šä¸ºæ¯ä¸€ä¸ªï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰é˜¶æ®µè¿è¡Œå„è‡ªçš„å°ç¨‹åºï¼Œä»è€Œåœ¨å›¾å½¢æ¸²æŸ“ç®¡çº¿ä¸­å¿«é€Ÿå¤„ç†ä½ çš„æ•°æ®.è¿™äº›å°ç¨‹åºå«åšç€è‰²å™¨(Shader). æœ‰äº›ç€è‰²å™¨å…è®¸å¼€å‘è€…è‡ªå·±é…ç½®ï¼Œè¿™å°±å…è®¸æˆ‘ä»¬ç”¨è‡ªå·±å†™çš„ç€è‰²å™¨æ¥æ›¿æ¢é»˜è®¤çš„ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´ç»†è‡´åœ°æ§åˆ¶å›¾å½¢æ¸²æŸ“ç®¡çº¿ä¸­çš„ç‰¹å®šéƒ¨åˆ†äº†ï¼Œè€Œä¸”å› ä¸ºå®ƒä»¬è¿è¡Œåœ¨GPUä¸Šï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥ç»™æˆ‘ä»¬èŠ‚çº¦å®è´µçš„CPUæ—¶é—´.OpenGLç€è‰²å™¨æ˜¯ç”¨OpenGLç€è‰²å™¨è¯­è¨€(OpenGL Shading Language, GLSL)å†™æˆçš„ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­æˆ‘ä»¬å†èŠ±æ›´å¤šæ—¶é—´ç ”ç©¶å®ƒ. ä¸‹é¢ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªå›¾å½¢æ¸²æŸ“ç®¡çº¿çš„æ¯ä¸ªé˜¶æ®µçš„æŠ½è±¡å±•ç¤º.è¦æ³¨æ„è“è‰²éƒ¨åˆ†ä»£è¡¨çš„æ˜¯æˆ‘ä»¬å¯ä»¥æ³¨å…¥è‡ªå®šä¹‰çš„ç€è‰²å™¨çš„éƒ¨åˆ†.é¦–å…ˆï¼Œæˆ‘ä»¬ä»¥æ•°ç»„çš„å½¢å¼ä¼ é€’3ä¸ª3Dåæ ‡ä½œä¸ºå›¾å½¢æ¸²æŸ“ç®¡çº¿çš„è¾“å…¥ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªä¸‰è§’å½¢ï¼Œè¿™ä¸ªæ•°ç»„å«åšé¡¶ç‚¹æ•°æ®(Vertex Data)ï¼›é¡¶ç‚¹æ•°æ®æ˜¯ä¸€ç³»åˆ—é¡¶ç‚¹çš„é›†åˆ.ä¸€ä¸ªé¡¶ç‚¹(Vertex)æ˜¯ä¸€ä¸ª3Dåæ ‡çš„æ•°æ®çš„é›†åˆ.è€Œé¡¶ç‚¹æ•°æ®æ˜¯ç”¨é¡¶ç‚¹å±æ€§(Vertex Attribute)è¡¨ç¤ºçš„ï¼Œå®ƒå¯ä»¥åŒ…å«ä»»ä½•æˆ‘ä»¬æƒ³ç”¨çš„æ•°æ®ï¼Œä½†æ˜¯ç®€å•èµ·è§ï¼Œæˆ‘ä»¬è¿˜æ˜¯å‡å®šæ¯ä¸ªé¡¶ç‚¹åªç”±ä¸€ä¸ª3Dä½ç½®(è¯‘æ³¨1)å’Œä¸€äº›é¢œè‰²å€¼ç»„æˆçš„å§. ä¸ºäº†è®©OpenGLçŸ¥é“æˆ‘ä»¬çš„åæ ‡å’Œé¢œè‰²å€¼æ„æˆçš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼ŒOpenGLéœ€è¦ä½ å»æŒ‡å®šè¿™äº›æ•°æ®æ‰€è¡¨ç¤ºçš„æ¸²æŸ“ç±»å‹ã€‚æˆ‘ä»¬æ˜¯å¸Œæœ›æŠŠè¿™äº›æ•°æ®æ¸²æŸ“æˆä¸€ç³»åˆ—çš„ç‚¹ï¼Ÿä¸€ç³»åˆ—çš„ä¸‰è§’å½¢ï¼Ÿè¿˜æ˜¯ä»…ä»…æ˜¯ä¸€ä¸ªé•¿é•¿çš„çº¿ï¼Ÿåšå‡ºçš„è¿™äº›æç¤ºå«åšå›¾å…ƒ(Primitive)ï¼Œä»»ä½•ä¸€ä¸ªç»˜åˆ¶æŒ‡ä»¤çš„è°ƒç”¨éƒ½å°†æŠŠå›¾å…ƒä¼ é€’ç»™OpenGL.è¿™æ˜¯å…¶ä¸­çš„å‡ ä¸ªï¼šGL_POINTSã€GL_TRIANGLESã€GL_LINE_STRIP. å›¾å½¢æ¸²æŸ“ç®¡çº¿çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯é¡¶ç‚¹ç€è‰²å™¨(Vertex Shader)ï¼Œå®ƒæŠŠä¸€ä¸ªå•ç‹¬çš„é¡¶ç‚¹ä½œä¸ºè¾“å…¥ã€‚é¡¶ç‚¹ç€è‰²å™¨ä¸»è¦çš„ç›®çš„æ˜¯æŠŠ3Dåæ ‡è½¬ä¸ºå¦ä¸€ç§3Dåæ ‡ï¼ˆåé¢ä¼šè§£é‡Šï¼‰ï¼ŒåŒæ—¶é¡¶ç‚¹ç€è‰²å™¨å…è®¸æˆ‘ä»¬å¯¹é¡¶ç‚¹å±æ€§è¿›è¡Œä¸€äº›åŸºæœ¬å¤„ç†ã€‚ å›¾å…ƒè£…é…(Primitive Assembly)é˜¶æ®µå°†é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºçš„æ‰€æœ‰é¡¶ç‚¹ä½œä¸ºè¾“å…¥ï¼ˆå¦‚æœæ˜¯GL_POINTSï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼‰ï¼Œæ‰€æœ‰çš„ç‚¹è£…é…æˆæŒ‡å®šå›¾å…ƒçš„å½¢çŠ¶ï¼›æœ¬èŠ‚ä¾‹å­ä¸­æ˜¯ä¸€ä¸ªä¸‰è§’å½¢ã€‚ å›¾å…ƒè£…é…é˜¶æ®µçš„è¾“å‡ºä¼šä¼ é€’ç»™å‡ ä½•ç€è‰²å™¨(Geometry Shader).å‡ ä½•ç€è‰²å™¨æŠŠå›¾å…ƒå½¢å¼çš„ä¸€ç³»åˆ—é¡¶ç‚¹çš„é›†åˆä½œä¸ºè¾“å…¥ï¼Œå®ƒå¯ä»¥é€šè¿‡äº§ç”Ÿæ–°é¡¶ç‚¹æ„é€ å‡ºæ–°çš„ï¼ˆæˆ–æ˜¯å…¶å®ƒçš„ï¼‰å›¾å…ƒæ¥ç”Ÿæˆå…¶ä»–å½¢çŠ¶ã€‚ä¾‹å­ä¸­ï¼Œå®ƒç”Ÿæˆäº†å¦ä¸€ä¸ªä¸‰è§’å½¢. å‡ ä½•ç€è‰²å™¨çš„è¾“å‡ºä¼šè¢«ä¼ å…¥å…‰æ …åŒ–é˜¶æ®µ(Rasterization Stage)ï¼Œè¿™é‡Œå®ƒä¼šæŠŠå›¾å…ƒæ˜ å°„ä¸ºæœ€ç»ˆå±å¹•ä¸Šç›¸åº”çš„åƒç´ ï¼Œç”Ÿæˆä¾›ç‰‡æ®µç€è‰²å™¨(Fragment Shader)ä½¿ç”¨çš„ç‰‡æ®µ(Fragment).åœ¨ç‰‡æ®µç€è‰²å™¨è¿è¡Œä¹‹å‰ä¼šæ‰§è¡Œè£åˆ‡(Clipping).è£åˆ‡ä¼šä¸¢å¼ƒè¶…å‡ºä½ çš„è§†å›¾ä»¥å¤–çš„æ‰€æœ‰åƒç´ ï¼Œç”¨æ¥æå‡æ‰§è¡Œæ•ˆç‡. OpenGLä¸­çš„ä¸€ä¸ªç‰‡æ®µæ˜¯OpenGLæ¸²æŸ“ä¸€ä¸ªåƒç´ æ‰€éœ€çš„æ‰€æœ‰æ•°æ®. ç‰‡æ®µç€è‰²å™¨çš„ä¸»è¦ç›®çš„æ˜¯è®¡ç®—ä¸€ä¸ªåƒç´ çš„æœ€ç»ˆé¢œè‰²ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰OpenGLé«˜çº§æ•ˆæœäº§ç”Ÿçš„åœ°æ–¹ã€‚é€šå¸¸ï¼Œç‰‡æ®µç€è‰²å™¨åŒ…å«3Dåœºæ™¯çš„æ•°æ®ï¼ˆæ¯”å¦‚å…‰ç…§ã€é˜´å½±ã€å…‰çš„é¢œè‰²ç­‰ç­‰ï¼‰ï¼Œè¿™äº›æ•°æ®å¯ä»¥è¢«ç”¨æ¥è®¡ç®—æœ€ç»ˆåƒç´ çš„é¢œè‰²ã€‚ åœ¨æ‰€æœ‰å¯¹åº”é¢œè‰²å€¼ç¡®å®šä»¥åï¼Œæœ€ç»ˆçš„å¯¹è±¡å°†ä¼šè¢«ä¼ åˆ°æœ€åä¸€ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬å«åšAlphaæµ‹è¯•å’Œæ··åˆ(Blending)é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µæ£€æµ‹ç‰‡æ®µçš„å¯¹åº”çš„æ·±åº¦ï¼ˆå’Œæ¨¡æ¿(Stencil)ï¼‰å€¼ï¼ˆåé¢ä¼šè®²ï¼‰ï¼Œç”¨å®ƒä»¬æ¥åˆ¤æ–­è¿™ä¸ªåƒç´ æ˜¯å…¶å®ƒç‰©ä½“çš„å‰é¢è¿˜æ˜¯åé¢ï¼Œå†³å®šæ˜¯å¦åº”è¯¥ä¸¢å¼ƒ.è¿™ä¸ªé˜¶æ®µä¹Ÿä¼šæ£€æŸ¥alphaå€¼ï¼ˆalphaå€¼å®šä¹‰äº†ä¸€ä¸ªç‰©ä½“çš„é€æ˜åº¦ï¼‰å¹¶å¯¹ç‰©ä½“è¿›è¡Œæ··åˆ(Blend).æ‰€ä»¥ï¼Œå³ä½¿åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è®¡ç®—å‡ºæ¥äº†ä¸€ä¸ªåƒç´ è¾“å‡ºçš„é¢œè‰²ï¼Œåœ¨æ¸²æŸ“å¤šä¸ªä¸‰è§’å½¢çš„æ—¶å€™æœ€åçš„åƒç´ é¢œè‰²ä¹Ÿå¯èƒ½å®Œå…¨ä¸åŒ. å¯ä»¥çœ‹åˆ°ï¼Œå›¾å½¢æ¸²æŸ“ç®¡çº¿éå¸¸å¤æ‚ï¼Œå®ƒåŒ…å«å¾ˆå¤šå¯é…ç½®çš„éƒ¨åˆ†.ç„¶è€Œï¼Œå¯¹äºå¤§å¤šæ•°åœºåˆï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨å°±è¡Œäº†.å‡ ä½•ç€è‰²å™¨æ˜¯å¯é€‰çš„ï¼Œé€šå¸¸ä½¿ç”¨å®ƒé»˜è®¤çš„ç€è‰²å™¨å°±è¡Œäº†. åœ¨ç°ä»£OpenGLä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰è‡³å°‘ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨å’Œä¸€ä¸ªç‰‡æ®µç€è‰²å™¨ï¼ˆå› ä¸ºGPUä¸­æ²¡æœ‰é»˜è®¤çš„é¡¶ç‚¹/ç‰‡æ®µç€è‰²å™¨ï¼‰.å‡ºäºè¿™ä¸ªåŸå› ï¼Œåˆšå¼€å§‹å­¦ä¹ ç°ä»£OpenGLçš„æ—¶å€™å¯èƒ½ä¼šéå¸¸å›°éš¾ï¼Œå› ä¸ºåœ¨ä½ èƒ½å¤Ÿæ¸²æŸ“è‡ªå·±çš„ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ä¹‹å‰å·²ç»éœ€è¦äº†è§£ä¸€å¤§å †çŸ¥è¯†äº†.åœ¨æœ¬èŠ‚ç»“æŸä½ æœ€ç»ˆæ¸²æŸ“å‡ºä½ çš„ä¸‰è§’å½¢çš„æ—¶å€™ï¼Œä½ ä¹Ÿä¼šäº†è§£åˆ°éå¸¸å¤šçš„å›¾å½¢ç¼–ç¨‹çŸ¥è¯†. é¡¶ç‚¹è¾“å…¥å¼€å§‹ç»˜åˆ¶å›¾å½¢ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆç»™OpenGLè¾“å…¥ä¸€äº›é¡¶ç‚¹æ•°æ®.OpenGLæ˜¯ä¸€ä¸ª3Då›¾å½¢åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨OpenGLä¸­æŒ‡å®šçš„æ‰€æœ‰åæ ‡éƒ½æ˜¯3Dåæ ‡ï¼ˆxã€yå’Œzï¼‰.OpenGLä¸æ˜¯ç®€å•åœ°æŠŠæ‰€æœ‰çš„3Dåæ ‡å˜æ¢ä¸ºå±å¹•ä¸Šçš„2Dåƒç´ ï¼›OpenGLä»…å½“3Dåæ ‡åœ¨3ä¸ªè½´ï¼ˆxã€yå’Œzï¼‰ä¸Šéƒ½ä¸º-1.0åˆ°1.0çš„èŒƒå›´å†…æ—¶æ‰å¤„ç†å®ƒ.æ‰€æœ‰åœ¨æ‰€è°“çš„æ ‡å‡†åŒ–è®¾å¤‡åæ ‡(Normalized Device Coordinates)èŒƒå›´å†…çš„åæ ‡æ‰ä¼šæœ€ç»ˆå‘ˆç°åœ¨å±å¹•ä¸Šï¼ˆåœ¨è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„åæ ‡éƒ½ä¸ä¼šæ˜¾ç¤ºï¼‰. ç”±äºæˆ‘ä»¬å¸Œæœ›æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæˆ‘ä»¬ä¸€å…±è¦æŒ‡å®šä¸‰ä¸ªé¡¶ç‚¹ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€ä¸ª3Dä½ç½®.æˆ‘ä»¬ä¼šå°†å®ƒä»¬ä»¥æ ‡å‡†åŒ–è®¾å¤‡åæ ‡çš„å½¢å¼ï¼ˆOpenGLçš„å¯è§åŒºåŸŸï¼‰å®šä¹‰ä¸ºä¸€ä¸ªfloatæ•°ç»„. float vertices[] = &#123; -0.5f, -0.5f, 0.0f, 0.5f, -0.5f, 0.0f, 0.0f, 0.5f, 0.0f&#125;; ç”±äºOpenGLæ˜¯åœ¨3Dç©ºé—´ä¸­å·¥ä½œçš„ï¼Œè€Œæˆ‘ä»¬æ¸²æŸ“çš„æ˜¯ä¸€ä¸ª2Dä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å°†å®ƒé¡¶ç‚¹çš„zåæ ‡è®¾ç½®ä¸º0.0.è¿™æ ·å­çš„è¯ä¸‰è§’å½¢æ¯ä¸€ç‚¹çš„æ·±åº¦(Depth)éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä»è€Œä½¿å®ƒçœ‹ä¸Šå»åƒæ˜¯2Dçš„. é€šå¸¸æ·±åº¦å¯ä»¥ç†è§£ä¸ºzåæ ‡ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªåƒç´ åœ¨ç©ºé—´ä¸­å’Œä½ çš„è·ç¦»ï¼Œå¦‚æœç¦»ä½ è¿œå°±å¯èƒ½è¢«åˆ«çš„åƒç´ é®æŒ¡ï¼Œä½ å°±çœ‹ä¸åˆ°å®ƒäº†ï¼Œå®ƒä¼šè¢«ä¸¢å¼ƒï¼Œä»¥èŠ‚çœèµ„æº. æ ‡å‡†åŒ–è®¾å¤‡åæ ‡(Normalized Device Coordinates, NDC)ä¸€æ—¦ä½ çš„é¡¶ç‚¹åæ ‡å·²ç»åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å¤„ç†è¿‡ï¼Œå®ƒä»¬å°±åº”è¯¥æ˜¯æ ‡å‡†åŒ–è®¾å¤‡åæ ‡äº†ï¼Œæ ‡å‡†åŒ–è®¾å¤‡åæ ‡æ˜¯ä¸€ä¸ªxã€yå’Œzå€¼åœ¨-1.0åˆ°1.0çš„ä¸€å°æ®µç©ºé—´ã€‚ä»»ä½•è½åœ¨èŒƒå›´å¤–çš„åæ ‡éƒ½ä¼šè¢«ä¸¢å¼ƒ/è£å‰ªï¼Œä¸ä¼šæ˜¾ç¤ºåœ¨ä½ çš„å±å¹•ä¸Šã€‚ä¸‹é¢ä½ ä¼šçœ‹åˆ°æˆ‘ä»¬å®šä¹‰çš„åœ¨æ ‡å‡†åŒ–è®¾å¤‡åæ ‡ä¸­çš„ä¸‰è§’å½¢(å¿½ç•¥zè½´)ï¼š ä¸é€šå¸¸çš„å±å¹•åæ ‡ä¸åŒï¼Œyè½´æ­£æ–¹å‘ä¸ºå‘ä¸Šï¼Œ(0, 0)åæ ‡æ˜¯è¿™ä¸ªå›¾åƒçš„ä¸­å¿ƒï¼Œè€Œä¸æ˜¯å·¦ä¸Šè§’ã€‚æœ€ç»ˆä½ å¸Œæœ›æ‰€æœ‰(å˜æ¢è¿‡çš„)åæ ‡éƒ½åœ¨è¿™ä¸ªåæ ‡ç©ºé—´ä¸­ï¼Œå¦åˆ™å®ƒä»¬å°±ä¸å¯è§äº†. ä½ çš„æ ‡å‡†åŒ–è®¾å¤‡åæ ‡æ¥ç€ä¼šå˜æ¢ä¸ºå±å¹•ç©ºé—´åæ ‡(Screen-space Coordinates)ï¼Œè¿™æ˜¯ä½¿ç”¨ä½ é€šè¿‡glViewportå‡½æ•°æä¾›çš„æ•°æ®ï¼Œè¿›è¡Œè§†å£å˜æ¢(Viewport Transform)å®Œæˆçš„.æ‰€å¾—çš„å±å¹•ç©ºé—´åæ ‡åˆä¼šè¢«å˜æ¢ä¸ºç‰‡æ®µè¾“å…¥åˆ°ç‰‡æ®µç€è‰²å™¨ä¸­. å®šä¹‰è¿™æ ·çš„é¡¶ç‚¹æ•°æ®ä»¥åï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒä½œä¸ºè¾“å…¥å‘é€ç»™å›¾å½¢æ¸²æŸ“ç®¡çº¿çš„ç¬¬ä¸€ä¸ªå¤„ç†é˜¶æ®µï¼šé¡¶ç‚¹ç€è‰²å™¨.å®ƒä¼šåœ¨GPUä¸Šåˆ›å»ºå†…å­˜ç”¨äºå‚¨å­˜æˆ‘ä»¬çš„é¡¶ç‚¹æ•°æ®ï¼Œè¿˜è¦é…ç½®OpenGLå¦‚ä½•è§£é‡Šè¿™äº›å†…å­˜ï¼Œå¹¶ä¸”æŒ‡å®šå…¶å¦‚ä½•å‘é€ç»™æ˜¾å¡.é¡¶ç‚¹ç€è‰²å™¨æ¥ç€ä¼šå¤„ç†æˆ‘ä»¬åœ¨å†…å­˜ä¸­æŒ‡å®šæ•°é‡çš„é¡¶ç‚¹. æˆ‘ä»¬é€šè¿‡é¡¶ç‚¹ç¼“å†²å¯¹è±¡(Vertex Buffer Objects, VBO)ç®¡ç†è¿™ä¸ªå†…å­˜ï¼Œå®ƒä¼šåœ¨GPUå†…å­˜ï¼ˆé€šå¸¸è¢«ç§°ä¸ºæ˜¾å­˜ï¼‰ä¸­å‚¨å­˜å¤§é‡é¡¶ç‚¹.ä½¿ç”¨è¿™äº›ç¼“å†²å¯¹è±¡çš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§çš„å‘é€ä¸€å¤§æ‰¹æ•°æ®åˆ°æ˜¾å¡ä¸Šï¼Œè€Œä¸æ˜¯æ¯ä¸ªé¡¶ç‚¹å‘é€ä¸€æ¬¡.ä»CPUæŠŠæ•°æ®å‘é€åˆ°æ˜¾å¡ç›¸å¯¹è¾ƒæ…¢ï¼Œæ‰€ä»¥åªè¦å¯èƒ½æˆ‘ä»¬éƒ½è¦å°è¯•å°½é‡ä¸€æ¬¡æ€§å‘é€å°½å¯èƒ½å¤šçš„æ•°æ®.å½“æ•°æ®å‘é€è‡³æ˜¾å¡çš„å†…å­˜ä¸­åï¼Œé¡¶ç‚¹ç€è‰²å™¨å‡ ä¹èƒ½ç«‹å³è®¿é—®é¡¶ç‚¹ï¼Œè¿™æ˜¯ä¸ªéå¸¸å¿«çš„è¿‡ç¨‹. é¡¶ç‚¹ç¼“å†²å¯¹è±¡æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„IDï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨glGenBufferså‡½æ•°å’Œä¸€ä¸ªç¼“å†²IDç”Ÿæˆä¸€ä¸ªVBOå¯¹è±¡:åŠ ç²—æ ·å¼unsigned int VBO;glGenBuffers(1, &amp;VBO); OpenGLæœ‰å¾ˆå¤šç¼“å†²å¯¹è±¡ç±»å‹ï¼Œé¡¶ç‚¹ç¼“å†²å¯¹è±¡çš„ç¼“å†²ç±»å‹æ˜¯GL_ARRAY_BUFFER.OpenGLå…è®¸æˆ‘ä»¬åŒæ—¶ç»‘å®šå¤šä¸ªç¼“å†²ï¼Œåªè¦å®ƒä»¬æ˜¯ä¸åŒçš„ç¼“å†²ç±»å‹.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨glBindBufferå‡½æ•°æŠŠæ–°åˆ›å»ºçš„ç¼“å†²ç»‘å®šåˆ°GL_ARRAY_BUFFERç›®æ ‡ä¸Šï¼š glBindBuffer(GL_ARRAY_BUFFER, VBO); ä»è¿™ä¸€åˆ»èµ·ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ä»»ä½•ï¼ˆåœ¨GL_ARRAY_BUFFERç›®æ ‡ä¸Šçš„ï¼‰ç¼“å†²è°ƒç”¨éƒ½ä¼šç”¨æ¥é…ç½®å½“å‰ç»‘å®šçš„ç¼“å†²(VBO).ç„¶åæˆ‘ä»¬å¯ä»¥è°ƒç”¨glBufferDataå‡½æ•°ï¼Œå®ƒä¼šæŠŠä¹‹å‰å®šä¹‰çš„é¡¶ç‚¹æ•°æ®å¤åˆ¶åˆ°ç¼“å†²çš„å†…å­˜ä¸­ï¼š glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW); glBufferDataæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥æŠŠç”¨æˆ·å®šä¹‰çš„æ•°æ®å¤åˆ¶åˆ°å½“å‰ç»‘å®šç¼“å†²çš„å‡½æ•°.å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡ç¼“å†²çš„ç±»å‹ï¼šé¡¶ç‚¹ç¼“å†²å¯¹è±¡å½“å‰ç»‘å®šåˆ°GL_ARRAY_BUFFERç›®æ ‡ä¸Š.ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¼ è¾“æ•°æ®çš„å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)ï¼›ç”¨ä¸€ä¸ªç®€å•çš„sizeofè®¡ç®—å‡ºé¡¶ç‚¹æ•°æ®å¤§å°å°±è¡Œ.ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬å¸Œæœ›å‘é€çš„å®é™…æ•°æ®. ç¬¬å››ä¸ªå‚æ•°æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›æ˜¾å¡å¦‚ä½•ç®¡ç†ç»™å®šçš„æ•°æ®ã€‚å®ƒæœ‰ä¸‰ç§å½¢å¼ï¼š GL_STATIC_DRAW ï¼šæ•°æ®ä¸ä¼šæˆ–å‡ ä¹ä¸ä¼šæ”¹å˜. GL_DYNAMIC_DRAWï¼šæ•°æ®ä¼šè¢«æ”¹å˜å¾ˆå¤š. GL_STREAM_DRAW ï¼šæ•°æ®æ¯æ¬¡ç»˜åˆ¶æ—¶éƒ½ä¼šæ”¹å˜. ä¸‰è§’å½¢çš„ä½ç½®æ•°æ®ä¸ä¼šæ”¹å˜ï¼Œæ¯æ¬¡æ¸²æŸ“è°ƒç”¨æ—¶éƒ½ä¿æŒåŸæ ·ï¼Œæ‰€ä»¥å®ƒçš„ä½¿ç”¨ç±»å‹æœ€å¥½æ˜¯GL_STATIC_DRAW.å¦‚æœï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªç¼“å†²ä¸­çš„æ•°æ®å°†é¢‘ç¹è¢«æ”¹å˜ï¼Œé‚£ä¹ˆä½¿ç”¨çš„ç±»å‹å°±æ˜¯GL_DYNAMIC_DRAWæˆ–GL_STREAM_DRAWï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿æ˜¾å¡æŠŠæ•°æ®æ”¾åœ¨èƒ½å¤Ÿé«˜é€Ÿå†™å…¥çš„å†…å­˜éƒ¨åˆ†ã€‚ ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠé¡¶ç‚¹æ•°æ®å‚¨å­˜åœ¨æ˜¾å¡çš„å†…å­˜ä¸­ï¼Œç”¨VBOè¿™ä¸ªé¡¶ç‚¹ç¼“å†²å¯¹è±¡ç®¡ç†.ä¸‹é¢æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªé¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨æ¥çœŸæ­£å¤„ç†è¿™äº›æ•°æ®.ç°åœ¨æˆ‘ä»¬å¼€å§‹ç€æ‰‹åˆ›å»ºå®ƒä»¬å§. å®šç‚¹ç€è‰²å™¨é¡¶ç‚¹ç€è‰²å™¨(Vertex Shader)æ˜¯å‡ ä¸ªå¯ç¼–ç¨‹ç€è‰²å™¨ä¸­çš„ä¸€ä¸ª.å¦‚æœæˆ‘ä»¬æ‰“ç®—åšæ¸²æŸ“çš„è¯ï¼Œç°ä»£OpenGLéœ€è¦æˆ‘ä»¬è‡³å°‘è®¾ç½®ä¸€ä¸ªé¡¶ç‚¹å’Œä¸€ä¸ªç‰‡æ®µç€è‰²å™¨.æˆ‘ä»¬ä¼šç®€è¦ä»‹ç»ä¸€ä¸‹ç€è‰²å™¨ä»¥åŠé…ç½®ä¸¤ä¸ªéå¸¸ç®€å•çš„ç€è‰²å™¨æ¥ç»˜åˆ¶æˆ‘ä»¬ç¬¬ä¸€ä¸ªä¸‰è§’å½¢.ä¸‹ä¸€èŠ‚ä¸­æˆ‘ä»¬ä¼šæ›´è¯¦ç»†çš„è®¨è®ºç€è‰²å™¨. æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç”¨ç€è‰²å™¨è¯­è¨€GLSL(OpenGL Shading Language)ç¼–å†™é¡¶ç‚¹ç€è‰²å™¨ï¼Œç„¶åç¼–è¯‘è¿™ä¸ªç€è‰²å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¨‹åºä¸­ä½¿ç”¨å®ƒäº†.ä¸‹é¢ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªéå¸¸åŸºç¡€çš„GLSLé¡¶ç‚¹ç€è‰²å™¨çš„æºä»£ç ï¼š #version 330 corelayout (location = 0) in vec3 aPos;void main()&#123; gl_Position = vec4(aPos.x, aPos.y, aPos.z, 1.0);&#125; å¯ä»¥çœ‹åˆ°ï¼ŒGLSLçœ‹èµ·æ¥å¾ˆåƒCè¯­è¨€ã€‚æ¯ä¸ªç€è‰²å™¨éƒ½èµ·å§‹äºä¸€ä¸ªç‰ˆæœ¬å£°æ˜.OpenGL 3.3ä»¥åŠå’Œæ›´é«˜ç‰ˆæœ¬ä¸­ï¼ŒGLSLç‰ˆæœ¬å·å’ŒOpenGLçš„ç‰ˆæœ¬æ˜¯åŒ¹é…çš„ï¼ˆæ¯”å¦‚è¯´GLSL 420ç‰ˆæœ¬å¯¹åº”äºOpenGL 4.2ï¼‰.æˆ‘ä»¬åŒæ ·æ˜ç¡®è¡¨ç¤ºæˆ‘ä»¬ä¼šä½¿ç”¨æ ¸å¿ƒæ¨¡å¼(core). ä¸‹ä¸€æ­¥ï¼Œä½¿ç”¨inå…³é”®å­—ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å£°æ˜æ‰€æœ‰çš„è¾“å…¥é¡¶ç‚¹å±æ€§(Input Vertex Attribute).ç°åœ¨æˆ‘ä»¬åªå…³å¿ƒä½ç½®(Position)æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªé¡¶ç‚¹å±æ€§.GLSLæœ‰ä¸€ä¸ªå‘é‡æ•°æ®ç±»å‹ï¼Œå®ƒåŒ…å«1åˆ°4ä¸ªfloatåˆ†é‡ï¼ŒåŒ…å«çš„æ•°é‡å¯ä»¥ä»å®ƒçš„åç¼€æ•°å­—çœ‹å‡ºæ¥.ç”±äºæ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€ä¸ª3Dåæ ‡ï¼Œæˆ‘ä»¬å°±åˆ›å»ºä¸€ä¸ªvec3è¾“å…¥å˜é‡aPos.æˆ‘ä»¬åŒæ ·ä¹Ÿé€šè¿‡layout (location = 0)è®¾å®šäº†è¾“å…¥å˜é‡çš„ä½ç½®å€¼(Location),ä½ åé¢ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šéœ€è¦è¿™ä¸ªä½ç½®å€¼. å‘é‡(Vector)åœ¨å›¾å½¢ç¼–ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨å‘é‡è¿™ä¸ªæ•°å­¦æ¦‚å¿µï¼Œå› ä¸ºå®ƒç®€æ˜åœ°è¡¨è¾¾äº†ä»»æ„ç©ºé—´ä¸­çš„ä½ç½®å’Œæ–¹å‘ï¼Œå¹¶ä¸”å®ƒæœ‰éå¸¸æœ‰ç”¨çš„æ•°å­¦å±æ€§ã€‚åœ¨GLSLä¸­ä¸€ä¸ªå‘é‡æœ‰æœ€å¤š4ä¸ªåˆ†é‡ï¼Œæ¯ä¸ªåˆ†é‡å€¼éƒ½ä»£è¡¨ç©ºé—´ä¸­çš„ä¸€ä¸ªåæ ‡ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡vec.xã€vec.yã€vec.zå’Œvec.wæ¥è·å–.æ³¨æ„vec.wåˆ†é‡ä¸æ˜¯ç”¨ä½œè¡¨è¾¾ç©ºé—´ä¸­çš„ä½ç½®çš„ï¼ˆæˆ‘ä»¬å¤„ç†çš„æ˜¯3Dä¸æ˜¯4Dï¼‰ï¼Œè€Œæ˜¯ç”¨åœ¨æ‰€è°“é€è§†é™¤æ³•(Perspective Division)ä¸Š.æˆ‘ä»¬ä¼šåœ¨åé¢çš„æ•™ç¨‹ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºå‘é‡. ä¸ºäº†è®¾ç½®é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¿…é¡»æŠŠä½ç½®æ•°æ®èµ‹å€¼ç»™é¢„å®šä¹‰çš„gl_Positionå˜é‡ï¼Œå®ƒåœ¨å¹•åæ˜¯vec4ç±»å‹çš„.åœ¨mainå‡½æ•°çš„æœ€åï¼Œæˆ‘ä»¬å°†gl_Positionè®¾ç½®çš„å€¼ä¼šæˆä¸ºè¯¥é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡º.ç”±äºæˆ‘ä»¬çš„è¾“å…¥æ˜¯ä¸€ä¸ª3åˆ†é‡çš„å‘é‡ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠå®ƒè½¬æ¢ä¸º4åˆ†é‡çš„.æˆ‘ä»¬å¯ä»¥æŠŠvec3çš„æ•°æ®ä½œä¸ºvec4æ„é€ å™¨çš„å‚æ•°ï¼ŒåŒæ—¶æŠŠwåˆ†é‡è®¾ç½®ä¸º1.0fï¼ˆæˆ‘ä»¬ä¼šåœ¨åé¢è§£é‡Šä¸ºä»€ä¹ˆï¼‰æ¥å®Œæˆè¿™ä¸€ä»»åŠ¡. å½“å‰è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨å¯èƒ½æ˜¯æˆ‘ä»¬èƒ½æƒ³åˆ°çš„æœ€ç®€å•çš„é¡¶ç‚¹ç€è‰²å™¨äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯¹è¾“å…¥æ•°æ®ä»€ä¹ˆéƒ½æ²¡æœ‰å¤„ç†å°±æŠŠå®ƒä¼ åˆ°ç€è‰²å™¨çš„è¾“å‡ºäº†.åœ¨çœŸå®çš„ç¨‹åºé‡Œè¾“å…¥æ•°æ®é€šå¸¸éƒ½ä¸æ˜¯æ ‡å‡†åŒ–è®¾å¤‡åæ ‡ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå¿…é¡»å…ˆæŠŠå®ƒä»¬è½¬æ¢è‡³OpenGLçš„å¯è§†åŒºåŸŸå†…. ç¼–è¯‘ç€è‰²å™¨æˆ‘ä»¬å·²ç»å†™äº†ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨æºç ï¼ˆå‚¨å­˜åœ¨ä¸€ä¸ªCçš„å­—ç¬¦ä¸²ä¸­ï¼‰ï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿè®©OpenGLä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬å¿…é¡»åœ¨è¿è¡Œæ—¶åŠ¨æ€ç¼–è¯‘å®ƒçš„æºç . æˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ï¼Œæ³¨æ„è¿˜æ˜¯ç”¨IDæ¥å¼•ç”¨çš„.æ‰€ä»¥æˆ‘ä»¬å‚¨å­˜è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨ä¸ºunsigned intï¼Œç„¶åç”¨glCreateShaderåˆ›å»ºè¿™ä¸ªç€è‰²å™¨ï¼š unsigned int vertexShader;vertexShader = glCreateShader(GL_VERTEX_SHADER); æˆ‘ä»¬æŠŠéœ€è¦åˆ›å»ºçš„ç€è‰²å™¨ç±»å‹ä»¥å‚æ•°å½¢å¼æä¾›ç»™glCreateShader.ç”±äºæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œä¼ é€’çš„å‚æ•°æ˜¯GL_VERTEX_SHADER. ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠè¿™ä¸ªç€è‰²å™¨æºç é™„åŠ åˆ°ç€è‰²å™¨å¯¹è±¡ä¸Šï¼Œç„¶åç¼–è¯‘å®ƒï¼š glShaderSource(vertexShader, 1, &amp;vertexShaderSource, NULL);glCompileShader(vertexShader); glShaderSourceå‡½æ•°æŠŠè¦ç¼–è¯‘çš„ç€è‰²å™¨å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°.ç¬¬äºŒå‚æ•°æŒ‡å®šäº†ä¼ é€’çš„æºç å­—ç¬¦ä¸²æ•°é‡ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ª.ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é¡¶ç‚¹ç€è‰²å™¨çœŸæ­£çš„æºç ï¼Œç¬¬å››ä¸ªå‚æ•°æˆ‘ä»¬å…ˆè®¾ç½®ä¸ºNULL. ä½ å¯èƒ½ä¼šå¸Œæœ›æ£€æµ‹åœ¨è°ƒç”¨glCompileShaderåç¼–è¯‘æ˜¯å¦æˆåŠŸäº†ï¼Œå¦‚æœæ²¡æˆåŠŸçš„è¯ï¼Œä½ è¿˜ä¼šå¸Œæœ›çŸ¥é“é”™è¯¯æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·ä½ æ‰èƒ½ä¿®å¤å®ƒä»¬ã€‚æ£€æµ‹ç¼–è¯‘æ—¶é”™è¯¯å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æ¥å®ç°ï¼š int success;char infoLog[512];glGetShaderiv(vertexShader, GL_COMPILE_STATUS, &amp;success); é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ•´å‹å˜é‡æ¥è¡¨ç¤ºæ˜¯å¦æˆåŠŸç¼–è¯‘ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªå‚¨å­˜é”™è¯¯æ¶ˆæ¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰çš„å®¹å™¨ã€‚ç„¶åæˆ‘ä»¬ç”¨glGetShaderivæ£€æŸ¥æ˜¯å¦ç¼–è¯‘æˆåŠŸ.å¦‚æœç¼–è¯‘å¤±è´¥ï¼Œæˆ‘ä»¬ä¼šç”¨glGetShaderInfoLogè·å–é”™è¯¯æ¶ˆæ¯ï¼Œç„¶åæ‰“å°å®ƒ. if(!success)&#123; glGetShaderInfoLog(vertexShader, 512, NULL, infoLog); std::cout &lt;&lt; \"ERROR::SHADER::VERTEX::COMPILATION_FAILED\\n\" &lt;&lt; infoLog &lt;&lt; std::endl;&#125; ç‰‡æ®µç€è‰²å™¨ç‰‡æ®µç€è‰²å™¨(Fragment Shader)æ˜¯ç¬¬äºŒä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªæˆ‘ä»¬æ‰“ç®—åˆ›å»ºçš„ç”¨äºæ¸²æŸ“ä¸‰è§’å½¢çš„ç€è‰²å™¨.ç‰‡æ®µç€è‰²å™¨æ‰€åšçš„æ˜¯è®¡ç®—åƒç´ æœ€åçš„é¢œè‰²è¾“å‡º.ä¸ºäº†è®©äº‹æƒ…æ›´ç®€å•ï¼Œæˆ‘ä»¬çš„ç‰‡æ®µç€è‰²å™¨å°†ä¼šä¸€ç›´è¾“å‡ºæ©˜é»„è‰². åœ¨è®¡ç®—æœºå›¾å½¢ä¸­é¢œè‰²è¢«è¡¨ç¤ºä¸ºæœ‰4ä¸ªå…ƒç´ çš„æ•°ç»„ï¼šçº¢è‰²ã€ç»¿è‰²ã€è“è‰²å’Œalpha(é€æ˜åº¦)åˆ†é‡ï¼Œé€šå¸¸ç¼©å†™ä¸ºRGBA.å½“åœ¨OpenGLæˆ–GLSLä¸­å®šä¹‰ä¸€ä¸ªé¢œè‰²çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠé¢œè‰²æ¯ä¸ªåˆ†é‡çš„å¼ºåº¦è®¾ç½®åœ¨0.0åˆ°1.0ä¹‹é—´.æ¯”å¦‚è¯´æˆ‘ä»¬è®¾ç½®çº¢ä¸º1.0fï¼Œç»¿ä¸º1.0fï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸¤ä¸ªé¢œè‰²çš„æ··åˆè‰²ï¼Œå³é»„è‰².è¿™ä¸‰ç§é¢œè‰²åˆ†é‡çš„ä¸åŒè°ƒé…å¯ä»¥ç”Ÿæˆè¶…è¿‡1600ä¸‡ç§ä¸åŒçš„é¢œè‰²ï¼ #version 330 coreout vec4 FragColor;void main()&#123; FragColor = vec4(1.0f, 0.5f, 0.2f, 1.0f);&#125; ç‰‡æ®µç€è‰²å™¨åªéœ€è¦ä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ª4åˆ†é‡å‘é‡ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æœ€ç»ˆçš„è¾“å‡ºé¢œè‰²ï¼Œæˆ‘ä»¬åº”è¯¥è‡ªå·±å°†å…¶è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å¯ä»¥ç”¨outå…³é”®å­—å£°æ˜è¾“å‡ºå˜é‡ï¼Œè¿™é‡Œæˆ‘ä»¬å‘½åä¸ºFragColorã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªalphaå€¼ä¸º1.0(1.0ä»£è¡¨å®Œå…¨ä¸é€æ˜)çš„æ©˜é»„è‰²çš„vec4èµ‹å€¼ç»™é¢œè‰²è¾“å‡ºã€‚ ç¼–è¯‘ç‰‡æ®µç€è‰²å™¨çš„è¿‡ç¨‹ä¸é¡¶ç‚¹ç€è‰²å™¨ç±»ä¼¼ï¼Œåªä¸è¿‡æˆ‘ä»¬ä½¿ç”¨GL_FRAGMENT_SHADERå¸¸é‡ä½œä¸ºç€è‰²å™¨ç±»å‹ï¼š unsigned int fragmentShader;fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);glShaderSource(fragmentShader, 1, &amp;fragmentShaderSource, NULL);glCompileShader(fragmentShader); ä¸¤ä¸ªç€è‰²å™¨ç°åœ¨éƒ½ç¼–è¯‘äº†ï¼Œå‰©ä¸‹çš„äº‹æƒ…æ˜¯æŠŠä¸¤ä¸ªç€è‰²å™¨å¯¹è±¡é“¾æ¥åˆ°ä¸€ä¸ªç”¨æ¥æ¸²æŸ“çš„ç€è‰²å™¨ç¨‹åº(Shader Program)ä¸­. ç€è‰²å™¨ç¨‹åºç€è‰²å™¨ç¨‹åºå¯¹è±¡(Shader Program Object)æ˜¯å¤šä¸ªç€è‰²å™¨åˆå¹¶ä¹‹åå¹¶æœ€ç»ˆé“¾æ¥å®Œæˆçš„ç‰ˆæœ¬.å¦‚æœè¦ä½¿ç”¨åˆšæ‰ç¼–è¯‘çš„ç€è‰²å™¨æˆ‘ä»¬å¿…é¡»æŠŠå®ƒä»¬é“¾æ¥(Link)ä¸ºä¸€ä¸ªç€è‰²å™¨ç¨‹åºå¯¹è±¡ï¼Œç„¶ååœ¨æ¸²æŸ“å¯¹è±¡çš„æ—¶å€™æ¿€æ´»è¿™ä¸ªç€è‰²å™¨ç¨‹åºã€‚å·²æ¿€æ´»ç€è‰²å™¨ç¨‹åºçš„ç€è‰²å™¨å°†åœ¨æˆ‘ä»¬å‘é€æ¸²æŸ“è°ƒç”¨çš„æ—¶å€™è¢«ä½¿ç”¨. å½“é“¾æ¥ç€è‰²å™¨è‡³ä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠæ¯ä¸ªç€è‰²å™¨çš„è¾“å‡ºé“¾æ¥åˆ°ä¸‹ä¸ªç€è‰²å™¨çš„è¾“å…¥.å½“è¾“å‡ºå’Œè¾“å…¥ä¸åŒ¹é…çš„æ—¶å€™ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªè¿æ¥é”™è¯¯. åˆ›å»ºä¸€ä¸ªç¨‹åºå¯¹è±¡å¾ˆç®€å•ï¼š unsigned int shaderProgram;shaderProgram = glCreateProgram(); glCreateProgramå‡½æ•°åˆ›å»ºä¸€ä¸ªç¨‹åºï¼Œå¹¶è¿”å›æ–°åˆ›å»ºç¨‹åºå¯¹è±¡çš„IDå¼•ç”¨.ç°åœ¨æˆ‘ä»¬éœ€è¦æŠŠä¹‹å‰ç¼–è¯‘çš„ç€è‰²å™¨é™„åŠ åˆ°ç¨‹åºå¯¹è±¡ä¸Šï¼Œç„¶åç”¨glLinkProgramé“¾æ¥å®ƒä»¬ï¼š glAttachShader(shaderProgram, vertexShader);glAttachShader(shaderProgram, fragmentShader);glLinkProgram(shaderProgram); ä»£ç åº”è¯¥å¾ˆæ¸…æ¥šï¼Œæˆ‘ä»¬æŠŠç€è‰²å™¨é™„åŠ åˆ°äº†ç¨‹åºä¸Šï¼Œç„¶åç”¨glLinkProgramé“¾æ¥. å°±åƒç€è‰²å™¨çš„ç¼–è¯‘ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ£€æµ‹é“¾æ¥ç€è‰²å™¨ç¨‹åºæ˜¯å¦å¤±è´¥ï¼Œå¹¶è·å–ç›¸åº”çš„æ—¥å¿—ã€‚ä¸ä¸Šé¢ä¸åŒï¼Œæˆ‘ä»¬ä¸ä¼šè°ƒç”¨glGetShaderivå’ŒglGetShaderInfoLogï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨ï¼š glGetProgramiv(shaderProgram, GL_LINK_STATUS, &amp;success);if(!success) &#123; glGetProgramInfoLog(shaderProgram, 512, NULL, infoLog); ...&#125; å¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸€ä¸ªç¨‹åºå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨glUseProgramå‡½æ•°ï¼Œç”¨åˆšåˆ›å»ºçš„ç¨‹åºå¯¹è±¡ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œä»¥æ¿€æ´»è¿™ä¸ªç¨‹åºå¯¹è±¡ï¼š glUseProgram(shaderProgram); åœ¨glUseProgramå‡½æ•°è°ƒç”¨ä¹‹åï¼Œæ¯ä¸ªç€è‰²å™¨è°ƒç”¨å’Œæ¸²æŸ“è°ƒç”¨éƒ½ä¼šä½¿ç”¨è¿™ä¸ªç¨‹åºå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ä¹‹å‰å†™çš„ç€è‰²å™¨)äº†. å¯¹äº†ï¼Œåœ¨æŠŠç€è‰²å™¨å¯¹è±¡é“¾æ¥åˆ°ç¨‹åºå¯¹è±¡ä»¥åï¼Œè®°å¾—åˆ é™¤ç€è‰²å™¨å¯¹è±¡ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦å®ƒä»¬äº†ï¼š glDeleteShader(vertexShader);glDeleteShader(fragmentShader); ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»æŠŠè¾“å…¥é¡¶ç‚¹æ•°æ®å‘é€ç»™äº†GPUï¼Œå¹¶æŒ‡ç¤ºäº†GPUå¦‚ä½•åœ¨é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ä¸­å¤„ç†å®ƒ.å°±å¿«è¦å®Œæˆäº†ï¼Œä½†è¿˜æ²¡ç»“æŸï¼ŒOpenGLè¿˜ä¸çŸ¥é“å®ƒè¯¥å¦‚ä½•è§£é‡Šå†…å­˜ä¸­çš„é¡¶ç‚¹æ•°æ®ï¼Œä»¥åŠå®ƒè¯¥å¦‚ä½•å°†é¡¶ç‚¹æ•°æ®é“¾æ¥åˆ°é¡¶ç‚¹ç€è‰²å™¨çš„å±æ€§ä¸Šã€‚æˆ‘ä»¬éœ€è¦å‘Šè¯‰OpenGLæ€ä¹ˆåš. é“¾æ¥é¡¶ç‚¹å±æ€§é¡¶ç‚¹ç€è‰²å™¨å…è®¸æˆ‘ä»¬æŒ‡å®šä»»ä½•ä»¥é¡¶ç‚¹å±æ€§ä¸ºå½¢å¼çš„è¾“å…¥.è¿™ä½¿å…¶å…·æœ‰å¾ˆå¼ºçš„çµæ´»æ€§çš„åŒæ—¶ï¼Œå®ƒè¿˜çš„ç¡®æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨æŒ‡å®šè¾“å…¥æ•°æ®çš„å“ªä¸€ä¸ªéƒ¨åˆ†å¯¹åº”é¡¶ç‚¹ç€è‰²å™¨çš„å“ªä¸€ä¸ªé¡¶ç‚¹å±æ€§.æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ¸²æŸ“å‰æŒ‡å®šOpenGLè¯¥å¦‚ä½•è§£é‡Šé¡¶ç‚¹æ•°æ®ã€‚ æˆ‘ä»¬çš„é¡¶ç‚¹ç¼“å†²æ•°æ®ä¼šè¢«è§£æä¸ºä¸‹é¢è¿™æ ·å­ï¼š ä½ç½®æ•°æ®è¢«å‚¨å­˜ä¸º32ä½ï¼ˆ4å­—èŠ‚ï¼‰æµ®ç‚¹å€¼ æ¯ä¸ªä½ç½®åŒ…å«3ä¸ªè¿™æ ·çš„å€¼ åœ¨è¿™3ä¸ªå€¼ä¹‹é—´æ²¡æœ‰ç©ºéš™ï¼ˆæˆ–å…¶ä»–å€¼ï¼‰,è¿™å‡ ä¸ªå€¼åœ¨æ•°ç»„ä¸­ç´§å¯†æ’åˆ—(Tightly Packed)ã€‚ æ•°æ®ä¸­ç¬¬ä¸€ä¸ªå€¼åœ¨ç¼“å†²å¼€å§‹çš„ä½ç½® æœ‰äº†è¿™äº›ä¿¡æ¯æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨glVertexAttribPointerå‡½æ•°å‘Šè¯‰OpenGLè¯¥å¦‚ä½•è§£æé¡¶ç‚¹æ•°æ®ï¼ˆåº”ç”¨åˆ°é€ä¸ªé¡¶ç‚¹å±æ€§ä¸Šï¼‰äº†ï¼š glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);glEnableVertexAttribArray(0); glVertexAttribPointerå‡½æ•°çš„å‚æ•°éå¸¸å¤šï¼Œæ‰€ä»¥æˆ‘ä¼šé€ä¸€ä»‹ç»å®ƒä»¬ï¼š ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šæˆ‘ä»¬è¦é…ç½®çš„é¡¶ç‚¹å±æ€§.è¿˜è®°å¾—æˆ‘ä»¬åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ä½¿ç”¨layout(location = 0)å®šä¹‰äº†positioné¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼(Location)å—ï¼Ÿå®ƒå¯ä»¥æŠŠé¡¶ç‚¹å±æ€§çš„ä½ç½®å€¼è®¾ç½®ä¸º0.å› ä¸ºæˆ‘ä»¬å¸Œæœ›æŠŠæ•°æ®ä¼ é€’åˆ°è¿™ä¸€ä¸ªé¡¶ç‚¹å±æ€§ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¼ å…¥0. ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šé¡¶ç‚¹å±æ€§çš„å¤§å°.é¡¶ç‚¹å±æ€§æ˜¯ä¸€ä¸ªvec3ï¼Œå®ƒç”±3ä¸ªå€¼ç»„æˆï¼Œæ‰€ä»¥å¤§å°æ˜¯3. ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šæ•°æ®çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯GL_FLOAT(GLSLä¸­vec*éƒ½æ˜¯ç”±æµ®ç‚¹æ•°å€¼ç»„æˆçš„). ä¸‹ä¸ªå‚æ•°å®šä¹‰æˆ‘ä»¬æ˜¯å¦å¸Œæœ›æ•°æ®è¢«æ ‡å‡†åŒ–(Normalize).å¦‚æœæˆ‘ä»¬è®¾ç½®ä¸ºGL_TRUEï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¼šè¢«æ˜ å°„åˆ°0ï¼ˆå¯¹äºæœ‰ç¬¦å·å‹signedæ•°æ®æ˜¯-1ï¼‰åˆ°1ä¹‹é—´.æˆ‘ä»¬æŠŠå®ƒè®¾ç½®ä¸ºGL_FALSE. ç¬¬äº”ä¸ªå‚æ•°å«åšæ­¥é•¿(Stride)ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬åœ¨è¿ç»­çš„é¡¶ç‚¹å±æ€§ç»„ä¹‹é—´çš„é—´éš”.ç”±äºä¸‹ä¸ªç»„ä½ç½®æ•°æ®åœ¨3ä¸ªfloatä¹‹åï¼Œæˆ‘ä»¬æŠŠæ­¥é•¿è®¾ç½®ä¸º3 * sizeof(float).è¦æ³¨æ„çš„æ˜¯ç”±äºæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°ç»„æ˜¯ç´§å¯†æ’åˆ—çš„ï¼ˆåœ¨ä¸¤ä¸ªé¡¶ç‚¹å±æ€§ä¹‹é—´æ²¡æœ‰ç©ºéš™ï¼‰æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ä¸º0æ¥è®©OpenGLå†³å®šå…·ä½“æ­¥é•¿æ˜¯å¤šå°‘ï¼ˆåªæœ‰å½“æ•°å€¼æ˜¯ç´§å¯†æ’åˆ—æ—¶æ‰å¯ç”¨ï¼‰.ä¸€æ—¦æˆ‘ä»¬æœ‰æ›´å¤šçš„é¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬å°±å¿…é¡»æ›´å°å¿ƒåœ°å®šä¹‰æ¯ä¸ªé¡¶ç‚¹å±æ€§ä¹‹é—´çš„é—´éš”ï¼Œæˆ‘ä»¬åœ¨åé¢ä¼šçœ‹åˆ°æ›´å¤šçš„ä¾‹å­ï¼ˆè¯‘æ³¨: è¿™ä¸ªå‚æ•°çš„æ„æ€ç®€å•è¯´å°±æ˜¯ä»è¿™ä¸ªå±æ€§ç¬¬äºŒæ¬¡å‡ºç°çš„åœ°æ–¹åˆ°æ•´ä¸ªæ•°ç»„0ä½ç½®ä¹‹é—´æœ‰å¤šå°‘å­—èŠ‚ï¼‰. æœ€åä¸€ä¸ªå‚æ•°çš„ç±»å‹æ˜¯void*ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è¿›è¡Œè¿™ä¸ªå¥‡æ€ªçš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å®ƒè¡¨ç¤ºä½ç½®æ•°æ®åœ¨ç¼“å†²ä¸­èµ·å§‹ä½ç½®çš„åç§»é‡(Offset)ã€‚ç”±äºä½ç½®æ•°æ®åœ¨æ•°ç»„çš„å¼€å¤´ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯0.æˆ‘ä»¬ä¼šåœ¨åé¢è¯¦ç»†è§£é‡Šè¿™ä¸ªå‚æ•°. æ¯ä¸ªé¡¶ç‚¹å±æ€§ä»ä¸€ä¸ªVBOç®¡ç†çš„å†…å­˜ä¸­è·å¾—å®ƒçš„æ•°æ®ï¼Œè€Œå…·ä½“æ˜¯ä»å“ªä¸ªVBOï¼ˆç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªVBOï¼‰è·å–åˆ™æ˜¯é€šè¿‡åœ¨è°ƒç”¨glVertexAttribPointeræ—¶ç»‘å®šåˆ°GL_ARRAY_BUFFERçš„VBOå†³å®šçš„.ç”±äºåœ¨è°ƒç”¨glVertexAttribPointerä¹‹å‰ç»‘å®šçš„æ˜¯å…ˆå‰å®šä¹‰çš„VBOå¯¹è±¡ï¼Œé¡¶ç‚¹å±æ€§0ç°åœ¨ä¼šé“¾æ¥åˆ°å®ƒçš„é¡¶ç‚¹æ•°æ®. ç°åœ¨æˆ‘ä»¬å·²ç»å®šä¹‰äº†OpenGLè¯¥å¦‚ä½•è§£é‡Šé¡¶ç‚¹æ•°æ®ï¼Œæˆ‘ä»¬ç°åœ¨åº”è¯¥ä½¿ç”¨glEnableVertexAttribArrayï¼Œä»¥é¡¶ç‚¹å±æ€§ä½ç½®å€¼ä½œä¸ºå‚æ•°ï¼Œå¯ç”¨é¡¶ç‚¹å±æ€§ï¼›é¡¶ç‚¹å±æ€§é»˜è®¤æ˜¯ç¦ç”¨çš„.è‡ªæ­¤ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½å·²ç»è®¾ç½®å¥½äº†ï¼šæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé¡¶ç‚¹ç¼“å†²å¯¹è±¡å°†é¡¶ç‚¹æ•°æ®åˆå§‹åŒ–è‡³ç¼“å†²ä¸­ï¼Œå»ºç«‹äº†ä¸€ä¸ªé¡¶ç‚¹å’Œä¸€ä¸ªç‰‡æ®µç€è‰²å™¨ï¼Œå¹¶å‘Šè¯‰äº†OpenGLå¦‚ä½•æŠŠé¡¶ç‚¹æ•°æ®é“¾æ¥åˆ°é¡¶ç‚¹ç€è‰²å™¨çš„é¡¶ç‚¹å±æ€§ä¸Š.åœ¨OpenGLä¸­ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“ï¼Œä»£ç ä¼šåƒæ˜¯è¿™æ ·ï¼š// 0. å¤åˆ¶é¡¶ç‚¹æ•°ç»„åˆ°ç¼“å†²ä¸­ä¾›OpenGLä½¿ç”¨glBindBuffer(GL_ARRAY_BUFFER, VBO);glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);// 1. è®¾ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);glEnableVertexAttribArray(0);// 2. å½“æˆ‘ä»¬æ¸²æŸ“ä¸€ä¸ªç‰©ä½“æ—¶è¦ä½¿ç”¨ç€è‰²å™¨ç¨‹åºglUseProgram(shaderProgram);// 3. ç»˜åˆ¶ç‰©ä½“someOpenGLFunctionThatDrawsOurTriangle(); æ¯å½“æˆ‘ä»¬ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™éƒ½å¿…é¡»é‡å¤è¿™ä¸€è¿‡ç¨‹ã€‚è¿™çœ‹èµ·æ¥å¯èƒ½ä¸å¤šï¼Œä½†æ˜¯å¦‚æœæœ‰è¶…è¿‡5ä¸ªé¡¶ç‚¹å±æ€§ï¼Œä¸Šç™¾ä¸ªä¸åŒç‰©ä½“å‘¢ï¼ˆè¿™å…¶å®å¹¶ä¸ç½•è§ï¼‰.ç»‘å®šæ­£ç¡®çš„ç¼“å†²å¯¹è±¡ï¼Œä¸ºæ¯ä¸ªç‰©ä½“é…ç½®æ‰€æœ‰é¡¶ç‚¹å±æ€§å¾ˆå¿«å°±å˜æˆä¸€ä»¶éº»çƒ¦äº‹.æœ‰æ²¡æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ä½¿æˆ‘ä»¬æŠŠæ‰€æœ‰è¿™äº›çŠ¶æ€é…ç½®å‚¨å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç»‘å®šè¿™ä¸ªå¯¹è±¡æ¥æ¢å¤çŠ¶æ€å‘¢ï¼Ÿ é¡¶ç‚¹æ•°ç»„å¯¹è±¡é¡¶ç‚¹æ•°ç»„å¯¹è±¡(Vertex Array Object, VAO)å¯ä»¥åƒé¡¶ç‚¹ç¼“å†²å¯¹è±¡é‚£æ ·è¢«ç»‘å®šï¼Œä»»ä½•éšåçš„é¡¶ç‚¹å±æ€§è°ƒç”¨éƒ½ä¼šå‚¨å­˜åœ¨è¿™ä¸ªVAOä¸­.è¿™æ ·çš„å¥½å¤„å°±æ˜¯ï¼Œå½“é…ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆæ—¶ï¼Œä½ åªéœ€è¦å°†é‚£äº›è°ƒç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åå†ç»˜åˆ¶ç‰©ä½“çš„æ—¶å€™åªéœ€è¦ç»‘å®šç›¸åº”çš„VAOå°±è¡Œäº†.è¿™ä½¿åœ¨ä¸åŒé¡¶ç‚¹æ•°æ®å’Œå±æ€§é…ç½®ä¹‹é—´åˆ‡æ¢å˜å¾—éå¸¸ç®€å•ï¼Œåªéœ€è¦ç»‘å®šä¸åŒçš„VAOå°±è¡Œäº†.åˆšåˆšè®¾ç½®çš„æ‰€æœ‰çŠ¶æ€éƒ½å°†å­˜å‚¨åœ¨VAOä¸­. OpenGLçš„æ ¸å¿ƒæ¨¡å¼è¦æ±‚æˆ‘ä»¬ä½¿ç”¨VAOï¼Œæ‰€ä»¥å®ƒçŸ¥é“è¯¥å¦‚ä½•å¤„ç†æˆ‘ä»¬çš„é¡¶ç‚¹è¾“å…¥.å¦‚æœæˆ‘ä»¬ç»‘å®šVAOå¤±è´¥ï¼ŒOpenGLä¼šæ‹’ç»ç»˜åˆ¶ä»»ä½•ä¸œè¥¿. ä¸€ä¸ªé¡¶ç‚¹æ•°ç»„å¯¹è±¡ä¼šå‚¨å­˜ä»¥ä¸‹è¿™äº›å†…å®¹ï¼š glEnableVertexAttribArrayå’ŒglDisableVertexAttribArrayçš„è°ƒç”¨. é€šè¿‡glVertexAttribPointerè®¾ç½®çš„é¡¶ç‚¹å±æ€§é…ç½®. é€šè¿‡glVertexAttribPointerè°ƒç”¨ä¸é¡¶ç‚¹å±æ€§å…³è”çš„é¡¶ç‚¹ç¼“å†²å¯¹è±¡.åˆ›å»ºä¸€ä¸ªVAOå’Œåˆ›å»ºä¸€ä¸ªVBOå¾ˆç±»ä¼¼ï¼šunsigned int VAO;glGenVertexArrays(1, &amp;VAO); è¦æƒ³ä½¿ç”¨VAOï¼Œè¦åšçš„åªæ˜¯ä½¿ç”¨glBindVertexArrayç»‘å®šVAO.ä»ç»‘å®šä¹‹åèµ·ï¼Œæˆ‘ä»¬åº”è¯¥ç»‘å®šå’Œé…ç½®å¯¹åº”çš„VBOå’Œå±æ€§æŒ‡é’ˆï¼Œä¹‹åè§£ç»‘VAOä¾›ä¹‹åä½¿ç”¨.å½“æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªè¦åœ¨ç»˜åˆ¶ç‰©ä½“å‰ç®€å•åœ°æŠŠVAOç»‘å®šåˆ°å¸Œæœ›ä½¿ç”¨çš„è®¾å®šä¸Šå°±è¡Œäº†.è¿™æ®µä»£ç åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š // ..:: åˆå§‹åŒ–ä»£ç ï¼ˆåªè¿è¡Œä¸€æ¬¡ (é™¤éä½ çš„ç‰©ä½“é¢‘ç¹æ”¹å˜)ï¼‰ :: ..// 1. ç»‘å®šVAOglBindVertexArray(VAO);// 2. æŠŠé¡¶ç‚¹æ•°ç»„å¤åˆ¶åˆ°ç¼“å†²ä¸­ä¾›OpenGLä½¿ç”¨glBindBuffer(GL_ARRAY_BUFFER, VBO);glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);// 3. è®¾ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);glEnableVertexAttribArray(0);[...]// ..:: ç»˜åˆ¶ä»£ç ï¼ˆæ¸²æŸ“å¾ªç¯ä¸­ï¼‰ :: ..// 4. ç»˜åˆ¶ç‰©ä½“glUseProgram(shaderProgram);glBindVertexArray(VAO);someOpenGLFunctionThatDrawsOurTriangle(); å°±è¿™ä¹ˆå¤šäº†ï¼å‰é¢åšçš„ä¸€åˆ‡éƒ½æ˜¯ç­‰å¾…è¿™ä¸€åˆ»ï¼Œä¸€ä¸ªå‚¨å­˜äº†æˆ‘ä»¬é¡¶ç‚¹å±æ€§é…ç½®å’Œåº”ä½¿ç”¨çš„VBOçš„é¡¶ç‚¹æ•°ç»„å¯¹è±¡.ä¸€èˆ¬å½“ä½ æ‰“ç®—ç»˜åˆ¶å¤šä¸ªç‰©ä½“æ—¶ï¼Œä½ é¦–å…ˆè¦ç”Ÿæˆ/é…ç½®æ‰€æœ‰çš„VAOï¼ˆå’Œå¿…é¡»çš„VBOåŠå±æ€§æŒ‡é’ˆ)ï¼Œç„¶åå‚¨å­˜å®ƒä»¬ä¾›åé¢ä½¿ç”¨.å½“æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶ç‰©ä½“çš„æ—¶å€™å°±æ‹¿å‡ºç›¸åº”çš„VAOï¼Œç»‘å®šå®ƒï¼Œç»˜åˆ¶å®Œç‰©ä½“åï¼Œå†è§£ç»‘VAO. æˆ‘ä»¬ä¸€ç›´æœŸå¾…çš„ä¸‰è§’å½¢è¦æƒ³ç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„ç‰©ä½“ï¼ŒOpenGLç»™æˆ‘ä»¬æä¾›äº†glDrawArrayså‡½æ•°ï¼Œå®ƒä½¿ç”¨å½“å‰æ¿€æ´»çš„ç€è‰²å™¨ï¼Œä¹‹å‰å®šä¹‰çš„é¡¶ç‚¹å±æ€§é…ç½®ï¼Œå’ŒVBOçš„é¡¶ç‚¹æ•°æ®ï¼ˆé€šè¿‡VAOé—´æ¥ç»‘å®šï¼‰æ¥ç»˜åˆ¶å›¾å…ƒ.glUseProgram(shaderProgram);glBindVertexArray(VAO);glDrawArrays(GL_TRIANGLES, 0, 3); glDrawArrayså‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶çš„OpenGLå›¾å…ƒçš„ç±»å‹.ç”±äºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹æ—¶è¯´è¿‡ï¼Œæˆ‘ä»¬å¸Œæœ›ç»˜åˆ¶çš„æ˜¯ä¸€ä¸ªä¸‰è§’å½¢ï¼Œè¿™é‡Œä¼ é€’GL_TRIANGLESç»™å®ƒã€‚ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†é¡¶ç‚¹æ•°ç»„çš„èµ·å§‹ç´¢å¼•ï¼Œæˆ‘ä»¬è¿™é‡Œå¡«0ã€‚æœ€åä¸€ä¸ªå‚æ•°æŒ‡å®šæˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶å¤šå°‘ä¸ªé¡¶ç‚¹ï¼Œè¿™é‡Œæ˜¯3ï¼ˆæˆ‘ä»¬åªä»æˆ‘ä»¬çš„æ•°æ®ä¸­æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢ï¼Œå®ƒåªæœ‰3ä¸ªé¡¶ç‚¹ï¼‰. ç°åœ¨å°è¯•ç¼–è¯‘ä»£ç ï¼Œå¦‚æœå¼¹å‡ºäº†ä»»ä½•é”™è¯¯ï¼Œå›å¤´æ£€æŸ¥ä½ çš„ä»£ç ã€‚å¦‚æœä½ ç¼–è¯‘é€šè¿‡äº†ï¼Œä½ åº”è¯¥çœ‹åˆ°ä¸‹é¢çš„ç»“æœï¼šä¸‰è§’å½¢çš„æºä»£ç åœ¨è¿™é‡Œ. ç´¢å¼•ç¼“å†²å¯¹è±¡åœ¨æ¸²æŸ“é¡¶ç‚¹è¿™ä¸€è¯é¢˜ä¸Šæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä¸ªéœ€è¦è®¨è®ºçš„ä¸œè¥¿â€”â€”ç´¢å¼•ç¼“å†²å¯¹è±¡(Element Buffer Objectï¼ŒEBOï¼Œä¹Ÿå«Index Buffer Objectï¼ŒIBO)ã€‚è¦è§£é‡Šç´¢å¼•ç¼“å†²å¯¹è±¡çš„å·¥ä½œæ–¹å¼æœ€å¥½è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬ä¸å†ç»˜åˆ¶ä¸€ä¸ªä¸‰è§’å½¢è€Œæ˜¯ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢.æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ä¸¤ä¸ªä¸‰è§’å½¢æ¥ç»„æˆä¸€ä¸ªçŸ©å½¢ï¼ˆOpenGLä¸»è¦å¤„ç†ä¸‰è§’å½¢ï¼‰.è¿™ä¼šç”Ÿæˆä¸‹é¢çš„é¡¶ç‚¹çš„é›†åˆï¼š float vertices[] = &#123; // ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ 0.5f, 0.5f, 0.0f, // å³ä¸Šè§’ 0.5f, -0.5f, 0.0f, // å³ä¸‹è§’ -0.5f, 0.5f, 0.0f, // å·¦ä¸Šè§’ // ç¬¬äºŒä¸ªä¸‰è§’å½¢ 0.5f, -0.5f, 0.0f, // å³ä¸‹è§’ -0.5f, -0.5f, 0.0f, // å·¦ä¸‹è§’ -0.5f, 0.5f, 0.0f // å·¦ä¸Šè§’&#125;; å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å‡ ä¸ªé¡¶ç‚¹å åŠ äº†.æˆ‘ä»¬æŒ‡å®šäº†å³ä¸‹è§’å’Œå·¦ä¸Šè§’ä¸¤æ¬¡ï¼ä¸€ä¸ªçŸ©å½¢åªæœ‰4ä¸ªè€Œä¸æ˜¯6ä¸ªé¡¶ç‚¹ï¼Œè¿™æ ·å°±äº§ç”Ÿ50%çš„é¢å¤–å¼€é”€.å½“æˆ‘ä»¬æœ‰åŒ…æ‹¬ä¸Šåƒä¸ªä¸‰è§’å½¢çš„æ¨¡å‹ä¹‹åè¿™ä¸ªé—®é¢˜ä¼šæ›´ç³Ÿç³•ï¼Œè¿™ä¼šäº§ç”Ÿä¸€å¤§å †æµªè´¹.æ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯åªå‚¨å­˜ä¸åŒçš„é¡¶ç‚¹ï¼Œå¹¶è®¾å®šç»˜åˆ¶è¿™äº›é¡¶ç‚¹çš„é¡ºåº.è¿™æ ·å­æˆ‘ä»¬åªè¦å‚¨å­˜4ä¸ªé¡¶ç‚¹å°±èƒ½ç»˜åˆ¶çŸ©å½¢äº†ï¼Œä¹‹ååªè¦æŒ‡å®šç»˜åˆ¶çš„é¡ºåºå°±è¡Œäº†.å¦‚æœOpenGLæä¾›è¿™ä¸ªåŠŸèƒ½å°±å¥½äº†ï¼Œå¯¹å§ï¼Ÿ å¾ˆå¹¸è¿ï¼Œç´¢å¼•ç¼“å†²å¯¹è±¡çš„å·¥ä½œæ–¹å¼æ­£æ˜¯è¿™æ ·çš„.å’Œé¡¶ç‚¹ç¼“å†²å¯¹è±¡ä¸€æ ·ï¼ŒEBOä¹Ÿæ˜¯ä¸€ä¸ªç¼“å†²ï¼Œå®ƒä¸“é—¨å‚¨å­˜ç´¢å¼•ï¼ŒOpenGLè°ƒç”¨è¿™äº›é¡¶ç‚¹çš„ç´¢å¼•æ¥å†³å®šè¯¥ç»˜åˆ¶å“ªä¸ªé¡¶ç‚¹.æ‰€è°“çš„ç´¢å¼•ç»˜åˆ¶(Indexed Drawing)æ­£æ˜¯æˆ‘ä»¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ.é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¦å®šä¹‰ï¼ˆä¸é‡å¤çš„ï¼‰é¡¶ç‚¹ï¼Œå’Œç»˜åˆ¶å‡ºçŸ©å½¢æ‰€éœ€çš„ç´¢å¼•ï¼š float vertices[] = &#123; 0.5f, 0.5f, 0.0f, // å³ä¸Šè§’ 0.5f, -0.5f, 0.0f, // å³ä¸‹è§’ -0.5f, -0.5f, 0.0f, // å·¦ä¸‹è§’ -0.5f, 0.5f, 0.0f // å·¦ä¸Šè§’&#125;;unsigned int indices[] = &#123; // æ³¨æ„ç´¢å¼•ä»0å¼€å§‹! 0, 1, 3, // ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ 1, 2, 3 // ç¬¬äºŒä¸ªä¸‰è§’å½¢&#125;; ä½ å¯ä»¥çœ‹åˆ°ï¼Œå½“æ—¶ç”¨ç´¢å¼•çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªå®šä¹‰äº†4ä¸ªé¡¶ç‚¹ï¼Œè€Œä¸æ˜¯6ä¸ªã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦åˆ›å»ºç´¢å¼•ç¼“å†²å¯¹è±¡ï¼š unsigned int EBO;glGenBuffers(1, &amp;EBO); ä¸VBOç±»ä¼¼ï¼Œæˆ‘ä»¬å…ˆç»‘å®šEBOç„¶åç”¨glBufferDataæŠŠç´¢å¼•å¤åˆ¶åˆ°ç¼“å†²é‡Œ.åŒæ ·ï¼Œå’ŒVBOç±»ä¼¼ï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™äº›å‡½æ•°è°ƒç”¨æ”¾åœ¨ç»‘å®šå’Œè§£ç»‘å‡½æ•°è°ƒç”¨ä¹‹é—´ï¼Œåªä¸è¿‡è¿™æ¬¡æˆ‘ä»¬æŠŠç¼“å†²çš„ç±»å‹å®šä¹‰ä¸ºGL_ELEMENT_ARRAY_BUFFER. glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW); è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¼ é€’äº†GL_ELEMENT_ARRAY_BUFFERå½“ä½œç¼“å†²ç›®æ ‡.æœ€åä¸€ä»¶è¦åšçš„äº‹æ˜¯ç”¨glDrawElementsæ¥æ›¿æ¢glDrawArrayså‡½æ•°ï¼Œæ¥æŒ‡æ˜æˆ‘ä»¬ä»ç´¢å¼•ç¼“å†²æ¸²æŸ“.ä½¿ç”¨glDrawElementsæ—¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å½“å‰ç»‘å®šçš„ç´¢å¼•ç¼“å†²å¯¹è±¡ä¸­çš„ç´¢å¼•è¿›è¡Œç»˜åˆ¶ï¼š glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0); ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†æˆ‘ä»¬ç»˜åˆ¶çš„æ¨¡å¼ï¼Œè¿™ä¸ªå’ŒglDrawArraysçš„ä¸€æ ·.ç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æ‰“ç®—ç»˜åˆ¶é¡¶ç‚¹çš„ä¸ªæ•°ï¼Œè¿™é‡Œå¡«6ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸€å…±éœ€è¦ç»˜åˆ¶6ä¸ªé¡¶ç‚¹.ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç´¢å¼•çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯GL_UNSIGNED_INT.æœ€åä¸€ä¸ªå‚æ•°é‡Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šEBOä¸­çš„åç§»é‡ï¼ˆæˆ–è€…ä¼ é€’ä¸€ä¸ªç´¢å¼•æ•°ç»„ï¼Œä½†æ˜¯è¿™æ˜¯å½“ä½ ä¸åœ¨ä½¿ç”¨ç´¢å¼•ç¼“å†²å¯¹è±¡çš„æ—¶å€™ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šåœ¨è¿™é‡Œå¡«å†™0. glDrawElementså‡½æ•°ä»å½“å‰ç»‘å®šåˆ°GL_ELEMENT_ARRAY_BUFFERç›®æ ‡çš„EBOä¸­è·å–ç´¢å¼•.è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»åœ¨æ¯æ¬¡è¦ç”¨ç´¢å¼•æ¸²æŸ“ä¸€ä¸ªç‰©ä½“æ—¶ç»‘å®šç›¸åº”çš„EBOï¼Œè¿™è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦.ä¸è¿‡é¡¶ç‚¹æ•°ç»„å¯¹è±¡åŒæ ·å¯ä»¥ä¿å­˜ç´¢å¼•ç¼“å†²å¯¹è±¡çš„ç»‘å®šçŠ¶æ€.VAOç»‘å®šæ—¶æ­£åœ¨ç»‘å®šçš„ç´¢å¼•ç¼“å†²å¯¹è±¡ä¼šè¢«ä¿å­˜ä¸ºVAOçš„å…ƒç´ ç¼“å†²å¯¹è±¡.ç»‘å®šVAOçš„åŒæ—¶ä¹Ÿä¼šè‡ªåŠ¨ç»‘å®šEBO. å½“ç›®æ ‡æ˜¯GL_ELEMENT_ARRAY_BUFFERçš„æ—¶å€™ï¼ŒVAOä¼šå‚¨å­˜glBindBufferçš„å‡½æ•°è°ƒç”¨.è¿™ä¹Ÿæ„å‘³ç€å®ƒä¹Ÿä¼šå‚¨å­˜è§£ç»‘è°ƒç”¨ï¼Œæ‰€ä»¥ç¡®ä¿ä½ æ²¡æœ‰åœ¨è§£ç»‘VAOä¹‹å‰è§£ç»‘ç´¢å¼•æ•°ç»„ç¼“å†²ï¼Œå¦åˆ™å®ƒå°±æ²¡æœ‰è¿™ä¸ªEBOé…ç½®äº†. æœ€åçš„åˆå§‹åŒ–å’Œç»˜åˆ¶ä»£ç ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š // ..:: åˆå§‹åŒ–ä»£ç  :: ..// 1. ç»‘å®šé¡¶ç‚¹æ•°ç»„å¯¹è±¡glBindVertexArray(VAO);// 2. æŠŠæˆ‘ä»¬çš„é¡¶ç‚¹æ•°ç»„å¤åˆ¶åˆ°ä¸€ä¸ªé¡¶ç‚¹ç¼“å†²ä¸­ï¼Œä¾›OpenGLä½¿ç”¨glBindBuffer(GL_ARRAY_BUFFER, VBO);glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);// 3. å¤åˆ¶æˆ‘ä»¬çš„ç´¢å¼•æ•°ç»„åˆ°ä¸€ä¸ªç´¢å¼•ç¼“å†²ä¸­ï¼Œä¾›OpenGLä½¿ç”¨glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);// 4. è®¾å®šé¡¶ç‚¹å±æ€§æŒ‡é’ˆglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), (void*)0);glEnableVertexAttribArray(0);[...]// ..:: ç»˜åˆ¶ä»£ç ï¼ˆæ¸²æŸ“å¾ªç¯ä¸­ï¼‰ :: ..glUseProgram(shaderProgram);glBindVertexArray(VAO);glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0)glBindVertexArray(0); è¿è¡Œç¨‹åºä¼šè·å¾—ä¸‹é¢è¿™æ ·çš„å›¾ç‰‡çš„ç»“æœ.å·¦ä¾§å›¾ç‰‡çœ‹åº”è¯¥èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Œè€Œå³ä¾§çš„åˆ™æ˜¯ä½¿ç”¨çº¿æ¡†æ¨¡å¼(Wireframe Mode)ç»˜åˆ¶çš„.çº¿æ¡†çŸ©å½¢å¯ä»¥æ˜¾ç¤ºå‡ºçŸ©å½¢çš„ç¡®æ˜¯ç”±ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆçš„. çº¿æ¡†æ¨¡å¼(Wireframe Mode)è¦æƒ³ç”¨çº¿æ¡†æ¨¡å¼ç»˜åˆ¶ä½ çš„ä¸‰è§’å½¢ï¼Œä½ å¯ä»¥é€šè¿‡glPolygonMode(GL_FRONT_AND_BACK, GL_LINE)å‡½æ•°é…ç½®OpenGLå¦‚ä½•ç»˜åˆ¶å›¾å…ƒ.ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæˆ‘ä»¬æ‰“ç®—å°†å…¶åº”ç”¨åˆ°æ‰€æœ‰çš„ä¸‰è§’å½¢çš„æ­£é¢å’ŒèƒŒé¢ï¼Œç¬¬äºŒä¸ªå‚æ•°å‘Šè¯‰æˆ‘ä»¬ç”¨çº¿æ¥ç»˜åˆ¶.ä¹‹åçš„ç»˜åˆ¶è°ƒç”¨ä¼šä¸€ç›´ä»¥çº¿æ¡†æ¨¡å¼ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œç›´åˆ°æˆ‘ä»¬ç”¨glPolygonMode(GL_FRONT_AND_BACK, GL_FILL)å°†å…¶è®¾ç½®å›é»˜è®¤æ¨¡å¼. å¦‚æœä½ é‡åˆ°ä»»ä½•é”™è¯¯ï¼Œå›å¤´æ£€æŸ¥ä»£ç ï¼Œçœ‹çœ‹æ˜¯å¦é—æ¼äº†ä»€ä¹ˆ.åŒæ—¶ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å…¨éƒ¨æºç . Clionåˆ‡æ¢è¿è¡Œcpp#CMakeLists.txt trianglecmake_minimum_required(VERSION 3.14)project(hello,triangle)set(CMAKE_CXX_STANDARD 14)set(SOURCE_FILES main.cpp glad.c)add_executable(main $&#123;SOURCE_FILES&#125;)target_link_libraries(main glfw3 GL m Xrandr Xi X11 Xxf86vm pthread dl Xinerama Xcursor) #CMakeLists.txt rectanglecmake_minimum_required(VERSION 3.14)project(hello,triangle)set(CMAKE_CXX_STANDARD 14)set(SOURCE_FILES rectangle.cpp glad.c)add_executable(rectangle $&#123;SOURCE_FILES&#125;)target_link_libraries(rectangle glfw3 GL m Xrandr Xi X11 Xxf86vm pthread dl Xinerama Xcursor) è°ƒè¯•æ•™ç¨‹è°ƒè¯•ï¼šè¿™ä¸ªæ•™ç¨‹ä¸­æ¶‰åŠåˆ°äº†å¾ˆå¤šæ­¥éª¤ï¼Œå¦‚æœä½ åœ¨å“ªå¡ä½äº†ï¼Œé˜…è¯»ä¸€ç‚¹è°ƒè¯•çš„æ•™ç¨‹æ˜¯éå¸¸å€¼å¾—çš„ï¼ˆåªéœ€è¦é˜…è¯»åˆ°è°ƒè¯•è¾“å‡ºéƒ¨åˆ†ï¼‰ ç€è‰²å™¨GLSLä¸€ä¸ªå…¸å‹çš„ç€è‰²å™¨æœ‰ä¸‹é¢çš„ç»“æ„ï¼š #version version_numberin type in_variable_name;in type in_variable_name;out type out_variable_name;uniform type uniform_name;int main()&#123; // å¤„ç†è¾“å…¥å¹¶è¿›è¡Œä¸€äº›å›¾å½¢æ“ä½œ ... // è¾“å‡ºå¤„ç†è¿‡çš„ç»“æœåˆ°è¾“å‡ºå˜é‡ out_variable_name = weird_stuff_we_processed;&#125; å½“æˆ‘ä»¬ç‰¹åˆ«è°ˆè®ºåˆ°é¡¶ç‚¹ç€è‰²å™¨çš„æ—¶å€™ï¼Œæ¯ä¸ªè¾“å…¥å˜é‡ä¹Ÿå«é¡¶ç‚¹å±æ€§(Vertex Attribute)ã€‚æˆ‘ä»¬èƒ½å£°æ˜çš„é¡¶ç‚¹å±æ€§æ˜¯æœ‰ä¸Šé™çš„ï¼Œå®ƒä¸€èˆ¬ç”±ç¡¬ä»¶æ¥å†³å®šã€‚OpenGLç¡®ä¿è‡³å°‘æœ‰16ä¸ªåŒ…å«4åˆ†é‡çš„é¡¶ç‚¹å±æ€§å¯ç”¨ï¼Œä½†æ˜¯æœ‰äº›ç¡¬ä»¶æˆ–è®¸å…è®¸æ›´å¤šçš„é¡¶ç‚¹å±æ€§ï¼Œä½ å¯ä»¥æŸ¥è¯¢GL_MAX_VERTEX_ATTRIBSæ¥è·å–å…·ä½“çš„ä¸Šé™ï¼š int nrAttributes;glGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &amp;nrAttributes);std::cout &lt;&lt; \"Maximum nr of vertex attributes supported: \" &lt;&lt; nrAttributes &lt;&lt; std::endl; å‘é‡GLSLä¸­çš„å‘é‡æ˜¯ä¸€ä¸ªå¯ä»¥åŒ…å«æœ‰1ã€2ã€3æˆ–è€…4ä¸ªåˆ†é‡çš„å®¹å™¨ï¼Œåˆ†é‡çš„ç±»å‹å¯ä»¥æ˜¯å‰é¢é»˜è®¤åŸºç¡€ç±»å‹çš„ä»»æ„ä¸€ä¸ªã€‚å®ƒä»¬å¯ä»¥æ˜¯ä¸‹é¢çš„å½¢å¼ï¼ˆnä»£è¡¨åˆ†é‡çš„æ•°é‡ï¼‰ï¼šä¸€ä¸ªå‘é‡çš„åˆ†é‡å¯ä»¥é€šè¿‡vec.xè¿™ç§æ–¹å¼è·å–ï¼Œè¿™é‡Œxæ˜¯æŒ‡è¿™ä¸ªå‘é‡çš„ç¬¬ä¸€ä¸ªåˆ†é‡.ä½ å¯ä»¥åˆ†åˆ«ä½¿ç”¨.xã€.yã€.zå’Œ.wæ¥è·å–å®ƒä»¬çš„ç¬¬1ã€2ã€3ã€4ä¸ªåˆ†é‡.GLSLä¹Ÿå…è®¸ä½ å¯¹é¢œè‰²ä½¿ç”¨rgbaï¼Œæˆ–æ˜¯å¯¹çº¹ç†åæ ‡ä½¿ç”¨stpqè®¿é—®ç›¸åŒçš„åˆ†é‡. é‡ç»„å‘é‡è¿™ä¸€æ•°æ®ç±»å‹ä¹Ÿå…è®¸ä¸€äº›æœ‰è¶£è€Œçµæ´»çš„åˆ†é‡é€‰æ‹©æ–¹å¼ï¼Œå«åšé‡ç»„(Swizzling)ã€‚é‡ç»„å…è®¸è¿™æ ·çš„è¯­æ³•ï¼š vec2 someVec;vec4 differentVec = someVec.xyxx;vec3 anotherVec = differentVec.zyw;vec4 otherVec = someVec.xxxx + anotherVec.yxzy; ä½ å¯ä»¥ä½¿ç”¨ä¸Šé¢4ä¸ªå­—æ¯ä»»æ„ç»„åˆæ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸæ¥å‘é‡ä¸€æ ·é•¿çš„ï¼ˆåŒç±»å‹ï¼‰æ–°å‘é‡ï¼Œåªè¦åŸæ¥å‘é‡æœ‰é‚£äº›åˆ†é‡å³å¯ï¼›ç„¶è€Œï¼Œä½ ä¸å…è®¸åœ¨ä¸€ä¸ªvec2å‘é‡ä¸­å»è·å–.zå…ƒç´ (vec2åªæœ‰2ä¸ªç»´åº¦).æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¸€ä¸ªå‘é‡ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ ç»™ä¸åŒçš„å‘é‡æ„é€ å‡½æ•°ï¼Œä»¥å‡å°‘éœ€æ±‚å‚æ•°çš„æ•°é‡ï¼š vec2 vect = vec2(0.5, 0.7);vec4 result = vec4(vect, 0.0, 0.0);vec4 otherResult = vec4(result.xyz, 1.0); è¾“å…¥è¾“å‡ºGLSLå®šä¹‰äº†inå’Œoutå…³é”®å­—ä¸“é—¨æ¥å®ç°æ•°æ®äº¤æµå’Œä¼ é€’.æ¯ä¸ªç€è‰²å™¨ä½¿ç”¨è¿™ä¸¤ä¸ªå…³é”®å­—è®¾å®šè¾“å…¥å’Œè¾“å‡ºï¼Œåªè¦ä¸€ä¸ªè¾“å‡ºå˜é‡ä¸ä¸‹ä¸€ä¸ªç€è‰²å™¨é˜¶æ®µçš„è¾“å…¥åŒ¹é…ï¼Œå®ƒå°±ä¼šä¼ é€’ä¸‹å»ã€‚ä½†åœ¨é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨ä¸­ä¼šæœ‰ç‚¹ä¸åŒ. é¡¶ç‚¹ç€è‰²å™¨åº”è¯¥æ¥æ”¶çš„æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„è¾“å…¥ï¼Œå¦åˆ™å°±ä¼šæ•ˆç‡ä½ä¸‹.é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥ç‰¹æ®Šåœ¨ï¼Œå®ƒä»é¡¶ç‚¹æ•°æ®ä¸­ç›´æ¥æ¥æ”¶è¾“å…¥.ä¸ºäº†å®šä¹‰é¡¶ç‚¹æ•°æ®è¯¥å¦‚ä½•ç®¡ç†ï¼Œæˆ‘ä»¬ä½¿ç”¨locationè¿™ä¸€å…ƒæ•°æ®æŒ‡å®šè¾“å…¥å˜é‡ï¼Œè¿™æ ·æˆ‘ä»¬æ‰å¯ä»¥åœ¨CPUä¸Šé…ç½®é¡¶ç‚¹å±æ€§.æˆ‘ä»¬å·²ç»åœ¨å‰é¢çš„æ•™ç¨‹çœ‹è¿‡è¿™ä¸ªäº†ï¼Œlayout (location = 0).é¡¶ç‚¹ç€è‰²å™¨éœ€è¦ä¸ºå®ƒçš„è¾“å…¥æä¾›ä¸€ä¸ªé¢å¤–çš„layoutæ ‡è¯†ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æŠŠå®ƒé“¾æ¥åˆ°é¡¶ç‚¹æ•°æ®. ä½ ä¹Ÿå¯ä»¥å¿½ç•¥layout (location = 0)æ ‡è¯†ç¬¦ï¼Œé€šè¿‡åœ¨OpenGLä»£ç ä¸­ä½¿ç”¨glGetAttribLocationæŸ¥è¯¢å±æ€§ä½ç½®å€¼(Location)ï¼Œä½†æ˜¯æˆ‘æ›´å–œæ¬¢åœ¨ç€è‰²å™¨ä¸­è®¾ç½®å®ƒä»¬ï¼Œè¿™æ ·ä¼šæ›´å®¹æ˜“ç†è§£è€Œä¸”èŠ‚çœä½ ï¼ˆå’ŒOpenGLï¼‰çš„å·¥ä½œé‡. å¦ä¸€ä¸ªä¾‹å¤–æ˜¯ç‰‡æ®µç€è‰²å™¨ï¼Œå®ƒéœ€è¦ä¸€ä¸ªvec4é¢œè‰²è¾“å‡ºå˜é‡ï¼Œå› ä¸ºç‰‡æ®µç€è‰²å™¨éœ€è¦ç”Ÿæˆä¸€ä¸ªæœ€ç»ˆè¾“å‡ºçš„é¢œè‰²ã€‚å¦‚æœä½ åœ¨ç‰‡æ®µç€è‰²å™¨æ²¡æœ‰å®šä¹‰è¾“å‡ºé¢œè‰²ï¼ŒOpenGLä¼šæŠŠä½ çš„ç‰©ä½“æ¸²æŸ“ä¸ºé»‘è‰²ï¼ˆæˆ–ç™½è‰²ï¼‰. æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬æ‰“ç®—ä»ä¸€ä¸ªç€è‰²å™¨å‘å¦ä¸€ä¸ªç€è‰²å™¨å‘é€æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å‘é€æ–¹ç€è‰²å™¨ä¸­å£°æ˜ä¸€ä¸ªè¾“å‡ºï¼Œåœ¨æ¥æ”¶æ–¹ç€è‰²å™¨ä¸­å£°æ˜ä¸€ä¸ªç±»ä¼¼çš„è¾“å…¥.å½“ç±»å‹å’Œåå­—éƒ½ä¸€æ ·çš„æ—¶å€™ï¼ŒOpenGLå°±ä¼šæŠŠä¸¤ä¸ªå˜é‡é“¾æ¥åˆ°ä¸€èµ·ï¼Œå®ƒä»¬ä¹‹é—´å°±èƒ½å‘é€æ•°æ®äº†ï¼ˆè¿™æ˜¯åœ¨é“¾æ¥ç¨‹åºå¯¹è±¡æ—¶å®Œæˆçš„ï¼‰.ä¸ºäº†å±•ç¤ºè¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬ä¼šç¨å¾®æ”¹åŠ¨ä¸€ä¸‹ä¹‹å‰æ•™ç¨‹é‡Œçš„é‚£ä¸ªç€è‰²å™¨ï¼Œè®©é¡¶ç‚¹ç€è‰²å™¨ä¸ºç‰‡æ®µç€è‰²å™¨å†³å®šé¢œè‰².é¡¶ç‚¹ç€è‰²å™¨ #version 330 corelayout (location = 0) in vec3 aPos; // ä½ç½®å˜é‡çš„å±æ€§ä½ç½®å€¼ä¸º0out vec4 vertexColor; // ä¸ºç‰‡æ®µç€è‰²å™¨æŒ‡å®šä¸€ä¸ªé¢œè‰²è¾“å‡ºvoid main()&#123; gl_Position = vec4(aPos, 1.0); // æ³¨æ„æˆ‘ä»¬å¦‚ä½•æŠŠä¸€ä¸ªvec3ä½œä¸ºvec4çš„æ„é€ å™¨çš„å‚æ•° vertexColor = vec4(0.5, 0.0, 0.0, 1.0); // æŠŠè¾“å‡ºå˜é‡è®¾ç½®ä¸ºæš—çº¢è‰²&#125; ç‰‡æ®µç€è‰²å™¨ #version 330 coreout vec4 FragColor;in vec4 vertexColor; // ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ æ¥çš„è¾“å…¥å˜é‡ï¼ˆåç§°ç›¸åŒã€ç±»å‹ç›¸åŒï¼‰void main()&#123; FragColor = vertexColor;&#125; ç»“æœå¦‚ä¸‹ï¼š UniformUniformæ˜¯ä¸€ç§ä»CPUä¸­çš„åº”ç”¨å‘GPUä¸­çš„ç€è‰²å™¨å‘é€æ•°æ®çš„æ–¹å¼ï¼Œä½†uniformå’Œé¡¶ç‚¹å±æ€§æœ‰äº›ä¸åŒ.é¦–å…ˆ,Uniformæ˜¯å…¨å±€çš„,åœ¨æ¯ä¸ªç€è‰²å™¨ç¨‹åºä¸­éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„,å®ƒå¯ä»¥è¢«ç€è‰²å™¨ç¨‹åºçš„ä»»æ„ç€è‰²å™¨åœ¨ä»»æ„é˜¶æ®µè®¿é—®.å…¶æ¬¡,æ— è®ºä½ æŠŠuniformå€¼è®¾ç½®æˆä»€ä¹ˆï¼Œuniformä¼šä¸€ç›´ä¿å­˜å®ƒä»¬çš„æ•°æ®ï¼Œç›´åˆ°å®ƒä»¬è¢«é‡ç½®æˆ–æ›´æ–°. #version 330 coreout vec4 FragColor;uniform vec4 ourColor; // åœ¨OpenGLç¨‹åºä»£ç ä¸­è®¾å®šè¿™ä¸ªå˜é‡void main()&#123; FragColor = ourColor;&#125; å¦‚æœä½ å£°æ˜äº†ä¸€ä¸ªuniformå´åœ¨GLSLä»£ç ä¸­æ²¡ç”¨è¿‡ï¼Œç¼–è¯‘å™¨ä¼šé™é»˜ç§»é™¤è¿™ä¸ªå˜é‡ï¼Œå¯¼è‡´æœ€åç¼–è¯‘å‡ºçš„ç‰ˆæœ¬ä¸­å¹¶ä¸ä¼šåŒ…å«å®ƒï¼Œè¿™å¯èƒ½å¯¼è‡´å‡ ä¸ªéå¸¸éº»çƒ¦çš„é”™è¯¯ï¼Œè®°ä½è¿™ç‚¹ï¼ ä¸‹é¢è¿™æ®µç¨‹åºå¯ä»¥è®©é¢œè‰²éšç€æ—¶é—´å˜åŒ–è€Œæ”¹å˜: float timeValue = glfwGetTime();float greenValue = (sin(timeValue) / 2.0f) + 0.5f;int vertexColorLocation = glGetUniformLocation(shaderProgram, \"ourColor\");glUseProgram(shaderProgram);glUniform4f(vertexColorLocation, 0.0f, greenValue, 0.0f, 1.0f); é¦–å…ˆæˆ‘ä»¬é€šè¿‡glfwGetTime()è·å–è¿è¡Œçš„ç§’æ•°.ç„¶åæˆ‘ä»¬ä½¿ç”¨sinå‡½æ•°è®©é¢œè‰²åœ¨0.0åˆ°1.0ä¹‹é—´æ”¹å˜ï¼Œæœ€åå°†ç»“æœå‚¨å­˜åˆ°greenValueé‡Œ. æ¥ç€ï¼Œæˆ‘ä»¬ç”¨glGetUniformLocationæŸ¥è¯¢uniform ourColorçš„ä½ç½®å€¼.-1ä»£è¡¨æ²¡æ‰¾åˆ°.æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡glUniform4få‡½æ•°è®¾ç½®uniformå€¼.æ³¨æ„ï¼ŒæŸ¥è¯¢uniformåœ°å€ä¸è¦æ±‚ä½ ä¹‹å‰ä½¿ç”¨è¿‡ç€è‰²å™¨ç¨‹åºï¼Œä½†æ˜¯æ›´æ–°ä¸€ä¸ªuniformä¹‹å‰ä½ å¿…é¡»å…ˆä½¿ç”¨ç¨‹åºï¼ˆè°ƒç”¨glUseProgram)ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨å½“å‰æ¿€æ´»çš„ç€è‰²å™¨ç¨‹åºä¸­è®¾ç½®uniformçš„. å› ä¸ºOpenGLåœ¨å…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ªCåº“ï¼Œæ‰€ä»¥å®ƒä¸æ”¯æŒç±»å‹é‡è½½ï¼Œåœ¨å‡½æ•°å‚æ•°ä¸åŒçš„æ—¶å€™å°±è¦ä¸ºå…¶å®šä¹‰æ–°çš„å‡½æ•°ï¼›glUniformæ˜¯ä¸€ä¸ªå…¸å‹ä¾‹å­.è¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªç‰¹å®šçš„åç¼€ï¼Œæ ‡è¯†è®¾å®šçš„uniformçš„ç±»å‹ã€‚å¯èƒ½çš„åç¼€æœ‰ï¼šæ¯å½“ä½ æ‰“ç®—é…ç½®ä¸€ä¸ªOpenGLçš„é€‰é¡¹æ—¶å°±å¯ä»¥ç®€å•åœ°æ ¹æ®è¿™äº›è§„åˆ™é€‰æ‹©é€‚åˆä½ çš„æ•°æ®ç±»å‹çš„é‡è½½å‡½æ•°ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬å¸Œæœ›åˆ†åˆ«è®¾å®šuniformçš„4ä¸ªfloatå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡glUniform4fä¼ é€’æˆ‘ä»¬çš„æ•°æ®(æ³¨æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨fvç‰ˆæœ¬). ä¸‹é¢çš„ç¨‹åºä½ ä¼šçœ‹åˆ°ä½ çš„ä¸‰è§’å½¢é€æ¸ç”±ç»¿å˜é»‘å†å˜å›ç»¿è‰².while(!glfwWindowShouldClose(window))&#123; // è¾“å…¥ processInput(window); // æ¸²æŸ“ // æ¸…é™¤é¢œè‰²ç¼“å†² glClearColor(0.2f, 0.3f, 0.3f, 1.0f); glClear(GL_COLOR_BUFFER_BIT); // è®°å¾—æ¿€æ´»ç€è‰²å™¨ glUseProgram(shaderProgram); // æ›´æ–°uniformé¢œè‰² float timeValue = glfwGetTime(); float greenValue = sin(timeValue) / 2.0f + 0.5f; int vertexColorLocation = glGetUniformLocation(shaderProgram, \"ourColor\"); glUniform4f(vertexColorLocation, 0.0f, greenValue, 0.0f, 1.0f); // ç»˜åˆ¶ä¸‰è§’å½¢ glBindVertexArray(VAO); glDrawArrays(GL_TRIANGLES, 0, 3); // äº¤æ¢ç¼“å†²å¹¶æŸ¥è¯¢IOäº‹ä»¶ glfwSwapBuffers(window); glfwPollEvents();&#125; å®Œæ•´ä»£ç ç‚¹å‡»æ­¤å¤„ æ›´å¤šå±æ€§ï¼æˆ‘ä»¬å°†æŠŠé¢œè‰²æ•°æ®æ·»åŠ ä¸º3ä¸ªfloatå€¼è‡³verticesæ•°ç»„ã€‚æˆ‘ä»¬å°†æŠŠä¸‰è§’å½¢çš„ä¸‰ä¸ªè§’åˆ†åˆ«æŒ‡å®šä¸ºçº¢è‰²ã€ç»¿è‰²å’Œè“è‰²ï¼š float vertices[] = &#123; // ä½ç½® // é¢œè‰² 0.5f, -0.5f, 0.0f, 1.0f, 0.0f, 0.0f, // å³ä¸‹ -0.5f, -0.5f, 0.0f, 0.0f, 1.0f, 0.0f, // å·¦ä¸‹ 0.0f, 0.5f, 0.0f, 0.0f, 0.0f, 1.0f // é¡¶éƒ¨&#125;; ç”±äºç°åœ¨æœ‰æ›´å¤šçš„æ•°æ®è¦å‘é€åˆ°é¡¶ç‚¹ç€è‰²å™¨ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å»è°ƒæ•´ä¸€ä¸‹é¡¶ç‚¹ç€è‰²å™¨ï¼Œä½¿å®ƒèƒ½å¤Ÿæ¥æ”¶é¢œè‰²å€¼ä½œä¸ºä¸€ä¸ªé¡¶ç‚¹å±æ€§è¾“å…¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ç”¨layoutæ ‡è¯†ç¬¦æ¥æŠŠaColorå±æ€§çš„ä½ç½®å€¼è®¾ç½®ä¸º1ï¼š #version 330 corelayout (location = 0) in vec3 aPos; // ä½ç½®å˜é‡çš„å±æ€§ä½ç½®å€¼ä¸º 0 layout (location = 1) in vec3 aColor; // é¢œè‰²å˜é‡çš„å±æ€§ä½ç½®å€¼ä¸º 1out vec3 ourColor; // å‘ç‰‡æ®µç€è‰²å™¨è¾“å‡ºä¸€ä¸ªé¢œè‰²void main()&#123; gl_Position = vec4(aPos, 1.0); ourColor = aColor; // å°†ourColorè®¾ç½®ä¸ºæˆ‘ä»¬ä»é¡¶ç‚¹æ•°æ®é‚£é‡Œå¾—åˆ°çš„è¾“å…¥é¢œè‰²&#125; ç”±äºæˆ‘ä»¬ä¸å†ä½¿ç”¨uniformæ¥ä¼ é€’ç‰‡æ®µçš„é¢œè‰²äº†ï¼Œç°åœ¨ä½¿ç”¨ourColorè¾“å‡ºå˜é‡ï¼Œæˆ‘ä»¬å¿…é¡»å†ä¿®æ”¹ä¸€ä¸‹ç‰‡æ®µç€è‰²å™¨ï¼š #version 330 coreout vec4 FragColor; in vec3 ourColor;void main()&#123; FragColor = vec4(ourColor, 1.0);&#125; å› ä¸ºæˆ‘ä»¬æ·»åŠ äº†å¦ä¸€ä¸ªé¡¶ç‚¹å±æ€§ï¼Œå¹¶ä¸”æ›´æ–°äº†VBOçš„å†…å­˜ï¼Œæˆ‘ä»¬å°±å¿…é¡»é‡æ–°é…ç½®é¡¶ç‚¹å±æ€§æŒ‡é’ˆã€‚æ›´æ–°åçš„VBOå†…å­˜ä¸­çš„æ•°æ®ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼šçŸ¥é“äº†ç°åœ¨ä½¿ç”¨çš„å¸ƒå±€ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨glVertexAttribPointerå‡½æ•°æ›´æ–°é¡¶ç‚¹æ ¼å¼:// ä½ç½®å±æ€§glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(float), (void*)0);glEnableVertexAttribArray(0);// é¢œè‰²å±æ€§glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(float), (void*)(3* sizeof(float)));glEnableVertexAttribArray(1); ç”±äºæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸¤ä¸ªé¡¶ç‚¹å±æ€§ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡æ–°è®¡ç®—æ­¥é•¿å€¼ã€‚ä¸ºè·å¾—æ•°æ®é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªå±æ€§å€¼ï¼ˆæ¯”å¦‚ä½ç½®å‘é‡çš„ä¸‹ä¸ªxåˆ†é‡ï¼‰æˆ‘ä»¬å¿…é¡»å‘å³ç§»åŠ¨6ä¸ªfloatï¼Œå…¶ä¸­3ä¸ªæ˜¯ä½ç½®å€¼ï¼Œå¦å¤–3ä¸ªæ˜¯é¢œè‰²å€¼.è¿™ä½¿æˆ‘ä»¬çš„æ­¥é•¿å€¼ä¸º6ä¹˜ä»¥floatçš„å­—èŠ‚æ•°ï¼ˆ=24å­—èŠ‚ï¼‰. åŒæ ·ï¼Œè¿™æ¬¡æˆ‘ä»¬å¿…é¡»æŒ‡å®šä¸€ä¸ªåç§»é‡ã€‚å¯¹äºæ¯ä¸ªé¡¶ç‚¹æ¥è¯´ï¼Œä½ç½®é¡¶ç‚¹å±æ€§åœ¨å‰ï¼Œæ‰€ä»¥å®ƒçš„åç§»é‡æ˜¯0ã€‚é¢œè‰²å±æ€§ç´§éšä½ç½®æ•°æ®ä¹‹åï¼Œæ‰€ä»¥åç§»é‡å°±æ˜¯3 * sizeof(float)ï¼Œç”¨å­—èŠ‚æ¥è®¡ç®—å°±æ˜¯12å­—èŠ‚. æˆ‘ä»¬åªè®¾ç½®äº†3ä¸ªé¢œè‰²,ä½†å´å¾—åˆ°äº†è€Œä¸€ä¸ªè°ƒè‰²æ¿,è¿™æ˜¯åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è¿›è¡Œçš„æ‰€è°“ç‰‡æ®µæ’å€¼(Fragment Interpolation)çš„ç»“æœ.å½“æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢æ—¶ï¼Œå…‰æ …åŒ–(Rasterization)é˜¶æ®µé€šå¸¸ä¼šé€ æˆæ¯”åŸæŒ‡å®šé¡¶ç‚¹æ›´å¤šçš„ç‰‡æ®µ.å…‰æ …ä¼šæ ¹æ®æ¯ä¸ªç‰‡æ®µåœ¨ä¸‰è§’å½¢å½¢çŠ¶ä¸Šæ‰€å¤„ç›¸å¯¹ä½ç½®å†³å®šè¿™äº›ç‰‡æ®µçš„ä½ç½®.åŸºäºè¿™äº›ä½ç½®ï¼Œå®ƒä¼šæ’å€¼(Interpolate)æ‰€æœ‰ç‰‡æ®µç€è‰²å™¨çš„è¾“å…¥å˜é‡.æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªçº¿æ®µï¼Œä¸Šé¢çš„ç«¯ç‚¹æ˜¯ç»¿è‰²çš„ï¼Œä¸‹é¢çš„ç«¯ç‚¹æ˜¯è“è‰²çš„ã€‚å¦‚æœä¸€ä¸ªç‰‡æ®µç€è‰²å™¨åœ¨çº¿æ®µçš„70%çš„ä½ç½®è¿è¡Œï¼Œå®ƒçš„é¢œè‰²è¾“å…¥å±æ€§å°±ä¼šæ˜¯ä¸€ä¸ªç»¿è‰²å’Œè“è‰²çš„çº¿æ€§ç»“åˆï¼›æ›´ç²¾ç¡®åœ°è¯´å°±æ˜¯30%è“ + 70%ç»¿. çº¹ç†ä¸ºäº†èƒ½å¤ŸæŠŠçº¹ç†æ˜ å°„(Map)åˆ°ä¸‰è§’å½¢ä¸Šï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šä¸‰è§’å½¢çš„æ¯ä¸ªé¡¶ç‚¹å„è‡ªå¯¹åº”çº¹ç†çš„å“ªä¸ªéƒ¨åˆ†.è¿™æ ·æ¯ä¸ªé¡¶ç‚¹å°±ä¼šå…³è”ç€ä¸€ä¸ªçº¹ç†åæ ‡(Texture Coordinate)ï¼Œç”¨æ¥æ ‡æ˜è¯¥ä»çº¹ç†å›¾åƒçš„å“ªä¸ªéƒ¨åˆ†é‡‡æ ·ï¼ˆè¯‘æ³¨ï¼šé‡‡é›†ç‰‡æ®µé¢œè‰²ï¼‰.ä¹‹ååœ¨å›¾å½¢çš„å…¶å®ƒç‰‡æ®µä¸Šè¿›è¡Œç‰‡æ®µæ’å€¼(Fragment Interpolation). çº¹ç†åæ ‡åœ¨xå’Œyè½´ä¸Šï¼ŒèŒƒå›´ä¸º0åˆ°1ä¹‹é—´ï¼ˆæ³¨æ„æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2Dçº¹ç†å›¾åƒï¼‰.ä½¿ç”¨çº¹ç†åæ ‡è·å–çº¹ç†é¢œè‰²å«åšé‡‡æ ·(Sampling).çº¹ç†åæ ‡èµ·å§‹äº(0, 0)ï¼Œä¹Ÿå°±æ˜¯çº¹ç†å›¾ç‰‡çš„å·¦ä¸‹è§’ï¼Œç»ˆå§‹äº(1, 1)ï¼Œå³çº¹ç†å›¾ç‰‡çš„å³ä¸Šè§’.ä¸‹é¢çš„å›¾ç‰‡å±•ç¤ºäº†æˆ‘ä»¬æ˜¯å¦‚ä½•æŠŠçº¹ç†åæ ‡æ˜ å°„åˆ°ä¸‰è§’å½¢ä¸Šçš„.çº¹ç†åæ ‡çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š float texCoords[] = &#123; 0.0f, 0.0f, // å·¦ä¸‹è§’ 1.0f, 0.0f, // å³ä¸‹è§’ 0.5f, 1.0f // ä¸Šä¸­&#125;; çº¹ç†ç¯ç»•æ–¹å¼çº¹ç†åæ ‡çš„èŒƒå›´é€šå¸¸æ˜¯ä»(0, 0)åˆ°(1, 1)ï¼Œé‚£å¦‚æœæˆ‘ä»¬æŠŠçº¹ç†åæ ‡è®¾ç½®åœ¨èŒƒå›´ä¹‹å¤–ä¼šå‘ç”Ÿä»€ä¹ˆï¼ŸOpenGLé»˜è®¤çš„è¡Œä¸ºæ˜¯é‡å¤è¿™ä¸ªçº¹ç†å›¾åƒï¼ˆæˆ‘ä»¬åŸºæœ¬ä¸Šå¿½ç•¥æµ®ç‚¹çº¹ç†åæ ‡çš„æ•´æ•°éƒ¨åˆ†ï¼‰ï¼Œä½†OpenGLæä¾›äº†æ›´å¤šçš„é€‰æ‹©ï¼šå‰é¢æåˆ°çš„æ¯ä¸ªé€‰é¡¹éƒ½å¯ä»¥ä½¿ç”¨glTexParameter*å‡½æ•°å¯¹å•ç‹¬çš„ä¸€ä¸ªåæ ‡è½´è®¾ç½®ï¼ˆsã€tï¼ˆå¦‚æœæ˜¯ä½¿ç”¨3Dçº¹ç†é‚£ä¹ˆè¿˜æœ‰ä¸€ä¸ªrï¼‰å®ƒä»¬å’Œxã€yã€zæ˜¯ç­‰ä»·çš„ï¼‰ï¼š glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_MIRRORED_REPEAT);glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_MIRRORED_REPEAT); ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†çº¹ç†ç›®æ ‡ï¼›æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2Dçº¹ç†ï¼Œå› æ­¤çº¹ç†ç›®æ ‡æ˜¯GL_TEXTURE_2D.ç¬¬äºŒä¸ªå‚æ•°éœ€è¦æˆ‘ä»¬æŒ‡å®šè®¾ç½®çš„é€‰é¡¹ä¸åº”ç”¨çš„çº¹ç†è½´.æˆ‘ä»¬æ‰“ç®—é…ç½®çš„æ˜¯WRAPé€‰é¡¹ï¼Œå¹¶ä¸”æŒ‡å®šSå’ŒTè½´.æœ€åä¸€ä¸ªå‚æ•°éœ€è¦æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªç¯ç»•æ–¹å¼(Wrapping)ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­OpenGLä¼šç»™å½“å‰æ¿€æ´»çš„çº¹ç†è®¾å®šçº¹ç†ç¯ç»•æ–¹å¼ä¸ºGL_MIRRORED_REPEAT. å¦‚æœæˆ‘ä»¬é€‰æ‹©GL_CLAMP_TO_BORDERé€‰é¡¹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªè¾¹ç¼˜çš„é¢œè‰².è¿™éœ€è¦ä½¿ç”¨glTexParameterå‡½æ•°çš„fvåç¼€å½¢å¼ï¼Œç”¨GL_TEXTURE_BORDER_COLORä½œä¸ºå®ƒçš„é€‰é¡¹ï¼Œå¹¶ä¸”ä¼ é€’ä¸€ä¸ªfloatæ•°ç»„ä½œä¸ºè¾¹ç¼˜çš„é¢œè‰²å€¼ï¼š float borderColor[] = &#123; 1.0f, 1.0f, 0.0f, 1.0f &#125;;glTexParameterfv(GL_TEXTURE_2D, GL_TEXTURE_BORDER_COLOR, borderColor); çº¹ç†è¿‡æ»¤çº¹ç†åæ ‡ä¸ä¾èµ–äºåˆ†è¾¨ç‡(Resolution)ï¼Œå®ƒå¯ä»¥æ˜¯ä»»æ„æµ®ç‚¹å€¼ï¼Œæ‰€ä»¥OpenGLéœ€è¦çŸ¥é“æ€æ ·å°†çº¹ç†åƒç´ (Texture Pixelï¼Œä¹Ÿå«Texelï¼Œè¯‘æ³¨1)æ˜ å°„åˆ°çº¹ç†åæ ‡.å½“ä½ æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç‰©ä½“ä½†æ˜¯çº¹ç†çš„åˆ†è¾¨ç‡å¾ˆä½çš„æ—¶å€™è¿™å°±å˜å¾—å¾ˆé‡è¦äº†.ä½ å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼ŒOpenGLä¹Ÿæœ‰å¯¹äºçº¹ç†è¿‡æ»¤(Texture Filtering)çš„é€‰é¡¹.çº¹ç†è¿‡æ»¤æœ‰å¾ˆå¤šä¸ªé€‰é¡¹ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åªè®¨è®ºæœ€é‡è¦çš„ä¸¤ç§ï¼šGL_NEARESTå’ŒGL_LINEAR. GL_NEARESTï¼ˆä¹Ÿå«é‚»è¿‘è¿‡æ»¤ï¼ŒNearest Neighbor Filteringï¼‰æ˜¯OpenGLé»˜è®¤çš„çº¹ç†è¿‡æ»¤æ–¹å¼.å½“è®¾ç½®ä¸ºGL_NEARESTçš„æ—¶å€™ï¼ŒOpenGLä¼šé€‰æ‹©ä¸­å¿ƒç‚¹æœ€æ¥è¿‘çº¹ç†åæ ‡çš„é‚£ä¸ªåƒç´ .ä¸‹å›¾ä¸­ä½ å¯ä»¥çœ‹åˆ°å››ä¸ªåƒç´ ï¼ŒåŠ å·ä»£è¡¨çº¹ç†åæ ‡.å·¦ä¸Šè§’é‚£ä¸ªçº¹ç†åƒç´ çš„ä¸­å¿ƒè·ç¦»çº¹ç†åæ ‡æœ€è¿‘ï¼Œæ‰€ä»¥å®ƒä¼šè¢«é€‰æ‹©ä¸ºæ ·æœ¬é¢œè‰²ï¼šGL_LINEARï¼ˆä¹Ÿå«çº¿æ€§è¿‡æ»¤ï¼Œ(Bi)linear Filteringï¼‰å®ƒä¼šåŸºäºçº¹ç†åæ ‡é™„è¿‘çš„çº¹ç†åƒç´ ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ’å€¼ï¼Œè¿‘ä¼¼å‡ºè¿™äº›çº¹ç†åƒç´ ä¹‹é—´çš„é¢œè‰².ä¸€ä¸ªçº¹ç†åƒç´ çš„ä¸­å¿ƒè·ç¦»çº¹ç†åæ ‡è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¹ç†åƒç´ çš„é¢œè‰²å¯¹æœ€ç»ˆçš„æ ·æœ¬é¢œè‰²çš„è´¡çŒ®è¶Šå¤§.ä¸‹å›¾ä¸­ä½ å¯ä»¥çœ‹åˆ°è¿”å›çš„é¢œè‰²æ˜¯é‚»è¿‘åƒç´ çš„æ··åˆè‰²ï¼šGL_NEARESTäº§ç”Ÿäº†é¢—ç²’çŠ¶çš„å›¾æ¡ˆï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¸…æ™°çœ‹åˆ°ç»„æˆçº¹ç†çš„åƒç´ ï¼Œè€ŒGL_LINEARèƒ½å¤Ÿäº§ç”Ÿæ›´å¹³æ»‘çš„å›¾æ¡ˆï¼Œå¾ˆéš¾çœ‹å‡ºå•ä¸ªçš„çº¹ç†åƒç´ .GL_LINEARå¯ä»¥äº§ç”Ÿæ›´çœŸå®çš„è¾“å‡ºï¼Œä½†æœ‰äº›å¼€å‘è€…æ›´å–œæ¬¢8-bité£æ ¼ï¼Œæ‰€ä»¥ä»–ä»¬ä¼šç”¨GL_NEARESTé€‰é¡¹. å½“è¿›è¡Œæ”¾å¤§(Magnify)å’Œç¼©å°(Minify)æ“ä½œçš„æ—¶å€™å¯ä»¥è®¾ç½®çº¹ç†è¿‡æ»¤çš„é€‰é¡¹ï¼Œæ¯”å¦‚ä½ å¯ä»¥åœ¨çº¹ç†è¢«ç¼©å°çš„æ—¶å€™ä½¿ç”¨é‚»è¿‘è¿‡æ»¤ï¼Œè¢«æ”¾å¤§æ—¶ä½¿ç”¨çº¿æ€§è¿‡æ»¤ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨glTexParameter*å‡½æ•°ä¸ºæ”¾å¤§å’Œç¼©å°æŒ‡å®šè¿‡æ»¤æ–¹å¼.è¿™æ®µä»£ç çœ‹èµ·æ¥ä¼šå’Œçº¹ç†ç¯ç»•æ–¹å¼çš„è®¾ç½®å¾ˆç›¸ä¼¼ï¼š glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); å¤šçº§æ¸è¿œçº¹ç†æƒ³è±¡ä¸€ä¸‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ç€ä¸Šåƒç‰©ä½“çš„å¤§æˆ¿é—´ï¼Œæ¯ä¸ªç‰©ä½“ä¸Šéƒ½æœ‰çº¹ç†ã€‚æœ‰äº›ç‰©ä½“ä¼šå¾ˆè¿œï¼Œä½†å…¶çº¹ç†ä¼šæ‹¥æœ‰ä¸è¿‘å¤„ç‰©ä½“åŒæ ·é«˜çš„åˆ†è¾¨ç‡.ç”±äºè¿œå¤„çš„ç‰©ä½“å¯èƒ½åªäº§ç”Ÿå¾ˆå°‘çš„ç‰‡æ®µï¼ŒOpenGLä»é«˜åˆ†è¾¨ç‡çº¹ç†ä¸­ä¸ºè¿™äº›ç‰‡æ®µè·å–æ­£ç¡®çš„é¢œè‰²å€¼å°±å¾ˆå›°éš¾ï¼Œå› ä¸ºå®ƒéœ€è¦å¯¹ä¸€ä¸ªè·¨è¿‡çº¹ç†å¾ˆå¤§éƒ¨åˆ†çš„ç‰‡æ®µåªæ‹¾å–ä¸€ä¸ªçº¹ç†é¢œè‰².åœ¨å°ç‰©ä½“ä¸Šè¿™ä¼šäº§ç”Ÿä¸çœŸå®çš„æ„Ÿè§‰ï¼Œæ›´ä¸ç”¨è¯´å¯¹å®ƒä»¬ä½¿ç”¨é«˜åˆ†è¾¨ç‡çº¹ç†æµªè´¹å†…å­˜çš„é—®é¢˜äº†. OpenGLä½¿ç”¨ä¸€ç§å«åšå¤šçº§æ¸è¿œçº¹ç†(Mipmap)çš„æ¦‚å¿µæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒç®€å•æ¥è¯´å°±æ˜¯ä¸€ç³»åˆ—çš„çº¹ç†å›¾åƒï¼Œåä¸€ä¸ªçº¹ç†å›¾åƒæ˜¯å‰ä¸€ä¸ªçš„äºŒåˆ†ä¹‹ä¸€.å¤šçº§æ¸è¿œçº¹ç†èƒŒåçš„ç†å¿µå¾ˆç®€å•ï¼šè·è§‚å¯Ÿè€…çš„è·ç¦»è¶…è¿‡ä¸€å®šçš„é˜ˆå€¼ï¼ŒOpenGLä¼šä½¿ç”¨ä¸åŒçš„å¤šçº§æ¸è¿œçº¹ç†ï¼Œå³æœ€é€‚åˆç‰©ä½“çš„è·ç¦»çš„é‚£ä¸ª.ç”±äºè·ç¦»è¿œï¼Œè§£æåº¦ä¸é«˜ä¹Ÿä¸ä¼šè¢«ç”¨æˆ·æ³¨æ„åˆ°.åŒæ—¶ï¼Œå¤šçº§æ¸è¿œçº¹ç†å¦ä¸€åŠ åˆ†ä¹‹å¤„æ˜¯å®ƒçš„æ€§èƒ½éå¸¸å¥½.è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¤šçº§æ¸è¿œçº¹ç†æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼šæ‰‹å·¥ä¸ºæ¯ä¸ªçº¹ç†å›¾åƒåˆ›å»ºä¸€ç³»åˆ—å¤šçº§æ¸è¿œçº¹ç†å¾ˆéº»çƒ¦ï¼Œå¹¸å¥½OpenGLæœ‰ä¸€ä¸ªglGenerateMipmapså‡½æ•°ï¼Œåœ¨åˆ›å»ºå®Œä¸€ä¸ªçº¹ç†åè°ƒç”¨å®ƒOpenGLå°±ä¼šæ‰¿æ‹…æ¥ä¸‹æ¥çš„æ‰€æœ‰å·¥ä½œäº†. åœ¨æ¸²æŸ“ä¸­åˆ‡æ¢å¤šçº§æ¸è¿œçº¹ç†çº§åˆ«(Level)æ—¶ï¼ŒOpenGLåœ¨ä¸¤ä¸ªä¸åŒçº§åˆ«çš„å¤šçº§æ¸è¿œçº¹ç†å±‚ä¹‹é—´ä¼šäº§ç”Ÿä¸çœŸå®çš„ç”Ÿç¡¬è¾¹ç•Œ.å°±åƒæ™®é€šçš„çº¹ç†è¿‡æ»¤ä¸€æ ·ï¼Œåˆ‡æ¢å¤šçº§æ¸è¿œçº¹ç†çº§åˆ«æ—¶ä½ ä¹Ÿå¯ä»¥åœ¨ä¸¤ä¸ªä¸åŒå¤šçº§æ¸è¿œçº¹ç†çº§åˆ«ä¹‹é—´ä½¿ç”¨NEARESTå’ŒLINEARè¿‡æ»¤.ä¸ºäº†æŒ‡å®šä¸åŒå¤šçº§æ¸è¿œçº¹ç†çº§åˆ«ä¹‹é—´çš„è¿‡æ»¤æ–¹å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢å››ä¸ªé€‰é¡¹ä¸­çš„ä¸€ä¸ªä»£æ›¿åŸæœ‰çš„è¿‡æ»¤æ–¹å¼ï¼šå°±åƒçº¹ç†è¿‡æ»¤ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨glTexParameteriå°†è¿‡æ»¤æ–¹å¼è®¾ç½®ä¸ºå‰é¢å››ç§æåˆ°çš„æ–¹æ³•ä¹‹ä¸€ï¼š glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯ï¼Œå°†æ”¾å¤§è¿‡æ»¤çš„é€‰é¡¹è®¾ç½®ä¸ºå¤šçº§æ¸è¿œçº¹ç†è¿‡æ»¤é€‰é¡¹ä¹‹ä¸€.è¿™æ ·æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œå› ä¸ºå¤šçº§æ¸è¿œçº¹ç†ä¸»è¦æ˜¯ä½¿ç”¨åœ¨çº¹ç†è¢«ç¼©å°çš„æƒ…å†µä¸‹çš„ï¼šçº¹ç†æ”¾å¤§ä¸ä¼šä½¿ç”¨å¤šçº§æ¸è¿œçº¹ç†ï¼Œä¸ºæ”¾å¤§è¿‡æ»¤è®¾ç½®å¤šçº§æ¸è¿œçº¹ç†çš„é€‰é¡¹ä¼šäº§ç”Ÿä¸€ä¸ªGL_INVALID_ENUMé”™è¯¯ä»£ç . åŠ è½½ä¸åˆ›å»ºçº¹ç†ä½¿ç”¨ä¸€ä¸ªæ”¯æŒå¤šç§æµè¡Œæ ¼å¼çš„å›¾åƒåŠ è½½åº“æ¥ä¸ºæˆ‘ä»¬è§£å†³å›¾åƒåŠ è½½çš„é—®é¢˜,æ¯”å¦‚è¯´æˆ‘ä»¬è¦ç”¨çš„stb_image.håº“. stb_image.hstb_image.hå¯ä»¥åœ¨è¿™é‡Œä¸‹è½½. #define STB_IMAGE_IMPLEMENTATION#include \"stb_image.h\" é€šè¿‡å®šä¹‰STB_IMAGE_IMPLEMENTATIONï¼Œé¢„å¤„ç†å™¨ä¼šä¿®æ”¹å¤´æ–‡ä»¶ï¼Œè®©å…¶åªåŒ…å«ç›¸å…³çš„å‡½æ•°å®šä¹‰æºç ï¼Œç­‰äºæ˜¯å°†è¿™ä¸ªå¤´æ–‡ä»¶å˜ä¸ºä¸€ä¸ª .cpp æ–‡ä»¶äº†.ç°åœ¨åªéœ€è¦åœ¨ä½ çš„ç¨‹åºä¸­åŒ…å«stb_image.hå¹¶ç¼–è¯‘å°±å¯ä»¥äº†. int width, height, nrChannels;unsigned char *data = stbi_load(\"container.jpg\", &amp;width, &amp;height, &amp;nrChannels, 0); è¿™ä¸ªå‡½æ•°é¦–å…ˆæ¥å—ä¸€ä¸ªå›¾åƒæ–‡ä»¶çš„ä½ç½®ä½œä¸ºè¾“å…¥ã€‚æ¥ä¸‹æ¥å®ƒéœ€è¦ä¸‰ä¸ªintä½œä¸ºå®ƒçš„ç¬¬äºŒã€ç¬¬ä¸‰å’Œç¬¬å››ä¸ªå‚æ•°ï¼Œstb_image.hå°†ä¼šç”¨å›¾åƒçš„å®½åº¦ã€é«˜åº¦å’Œé¢œè‰²é€šé“çš„ä¸ªæ•°å¡«å……è¿™ä¸‰ä¸ªå˜é‡ã€‚æˆ‘ä»¬ä¹‹åç”Ÿæˆçº¹ç†çš„æ—¶å€™ä¼šç”¨åˆ°çš„å›¾åƒçš„å®½åº¦å’Œé«˜åº¦çš„. ç”Ÿæˆçº¹ç†å’Œä¹‹å‰ç”Ÿæˆçš„OpenGLå¯¹è±¡ä¸€æ ·ï¼Œçº¹ç†ä¹Ÿæ˜¯ä½¿ç”¨IDå¼•ç”¨çš„. unsigned int texture;glGenTextures(1, &amp;texture); glGenTextureså‡½æ•°é¦–å…ˆéœ€è¦è¾“å…¥ç”Ÿæˆçº¹ç†çš„æ•°é‡ï¼Œç„¶åæŠŠå®ƒä»¬å‚¨å­˜åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„unsigned intæ•°ç»„ä¸­ï¼ˆæˆ‘ä»¬çš„ä¾‹å­ä¸­åªæ˜¯å•ç‹¬çš„ä¸€ä¸ªunsigned intï¼‰ï¼Œå°±åƒå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ç»‘å®šå®ƒï¼Œè®©ä¹‹åä»»ä½•çš„çº¹ç†æŒ‡ä»¤éƒ½å¯ä»¥é…ç½®å½“å‰ç»‘å®šçš„çº¹ç†ï¼š glBindTexture(GL_TEXTURE_2D, texture); ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†çº¹ç†ç›®æ ‡(Target).è®¾ç½®ä¸ºGL_TEXTURE_2Dæ„å‘³ç€ä¼šç”Ÿæˆä¸å½“å‰ç»‘å®šçš„çº¹ç†å¯¹è±¡åœ¨åŒä¸€ä¸ªç›®æ ‡ä¸Šçš„çº¹ç†ï¼ˆä»»ä½•ç»‘å®šåˆ°GL_TEXTURE_1Då’ŒGL_TEXTURE_3Dçš„çº¹ç†ä¸ä¼šå—åˆ°å½±å“ï¼‰. ç¬¬äºŒä¸ªå‚æ•°ä¸ºçº¹ç†æŒ‡å®šå¤šçº§æ¸è¿œçº¹ç†çš„çº§åˆ«ï¼Œå¦‚æœä½ å¸Œæœ›å•ç‹¬æ‰‹åŠ¨è®¾ç½®æ¯ä¸ªå¤šçº§æ¸è¿œçº¹ç†çš„çº§åˆ«çš„è¯.è¿™é‡Œæˆ‘ä»¬å¡«0ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬çº§åˆ«. ç¬¬ä¸‰ä¸ªå‚æ•°å‘Šè¯‰OpenGLæˆ‘ä»¬å¸Œæœ›æŠŠçº¹ç†å‚¨å­˜ä¸ºä½•ç§æ ¼å¼.æˆ‘ä»¬çš„å›¾åƒåªæœ‰RGBå€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¹ŸæŠŠçº¹ç†å‚¨å­˜ä¸ºRGBå€¼. ç¬¬å››ä¸ªå’Œç¬¬äº”ä¸ªå‚æ•°è®¾ç½®æœ€ç»ˆçš„çº¹ç†çš„å®½åº¦å’Œé«˜åº¦.æˆ‘ä»¬ä¹‹å‰åŠ è½½å›¾åƒçš„æ—¶å€™å‚¨å­˜äº†å®ƒä»¬ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å¯¹åº”çš„å˜é‡. ä¸‹ä¸ªå‚æ•°åº”è¯¥æ€»æ˜¯è¢«è®¾ä¸º0ï¼ˆå†å²é—ç•™çš„é—®é¢˜ï¼‰. ç¬¬ä¸ƒç¬¬å…«ä¸ªå‚æ•°å®šä¹‰äº†æºå›¾çš„æ ¼å¼å’Œæ•°æ®ç±»å‹ã€‚æˆ‘ä»¬ä½¿ç”¨RGBå€¼åŠ è½½è¿™ä¸ªå›¾åƒï¼Œå¹¶æŠŠå®ƒä»¬å‚¨å­˜ä¸ºchar(byte)æ•°ç»„ï¼Œæˆ‘ä»¬å°†ä¼šä¼ å…¥å¯¹åº”å€¼. æœ€åä¸€ä¸ªå‚æ•°æ˜¯çœŸæ­£çš„å›¾åƒæ•°æ®. å½“è°ƒç”¨glTexImage2Dæ—¶ï¼Œå½“å‰ç»‘å®šçš„çº¹ç†å¯¹è±¡å°±ä¼šè¢«é™„åŠ ä¸Šçº¹ç†å›¾åƒ.ç„¶è€Œï¼Œç›®å‰åªæœ‰åŸºæœ¬çº§åˆ«(Base-level)çš„çº¹ç†å›¾åƒè¢«åŠ è½½äº†ï¼Œå¦‚æœè¦ä½¿ç”¨å¤šçº§æ¸è¿œçº¹ç†ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è®¾ç½®æ‰€æœ‰ä¸åŒçš„å›¾åƒï¼ˆä¸æ–­é€’å¢ç¬¬äºŒä¸ªå‚æ•°ï¼‰.æˆ–è€…ï¼Œç›´æ¥åœ¨ç”Ÿæˆçº¹ç†ä¹‹åè°ƒç”¨glGenerateMipmap.è¿™ä¼šä¸ºå½“å‰ç»‘å®šçš„çº¹ç†è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰éœ€è¦çš„å¤šçº§æ¸è¿œçº¹ç†. ç”Ÿæˆäº†çº¹ç†å’Œç›¸åº”çš„å¤šçº§æ¸è¿œçº¹ç†åï¼Œé‡Šæ”¾å›¾åƒçš„å†…å­˜æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯. stbi_image_free(data); å˜æ¢ä¸‰ç»´æ—‹è½¬å…¬å¼åˆ©ç”¨æ—‹è½¬çŸ©é˜µæˆ‘ä»¬å¯ä»¥æŠŠä»»æ„ä½ç½®å‘é‡æ²¿ä¸€ä¸ªå•ä½æ—‹è½¬è½´è¿›è¡Œæ—‹è½¬ã€‚ä¹Ÿå¯ä»¥å°†å¤šä¸ªçŸ©é˜µå¤åˆï¼Œæ¯”å¦‚å…ˆæ²¿ç€xè½´æ—‹è½¬å†æ²¿ç€yè½´æ—‹è½¬.ä½†æ˜¯è¿™ä¼šå¾ˆå¿«å¯¼è‡´ä¸€ä¸ªé—®é¢˜â€”â€”ä¸‡å‘èŠ‚æ­»é”ï¼ˆGimbal Lockï¼‰.è¿™æ ·çš„ä¸€ä¸ªï¼ˆè¶…çº§éº»çƒ¦çš„ï¼‰çŸ©é˜µæ˜¯å­˜åœ¨çš„ï¼Œè§ä¸‹é¢è¿™ä¸ªå…¬å¼ï¼Œå…¶ä¸­(Rx,Ry,Rz)ä»£è¡¨ä»»æ„æ—‹è½¬è½´ï¼šå³ä½¿è¿™æ ·ä¸€ä¸ªçŸ©é˜µä¹Ÿä¸èƒ½å®Œå…¨è§£å†³ä¸‡å‘èŠ‚æ­»é”é—®é¢˜ï¼ˆå°½ç®¡ä¼šæå¤§åœ°é¿å…ï¼‰.é¿å…ä¸‡å‘èŠ‚æ­»é”çš„çœŸæ­£è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å››å…ƒæ•°(Quaternion)ï¼Œå®ƒä¸ä»…æ›´å®‰å…¨ï¼Œè€Œä¸”è®¡ç®—ä¼šæ›´æœ‰æ•ˆç‡ã€‚å››å…ƒæ•°å¯èƒ½ä¼šåœ¨åé¢çš„æ•™ç¨‹ä¸­è®¨è®º.ç›¸å…³èµ„æ–™:å››å…ƒæ•°ä¸‡å‘èŠ‚æ­»é”ä¸‡å‘èŠ‚æ­»é”çš„ç†è§£ çŸ©é˜µçš„ç»„åˆå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¶ç‚¹(x, y, z)ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶ç¼©æ”¾2å€ï¼Œç„¶åä½ç§»(1, 2, 3)ä¸ªå•ä½.æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä½ç§»å’Œç¼©æ”¾çŸ©é˜µæ¥å®Œæˆè¿™äº›å˜æ¢.ç»“æœçš„å˜æ¢çŸ©é˜µçœ‹èµ·æ¥åƒè¿™æ ·ï¼š åæ ‡ç³»ç»Ÿé€è§†æŠ•å½±å¦‚æœä½ æ›¾ç»ä½“éªŒè¿‡å®é™…ç”Ÿæ´»ç»™ä½ å¸¦æ¥çš„æ™¯è±¡ï¼Œä½ å°±ä¼šæ³¨æ„åˆ°ç¦»ä½ è¶Šè¿œçš„ä¸œè¥¿çœ‹èµ·æ¥æ›´å°.è¿™ä¸ªå¥‡æ€ªçš„æ•ˆæœç§°ä¹‹ä¸ºé€è§†(Perspective).é€è§†çš„æ•ˆæœåœ¨æˆ‘ä»¬çœ‹ä¸€æ¡æ— é™é•¿çš„é«˜é€Ÿå…¬è·¯æˆ–é“è·¯æ—¶å°¤å…¶æ˜æ˜¾ï¼Œæ­£å¦‚ä¸‹é¢å›¾ç‰‡æ˜¾ç¤ºçš„é‚£æ ·ï¼šæ­£å¦‚ä½ çœ‹åˆ°çš„é‚£æ ·ï¼Œç”±äºé€è§†ï¼Œè¿™ä¸¤æ¡çº¿åœ¨å¾ˆè¿œçš„åœ°æ–¹çœ‹èµ·æ¥ä¼šç›¸äº¤.è¿™æ­£æ˜¯é€è§†æŠ•å½±æƒ³è¦æ¨¡ä»¿çš„æ•ˆæœï¼Œå®ƒæ˜¯ä½¿ç”¨é€è§†æŠ•å½±çŸ©é˜µæ¥å®Œæˆçš„.è¿™ä¸ªæŠ•å½±çŸ©é˜µå°†ç»™å®šçš„å¹³æˆªå¤´ä½“èŒƒå›´æ˜ å°„åˆ°è£å‰ªç©ºé—´ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜ä¿®æ”¹äº†æ¯ä¸ªé¡¶ç‚¹åæ ‡çš„wå€¼ï¼Œä»è€Œä½¿å¾—ç¦»è§‚å¯Ÿè€…è¶Šè¿œçš„é¡¶ç‚¹åæ ‡wåˆ†é‡è¶Šå¤§.è¢«å˜æ¢åˆ°è£å‰ªç©ºé—´çš„åæ ‡éƒ½ä¼šåœ¨-wåˆ°wçš„èŒƒå›´ä¹‹é—´ï¼ˆä»»ä½•å¤§äºè¿™ä¸ªèŒƒå›´çš„åæ ‡éƒ½ä¼šè¢«è£å‰ªæ‰ï¼‰.OpenGLè¦æ±‚æ‰€æœ‰å¯è§çš„åæ ‡éƒ½è½åœ¨-1.0åˆ°1.0èŒƒå›´å†…ï¼Œä½œä¸ºé¡¶ç‚¹ç€è‰²å™¨æœ€åçš„è¾“å‡ºï¼Œå› æ­¤ï¼Œä¸€æ—¦åæ ‡åœ¨è£å‰ªç©ºé—´å†…ä¹‹åï¼Œé€è§†é™¤æ³•å°±ä¼šè¢«åº”ç”¨åˆ°è£å‰ªç©ºé—´åæ ‡ä¸Šï¼šé¡¶ç‚¹åæ ‡çš„æ¯ä¸ªåˆ†é‡éƒ½ä¼šé™¤ä»¥å®ƒçš„wåˆ†é‡ï¼Œè·ç¦»è§‚å¯Ÿè€…è¶Šè¿œé¡¶ç‚¹åæ ‡å°±ä¼šè¶Šå°.è¿™æ˜¯ä¹Ÿæ˜¯wåˆ†é‡éå¸¸é‡è¦çš„å¦ä¸€ä¸ªåŸå› ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬è¿›è¡Œé€è§†æŠ•å½±ã€‚æœ€åçš„ç»“æœåæ ‡å°±æ˜¯å¤„äºæ ‡å‡†åŒ–è®¾å¤‡ç©ºé—´ä¸­çš„.å¦‚æœä½ å¯¹æ­£å°„æŠ•å½±çŸ©é˜µå’Œé€è§†æŠ•å½±çŸ©é˜µæ˜¯å¦‚ä½•è®¡ç®—çš„å¾ˆæ„Ÿå…´è¶£ï¼ˆä¸”ä¸ä¼šå¯¹æ•°å­¦æ„Ÿåˆ°ææƒ§çš„è¯ï¼‰æˆ‘æ¨èè¿™ç¯‡ç”±Songhoå†™çš„æ–‡ç« .åœ¨GLMä¸­å¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªé€è§†æŠ•å½±çŸ©é˜µï¼š glm::mat4 proj = glm::perspective(glm::radians(45.0f), (float)width/(float)height, 0.1f, 100.0f); åŒæ ·ï¼Œglm::perspectiveæ‰€åšçš„å…¶å®å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå®šä¹‰äº†å¯è§†ç©ºé—´çš„å¤§å¹³æˆªå¤´ä½“ï¼Œä»»ä½•åœ¨è¿™ä¸ªå¹³æˆªå¤´ä½“ä»¥å¤–çš„ä¸œè¥¿æœ€åéƒ½ä¸ä¼šå‡ºç°åœ¨è£å‰ªç©ºé—´ä½“ç§¯å†…ï¼Œå¹¶ä¸”å°†ä¼šå—åˆ°è£å‰ª.ä¸€ä¸ªé€è§†å¹³æˆªå¤´ä½“å¯ä»¥è¢«çœ‹ä½œä¸€ä¸ªä¸å‡åŒ€å½¢çŠ¶çš„ç®±å­ï¼Œåœ¨è¿™ä¸ªç®±å­å†…éƒ¨çš„æ¯ä¸ªåæ ‡éƒ½ä¼šè¢«æ˜ å°„åˆ°è£å‰ªç©ºé—´ä¸Šçš„ä¸€ä¸ªç‚¹.ä¸‹é¢æ˜¯ä¸€å¼ é€è§†å¹³æˆªå¤´ä½“çš„å›¾ç‰‡ï¼šå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰äº†fovçš„å€¼ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯è§†é‡(Field of View)ï¼Œå¹¶ä¸”è®¾ç½®äº†è§‚å¯Ÿç©ºé—´çš„å¤§å°.å¦‚æœæƒ³è¦ä¸€ä¸ªçœŸå®çš„è§‚å¯Ÿæ•ˆæœï¼Œå®ƒçš„å€¼é€šå¸¸è®¾ç½®ä¸º45.0fï¼Œä½†æƒ³è¦ä¸€ä¸ªæœ«æ—¥é£æ ¼çš„ç»“æœä½ å¯ä»¥å°†å…¶è®¾ç½®ä¸€ä¸ªæ›´å¤§çš„å€¼.ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®äº†å®½é«˜æ¯”ï¼Œç”±è§†å£çš„å®½é™¤ä»¥é«˜æ‰€å¾—.ç¬¬ä¸‰å’Œç¬¬å››ä¸ªå‚æ•°è®¾ç½®äº†å¹³æˆªå¤´ä½“çš„è¿‘å’Œè¿œå¹³é¢ã€‚æˆ‘ä»¬é€šå¸¸è®¾ç½®è¿‘è·ç¦»ä¸º0.1fï¼Œè€Œè¿œè·ç¦»è®¾ä¸º100.0f.æ‰€æœ‰åœ¨è¿‘å¹³é¢å’Œè¿œå¹³é¢å†…ä¸”å¤„äºå¹³æˆªå¤´ä½“å†…çš„é¡¶ç‚¹éƒ½ä¼šè¢«æ¸²æŸ“. å½“ä½ æŠŠé€è§†çŸ©é˜µçš„ near å€¼è®¾ç½®å¤ªå¤§æ—¶ï¼ˆå¦‚10.0fï¼‰ï¼ŒOpenGLä¼šå°†é è¿‘æ‘„åƒæœºçš„åæ ‡ï¼ˆåœ¨0.0få’Œ10.0fä¹‹é—´ï¼‰éƒ½è£å‰ªæ‰ï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ªä½ åœ¨æ¸¸æˆä¸­å¾ˆç†Ÿæ‚‰çš„è§†è§‰æ•ˆæœï¼šåœ¨å¤ªè¿‡é è¿‘ä¸€ä¸ªç‰©ä½“çš„æ—¶å€™ä½ çš„è§†çº¿ä¼šç›´æ¥ç©¿è¿‡å». å½“ä½¿ç”¨æ­£å°„æŠ•å½±æ—¶ï¼Œæ¯ä¸€ä¸ªé¡¶ç‚¹åæ ‡éƒ½ä¼šç›´æ¥æ˜ å°„åˆ°è£å‰ªç©ºé—´ä¸­è€Œä¸ç»è¿‡ä»»ä½•ç²¾ç»†çš„é€è§†é™¤æ³•ï¼ˆå®ƒä»ç„¶ä¼šè¿›è¡Œé€è§†é™¤æ³•ï¼Œåªæ˜¯wåˆ†é‡æ²¡æœ‰è¢«æ”¹å˜ï¼ˆå®ƒä¿æŒä¸º1ï¼‰ï¼Œå› æ­¤æ²¡æœ‰èµ·ä½œç”¨ï¼‰.å› ä¸ºæ­£å°„æŠ•å½±æ²¡æœ‰ä½¿ç”¨é€è§†ï¼Œè¿œå¤„çš„ç‰©ä½“ä¸ä¼šæ˜¾å¾—æ›´å°ï¼Œæ‰€ä»¥äº§ç”Ÿå¥‡æ€ªçš„è§†è§‰æ•ˆæœ.ç”±äºè¿™ä¸ªåŸå› ï¼Œæ­£å°„æŠ•å½±ä¸»è¦ç”¨äºäºŒç»´æ¸²æŸ“ä»¥åŠä¸€äº›å»ºç­‘æˆ–å·¥ç¨‹çš„ç¨‹åºï¼Œåœ¨è¿™äº›åœºæ™¯ä¸­æˆ‘ä»¬æ›´å¸Œæœ›é¡¶ç‚¹ä¸ä¼šè¢«é€è§†æ‰€å¹²æ‰°.æŸäº›å¦‚ Blender ç­‰è¿›è¡Œä¸‰ç»´å»ºæ¨¡çš„è½¯ä»¶æœ‰æ—¶åœ¨å»ºæ¨¡æ—¶ä¹Ÿä¼šä½¿ç”¨æ­£å°„æŠ•å½±ï¼Œå› ä¸ºå®ƒåœ¨å„ä¸ªç»´åº¦ä¸‹éƒ½æ›´å‡†ç¡®åœ°æç»˜äº†æ¯ä¸ªç‰©ä½“ã€‚ä¸‹é¢ä½ èƒ½å¤Ÿçœ‹åˆ°åœ¨Blenderé‡Œé¢ä½¿ç”¨ä¸¤ç§æŠ•å½±æ–¹å¼çš„å¯¹æ¯”ï¼šä½ å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨é€è§†æŠ•å½±çš„è¯ï¼Œè¿œå¤„çš„é¡¶ç‚¹çœ‹èµ·æ¥æ¯”è¾ƒå°ï¼Œè€Œåœ¨æ­£å°„æŠ•å½±ä¸­æ¯ä¸ªé¡¶ç‚¹è·ç¦»è§‚å¯Ÿè€…çš„è·ç¦»éƒ½æ˜¯ä¸€æ ·çš„. Zç¼“å†²(æ·±åº¦ç¼“å†²)OpenGLå­˜å‚¨æ·±åº¦ä¿¡æ¯åœ¨ä¸€ä¸ªå«åšZç¼“å†²(Z-buffer)çš„ç¼“å†²ä¸­ï¼Œå®ƒå…è®¸OpenGLå†³å®šä½•æ—¶è¦†ç›–ä¸€ä¸ªåƒç´ è€Œä½•æ—¶ä¸è¦†ç›–.é€šè¿‡ä½¿ç”¨Zç¼“å†²ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®OpenGLæ¥è¿›è¡Œæ·±åº¦æµ‹è¯•. GLFWä¼šè‡ªåŠ¨ä¸ºä½ ç”Ÿæˆè¿™æ ·ä¸€ä¸ªç¼“å†²ï¼ˆå°±åƒå®ƒä¹Ÿæœ‰ä¸€ä¸ªé¢œè‰²ç¼“å†²æ¥å­˜å‚¨è¾“å‡ºå›¾åƒçš„é¢œè‰²ï¼‰.æ·±åº¦å€¼å­˜å‚¨åœ¨æ¯ä¸ªç‰‡æ®µé‡Œé¢ï¼ˆä½œä¸ºç‰‡æ®µçš„zå€¼ï¼‰ï¼Œå½“ç‰‡æ®µæƒ³è¦è¾“å‡ºå®ƒçš„é¢œè‰²æ—¶ï¼ŒOpenGLä¼šå°†å®ƒçš„æ·±åº¦å€¼å’Œzç¼“å†²è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå½“å‰çš„ç‰‡æ®µåœ¨å…¶å®ƒç‰‡æ®µä¹‹åï¼Œå®ƒå°†ä¼šè¢«ä¸¢å¼ƒï¼Œå¦åˆ™å°†ä¼šè¦†ç›–.è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ·±åº¦æµ‹è¯•(Depth Testing)ï¼Œå®ƒæ˜¯ç”±OpenGLè‡ªåŠ¨å®Œæˆçš„. glEnableå’ŒglDisableå‡½æ•°å…è®¸æˆ‘ä»¬å¯ç”¨æˆ–ç¦ç”¨æŸä¸ªOpenGLåŠŸèƒ½.è¿™ä¸ªåŠŸèƒ½ä¼šä¸€ç›´ä¿æŒå¯ç”¨/ç¦ç”¨çŠ¶æ€ï¼Œç›´åˆ°å¦ä¸€ä¸ªè°ƒç”¨æ¥ç¦ç”¨/å¯ç”¨å®ƒ.ç°åœ¨æˆ‘ä»¬æƒ³å¯ç”¨æ·±åº¦æµ‹è¯•ï¼Œéœ€è¦å¼€å¯GL_DEPTH_TESTï¼š glEnable(GL_DEPTH_TEST); å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†æ·±åº¦æµ‹è¯•ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³è¦åœ¨æ¯æ¬¡æ¸²æŸ“è¿­ä»£ä¹‹å‰æ¸…é™¤æ·±åº¦ç¼“å†²ï¼ˆå¦åˆ™å‰ä¸€å¸§çš„æ·±åº¦ä¿¡æ¯ä»ç„¶ä¿å­˜åœ¨ç¼“å†²ä¸­ï¼‰.å°±åƒæ¸…é™¤é¢œè‰²ç¼“å†²ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨glClearå‡½æ•°ä¸­æŒ‡å®šDEPTH_BUFFER_BITä½æ¥æ¸…é™¤æ·±åº¦ç¼“å†²ï¼š glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); æ‘„åƒæœº æ‘„åƒæœºæ–¹å‘æ‘„åƒæœºçš„æ–¹å‘æŒ‡çš„æ˜¯æ‘„åƒæœºæŒ‡å‘å“ªä¸ªæ–¹å‘.ç°åœ¨æˆ‘ä»¬è®©æ‘„åƒæœºæŒ‡å‘åœºæ™¯åŸç‚¹ï¼š(0, 0, 0).ç”¨åœºæ™¯åŸç‚¹å‘é‡å‡å»æ‘„åƒæœºä½ç½®å‘é‡çš„ç»“æœå°±æ˜¯æ‘„åƒæœºçš„æŒ‡å‘å‘é‡.ç”±äºæˆ‘ä»¬çŸ¥é“æ‘„åƒæœºæŒ‡å‘zè½´è´Ÿæ–¹å‘ï¼Œä½†æˆ‘ä»¬å¸Œæœ›æ–¹å‘å‘é‡(Direction Vector)æŒ‡å‘æ‘„åƒæœºçš„zè½´æ­£æ–¹å‘.å¦‚æœæˆ‘ä»¬äº¤æ¢ç›¸å‡çš„é¡ºåºï¼Œæˆ‘ä»¬å°±ä¼šè·å¾—ä¸€ä¸ªæŒ‡å‘æ‘„åƒæœºæ­£zè½´æ–¹å‘çš„å‘é‡ï¼š glm::vec3 cameraTarget = glm::vec3(0.0f, 0.0f, 0.0f);glm::vec3 cameraDirection = glm::normalize(cameraPos - cameraTarget); æ–¹å‘å‘é‡(Direction Vector)å¹¶ä¸æ˜¯æœ€å¥½çš„åå­—ï¼Œå› ä¸ºå®ƒå®é™…ä¸ŠæŒ‡å‘ä»å®ƒåˆ°ç›®æ ‡å‘é‡çš„ç›¸åæ–¹å‘ï¼ˆè¯‘æ³¨ï¼šæ³¨æ„çœ‹å‰é¢çš„é‚£ä¸ªå›¾ï¼Œè“è‰²çš„æ–¹å‘å‘é‡å¤§æ¦‚æŒ‡å‘zè½´çš„æ­£æ–¹å‘ï¼Œä¸æ‘„åƒæœºå®é™…æŒ‡å‘çš„æ–¹å‘æ˜¯æ­£å¥½ç›¸åçš„ï¼‰. å³è½´æˆ‘ä»¬éœ€è¦çš„å¦ä¸€ä¸ªå‘é‡æ˜¯ä¸€ä¸ªå³å‘é‡(Right Vector)ï¼Œå®ƒä»£è¡¨æ‘„åƒæœºç©ºé—´çš„xè½´çš„æ­£æ–¹å‘.ä¸ºè·å–å³å‘é‡æˆ‘ä»¬éœ€è¦å…ˆä½¿ç”¨ä¸€ä¸ªå°æŠ€å·§ï¼šå…ˆå®šä¹‰ä¸€ä¸ªä¸Šå‘é‡(Up Vector).æ¥ä¸‹æ¥æŠŠä¸Šå‘é‡å’Œç¬¬äºŒæ­¥å¾—åˆ°çš„æ–¹å‘å‘é‡è¿›è¡Œå‰ä¹˜.ä¸¤ä¸ªå‘é‡å‰ä¹˜çš„ç»“æœä¼šåŒæ—¶å‚ç›´äºä¸¤å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬ä¼šå¾—åˆ°æŒ‡å‘xè½´æ­£æ–¹å‘çš„é‚£ä¸ªå‘é‡ï¼ˆå¦‚æœæˆ‘ä»¬äº¤æ¢ä¸¤ä¸ªå‘é‡å‰ä¹˜çš„é¡ºåºå°±ä¼šå¾—åˆ°ç›¸åçš„æŒ‡å‘xè½´è´Ÿæ–¹å‘çš„å‘é‡ï¼‰ï¼š glm::vec3 up = glm::vec3(0.0f, 1.0f, 0.0f); glm::vec3 cameraRight = glm::normalize(glm::cross(up, cameraDirection)); ä¸Šè½´å³å‘é‡å’Œæ–¹å‘å‘é‡è¿›è¡Œå‰ä¹˜å¾—åˆ°yè½´æ­£æ–¹å½¢,å³ä¸Šè½´. glm::vec3 cameraUp = glm::cross(cameraDirection, cameraRight); å¯¹äºæƒ³å­¦åˆ°æ›´å¤šæ•°å­¦åŸç†çš„è¯»è€…ï¼Œæç¤ºä¸€ä¸‹ï¼Œåœ¨çº¿æ€§ä»£æ•°ä¸­è¿™ä¸ªå¤„ç†å«åšæ ¼æ‹‰å§†â€”æ–½å¯†ç‰¹æ­£äº¤åŒ–(Gram-Schmidt Process).ä½¿ç”¨è¿™äº›æ‘„åƒæœºå‘é‡æˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªLookAtçŸ©é˜µäº†ï¼Œå®ƒåœ¨åˆ›å»ºæ‘„åƒæœºçš„æ—¶å€™éå¸¸æœ‰ç”¨. Look Atä½¿ç”¨çŸ©é˜µçš„å¥½å¤„ä¹‹ä¸€æ˜¯å¦‚æœä½ ä½¿ç”¨3ä¸ªç›¸äº’å‚ç›´ï¼ˆæˆ–éçº¿æ€§ï¼‰çš„è½´å®šä¹‰äº†ä¸€ä¸ªåæ ‡ç©ºé—´ï¼Œä½ å¯ä»¥ç”¨è¿™3ä¸ªè½´å¤–åŠ ä¸€ä¸ªå¹³ç§»å‘é‡æ¥åˆ›å»ºä¸€ä¸ªçŸ©é˜µï¼Œå¹¶ä¸”ä½ å¯ä»¥ç”¨è¿™ä¸ªçŸ©é˜µä¹˜ä»¥ä»»ä½•å‘é‡æ¥å°†å…¶å˜æ¢åˆ°é‚£ä¸ªåæ ‡ç©ºé—´.è¿™æ­£æ˜¯LookAtçŸ©é˜µæ‰€åšçš„ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†3ä¸ªç›¸äº’å‚ç›´çš„è½´å’Œä¸€ä¸ªå®šä¹‰æ‘„åƒæœºç©ºé—´çš„ä½ç½®åæ ‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„LookAtçŸ©é˜µäº†ï¼šå…¶ä¸­Ræ˜¯å³å‘é‡ï¼ŒUæ˜¯ä¸Šå‘é‡ï¼ŒDæ˜¯æ–¹å‘å‘é‡Pæ˜¯æ‘„åƒæœºä½ç½®å‘é‡.æ³¨æ„ï¼Œä½ç½®å‘é‡æ˜¯ç›¸åçš„ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ç»ˆå¸Œæœ›æŠŠä¸–ç•Œå¹³ç§»åˆ°ä¸æˆ‘ä»¬è‡ªèº«ç§»åŠ¨çš„ç›¸åæ–¹å‘.æŠŠè¿™ä¸ªLookAtçŸ©é˜µä½œä¸ºè§‚å¯ŸçŸ©é˜µå¯ä»¥å¾ˆé«˜æ•ˆåœ°æŠŠæ‰€æœ‰ä¸–ç•Œåæ ‡å˜æ¢åˆ°åˆšåˆšå®šä¹‰çš„è§‚å¯Ÿç©ºé—´.LookAtçŸ©é˜µå°±åƒå®ƒçš„åå­—è¡¨è¾¾çš„é‚£æ ·ï¼šå®ƒä¼šåˆ›å»ºä¸€ä¸ªçœ‹ç€(Look at)ç»™å®šç›®æ ‡çš„è§‚å¯ŸçŸ©é˜µ. å¹¸è¿çš„æ˜¯ï¼ŒGLMå·²ç»æä¾›äº†è¿™äº›æ”¯æŒ.æˆ‘ä»¬è¦åšçš„åªæ˜¯å®šä¹‰ä¸€ä¸ªæ‘„åƒæœºä½ç½®ï¼Œä¸€ä¸ªç›®æ ‡ä½ç½®å’Œä¸€ä¸ªè¡¨ç¤ºä¸–ç•Œç©ºé—´ä¸­çš„ä¸Šå‘é‡çš„å‘é‡ï¼ˆæˆ‘ä»¬è®¡ç®—å³å‘é‡ä½¿ç”¨çš„é‚£ä¸ªä¸Šå‘é‡ï¼‰.æ¥ç€GLMå°±ä¼šåˆ›å»ºä¸€ä¸ªLookAtçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½“ä½œæˆ‘ä»¬çš„è§‚å¯ŸçŸ©é˜µï¼š glm::mat4 view;view = glm::lookAt(glm::vec3(0.0f, 0.0f, 3.0f), glm::vec3(0.0f, 0.0f, 0.0f), glm::vec3(0.0f, 1.0f, 0.0f)); è‡ªç”±ç§»åŠ¨glm::vec3 cameraPos = glm::vec3(0.0f, 0.0f, 3.0f);glm::vec3 cameraFront = glm::vec3(0.0f, 0.0f, -1.0f);glm::vec3 cameraUp = glm::vec3(0.0f, 1.0f, 0.0f);view = glm::lookAt(cameraPos, cameraPos + cameraFront, cameraUp); æˆ‘ä»¬é¦–å…ˆå°†æ‘„åƒæœºä½ç½®è®¾ç½®ä¸ºä¹‹å‰å®šä¹‰çš„cameraPos.æ–¹å‘æ˜¯å½“å‰çš„ä½ç½®åŠ ä¸Šæˆ‘ä»¬åˆšåˆšå®šä¹‰çš„æ–¹å‘å‘é‡.è¿™æ ·èƒ½ä¿è¯æ— è®ºæˆ‘ä»¬æ€ä¹ˆç§»åŠ¨ï¼Œæ‘„åƒæœºéƒ½ä¼šæ³¨è§†ç€ç›®æ ‡æ–¹å‘.è®©æˆ‘ä»¬æ‘†å¼„ä¸€ä¸‹è¿™äº›å‘é‡ï¼Œåœ¨æŒ‰ä¸‹æŸäº›æŒ‰é’®æ—¶æ›´æ–°cameraPoså‘é‡. æˆ‘ä»¬å·²ç»ä¸ºGLFWçš„é”®ç›˜è¾“å…¥å®šä¹‰è¿‡ä¸€ä¸ªprocessInputå‡½æ•°äº†ï¼Œæˆ‘ä»¬æ¥æ–°æ·»åŠ å‡ ä¸ªéœ€è¦æ£€æŸ¥çš„æŒ‰é”®å‘½ä»¤ï¼š void processInput(GLFWwindow *window)&#123; ... float cameraSpeed = 0.05f; // adjust accordingly if (glfwGetKey(window, GLFW_KEY_W) == GLFW_PRESS) cameraPos += cameraSpeed * cameraFront; if (glfwGetKey(window, GLFW_KEY_S) == GLFW_PRESS) cameraPos -= cameraSpeed * cameraFront; if (glfwGetKey(window, GLFW_KEY_A) == GLFW_PRESS) cameraPos -= glm::normalize(glm::cross(cameraFront, cameraUp)) * cameraSpeed; if (glfwGetKey(window, GLFW_KEY_D) == GLFW_PRESS) cameraPos += glm::normalize(glm::cross(cameraFront, cameraUp)) * cameraSpeed;&#125; å½“æˆ‘ä»¬æŒ‰ä¸‹WASDé”®çš„ä»»æ„ä¸€ä¸ªï¼Œæ‘„åƒæœºçš„ä½ç½®éƒ½ä¼šç›¸åº”æ›´æ–°ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›å‘å‰æˆ–å‘åç§»åŠ¨ï¼Œæˆ‘ä»¬å°±æŠŠä½ç½®å‘é‡åŠ ä¸Šæˆ–å‡å»æ–¹å‘å‘é‡.å¦‚æœæˆ‘ä»¬å¸Œæœ›å‘å·¦å³ç§»åŠ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰ä¹˜æ¥åˆ›å»ºä¸€ä¸ªå³å‘é‡(Right Vector)ï¼Œå¹¶æ²¿ç€å®ƒç›¸åº”ç§»åŠ¨å°±å¯ä»¥äº†.è¿™æ ·å°±åˆ›å»ºäº†ä½¿ç”¨æ‘„åƒæœºæ—¶ç†Ÿæ‚‰çš„æ¨ªç§»(Strafe)æ•ˆæœ. æ³¨æ„ï¼Œæˆ‘ä»¬å¯¹å³å‘é‡è¿›è¡Œäº†æ ‡å‡†åŒ–.å¦‚æœæˆ‘ä»¬æ²¡å¯¹è¿™ä¸ªå‘é‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæœ€åçš„å‰ä¹˜ç»“æœä¼šæ ¹æ®cameraFrontå˜é‡è¿”å›å¤§å°ä¸åŒçš„å‘é‡.å¦‚æœæˆ‘ä»¬ä¸å¯¹å‘é‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæˆ‘ä»¬å°±å¾—æ ¹æ®æ‘„åƒæœºçš„æœå‘ä¸åŒåŠ é€Ÿæˆ–å‡é€Ÿç§»åŠ¨äº†ï¼Œä½†å¦‚æœè¿›è¡Œäº†æ ‡å‡†åŒ–ç§»åŠ¨å°±æ˜¯åŒ€é€Ÿçš„. ç§»åŠ¨é€Ÿåº¦ç›®å‰æˆ‘ä»¬çš„ç§»åŠ¨é€Ÿåº¦æ˜¯ä¸ªå¸¸é‡.ç†è®ºä¸Šæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å®é™…æƒ…å†µä¸‹æ ¹æ®å¤„ç†å™¨çš„èƒ½åŠ›ä¸åŒï¼Œæœ‰äº›äººå¯èƒ½ä¼šæ¯”å…¶ä»–äººæ¯ç§’ç»˜åˆ¶æ›´å¤šå¸§ï¼Œä¹Ÿå°±æ˜¯ä»¥æ›´é«˜çš„é¢‘ç‡è°ƒç”¨processInputå‡½æ•°.ç»“æœå°±æ˜¯ï¼Œæ ¹æ®é…ç½®çš„ä¸åŒï¼Œæœ‰äº›äººå¯èƒ½ç§»åŠ¨å¾ˆå¿«ï¼Œè€Œæœ‰äº›äººä¼šç§»åŠ¨å¾ˆæ…¢.å½“ä½ å‘å¸ƒä½ çš„ç¨‹åºçš„æ—¶å€™ï¼Œä½ å¿…é¡»ç¡®ä¿å®ƒåœ¨æ‰€æœ‰ç¡¬ä»¶ä¸Šç§»åŠ¨é€Ÿåº¦éƒ½ä¸€æ ·. å›¾å½¢ç¨‹åºå’Œæ¸¸æˆé€šå¸¸ä¼šè·Ÿè¸ªä¸€ä¸ªæ—¶é—´å·®(Deltatime)å˜é‡ï¼Œå®ƒå‚¨å­˜äº†æ¸²æŸ“ä¸Šä¸€å¸§æ‰€ç”¨çš„æ—¶é—´.æˆ‘ä»¬æŠŠæ‰€æœ‰é€Ÿåº¦éƒ½å»ä¹˜ä»¥deltaTimeå€¼.ç»“æœå°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„deltaTimeå¾ˆå¤§ï¼Œå°±æ„å‘³ç€ä¸Šä¸€å¸§çš„æ¸²æŸ“èŠ±è´¹äº†æ›´å¤šæ—¶é—´ï¼Œæ‰€ä»¥è¿™ä¸€å¸§çš„é€Ÿåº¦éœ€è¦å˜å¾—æ›´é«˜æ¥å¹³è¡¡æ¸²æŸ“æ‰€èŠ±å»çš„æ—¶é—´.ä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œæ— è®ºä½ çš„ç”µè„‘å¿«è¿˜æ˜¯æ…¢ï¼Œæ‘„åƒæœºçš„é€Ÿåº¦éƒ½ä¼šç›¸åº”å¹³è¡¡ï¼Œè¿™æ ·æ¯ä¸ªç”¨æˆ·çš„ä½“éªŒå°±éƒ½ä¸€æ ·äº†. è§†è§’ç§»åŠ¨ä¸ºäº†èƒ½å¤Ÿæ”¹å˜è§†è§’ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®é¼ æ ‡çš„è¾“å…¥æ”¹å˜cameraFrontå‘é‡.åœ¨æ­¤ä¹‹å‰,æˆ‘ä»¬éœ€è¦å­¦ä¹ ç›¸å…³çš„æ•°å­¦çŸ¥è¯†. æ¬§æ‹‰è§’æ¬§æ‹‰è§’(Euler Angle)æ˜¯å¯ä»¥è¡¨ç¤º3Dç©ºé—´ä¸­ä»»ä½•æ—‹è½¬çš„3ä¸ªå€¼ï¼Œç”±è±æ˜‚å“ˆå¾·Â·æ¬§æ‹‰(Leonhard Euler)åœ¨18ä¸–çºªæå‡º.ä¸€å…±æœ‰3ç§æ¬§æ‹‰è§’ï¼šä¿¯ä»°è§’(Pitch)ã€åèˆªè§’(Yaw)å’Œæ»šè½¬è§’(Roll)ï¼Œä¸‹é¢çš„å›¾ç‰‡å±•ç¤ºäº†å®ƒä»¬çš„å«ä¹‰ï¼šå¯¹äºæˆ‘ä»¬çš„æ‘„åƒæœºç³»ç»Ÿæ¥è¯´ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¿¯ä»°è§’å’Œåèˆªè§’ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šè®¨è®ºæ»šè½¬è§’.ç»™å®šä¸€ä¸ªä¿¯ä»°è§’å’Œåèˆªè§’ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬è½¬æ¢ä¸ºä¸€ä¸ªä»£è¡¨æ–°çš„æ–¹å‘å‘é‡çš„3Då‘é‡.ä¿¯ä»°è§’å’Œåèˆªè§’è½¬æ¢ä¸ºæ–¹å‘å‘é‡çš„å¤„ç†éœ€è¦ä¸€äº›ä¸‰è§’å­¦çŸ¥è¯†ï¼Œæˆ‘ä»¬å…ˆä»æœ€åŸºæœ¬çš„æƒ…å†µå¼€å§‹ï¼šå¦‚æœæˆ‘ä»¬æŠŠæ–œè¾¹è¾¹é•¿å®šä¹‰ä¸º1ï¼Œæˆ‘ä»¬å°±èƒ½çŸ¥é“é‚»è¾¹çš„é•¿åº¦æ˜¯cos x/h=cos x/1=cos xï¼Œå®ƒçš„å¯¹è¾¹æ˜¯sin y/h=sin y/1=sin y.è¿™æ ·æˆ‘ä»¬è·å¾—äº†èƒ½å¤Ÿå¾—åˆ°xå’Œyæ–¹å‘é•¿åº¦çš„é€šç”¨å…¬å¼ï¼Œå®ƒä»¬å–å†³äºæ‰€ç»™çš„è§’åº¦.æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥è®¡ç®—æ–¹å‘å‘é‡çš„åˆ†é‡ï¼šè¿™ä¸ªä¸‰è§’å½¢çœ‹èµ·æ¥å’Œå‰é¢çš„ä¸‰è§’å½¢å¾ˆåƒï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è±¡è‡ªå·±åœ¨xzå¹³é¢ä¸Šï¼Œçœ‹å‘yè½´ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºç¬¬ä¸€ä¸ªä¸‰è§’å½¢è®¡ç®—æ¥è®¡ç®—å®ƒçš„é•¿åº¦/yæ–¹å‘çš„å¼ºåº¦(Strength)ï¼ˆæˆ‘ä»¬å¾€ä¸Šæˆ–å¾€ä¸‹çœ‹å¤šå°‘ï¼‰.ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹äºä¸€ä¸ªç»™å®šä¿¯ä»°è§’çš„yå€¼ç­‰äºsin Î¸ï¼š direction.y = sin(glm::radians(pitch)); // æ³¨æ„æˆ‘ä»¬å…ˆæŠŠè§’åº¦è½¬ä¸ºå¼§åº¦ è¿™é‡Œæˆ‘ä»¬åªæ›´æ–°äº†yå€¼ï¼Œä»”ç»†è§‚å¯Ÿxå’Œzåˆ†é‡ä¹Ÿè¢«å½±å“äº†.ä»ä¸‰è§’å½¢ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬çš„å€¼ç­‰äºï¼š direction.x = cos(glm::radians(pitch));direction.z = cos(glm::radians(pitch)); çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿä¸ºåèˆªè§’æ‰¾åˆ°éœ€è¦çš„åˆ†é‡ï¼šå°±åƒä¿¯ä»°è§’çš„ä¸‰è§’å½¢ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°xåˆ†é‡å–å†³äºcos(yaw)çš„å€¼ï¼Œzå€¼åŒæ ·å–å†³äºåèˆªè§’çš„æ­£å¼¦å€¼.æŠŠè¿™ä¸ªåŠ åˆ°å‰é¢çš„å€¼ä¸­ï¼Œä¼šå¾—åˆ°åŸºäºä¿¯ä»°è§’å’Œåèˆªè§’çš„æ–¹å‘å‘é‡ï¼š direction.x = cos(glm::radians(pitch)) * cos(glm::radians(yaw)); // è¯‘æ³¨ï¼šdirectionä»£è¡¨æ‘„åƒæœºçš„å‰è½´(Front)ï¼Œè¿™ä¸ªå‰è½´æ˜¯å’Œæœ¬æ–‡ç¬¬ä¸€å¹…å›¾ç‰‡çš„ç¬¬äºŒä¸ªæ‘„åƒæœºçš„æ–¹å‘å‘é‡æ˜¯ç›¸åçš„direction.y = sin(glm::radians(pitch));direction.z = cos(glm::radians(pitch)) * sin(glm::radians(yaw)); è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå¯ä»¥æŠŠä¿¯ä»°è§’å’Œåèˆªè§’è½¬åŒ–ä¸ºç”¨æ¥è‡ªç”±æ—‹è½¬è§†è§’çš„æ‘„åƒæœºçš„3ç»´æ–¹å‘å‘é‡äº†.ä½ å¯èƒ½ä¼šå¥‡æ€ªï¼šæˆ‘ä»¬æ€ä¹ˆå¾—åˆ°ä¿¯ä»°è§’å’Œåèˆªè§’ï¼Ÿ é¼ æ ‡è¾“å…¥åèˆªè§’å’Œä¿¯ä»°è§’æ˜¯é€šè¿‡é¼ æ ‡ï¼ˆæˆ–æ‰‹æŸ„ï¼‰ç§»åŠ¨è·å¾—çš„ï¼Œæ°´å¹³çš„ç§»åŠ¨å½±å“åèˆªè§’ï¼Œç«–ç›´çš„ç§»åŠ¨å½±å“ä¿¯ä»°è§’.å®ƒçš„åŸç†å°±æ˜¯ï¼Œå‚¨å­˜ä¸Šä¸€å¸§é¼ æ ‡çš„ä½ç½®ï¼Œåœ¨å½“å‰å¸§ä¸­æˆ‘ä»¬å½“å‰è®¡ç®—é¼ æ ‡ä½ç½®ä¸ä¸Šä¸€å¸§çš„ä½ç½®ç›¸å·®å¤šå°‘.å¦‚æœæ°´å¹³/ç«–ç›´å·®åˆ«è¶Šå¤§é‚£ä¹ˆä¿¯ä»°è§’æˆ–åèˆªè§’å°±æ”¹å˜è¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯æ‘„åƒæœºéœ€è¦ç§»åŠ¨æ›´å¤šçš„è·ç¦». é¦–å…ˆæˆ‘ä»¬è¦å‘Šè¯‰GLFWï¼Œå®ƒåº”è¯¥éšè—å…‰æ ‡ï¼Œå¹¶æ•æ‰(Capture)å®ƒ.æ•æ‰å…‰æ ‡è¡¨ç¤ºçš„æ˜¯ï¼Œå¦‚æœç„¦ç‚¹åœ¨ä½ çš„ç¨‹åºä¸Šï¼ˆè¯‘æ³¨ï¼šå³è¡¨ç¤ºä½ æ­£åœ¨æ“ä½œè¿™ä¸ªç¨‹åºï¼ŒWindowsä¸­æ‹¥æœ‰ç„¦ç‚¹çš„ç¨‹åºæ ‡é¢˜æ é€šå¸¸æ˜¯æœ‰é¢œè‰²çš„é‚£ä¸ªï¼Œè€Œå¤±å»ç„¦ç‚¹çš„ç¨‹åºæ ‡é¢˜æ åˆ™æ˜¯ç°è‰²çš„ï¼‰ï¼Œå…‰æ ‡åº”è¯¥åœç•™åœ¨çª—å£ä¸­ï¼ˆé™¤éç¨‹åºå¤±å»ç„¦ç‚¹æˆ–è€…é€€å‡ºï¼‰.æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•åœ°é…ç½®è°ƒç”¨æ¥å®Œæˆï¼š glfwSetInputMode(window, GLFW_CURSOR, GLFW_CURSOR_DISABLED); ä¸ºäº†è®¡ç®—ä¿¯ä»°è§’å’Œåèˆªè§’ï¼Œæˆ‘ä»¬éœ€è¦è®©GLFWç›‘å¬é¼ æ ‡ç§»åŠ¨äº‹ä»¶.ï¼ˆå’Œé”®ç›˜è¾“å…¥ç›¸ä¼¼ï¼‰æˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å®Œæˆï¼Œå‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼š void mouse_callback(GLFWwindow* window, double xpos, double ypos); è¿™é‡Œçš„xposå’Œyposä»£è¡¨å½“å‰é¼ æ ‡çš„ä½ç½®.å½“æˆ‘ä»¬ç”¨GLFWæ³¨å†Œäº†å›è°ƒå‡½æ•°ä¹‹åï¼Œé¼ æ ‡ä¸€ç§»åŠ¨mouse_callbackå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼š glfwSetCursorPosCallback(window, mouse_callback); åœ¨å¤„ç†FPSé£æ ¼æ‘„åƒæœºçš„é¼ æ ‡è¾“å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æœ€ç»ˆè·å–æ–¹å‘å‘é‡ä¹‹å‰åšä¸‹é¢è¿™å‡ æ­¥ï¼š è®¡ç®—é¼ æ ‡è·ä¸Šä¸€å¸§çš„åç§»é‡ æŠŠåç§»é‡æ·»åŠ åˆ°æ‘„åƒæœºçš„ä¿¯ä»°è§’å’Œåèˆªè§’ä¸­ å¯¹åèˆªè§’å’Œä¿¯ä»°è§’è¿›è¡Œæœ€å¤§å’Œæœ€å°å€¼çš„é™åˆ¶ è®¡ç®—æ–¹å‘å‘é‡ ç¬¬ä¸€æ­¥æ˜¯è®¡ç®—é¼ æ ‡è‡ªä¸Šä¸€å¸§çš„åç§»é‡.æˆ‘ä»¬å¿…é¡»å…ˆåœ¨ç¨‹åºä¸­å‚¨å­˜ä¸Šä¸€å¸§çš„é¼ æ ‡ä½ç½®ï¼Œæˆ‘ä»¬æŠŠå®ƒçš„åˆå§‹å€¼è®¾ç½®ä¸ºå±å¹•çš„ä¸­å¿ƒï¼ˆå±å¹•çš„å°ºå¯¸æ˜¯800x600ï¼‰ï¼š float lastX = 400, lastY = 300; ç„¶ååœ¨é¼ æ ‡çš„å›è°ƒå‡½æ•°ä¸­æˆ‘ä»¬è®¡ç®—å½“å‰å¸§å’Œä¸Šä¸€å¸§é¼ æ ‡ä½ç½®çš„åç§»é‡ï¼š float xoffset = xpos - lastX;float yoffset = lastY - ypos; // æ³¨æ„è¿™é‡Œæ˜¯ç›¸åçš„ï¼Œå› ä¸ºyåæ ‡æ˜¯ä»åº•éƒ¨å¾€é¡¶éƒ¨ä¾æ¬¡å¢å¤§çš„lastX = xpos;lastY = ypos;float sensitivity = 0.05f;xoffset *= sensitivity;yoffset *= sensitivity; æ³¨æ„æˆ‘ä»¬æŠŠåç§»é‡ä¹˜ä»¥äº†sensitivityï¼ˆçµæ•åº¦ï¼‰å€¼.å¦‚æœæˆ‘ä»¬å¿½ç•¥è¿™ä¸ªå€¼ï¼Œé¼ æ ‡ç§»åŠ¨å°±ä¼šå¤ªå¤§äº†ï¼›ä½ å¯ä»¥è‡ªå·±å®éªŒä¸€ä¸‹ï¼Œæ‰¾åˆ°é€‚åˆè‡ªå·±çš„çµæ•åº¦å€¼. æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠåç§»é‡åŠ åˆ°å…¨å±€å˜é‡pitchå’Œyawä¸Šï¼š yaw += xoffset;pitch += yoffset; ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ‘„åƒæœºæ·»åŠ ä¸€äº›é™åˆ¶ï¼Œè¿™æ ·æ‘„åƒæœºå°±ä¸ä¼šå‘ç”Ÿå¥‡æ€ªçš„ç§»åŠ¨äº†ï¼ˆè¿™æ ·ä¹Ÿä¼šé¿å…ä¸€äº›å¥‡æ€ªçš„é—®é¢˜ï¼‰.å¯¹äºä¿¯ä»°è§’ï¼Œè¦è®©ç”¨æˆ·ä¸èƒ½çœ‹å‘é«˜äº89åº¦çš„åœ°æ–¹ï¼ˆåœ¨90åº¦æ—¶è§†è§’ä¼šå‘ç”Ÿé€†è½¬ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠ89åº¦ä½œä¸ºæé™ï¼‰ï¼ŒåŒæ ·ä¹Ÿä¸å…è®¸å°äº-89åº¦.è¿™æ ·èƒ½å¤Ÿä¿è¯ç”¨æˆ·åªèƒ½çœ‹åˆ°å¤©ç©ºæˆ–è„šä¸‹ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¶Šè¿™ä¸ªé™åˆ¶.æˆ‘ä»¬å¯ä»¥åœ¨å€¼è¶…è¿‡é™åˆ¶çš„æ—¶å€™å°†å…¶æ”¹ä¸ºæé™å€¼æ¥å®ç°ï¼š if(pitch &gt; 89.0f) pitch = 89.0f;if(pitch &lt; -89.0f) pitch = -89.0f; ç¬¬å››ä¹Ÿæ˜¯æœ€åä¸€æ­¥ï¼Œå°±æ˜¯é€šè¿‡ä¿¯ä»°è§’å’Œåèˆªè§’æ¥è®¡ç®—ä»¥å¾—åˆ°çœŸæ­£çš„æ–¹å‘å‘é‡ï¼š glm::vec3 front;front.x = cos(glm::radians(pitch)) * cos(glm::radians(yaw));front.y = sin(glm::radians(pitch));front.z = cos(glm::radians(pitch)) * sin(glm::radians(yaw));cameraFront = glm::normalize(front); è®¡ç®—å‡ºæ¥çš„æ–¹å‘å‘é‡å°±ä¼šåŒ…å«æ ¹æ®é¼ æ ‡ç§»åŠ¨è®¡ç®—å‡ºæ¥çš„æ‰€æœ‰æ—‹è½¬äº†.ç”±äºcameraFrontå‘é‡å·²ç»åŒ…å«åœ¨GLMçš„lookAtå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è¿™å°±æ²¡ä»€ä¹ˆé—®é¢˜äº†. å¦‚æœä½ ç°åœ¨è¿è¡Œä»£ç ï¼Œä½ ä¼šå‘ç°åœ¨çª—å£ç¬¬ä¸€æ¬¡è·å–ç„¦ç‚¹çš„æ—¶å€™æ‘„åƒæœºä¼šçªç„¶è·³ä¸€ä¸‹ã€‚è¿™ä¸ªé—®é¢˜äº§ç”Ÿçš„åŸå› æ˜¯ï¼Œåœ¨ä½ çš„é¼ æ ‡ç§»åŠ¨è¿›çª—å£çš„é‚£ä¸€åˆ»ï¼Œé¼ æ ‡å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ—¶å€™çš„xposå’Œyposä¼šç­‰äºé¼ æ ‡åˆšåˆšè¿›å…¥å±å¹•çš„é‚£ä¸ªä½ç½®.è¿™é€šå¸¸æ˜¯ä¸€ä¸ªè·ç¦»å±å¹•ä¸­å¿ƒå¾ˆè¿œçš„åœ°æ–¹ï¼Œå› è€Œäº§ç”Ÿä¸€ä¸ªå¾ˆå¤§çš„åç§»é‡ï¼Œæ‰€ä»¥å°±ä¼šè·³äº†.æˆ‘ä»¬å¯ä»¥ç®€å•çš„ä½¿ç”¨ä¸€ä¸ªboolå˜é‡æ£€éªŒæˆ‘ä»¬æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è·å–é¼ æ ‡è¾“å…¥ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæŠŠé¼ æ ‡çš„åˆå§‹ä½ç½®æ›´æ–°ä¸ºxposå’Œyposå€¼ï¼Œè¿™æ ·å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼›æ¥ä¸‹æ¥çš„é¼ æ ‡ç§»åŠ¨å°±ä¼šä½¿ç”¨åˆšè¿›å…¥çš„é¼ æ ‡ä½ç½®åæ ‡æ¥è®¡ç®—åç§»é‡äº†ï¼š if(firstMouse) // è¿™ä¸ªboolå˜é‡åˆå§‹æ—¶æ˜¯è®¾å®šä¸ºtrueçš„&#123; lastX = xpos; lastY = ypos; firstMouse = false;&#125; ç¼©æ”¾æ³¨å†Œæ»šè½®å›è°ƒå‡½æ•° void scroll_callback(GLFWwindow* window, double xoffset, double yoffset)&#123; if(fov &gt;= 1.0f &amp;&amp; fov &lt;= 45.0f) fov -= yoffset; if(fov &lt;= 1.0f) fov = 1.0f; if(fov &gt;= 45.0f) fov = 45.0f;&#125; å½“æ»šåŠ¨é¼ æ ‡æ»šè½®çš„æ—¶å€™ï¼Œyoffsetå€¼ä»£è¡¨æˆ‘ä»¬ç«–ç›´æ»šåŠ¨çš„å¤§å°.å½“scroll_callbackå‡½æ•°è¢«è°ƒç”¨åï¼Œæˆ‘ä»¬æ”¹å˜å…¨å±€å˜é‡fovå˜é‡çš„å†…å®¹.å› ä¸º45.0fæ˜¯é»˜è®¤çš„è§†é‡å€¼ï¼Œæˆ‘ä»¬å°†ä¼šæŠŠç¼©æ”¾çº§åˆ«(Zoom Level)é™åˆ¶åœ¨1.0fåˆ°45.0f. æˆ‘ä»¬ç°åœ¨åœ¨æ¯ä¸€å¸§éƒ½å¿…é¡»æŠŠé€è§†æŠ•å½±çŸ©é˜µä¸Šä¼ åˆ°GPUï¼Œä½†ç°åœ¨ä½¿ç”¨fovå˜é‡ä½œä¸ºå®ƒçš„è§†é‡ï¼š projection = glm::perspective(glm::radians(fov), 800.0f / 600.0f, 0.1f, 100.0f); æœ€åä¸è¦å¿˜è®°æ³¨å†Œé¼ æ ‡æ»šè½®çš„å›è°ƒå‡½æ•°ï¼š glfwSetScrollCallback(window, scroll_callback); æ³¨æ„ï¼Œä½¿ç”¨æ¬§æ‹‰è§’çš„æ‘„åƒæœºç³»ç»Ÿå¹¶ä¸å®Œç¾.æ ¹æ®ä½ çš„è§†è§’é™åˆ¶æˆ–è€…æ˜¯é…ç½®ï¼Œä½ ä»ç„¶å¯èƒ½å¼•å…¥ä¸‡å‘èŠ‚æ­»é”é—®é¢˜.æœ€å¥½çš„æ‘„åƒæœºç³»ç»Ÿæ˜¯ä½¿ç”¨å››å…ƒæ•°(Quaternions)çš„ï¼Œä½†æˆ‘ä»¬å°†ä¼šæŠŠè¿™ä¸ªç•™åˆ°åé¢è®¨è®º.ï¼ˆè¯‘æ³¨ï¼šè¿™é‡Œå¯ä»¥æŸ¥çœ‹å››å…ƒæ•°æ‘„åƒæœºçš„å®ç°ï¼‰ æ‘„åƒæœºç±»å’Œç€è‰²å™¨å¯¹è±¡ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠæ‘„åƒæœºç±»å†™åœ¨ä¸€ä¸ªå•ç‹¬çš„å¤´æ–‡ä»¶ä¸­.ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒï¼Œä½ ç°åœ¨åº”è¯¥èƒ½å¤Ÿç†è§£æ‰€æœ‰çš„ä»£ç äº†.æˆ‘ä»¬å»ºè®®æ‚¨è‡³å°‘çœ‹ä¸€çœ‹è¿™ä¸ªç±»ï¼Œçœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„æ‘„åƒæœºç±».","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"OpenGL","slug":"OpenGL","permalink":"/tags/OpenGL/"},{"name":"è®¡ç®—æœºå›¾å½¢å­¦","slug":"è®¡ç®—æœºå›¾å½¢å­¦","permalink":"/tags/è®¡ç®—æœºå›¾å½¢å­¦/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è®°å½•ä¸€ä¸‹å¹³å¸¸é‡åˆ°çš„ç¯å¢ƒé…ç½®é—®é¢˜","slug":"è®°å½•ä¸€ä¸‹å¹³å¸¸é‡åˆ°çš„ç¯å¢ƒé…ç½®é—®é¢˜","date":"2019-10-07T14:57:03.000Z","updated":"2019-10-07T14:58:25.943Z","comments":true,"path":"2019/10/07/è®°å½•ä¸€ä¸‹å¹³å¸¸é‡åˆ°çš„ç¯å¢ƒé…ç½®é—®é¢˜/","link":"","permalink":"/2019/10/07/è®°å½•ä¸€ä¸‹å¹³å¸¸é‡åˆ°çš„ç¯å¢ƒé…ç½®é—®é¢˜/","excerpt":"","text":"1.matlabå¯¹äºæ¯”è¾ƒæ— æ³•ä¿å­˜æ¯”è¾ƒå¤§çš„matæ–‡ä»¶ï¼Œè€ŒæœåŠ¡å™¨åˆæ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢å¯ä»¥è¿›è¡Œ-v7.3è®¾ç½®ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨save(â€˜1.matâ€™,â€™dataâ€™,â€™-v7.3â€™)å¯¹æ•°æ®è¿›è¡Œä¿å­˜.2.matlabè°ƒç”¨jdbcçš„mysqlä½¿ç”¨5çš„è€ç‰ˆæœ¬å°±è¡Œäº†ï¼Œä¸è¦ç”¨8ï¼Œjdk&gt;=1.8å³å¯.3.clionä¸­çš„glslæ–‡ä»¶ç›¸å¯¹è·¯å¾„æ€»æ˜¯ä¸å¯¹æ˜¯å› ä¸ºç¨‹åºåœ¨æ‰§è¡Œè°ƒç”¨æ—¶ç”¨çš„æ˜¯cmke-build-debug/binç›®å½•ä¸‹çš„glslä»£ç æ–‡ä»¶.4.openglå¦‚æœé‡åˆ°è¿è¡Œé—ªç™½ï¼Œå…³é—­ç¬é—´æ‰æ˜¾ç¤ºçš„æƒ…å†µï¼Œè¿™æ—¶åº”è¯¥æ³¨é‡Šæ‰ç‰ˆæœ¬ä¿¡æ¯çš„è¯­å¥.5.linuxç³»ç»Ÿé™é»˜å®‰è£…matlabå¯å‚ç…§è¿™ç¯‡æ–‡ç« ï¼Œå®‰è£…æ­¥éª¤æ˜¯å¯¹çš„ï¼Œæ¿€æ´»å¤±è´¥æ²¡å…³ç³»ï¼Œå¯ä»¥ç ´è§£å°±è¡Œ.6.hexoåšå®¢ä¸»é¢˜ä¸­çš„package.jsonè®°å½•çš„æ˜¯ä¾èµ–æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡cnpm iæ¥è‡ªåŠ¨å®‰è£…è¯¥æ–‡ä»¶ä¸­çš„ä¾èµ–.7.linuxç³»ç»Ÿå®‰è£…openglå®‰è£…æœ‰ä¸ªå‘ï¼Œlibglut.soç½‘ä¸Šçš„æ•™ç¨‹éƒ½è¯´æ˜¯åœ¨/usr/lib/i386-linux-gnuå…¶å®64ä½çš„æœºå™¨å¥½åƒæ˜¯åœ¨x86-linux-gnuå¤„ï¼Œåˆç†åˆ©ç”¨æœç´¢åŠŸèƒ½å°±è¡Œäº†.8.torchç‰ˆæœ¬å¯¹åº”ä¸ä¸Šå¯ä»¥å…ˆæ‰¾whlï¼Œå¦‚æœå®‰è£…torhvisionä¼šå¼ºåˆ¶æ›´æ–°torchï¼Œæ ¹æ®ç»éªŒï¼Œtorch0.4.1å¯¹åº”torchvision0.2.0.9.cudaå¯ä»¥å¤šç‰ˆæœ¬ï¼Œä¿®æ”¹é“¾æ¥å³å¯.10.linuxç¯å¢ƒä¸‹æ˜¾å¡é©±åŠ¨ç›´æ¥é€šè¿‡runæ–‡ä»¶å®‰è£…å³å¯.11.windowsä¸‹é…ç½®opengléœ€è¦æ‰¾å¯¹åº”çš„ç¼–è¯‘æ–‡ä»¶(Mingwå’Œvsçš„é“¾æ¥åº“æ–‡ä»¶åç¼€ä¼¼ä¹æ˜¯ä¸åŒçš„).","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"ç¯å¢ƒé…ç½®","slug":"ç¯å¢ƒé…ç½®","permalink":"/tags/ç¯å¢ƒé…ç½®/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"æ•°æ®ç»“æ„-é‚“ä¿Šè¾‰","slug":"æ•°æ®ç»“æ„-é‚“ä¿Šè¾‰","date":"2019-09-18T10:56:52.000Z","updated":"2019-09-18T10:56:43.970Z","comments":true,"path":"2019/09/18/æ•°æ®ç»“æ„-é‚“ä¿Šè¾‰/","link":"","permalink":"/2019/09/18/æ•°æ®ç»“æ„-é‚“ä¿Šè¾‰/","excerpt":"","text":"@[toc] å»é‡è®²è§£ä¸»è¦æ€æƒ³:å…ˆæ’åº,ç„¶åæ‰¾åˆ°ä¸åŒçš„å…ƒç´ å°±å°†å…¶æ”¾åˆ°å‰åˆ— æ–æ³¢é‚£å¥‘æŸ¥æ‰¾åœ¨å¸¸ç³»æ•°æ„ä¹‰ä¸Šè¦ä¼˜äºäºŒåˆ†æŸ¥æ‰¾æ‹“å±•:ç¬¦åˆè¯­ä¹‰è¦æ±‚çš„äºŒåˆ†æŸ¥æ‰¾ç‰ˆæœ¬C æ”¹è¿›ç‰ˆå†’æ³¡æ’åºè§£æå‰åŠéƒ¨åˆ†(ç»¿è‰²)å…¶å®å¹¶ä¸ä¸€å®šæ˜¯æ— åºçš„,è€Œæˆ‘ä»¬åœ¨å†’æ³¡çš„è¿‡ç¨‹ä¸­å…¶å®å·²ç»â€éšå¼â€åœ°æ£€æŸ¥è¿‡äº†.å¦‚æœä¹‹å‰çš„å†’æ³¡æ²¡æœ‰äº¤æ¢è¿‡,è¯æ˜å‰é¢çš„å·²ç»æ˜¯æœ‰åºçš„äº†.ç»§ç»­æ”¹è¿›æ¯æ¬¡éƒ½è®°å½•ä¸‹æœ€åä¸€æ¬¡é€†åºå¯¹çš„ä½ç½®,è¿™æ ·å°±å¯ä»¥ä¸å¿…å¯¹æ²¡æœ‰é€†åºçš„å…ƒç´ è¿›è¡Œéå†,æœ€å¥½æƒ…å†µä¸‹å¯ä»¥åˆ°è¾¾O(n). ä¸­ç¼€è¡¨è¾¾å¼è½¬é€†æ³¢å…°è¡¨è¾¾å¼(RPN)é€†æ³¢å…°è¡¨è¾¾å¼æ— æ‹¬å·,ä»å¤´åˆ°å°¾è®¡ç®— æ‹¬å·å¼•ç†è®°å½•ä¸‹dfsæœç´¢è¿‡ç¨‹çš„æ—¶é—´æ ‡ç­¾çš„ä½œç”¨ AVLæ ‘3+4é‡æ„ä¸‹é¢çš„ä»£ç ä¼¼ä¹æœ‰ç‚¹é”™è¯¯: ä¼¸å±•æ ‘åˆ©ç”¨äº†å±€éƒ¨æ€§åŸç†,ç»è¿‡é•¿æ—¶é—´çš„è°ƒæ•´,å¸¸è¢«è®¿é—®çš„èŠ‚ç‚¹ä¼šé è¿‘æ ‘æ ¹ä½ç½®.TanjarnåŒå±‚è°ƒæ•´æ”¹è¿›ç®—æ³• B-æ ‘åˆ†è£‚æ“ä½œå¦‚æœå‘ä¸Šä¼ æ’­è‡³æ ¹,é‚£ä¹ˆBæ ‘æœ¨é«˜åº¦+1,è¿™ä¹Ÿæ˜¯ä½¿å¾—Bæ ‘å¯ä»¥é•¿é«˜çš„å”¯ä¸€æ“ä½œ. çº¢é»‘æ ‘ æ•£åˆ—å‡½æ•°çš„è®¾è®¡ä¸ºä»€ä¹ˆæ˜¯å¹³æ–¹å–ä¸­? å¹³æ–¹è¯•æ¢è§†é¢‘è¯æ˜æé«˜è£…å¡«å› å­ ä¼˜å…ˆçº§é˜Ÿåˆ—å®Œå…¨äºŒå‰æ ‘å®ç°:æ ¹èŠ‚ç‚¹å³æœ€å¤§å…ƒç´ å¸¸ç³»æ•°æ”¹è¿›:ä¸ç”¨æ¯æ¬¡éƒ½swap,å…ˆå°†æœ€åä¸€ä¸ªèŠ‚ç‚¹å¤‡ä»½,é€æ¸å‘ä¸Šæ¯”è¾ƒ,æ¯æ¬¡åªä¸‹ç§»çˆ¶èŠ‚ç‚¹,æœ€åç›´æ¥æ›¿æ¢å³å¯è›®åŠ›å»ºå †:æ”¹è¿›:è‡ªä¸‹è€Œä¸Šçš„ä¸‹æ»¤æ·±åº¦å’Œé«˜åº¦ä½œä¸ºæŒ‡æ ‡æ˜æ˜åº”è¯¥å¾ˆæ¥è¿‘,ä¸ºä»€ä¹ˆåœ¨æ¸è¿›çš„æ„ä¹‰ä¸Šä¼šæœ‰è¿™æ ·çš„å·®åˆ«?è¶Šåº•å±‚,èŠ‚ç‚¹æ•°é‡è¶Šå¤š.å †æ’åº:å †åˆå¹¶:ä»¥ä¸Šæ–¹æ³•å¹¶æ²¡æœ‰åˆ©ç”¨åˆ°Aå’ŒBä¸¤ä¸ªå †åŸæœ¬çš„ååºä¿¡æ¯.å·¦å¼å †:å³ä¾§é“¾:å·¦å¼å †å®ä¾‹:è§†é¢‘å®ä¾‹æ’å…¥å³æ˜¯åˆå¹¶åˆ é™¤äº¦æ˜¯åˆå¹¶ ä¸²è›®åŠ›ä¸ºä½•ä½æ•ˆ?åªçœ‹åŸå­—ç¬¦ä¸²,é’ˆå¯¹åŸå­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦,åœ¨æœ€åæƒ…å†µä¸‹,éƒ½éœ€è¦å’Œæ¨¡å¼ä¸²çš„æ¯ä¸ªå­—ç¬¦è¿›è¡Œæ¯”å¯¹.ä¸å˜æ€§:KMPç®—æ³•:next[]æ•°ç»„:é€‰å–æœ€å¤§çš„é‚£ä¸ªt,tè¶Šå¤§,j-tè¶Šå°,æ„å‘³ç€è¶Šå®‰å…¨,å¯ä»¥é¿å…å›æº¯(æš‚æœªç†è§£),ä¹Ÿå³è·ƒè¿‡çš„éƒ¨åˆ†ç¡®å®æ˜¯ä¸å¿…å°è¯•åŒ¹é…çš„.è§†é¢‘è®²è§£j&lt;0ä¹Ÿè¡¨ç¤ºä¸Šä¸€æ¬¡å¤±é…çš„ä½ç½®å³é¦–ä½ç½®.æ„é€ next[]æ•°ç»„:é€’æ¨å…¬å¼:æ•ˆç‡ç²¾ç¡®ä¼°è®¡:KMPå†æ”¹è¿›:ä¸‹ä¸€ä¸ªè¿›è¡ŒåŒ¹é…çš„è‡³å°‘ä¸åº”è¯¥å’ŒåŸæ¥ä¸€æ ·,é’ˆå¯¹ä¸‹é¢çš„æ¡ˆä¾‹,å³è‡³å°‘ä¸èƒ½å†æ˜¯0.æ³¨æ„ç¬¬äºŒè¡Œ0ä¸‹é¢éƒ½å˜æˆäº†-1.BMç®—æ³•:åå­—ç¬¦æ›´å¤šåœ°å…³æ³¨æ•™è®­,åŠ é€Ÿå¤±è´¥,è®©æ›´å¤§çš„æ•™è®­æ›´æ—©åœ°å‡ºç°.åé¢çš„å­—ç¬¦å¯ä»¥æ’é™¤æ›´å¤šçš„å¯¹é½ä½ç½®.è§†é¢‘è®²è§£BCè¡¨:ä½†æ¨¡å¼ä¸²ä¸­å¯èƒ½æœ‰å¤šä¸ªâ€™Xâ€™,é‚£ä¹ˆè¦é€‰ç”¨å“ªä¸ªâ€™Xâ€™å‘¢?æ­¤æ—¶åº”è¯¥å·§é€‰å…¶ä¸€,é¿å…å›æº¯.é€‰æ‹©shiftä½ç§»é‡ç›¸å¯¹è¾ƒå°çš„,å³é€‰ç”¨æœ€åçš„é‚£ä¸ªâ€™Xâ€™.é‚£å¦‚æœæ¨¡å¼ä¸²ä¸­æ²¡æœ‰â€™Xâ€™å‘¢?æ­¤æ—¶åº”å°†æ¨¡å¼ä¸²å®Œæ•´åœ°ç§»è¿‡è¿™ä¸ªä½ç½®.(ç¬¬å››è¡Œ,åˆ©ç”¨é€šé…å“¨å…µå­—ç¬¦)å¦‚æœæœ€åä¸€ä¸ªâ€™Xâ€™çš„ç§©è¿‡å¤§å¯¼è‡´shiftä¸ºè´Ÿæ•°,æ­¤æ—¶åº”è¯¥æ€ä¹ˆåŠ?ç›´æ¥+1.æœ€å¥½æ€§èƒ½:æœ€åæ€§èƒ½:è§†é¢‘è®²è§£åå­—ç¬¦â€™1â€™çš„æ›¿ä»£è€…â€™0â€™çš„æœ€åä½ç½®å¤ªé å,å¯¼è‡´shifitä¸ºè´Ÿæ•°,å› è€Œåªèƒ½æ•´ä½“ç§»åŠ¨ä¸€ä¸ªä½ç½®.æ”¹è¿›:GS:å¥½åç¼€äº§ç”Ÿgs[]è¡¨:æ€§èƒ½æ¯”è¾ƒ: æ•™æä¸­æœ‰ç­”æ¡ˆ æ’åºå¿«æ’:æ³¨æ„æ•°å­—5æœ‰ä¸¤ä¸ª,å¯ä»¥çœ‹å‡ºå¿«æ’çš„ä¸ç¨³å®šæ€§.å¿«æ’å˜ç§:éšæœºäº¤æ¢æ˜¯ä¸ºäº†å‡å°‘æœ€åæƒ…å†µçš„å‡ºç°.é€‰å–ä¼—æ•°:(ä¸æ‡‚)å¿«é€Ÿé€‰æ‹©:çº¿æ€§é€‰æ‹©:å¸Œå°”æ’åº: TIPå°äºå·å¯¹åº”åŒºé—´åˆ¤æ–­çš„æ—¶å€™ç»Ÿä¸€ç”¨&lt;å·,è¿™æ ·å¯ä»¥ç›´æ¥å¯¹åº”åŒºé—´,æ–¹ä¾¿ç†è§£ ä½è¿ç®—å¿«é€Ÿå–æ¨¡+ä¸ºä»€ä¹ˆæ˜¯ç´ æ•°(æ•£åˆ—)è‰çš„å“²å­¦:Sæ˜¯å¤©æ•Œçš„ç”Ÿå‘½å‘¨æœŸ,Mæ˜¯è‰çš„ç”Ÿå‘½å‘¨æœŸ,ç»è¿‡é•¿æœŸçš„è‡ªç„¶é€‰æ‹©,è‰çš„ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯ç´ æ•°,è¿™æ ·å¯ä»¥ä½¿å¾—å¤©æ•Œåœ¨å…¶ç”Ÿå‘½å‘¨æœŸçš„åˆ†å¸ƒå°½å¯èƒ½åœ°å‡åŒ€,è¿™æ ·æ‰æœ‰åˆ©äºè‰ä½œä¸ºä¸€ä¸ªç‰©ç§çš„ç¹è¡ç”Ÿæ¯. åŒå‘å¹³æ–¹æ¢æµ‹ç”¨4k+3çš„ç´ æ•°(åŒå¹³æ–¹å®šç†)è¯æ˜è¿™é‡Œç”¨çš„æ˜¯åè¯æ³•,n%M=0,nåŒæ—¶å¯ä»¥æ•´é™¤Mçš„å¹³æ–¹.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"/tags/æ•°æ®ç»“æ„/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"é›¶æ¬¡å­¦ä¹ å…¥é—¨","slug":"é›¶æ¬¡å­¦ä¹ å…¥é—¨","date":"2019-09-18T10:51:52.000Z","updated":"2019-09-18T10:55:01.650Z","comments":true,"path":"2019/09/18/é›¶æ¬¡å­¦ä¹ å…¥é—¨/","link":"","permalink":"/2019/09/18/é›¶æ¬¡å­¦ä¹ å…¥é—¨/","excerpt":"","text":"åŸæ–‡é“¾æ¥ å¾ˆä¹…æ²¡æœ‰æ›´æ–‡ç« äº†ï¼Œä¸»è¦æ˜¯æ²¡æœ‰æ‰¾åˆ°zero-shot learning(ZSL)æ–¹é¢æˆ‘ç‰¹åˆ«æƒ³è¦åˆ†äº«çš„æ–‡ç« ï¼Œä¸”ä¸­é—´æœ‰ä¸€æ®µæ—¶é—´åœ¨è€ƒè™‘è¦ä¸è¦ç»§ç»­åšè¿™ä¸ªé¢˜ç›®ï¼Œå†åŠ ä¸Šæˆ‘æ‡’ (ï¿¢_ï¿¢)ï¼Œæ‰€ä»¥ä¸€ç›´æ‹–åˆ°äº†ç°åœ¨ã€‚æœ€è¿‘ç§‘ç ”æ²¡ä»€ä¹ˆè¿›å±•ï¼Œå°±æƒ³ç€å†™ä¸€ä¸ªZSLçš„å…¥é—¨æ€§çš„æ–‡ç« ï¼Œç›®çš„æ˜¯ä¸ºäº†å¸®åŠ©å®Œå…¨æ²¡æœ‰æ¥è§¦è¿‡è¿™æ–¹é¢ï¼Œå¹¶æœ‰äº›å…´è¶£çš„åŒå­¦ï¼Œèƒ½åœ¨è¾ƒçŸ­çš„æ—¶é—´å¯¹ZSLæœ‰ä¸€å®šçš„è®¤è¯†ï¼Œå¹¶ä¸”å¯¹ç›®å‰çš„å‘å±•æƒ…å†µæœ‰ä¸€å®šçš„æŠŠæ¡ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦æåˆ°çš„æ˜¯ï¼šæ— è®ºæ˜¯è®ºæ–‡ç¬”è®°ï¼Œè¿˜æ˜¯æ€»ç»“æ€§çš„è¯»ç‰©ï¼Œéƒ½åŒ…å«äº†ä½œè€…è‡ªå·±çš„ç†è§£å’ŒäºŒæ¬¡åŠ å·¥ï¼Œæƒ³è¦åšå‡ºå¥½çš„å·¥ä½œå¿…å®šéœ€è¦è‡ªå·±çœ‹è®ºæ–‡å’Œæ€»ç»“ã€‚é›¶æ¬¡å­¦ä¹ ï¼ˆzero-shot learningï¼‰åŸºæœ¬æ¦‚å¿µæ¯æ¬¡åœ¨å®éªŒå®¤åšå·¥ä½œæ±‡æŠ¥çš„æ—¶å€™ï¼Œæ€»ä¼šæŠŠZSLçš„åŸºæœ¬æ¦‚å¿µè®²ä¸€éï¼Œä½†æ˜¯æ¯æ¬¡çš„æ•ˆæœéƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œå·¥ä½œéƒ½è®²å®Œäº†ï¼Œæçš„ç¬¬ä¸€ä¸ªé—®é¢˜ä¾ç„¶æ˜¯ï¼šZSLåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿè¿™è®©æˆ‘ä¸€åº¦è®¤ä¸ºæˆ‘çš„è¡¨è¾¾èƒ½åŠ›æœ‰é—®é¢˜ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸è¿‡å›å¿†èµ·æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œä¹ŸèŠ±äº†æŒºé•¿çš„æ—¶é—´æ‰ææ¸…æ¥šåˆ°åº•åœ¨åšä¸€ä»¶ä»€ä¹ˆäº‹æƒ…ï¼Œé‚£ç¯‡å…¥é—¨çš„æ–‡ç« [1]çœ‹äº†å¾ˆä¹…æ‰åŸºæœ¬çœ‹æ‡‚ã€‚å› æ­¤ï¼Œæˆ‘å°½é‡ç”¨æœ€ç®€å•çš„ï¼Œä¸å¸¦ä»»ä½•å…¬å¼çš„æ–¹å¼æ¥è®²ä¸€ä¸‹è¿™åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆé—®é¢˜ã€‚å‡è®¾å°æš—ï¼ˆçº¯ç²¹å› ä¸ºä¸æƒ³ç”¨å°æ˜ï¼‰å’Œçˆ¸çˆ¸ï¼Œåˆ°äº†åŠ¨ç‰©å›­ï¼Œçœ‹åˆ°äº†é©¬ï¼Œç„¶åçˆ¸çˆ¸å‘Šè¯‰ä»–ï¼Œè¿™å°±æ˜¯é©¬ï¼›ä¹‹åï¼Œåˆçœ‹åˆ°äº†è€è™ï¼Œå‘Šè¯‰ä»–ï¼šâ€œçœ‹ï¼Œè¿™ç§èº«ä¸Šæœ‰æ¡çº¹çš„åŠ¨ç‰©å°±æ˜¯è€è™ã€‚â€ï¼›æœ€åï¼Œåˆå¸¦ä»–å»çœ‹äº†ç†ŠçŒ«ï¼Œå¯¹ä»–è¯´ï¼šâ€œä½ çœ‹è¿™ç†ŠçŒ«æ˜¯é»‘ç™½è‰²çš„ã€‚â€ç„¶åï¼Œçˆ¸çˆ¸ç»™å°æš—å®‰æ’äº†ä¸€ä¸ªä»»åŠ¡ï¼Œè®©ä»–åœ¨åŠ¨ç‰©å›­é‡Œæ‰¾ä¸€ç§ä»–ä»æ²¡è§è¿‡çš„åŠ¨ç‰©ï¼Œå«æ–‘é©¬ï¼Œå¹¶å‘Šè¯‰äº†å°æš—æœ‰å…³äºæ–‘é©¬çš„ä¿¡æ¯ï¼šâ€œæ–‘é©¬æœ‰ç€é©¬çš„è½®å»“ï¼Œèº«ä¸Šæœ‰åƒè€è™ä¸€æ ·çš„æ¡çº¹ï¼Œè€Œä¸”å®ƒåƒç†ŠçŒ«ä¸€æ ·æ˜¯é»‘ç™½è‰²çš„ã€‚â€æœ€åï¼Œå°æš—æ ¹æ®çˆ¸çˆ¸çš„æç¤ºï¼Œåœ¨åŠ¨ç‰©å›­é‡Œæ‰¾åˆ°äº†æ–‘é©¬ï¼ˆæ„æ–™ä¹‹ä¸­çš„ç»“å±€ã€‚ã€‚ã€‚ï¼‰ã€‚ä¸Šè¿°ä¾‹å­ä¸­åŒ…å«äº†ä¸€ä¸ªäººç±»çš„æ¨ç†è¿‡ç¨‹ï¼Œå°±æ˜¯åˆ©ç”¨è¿‡å»çš„çŸ¥è¯†ï¼ˆé©¬ï¼Œè€è™ï¼Œç†ŠçŒ«å’Œæ–‘é©¬çš„æè¿°ï¼‰ï¼Œåœ¨è„‘æµ·ä¸­æ¨ç†å‡ºæ–°å¯¹è±¡çš„å…·ä½“å½¢æ€ï¼Œä»è€Œèƒ½å¯¹æ–°å¯¹è±¡è¿›è¡Œè¾¨è®¤ã€‚ï¼ˆå¦‚å›¾1æ‰€ç¤ºï¼‰ZSLå°±æ˜¯å¸Œæœ›èƒ½å¤Ÿæ¨¡ä»¿äººç±»çš„è¿™ä¸ªæ¨ç†è¿‡ç¨‹ï¼Œä½¿å¾—è®¡ç®—æœºå…·æœ‰è¯†åˆ«æ–°äº‹ç‰©çš„èƒ½åŠ›ã€‚å›¾1 ZSLæ¦‚å¿µå›¾[17]å¦‚ä»Šæ·±åº¦å­¦ä¹ éå¸¸ç«çƒ­ï¼Œä½¿å¾—çº¯ç›‘ç£å­¦ä¹ åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šéƒ½è¾¾åˆ°äº†è®©äººæƒŠå¹çš„ç»“æœï¼Œä½†å…¶é™åˆ¶æ˜¯ï¼šå¾€å¾€éœ€è¦è¶³å¤Ÿå¤šçš„æ ·æœ¬æ‰èƒ½è®­ç»ƒå‡ºè¶³å¤Ÿå¥½çš„æ¨¡å‹ï¼Œå¹¶ä¸”åˆ©ç”¨çŒ«ç‹—è®­ç»ƒå‡ºæ¥çš„åˆ†ç±»å™¨ï¼Œå°±åªèƒ½å¯¹çŒ«ç‹—è¿›è¡Œåˆ†ç±»ï¼Œå…¶ä»–çš„ç‰©ç§å®ƒéƒ½æ— æ³•è¯†åˆ«ã€‚è¿™æ ·çš„æ¨¡å‹æ˜¾ç„¶å¹¶ä¸ç¬¦åˆæˆ‘ä»¬å¯¹äººå·¥æ™ºèƒ½çš„ç»ˆææƒ³è±¡ï¼Œæˆ‘ä»¬å¸Œæœ›æœºå™¨èƒ½å¤Ÿåƒä¸Šæ–‡ä¸­çš„å°æš—ä¸€æ ·ï¼Œå…·æœ‰é€šè¿‡æ¨ç†ï¼Œè¯†åˆ«æ–°ç±»åˆ«çš„èƒ½åŠ›ã€‚ZSLå°±æ˜¯å¸Œæœ›æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå¯¹å…¶ä»æ²¡è§è¿‡çš„ç±»åˆ«è¿›è¡Œåˆ†ç±»ï¼Œè®©æœºå™¨å…·æœ‰æ¨ç†èƒ½åŠ›ï¼Œå®ç°çœŸæ­£çš„æ™ºèƒ½ã€‚å…¶ä¸­é›¶æ¬¡ï¼ˆZero-shotï¼‰æ˜¯æŒ‡å¯¹äºè¦åˆ†ç±»çš„ç±»åˆ«å¯¹è±¡ï¼Œä¸€æ¬¡ä¹Ÿä¸å­¦ä¹ ã€‚è¿™æ ·çš„èƒ½åŠ›å¬ä¸Šå»å¾ˆå…·æœ‰å¸å¼•åŠ›ï¼Œé‚£ä¹ˆåˆ°åº•æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬çš„æ¨¡å‹å·²ç»èƒ½å¤Ÿè¯†åˆ«é©¬ï¼Œè€è™å’Œç†ŠçŒ«äº†ï¼Œç°åœ¨éœ€è¦è¯¥æ¨¡å‹ä¹Ÿè¯†åˆ«æ–‘é©¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åƒçˆ¸çˆ¸ä¸€æ ·å‘Šè¯‰æ¨¡å‹ï¼Œæ€æ ·çš„å¯¹è±¡æ‰æ˜¯æ–‘é©¬ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥è®©æ¨¡å‹çœ‹è§æ–‘é©¬ã€‚æ‰€ä»¥æ¨¡å‹éœ€è¦çŸ¥é“çš„ä¿¡æ¯æ˜¯é©¬çš„æ ·æœ¬ã€è€è™çš„æ ·æœ¬ã€ç†ŠçŒ«çš„æ ·æœ¬å’Œæ ·æœ¬çš„æ ‡ç­¾ï¼Œä»¥åŠå…³äºå‰ä¸‰ç§åŠ¨ç‰©å’Œæ–‘é©¬çš„æè¿°ã€‚å°†å…¶è½¬æ¢ä¸ºå¸¸è§„çš„æœºå™¨å­¦ä¹ ï¼Œè¿™é‡Œæˆ‘ä»¬åªè®¨è®ºä¸€èˆ¬çš„å›¾ç‰‡åˆ†ç±»é—®é¢˜ï¼šï¼ˆ1ï¼‰è®­ç»ƒé›†æ•°æ® åŠå…¶æ ‡ç­¾ ï¼ŒåŒ…å«äº†æ¨¡å‹éœ€è¦å­¦ä¹ çš„ç±»åˆ«ï¼ˆé©¬ã€è€è™å’Œç†ŠçŒ«ï¼‰ï¼Œè¿™é‡Œå’Œä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ ä¸­çš„å®šä¹‰ä¸€è‡´ï¼›ï¼ˆ2ï¼‰æµ‹è¯•é›†æ•°æ® åŠå…¶æ ‡ç­¾ ï¼ŒåŒ…å«äº†æ¨¡å‹éœ€è¦è¾¨è¯†çš„ç±»åˆ«ï¼ˆæ–‘é©¬ï¼‰ï¼Œè¿™é‡Œå’Œä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ ä¸­ä¹Ÿå®šä¹‰ä¸€ç›´ï¼›ï¼ˆ3ï¼‰è®­ç»ƒé›†ç±»åˆ«çš„æè¿° ï¼Œä»¥åŠæµ‹è¯•é›†ç±»åˆ«çš„æè¿° ï¼›æˆ‘ä»¬å°†æ¯ä¸€ä¸ªç±»åˆ« ï¼Œéƒ½è¡¨ç¤ºæˆä¸€ä¸ªè¯­ä¹‰å‘é‡ çš„å½¢å¼ï¼Œè€Œè¿™ä¸ªè¯­ä¹‰å‘é‡çš„æ¯ä¸€ä¸ªç»´åº¦éƒ½è¡¨ç¤ºä¸€ç§é«˜çº§çš„å±æ€§ï¼Œæ¯”å¦‚â€œé»‘ç™½è‰²â€ã€â€œæœ‰å°¾å·´â€ã€â€œæœ‰ç¾½æ¯›â€ç­‰ç­‰ï¼Œå½“è¿™ä¸ªç±»åˆ«åŒ…å«è¿™ç§å±æ€§æ—¶ï¼Œé‚£åœ¨å…¶ç»´åº¦ä¸Šè¢«è®¾ç½®ä¸ºéé›¶å€¼ã€‚å¯¹äºä¸€ä¸ªæ•°æ®é›†æ¥è¯´ï¼Œè¯­ä¹‰å‘é‡çš„ç»´åº¦æ˜¯å›ºå®šçš„ï¼Œå®ƒåŒ…å«äº†èƒ½å¤Ÿè¾ƒå……åˆ†æè¿°æ•°æ®é›†ä¸­ç±»åˆ«çš„å±æ€§ã€‚åœ¨ZSLä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨ å’Œ æ¥è®­ç»ƒæ¨¡å‹ï¼Œè€Œæ¨¡å‹èƒ½å¤Ÿå…·æœ‰è¯†åˆ« çš„èƒ½åŠ›ï¼Œå› æ­¤æ¨¡å‹éœ€è¦çŸ¥é“æ‰€æœ‰ç±»åˆ«çš„æè¿° å’Œ ã€‚ZSLè¿™æ ·çš„è®¾ç½®å…¶å®å°±æ˜¯ä¸Šæ–‡ä¸­å°æš—è¯†åˆ«æ–‘é©¬çš„è¿‡ç¨‹ä¸­ï¼Œçˆ¸çˆ¸ä¸ºä»–æä¾›çš„æ¡ä»¶ã€‚å›¾2 ZSLè®¾ç½®å›¾[16]å¦‚å›¾2ï¼Œå¯ä»¥è¾ƒä¸ºç›´è§‚åœ°äº†è§£ZSLçš„è®¾ç½®ã€‚è®²åˆ°è¿™ï¼Œå¾ˆå¤šåŒå­¦å¯èƒ½ä¼šé—®ï¼šï¼ˆ1ï¼‰ç±»åˆ«çš„æè¿° åˆ°åº•æ˜¯æ€ä¹ˆè·å–çš„ï¼Ÿç­”ï¼šæœ‰äººå·¥ä¸“å®¶å®šä¹‰çš„ï¼Œä¹Ÿæœ‰é€šè¿‡æµ·é‡çš„é™„åŠ æ•°æ®é›†è‡ªåŠ¨å­¦ä¹ å‡ºæ¥çš„ï¼Œä½†å‰è€…çš„æ•ˆæœç›®å‰è¦å¥½å¾ˆå¤šã€‚ï¼ˆ2ï¼‰è¿™æ ·åšè®©äººè§‰å¾—æœ‰ç‚¹å¤±æœ›å‘€ï¼æˆ‘å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿåœ¨æ²¡æœ‰æ–‘é©¬æ ·æœ¬çš„æƒ…å†µä¸‹ï¼Œè¯†åˆ«æ–‘é©¬ï¼Œè€Œç°åœ¨ï¼Œè™½ç„¶æˆ‘ä¸éœ€è¦ä¸ºæ¨¡å‹æä¾›æ–‘é©¬çš„æ ·æœ¬ï¼Œä½†æ˜¯å´è¦ä¸ºæ¯ä¸€ä¸ªç±»åˆ«æ·»åŠ ä¸€ç§æè¿°ï¼Œæ›´ç¦»è°±çš„æ˜¯æˆ‘è¿˜éœ€è¦æ–‘é©¬ï¼ˆæµ‹è¯•é›†ï¼‰çš„æè¿°ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶æ²¡æœ‰æƒ³è±¡ä¸­æ™ºèƒ½è¯¶ï¼ç­”ï¼šçš„ç¡®ï¼Œåœ¨æˆ‘ä»¬çš„æƒ³è±¡ä¸­ï¼Œæˆ‘ä»¬æœŸå¾…çš„æ™ºèƒ½æ˜¯ï¼šåªç»™æœºå™¨é©¬ã€è€è™å’Œç†ŠçŒ«ï¼Œç„¶åå®ƒå°±å¯ä»¥è¯†åˆ«æ–‘é©¬äº†ï¼Œè¿™æ ·å¤šçˆ½ï¼Œå¤šç¥å¥‡ã€‚ä½†æˆ‘ä»¬å›è¿‡å¤´å»ï¼Œå†æƒ³æƒ³å°æš—çš„æ€è€ƒè¿‡ç¨‹ï¼Œå¦‚æœçˆ¸çˆ¸ä¸å‘Šè¯‰å°æš—å…³äºæ–‘é©¬çš„ä»»ä½•ä¿¡æ¯ï¼Œé‚£ä¹ˆå½“å°æš—çœ‹è§æ–‘é©¬çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šçŸ¥é“å®ƒæ˜¯ä»€ä¹ˆï¼Œåªæ˜¯å°æš—èƒ½å¤Ÿæè¿°å®ƒï¼šâ€œè¿™æ˜¯ä¸€åŒ¹æœ‰ç€é»‘ç™½é¢œè‰²æ¡çº¹çš„é©¬ã€‚â€è¿™é‡Œï¼Œæœ‰åŒå­¦å¯èƒ½åˆä¼šè¯´ï¼šè‡³å°‘æˆ‘ä»¬å¯ä»¥ä¸ç”¨å‘Šè¯‰å°æš—ç±»åˆ«çš„æè¿°å‘€ï¼Œä½†æ˜¯ZSLå°±ä¸è¡Œã€‚å…¶å®ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦å‘Šè¯‰å°æš—ç±»åˆ«æè¿°çš„ï¼Œæˆ–è€…è¯´å°æš—åœ¨ä¹‹å‰å°±å­¦ä¹ åˆ°äº†ç±»åˆ«æè¿°ï¼Œæ¯”å¦‚æ€æ ·çš„å›¾æ¡ˆæ˜¯â€œæ¡çº¹â€ï¼Œæ€æ ·çš„é¢œè‰²ç§°ä¸ºâ€œé»‘ç™½è‰²â€ï¼Œè¿™æ ·çš„å±æ€§å®šä¹‰ã€‚å¯¹äºä¸€ä¸ªæ¨¡å‹æ¥è¯´ï¼Œå®ƒå°±åƒåˆšå‡ºç”Ÿçš„å©´å„¿ï¼Œæˆ‘ä»¬éœ€è¦æ•™ä¼šå®ƒè¿™äº›å±æ€§çš„å®šä¹‰ã€‚ï¼ˆ3ï¼‰å°±ç®—æ˜¯è¿™æ ·ï¼Œéœ€è¦å®ç°å®šä¹‰è¿™ä¸ªæè¿° è¿˜æ˜¯å¾ˆè›‹ç–¼çš„ä¸€ä»¶äº‹æƒ…ã€‚ç­”ï¼šï¼ˆ1ï¼‰ä¸­å°±æœ‰æåˆ°ï¼Œæè¿° å¯ä»¥è‡ªåŠ¨å­¦ä¹ ï¼Œæˆ‘ä»¬å°†å°æš—å·²ç»æŒæ¡çš„çŸ¥è¯†æè¿°ä¸ºä¸€ä¸ªçŸ¥è¯†åº“ï¼Œè¿™ä¸ªçŸ¥è¯†åº“é‡Œå°±æœ‰å¯¹å„ç§å±æ€§çš„å®šä¹‰ï¼›è€Œèƒ½å¤Ÿæ¨¡ä»¿äººç±»çŸ¥è¯†åº“çš„æœ€å¥½ä¸œè¥¿å°±æ˜¯â€œç™¾åº¦ç™¾ç§‘â€ï¼Œâ€œç»´åŸºç™¾ç§‘â€ç­‰ç­‰å„ç§ç™¾ç§‘ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç™¾ç§‘ä¸­çš„å„ç§å®šä¹‰ï¼Œç”Ÿæˆç±»åˆ«çš„å®šä¹‰ï¼Œè¿™æ–¹é¢ä¾§é‡äºNLPï¼Œå› æ­¤ä¸è¿›ä¸€æ­¥è®¨è®ºã€‚åœ¨æ­¤ï¼Œæˆ‘ä»¬å°å°æ€»ç»“ä¸€ä¸‹ZSLé—®é¢˜çš„å®šä¹‰ã€‚åˆ©ç”¨è®­ç»ƒé›†æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿå¯¹æµ‹è¯•é›†çš„å¯¹è±¡è¿›è¡Œåˆ†ç±»ï¼Œä½†æ˜¯è®­ç»ƒé›†ç±»åˆ«å’Œæµ‹è¯•é›†ç±»åˆ«ä¹‹é—´æ²¡æœ‰äº¤é›†ï¼›æœŸé—´éœ€è¦å€ŸåŠ©ç±»åˆ«çš„æè¿°ï¼Œæ¥å»ºç«‹è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¹‹é—´çš„è”ç³»ï¼Œä»è€Œä½¿å¾—æ¨¡å‹æœ‰æ•ˆã€‚ç›®å‰çš„ç ”ç©¶æ–¹å¼åœ¨ä¸Šæ–‡ä¸­æåˆ°ï¼Œè¦å®ç°ZSLåŠŸèƒ½ä¼¼ä¹éœ€è¦è§£å†³ä¸¤ä¸ªéƒ¨åˆ†çš„é—®é¢˜ï¼šç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯è·å–åˆé€‚çš„ç±»åˆ«æè¿° ï¼›ç¬¬äºŒä¸ªé—®é¢˜æ˜¯å»ºç«‹ä¸€ä¸ªåˆé€‚çš„åˆ†ç±»æ¨¡å‹ã€‚ç›®å‰å¤§éƒ¨åˆ†å·¥ä½œéƒ½é›†ä¸­åœ¨ç¬¬äºŒä¸ªé—®é¢˜ä¸Šï¼Œè€Œç¬¬ä¸€ä¸ªé—®é¢˜çš„ç ”ç©¶è¿›å±•æ¯”è¾ƒç¼“æ…¢ã€‚ä¸ªäººè®¤ä¸ºçš„åŸå› æ˜¯ï¼Œ ç›®å‰ çš„è·å–ä¸»è¦é›†ä¸­äºä¸€äº›NLPçš„æ–¹æ³•ï¼Œè€Œä¸”éš¾åº¦è¾ƒå¤§ï¼›è€Œç¬¬äºŒä¸ªé—®é¢˜èƒ½å¤Ÿç”¨çš„æ–¹æ³•è¾ƒå¤šï¼Œæ¯”è¾ƒå®¹æ˜“å‡ºæˆæœã€‚å› æ­¤ï¼Œæ¥ä¸‹æ¥çš„ç®—æ³•éƒ¨åˆ†ï¼Œä¹Ÿåªä»‹ç»ç ”ç©¶åˆ†ç±»æ¨¡å‹çš„æ–¹æ³•ã€‚æ•°æ®é›†ä»‹ç»å…ˆä»‹ç»æ•°æ®é›†ï¼Œæ˜¯å› ä¸ºå¸Œæœ›åœ¨ç®—æ³•ä»‹ç»éƒ¨åˆ†ï¼Œç›´æ¥ç»™å‡ºå®ä¾‹ï¼Œè®©å¤§å®¶èƒ½å¤Ÿç›´æ¥ä¸Šæ‰‹ï¼Œè¿™é‡Œé¡ºä¾¿æ’ä¸ªæ²ç¥ ææ² çš„æ„Ÿæ‚Ÿã€‚è™½ç„¶åœ¨æˆ‘è®¤è¯†çš„äººé‡Œï¼Œå¥½äº›äººèƒ½å¤Ÿè¯»ä¸€ç¯‡è®ºæ–‡æˆ–è€…å¬ä¸€ä¸ªæŠ¥å‘Šåå°±èƒ½é—®å‡ºå¾ˆå¥½çš„é—®é¢˜ï¼Œç„¶åå°±åŸºæœ¬å¼„æ‡‚äº†ã€‚ä½†æˆ‘åœ¨è¿™ä¸ªä¸Šç¬¨å¾ˆå¤šã€‚è¯»è¿‡çš„è®ºæ–‡å°±åƒå–è¿‡çš„æ°´ï¼Œç¬¬äºŒå¤©å°±ä¸è®°å¾—äº†ã€‚ä¸€å®šæ˜¯éœ€è¦é™ä¸‹å¿ƒæ¥ï¼Œä»å¤´åˆ°å°¾å®ç°ä¸€ç¯‡ï¼Œè·‘ä¸Šå‡ ä¸ªæ•°æ®ï¼Œè°ƒäº›å‚æ•°ï¼Œæ‰èƒ½å¿ƒå®‰åœ°è§‰å¾—æ‡‚äº†ã€‚ä¾‹å¦‚åœ¨æ¸¯ç§‘å¤§çš„ä¸¤å¹´è¯»äº†å¾ˆå¤šè®ºæ–‡ï¼Œä½†ç°åœ¨åè¿‡æ¥çœ‹ï¼Œä»ç„¶è®°å¾—å¯èƒ½å°±æ˜¯é‚£ä¸¤ä¸ªè€è€å®å®åŠ¨æ‰‹å®ç°è¿‡å†™è¿‡è®ºæ–‡çš„æ¨¡å‹äº†ã€‚å³ä½¿åæ¥åœ¨æœºå™¨å­¦ä¹ è¿™ä¸ªæ–¹å‘åˆèµ°äº†äº”å¹´ï¼Œå­¦ä¹ ä»»ä½•æ–°ä¸œè¥¿ä»ç„¶æ˜¯è¦é åŠ¨æ‰‹ã€‚â€”â€”ææ²ï¼ˆMXNetå¼€å‘è€…ï¼‰ï¼ˆ1ï¼‰Animal with Attributesï¼ˆAwAï¼‰å®˜ç½‘ï¼šAnimals with Attributesæå‡ºZSLå®šä¹‰çš„ä½œè€…ï¼Œç»™å‡ºçš„æ•°æ®é›†ï¼Œéƒ½æ˜¯åŠ¨ç‰©çš„å›¾ç‰‡ï¼ŒåŒ…æ‹¬50ä¸ªç±»åˆ«çš„å›¾ç‰‡ï¼Œå…¶ä¸­40ä¸ªç±»åˆ«ä½œä¸ºè®­ç»ƒé›†ï¼Œ10ä¸ªç±»åˆ«ä½œä¸ºæµ‹è¯•é›†ï¼Œæ¯ä¸ªç±»åˆ«çš„è¯­ä¹‰ä¸º85ç»´ï¼Œæ€»å…±æœ‰30475å¼ å›¾ç‰‡ã€‚ä½†æ˜¯ç›®å‰ç”±äºç‰ˆæƒé—®é¢˜ï¼Œå·²ç»æ— æ³•è·å–è¿™ä¸ªæ•°æ®é›†çš„å›¾ç‰‡äº†ï¼Œä½œè€…ä¾¿æå‡ºäº†AwA2ï¼Œä¸å‰è€…ç±»ä¼¼ï¼Œæ€»å…±37322å¼ å›¾ç‰‡ã€‚ï¼ˆ2ï¼‰Caltech-UCSD-Birds-200-2011ï¼ˆCUBï¼‰å®˜ç½‘ï¼šCaltech-UCSD Birds-200-2011å…¨éƒ¨éƒ½æ˜¯é¸Ÿç±»çš„å›¾ç‰‡ï¼Œæ€»å…±200ç±»ï¼Œ150ç±»ä¸ºè®­ç»ƒé›†ï¼Œ50ç±»ä¸ºæµ‹è¯•é›†ï¼Œç±»åˆ«çš„è¯­ä¹‰ä¸º312ç»´ï¼Œæœ‰11788å¼ å›¾ç‰‡ã€‚ï¼ˆ3ï¼‰Sun databaseï¼ˆSUNï¼‰å®˜ç½‘ï¼šSUN Databaseæ€»å…±æœ‰717ä¸ªç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«20å¼ å›¾ç‰‡ï¼Œç±»åˆ«è¯­ä¹‰ä¸º102ç»´ã€‚ä¼ ç»Ÿçš„åˆ†æ³•æ˜¯è®­ç»ƒé›†707ç±»ï¼Œæµ‹è¯•é›†10ç±»ã€‚ï¼ˆ4ï¼‰Attribute Pascal and Yahoo datasetï¼ˆaPYï¼‰å®˜ç½‘ï¼šDescribing Objects by their Attributeså…±æœ‰32ä¸ªç±»ï¼Œå…¶ä¸­20ä¸ªç±»ä½œä¸ºè®­ç»ƒé›†ï¼Œ12ä¸ªç±»ä½œä¸ºæµ‹è¯•é›†ï¼Œç±»åˆ«è¯­ä¹‰ä¸º64ç»´ï¼Œå…±æœ‰15339å¼ å›¾ç‰‡ã€‚ï¼ˆ5ï¼‰ILSVRC2012/ILSVRC2010ï¼ˆImNet-2ï¼‰åˆ©ç”¨ImageNetåšæˆçš„æ•°æ®é›†ï¼Œç”±ILSVRC2012çš„1000ä¸ªç±»ä½œä¸ºè®­ç»ƒé›†ï¼ŒILSVRC2010çš„360ä¸ªç±»ä½œä¸ºæµ‹è¯•é›†ï¼Œæœ‰254000å¼ å›¾ç‰‡ã€‚å®ƒç”± 4.6M çš„Wikipediaæ•°æ®é›†è®­ç»ƒè€Œå¾—åˆ°ï¼Œå…±1000ç»´ã€‚ä¸Šè¿°æ•°æ®é›†ä¸­ï¼ˆ1ï¼‰-ï¼ˆ4ï¼‰éƒ½æ˜¯è¾ƒå°å‹ï¼ˆsmall-scaleï¼‰çš„æ•°æ®é›†ï¼Œï¼ˆ5ï¼‰æ˜¯å¤§å‹ï¼ˆlarge-scaleï¼‰æ•°æ®é›†ã€‚è™½ç„¶ï¼ˆ1ï¼‰-ï¼ˆ4ï¼‰å·²ç»æä¾›äº†äººå·¥å®šä¹‰çš„ç±»åˆ«è¯­ä¹‰ï¼Œä½†æ˜¯æœ‰äº›ä½œè€…ä¹Ÿä¼šä»ç»´åŸºè¯­æ–™åº“ä¸­è‡ªåŠ¨æå–å‡ºç±»åˆ«çš„è¯­ä¹‰è¡¨ç¤ºï¼Œæ¥æ£€æµ‹è‡ªå·±çš„æ¨¡å‹ã€‚è¿™é‡Œç»™å¤§å®¶æä¾›ä¸€äº›å·²ç»ç”¨GoogleNetæå–å¥½çš„æ•°æ®é›†å›¾ç‰‡ç‰¹å¾ï¼Œå¤§å®¶å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°ä½¿ç”¨ã€‚Zero-Shot Learingé—®é¢˜æ•°æ®é›†åˆ†äº«ï¼ˆGoogleNet æå–ï¼‰åŸºç¡€ç®—æ³•ä»‹ç»åœ¨æ­¤ï¼Œåªå…·ä½“ä»‹ç»æœ€ç®€å•çš„æ–¹æ³•ï¼Œè®©å¤§å®¶å¯ä»¥å¿«é€Ÿä¸Šæ‰‹ã€‚æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€ä¸ªå›¾ç‰‡åˆ†ç±»é—®é¢˜ï¼Œå³å¯¹æµ‹è¯•é›†çš„æ ·æœ¬ è¿›è¡Œåˆ†ç±»ï¼Œè€Œæˆ‘ä»¬åˆ†ç±»æ—¶éœ€è¦å€ŸåŠ©ç±»åˆ«çš„æè¿° ï¼Œç”±äºæ¯ä¸€ä¸ªç±»åˆ« ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªè¯­ä¹‰å‘é‡ ï¼Œå› æ­¤æˆ‘ä»¬ç°åœ¨å¯ä»¥å¿˜æ‰ ï¼Œç›´æ¥ä½¿ç”¨ ã€‚æˆ‘ä»¬æŠŠ ï¼ˆåˆ©ç”¨æ·±åº¦ç½‘ç»œæå–çš„å›¾ç‰‡ç‰¹å¾ï¼Œæ¯”å¦‚GoogleNetæå–ä¸º1024ç»´ï¼‰ç§°ä¸ºç‰¹å¾ç©ºé—´ï¼ˆvisual feature spaceï¼‰ï¼ŒæŠŠç±»åˆ«çš„è¯­ä¹‰è¡¨ç¤º ï¼Œç§°ä¸ºè¯­ä¹‰ç©ºé—´ã€‚æˆ‘ä»¬è¦åšçš„ï¼Œå…¶å®å°±æ˜¯å»ºç«‹ç‰¹å¾ç©ºé—´ä¸è¯­ä¹‰ç©ºé—´ä¹‹é—´çš„æ˜ å°„ã€‚å¯¹äºåˆ†ç±»ï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°çš„æœ€ç®€å•çš„å½¢å¼å°±æ˜¯å²­å›å½’ï¼ˆridge regressionï¼‰ï¼Œä¿—ç§°å‡æ–¹è¯¯å·®åŠ èŒƒæ•°çº¦æŸï¼Œå…·ä½“å½¢å¼ä¸ºï¼š (1)å…¶ä¸­ï¼Œ é€šå¸¸ä¸º2èŒƒæ•°çº¦æŸï¼Œ ä¸ºè¶…å‚ï¼Œå¯¹ æ±‚å¯¼ï¼Œå¹¶è®©å¯¼ä¸º0ï¼Œå³å¯æ±‚å‡º çš„å€¼ã€‚æµ‹è¯•æ—¶ï¼Œåˆ©ç”¨ å°† æŠ•å½±åˆ°è¯­ä¹‰ç©ºé—´ä¸­ï¼Œå¹¶åœ¨è¯¥ç©ºé—´ä¸­å¯»æ‰¾åˆ°ç¦»å®ƒæœ€è¿‘çš„ ï¼Œåˆ™æ ·æœ¬çš„ç±»åˆ«ä¸º æ‰€å¯¹åº”çš„æ ‡ç­¾ ã€‚ç®€å•å†™ä¸€ä¸ªmatlabå®ç°ã€‚regression_lambda = 1.0;W = ridge_regression(param.train_set, param.train_class_attributes, regression_lambda , 1024);S_test = param.test_set W;[zsl_accuracy]= zsl_el(S_test, param.S_te, param);fprintf(â€˜AwA ZSL accuracy on test set: %.1f%%\\nâ€™, zsl_accuracy100);æˆ‘ä»¬ä½¿ç”¨AwAæ•°æ®é›†ï¼Œå›¾ç‰‡äº‹å…ˆåˆ©ç”¨GoogleNetæå–äº†ç‰¹å¾ï¼ˆ1024ç»´ï¼‰ï¼Œåœ¨æµ‹è¯•é›†ä¸Šå¯ä»¥å¾—åˆ°59.1%çš„å‡†ç¡®ç‡ã€‚è¿™æ ·ä¸€ä¸ªå²­å›å½’ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºè®­ç»ƒé›†ç±»åˆ«è¯­ä¹‰ ä¸æµ‹è¯•é›†ç±»åˆ«è¯­ä¹‰ ä¹‹é—´å­˜åœ¨çš„å¯†åˆ‡è”ç³»ã€‚å…¶å®ä»»ä½•ZSLæ–¹æ³•æœ‰æ•ˆçš„åŸºç¡€ï¼Œéƒ½æ˜¯å› ä¸ºè¿™ä¸¤è€…ä¹‹é—´å…·ä½“çš„è”ç³»ã€‚ä»…ä»…åˆ©ç”¨å¦‚æ­¤naiveçš„æ–¹å¼ï¼Œå¾—åˆ°çš„ç»“æœæ˜¾ç„¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼Œé‚£ä¹ˆå»ºç«‹æ›´å¥½çš„æ¨¡å‹ï¼Œåˆ™éœ€è¦è¿›ä¸€æ­¥äº†è§£ZSLé—®é¢˜ä¸­ï¼Œå­˜åœ¨ç€å“ªäº›å’Œä¼ ç»Ÿç›‘ç£åˆ†ç±»çš„å·®å¼‚ã€‚ZSLä¸­å­˜åœ¨çš„é—®é¢˜åœ¨æ­¤ï¼Œä»‹ç»ä¸€äº›ç›®å‰ZSLä¸­ä¸»è¦å­˜åœ¨çš„é—®é¢˜ï¼Œä»¥ä¾¿è®©å¤§å®¶äº†è§£ç›®å‰ZSé¢†åŸŸæœ‰å“ªäº›ç ”ç©¶ç‚¹ã€‚é¢†åŸŸæ¼‚ç§»é—®é¢˜ï¼ˆdomain shift problemï¼‰è¯¥é—®é¢˜çš„æ­£å¼å®šä¹‰é¦–å…ˆç”±[2]æå‡ºã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åŒä¸€ç§å±æ€§ï¼Œåœ¨ä¸åŒçš„ç±»åˆ«ä¸­ï¼Œè§†è§‰ç‰¹å¾çš„è¡¨ç°å¯èƒ½å¾ˆå¤§ã€‚å¦‚å›¾3æ‰€ç¤ºï¼Œæ–‘é©¬å’ŒçŒªéƒ½æœ‰å°¾å·´ï¼Œå› æ­¤åœ¨å®ƒçš„ç±»åˆ«è¯­ä¹‰è¡¨ç¤ºä¸­ï¼Œâ€œæœ‰å°¾å·´â€è¿™ä¸€é¡¹éƒ½æ˜¯é0å€¼ï¼Œä½†æ˜¯ä¸¤è€…å°¾å·´çš„è§†è§‰ç‰¹å¾å´ç›¸å·®å¾ˆè¿œã€‚å¦‚æœæ–‘é©¬æ˜¯è®­ç»ƒé›†ï¼Œè€ŒçŒªæ˜¯æµ‹è¯•é›†ï¼Œé‚£ä¹ˆåˆ©ç”¨æ–‘é©¬è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹ï¼Œåˆ™å¾ˆéš¾æ­£ç¡®åœ°å¯¹çŒªè¿›è¡Œåˆ†ç±»ã€‚å›¾3 domain shiftç¤ºæ„å›¾ï¼Œå›¾ä¸­çš„prototypeè¡¨ç¤ºç±»åˆ«åœ¨è¯­ä¹‰ç©ºé—´ä¸­çš„ä½ç½®[2]æ¢çº½ç‚¹é—®é¢˜ï¼ˆHubness problemï¼‰è¿™å…¶å®æ˜¯é«˜ç»´ç©ºé—´ä¸­å›ºæœ‰çš„é—®é¢˜ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼ŒæŸäº›ç‚¹ä¼šæˆä¸ºå¤§å¤šæ•°ç‚¹çš„æœ€è¿‘é‚»ç‚¹ã€‚è¿™å¬ä¸Šå»æœ‰äº›åç›´è§‚ï¼Œç»†èŠ‚æ–¹é¢å¯ä»¥å‚è€ƒ[3]ã€‚ç”±äºZSLåœ¨è®¡ç®—æœ€ç»ˆçš„æ­£ç¡®ç‡æ—¶ï¼Œä½¿ç”¨çš„æ˜¯K-NNï¼Œæ‰€ä»¥ä¼šå—åˆ°hubness problemçš„å½±å“ï¼Œå¹¶ä¸”[4]ä¸­ï¼Œè¯æ˜äº†åŸºäºå²­å›å½’çš„æ–¹æ³•ä¼šåŠ é‡hubness problemé—®é¢˜ã€‚è¯­ä¹‰é—´éš”ï¼ˆsemantic gapï¼‰æ ·æœ¬çš„ç‰¹å¾å¾€å¾€æ˜¯è§†è§‰ç‰¹å¾ï¼Œæ¯”å¦‚ç”¨æ·±åº¦ç½‘ç»œæå–åˆ°çš„ç‰¹å¾ï¼Œè€Œè¯­ä¹‰è¡¨ç¤ºå´æ˜¯éè§†è§‰çš„ï¼Œè¿™ç›´æ¥ååº”åˆ°æ•°æ®ä¸Šå…¶å®å°±æ˜¯ï¼šæ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­æ‰€æ„æˆçš„æµå‹ä¸è¯­ä¹‰ç©ºé—´ä¸­ç±»åˆ«æ„æˆçš„æµå‹æ˜¯ä¸ä¸€è‡´çš„ã€‚ï¼ˆå¦‚å›¾4æ‰€ç¤ºï¼‰å›¾4 æµå‹ä¸ä¸€è‡´ç¤ºæ„å›¾[8]è¿™ä½¿å¾—ç›´æ¥å­¦ä¹ ä¸¤è€…ä¹‹é—´çš„æ˜ å°„å˜å¾—å›°éš¾ã€‚è¿˜æœ‰å…¶ä»–çš„ï¼Œæ¯”å¦‚semantic loss[5]é—®é¢˜ï¼Œæ ·æœ¬é€šè¿‡æ˜ å°„åå¡Œåˆ°ä¸€ç‚¹[6]ç­‰ï¼Œç”±äºè¿˜ä¸å¸¸ç ”ç©¶ï¼Œåœ¨æ­¤å°±ä¸å†è®¨è®ºã€‚åœ¨æ­¤ï¼Œæˆ‘ä»¬ç»™å‡ºè§£å†³ä¸Šè¿°ä¸‰ä¸ªé—®é¢˜çš„åŸºæœ¬æ–¹æ³•ï¼Œä»è€Œæ›´åŠ æ·±åº¦åœ°äº†è§£è¿™ä¸‰ä¸ªé—®é¢˜ã€‚ï¼ˆ1ï¼‰é¢†åŸŸæ¼‚ç§»ç”±äºæ ·æœ¬çš„ç‰¹å¾ç»´åº¦å¾€å¾€æ¯”è¯­ä¹‰çš„ç»´åº¦å¤§ï¼Œæ‰€ä»¥å»ºç«‹ä» åˆ° çš„æ˜ å°„å¾€å¾€ä¼šä¸¢å¤±ä¿¡æ¯ï¼Œä¸ºäº†ä¿ç•™æ›´å¤šçš„ä¿¡æ¯ï¼Œä¿æŒæ›´å¤šçš„ä¸°å¯Œæ€§ï¼Œæœ€æµè¡Œçš„åšæ³•æ˜¯å°†æ˜ å°„åˆ°è¯­ä¹‰ç©ºé—´ä¸­çš„æ ·æœ¬ï¼Œå†é‡å»ºå›å»ï¼Œè¿™æ ·å­¦ä¹ åˆ°çš„æ˜ å°„å°±èƒ½å¤Ÿå¾—åˆ°ä¿ç•™æ›´å¤šçš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œåœ¨åŸæ¥ç®€å•å²­å›å½’[1]çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å°†ç›®æ ‡å‡½æ•°æ”¹ä¸ºï¼š[7] (2)ä»ç›®æ ‡å‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œè¿™å…¶å®å®Œæˆçš„æ˜¯ä¸€ä¸ªç®€æ˜“çš„è‡ªç¼–ç å™¨è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç®€ç§°è¿™ä¸ªç®—æ³•ä¸ºSAEï¼Œåˆ©ç”¨matlabå¯ä»¥è½»æ¾å¯¹å…¶å®ç°ã€‚lambda1 = 800000;W = SAE(param.train_setâ€˜, param.train_class_attributesâ€™, lambda1);S_test = param.test_set NormalizeFea(Wâ€˜);[zsl_accuracy]= zsl_el(S_test, param.S_te, param);fprintf(â€˜AwA ZSL accuracy on test set: %.1f%%\\nâ€™, zsl_accuracy100);ä¾ç„¶æ˜¯åœ¨AwAä¸Šè¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥å¾—åˆ°83.2%çš„å‡†ç¡®ç‡ï¼Œæ¯”ç®€å•çš„å²­å›å½’(1)æé«˜äº†24.1%ã€‚è‡ªç¼–ç å™¨çš„è¿™ä¸ªç»“æ„ç›®å‰åœ¨ZSLæ–¹æ³•ä¸­éå¸¸æµè¡Œï¼Œç¨åæˆ‘ä»¬è¿˜ä¼šæåˆ°ã€‚ï¼ˆ2ï¼‰æ¢çº½ç‚¹é—®é¢˜ç›®å‰å¯¹äºæ¢çº½ç‚¹é—®é¢˜çš„è§£å†³ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼ša. å¦‚æœæ¨¡å‹å»ºç«‹çš„æ–¹å¼ä¸ºå²­å›å½’ï¼Œé‚£ä¹ˆå¯ä»¥å»ºç«‹ä»è¯­ä¹‰ç©ºé—´åˆ°ç‰¹å¾ç©ºé—´çš„æ˜ å°„ï¼Œä»è€Œä¸åŠ æ·±hubness problemå¯¹ç»“æœçš„å½±å“[4]ï¼Œä¹Ÿå°±æ˜¯è¯´å°†ç›®æ ‡å‡½æ•°ï¼ˆ1ï¼‰æ”¹ä¸ºï¼š (3)åœ¨AwAæ•°æ®é›†ä¸Šï¼Œè¿™ç§ç®€å•çš„æ”¹å˜èƒ½å¤Ÿå¾—åˆ°76.5%çš„æ­£ç¡®ç‡ï¼Œæ¯”åŸæœ¬æé«˜äº†17.4%ã€‚b.å¯ä»¥ä½¿ç”¨ç”Ÿæˆæ¨¡å‹ï¼Œæ¯”å¦‚è‡ªç¼–ç å™¨ã€GANç­‰ï¼Œç”Ÿæˆæµ‹è¯•é›†çš„æ ·æœ¬ï¼Œè¿™æ ·å°±å˜æˆäº†ä¸€ä¸ªä¼ ç»Ÿçš„ç›‘ç£åˆ†ç±»é—®é¢˜ï¼Œä¸å­˜åœ¨K-NNçš„æ“ä½œï¼Œæ‰€ä»¥ä¸å­˜åœ¨hubness problemçš„å½±å“ã€‚ï¼ˆ3ï¼‰è¯­ä¹‰é—´éš”é—®é¢˜è¯­ä¹‰é—´éš”é—®é¢˜çš„æœ¬è´¨æ˜¯äºŒè€…çš„æµå½¢ç»“æ„ä¸ä¸€è‡´ï¼Œå› æ­¤ï¼Œè§£å†³æ­¤é—®é¢˜çš„ç€æ‰‹ç‚¹å°±åœ¨äºå°†ä¸¤è€…çš„æµå½¢è°ƒæ•´åˆ°ä¸€è‡´ï¼Œå†å­¦ä¹ ä¸¤è€…ä¹‹é—´çš„æ˜ å°„[8]ã€‚æœ€ç®€å•çš„æ–¹æ³•è‡ªç„¶æ˜¯å°†ç±»åˆ«çš„è¯­ä¹‰è¡¨ç¤ºè°ƒæ•´åˆ°æ ·æœ¬çš„æµå‹ä¸Šï¼Œå³ç”¨ç±»åˆ«è¯­ä¹‰è¡¨ç¤ºçš„Kè¿‘é‚»æ ·æœ¬ç‚¹ï¼Œé‡æ–°è¡¨ç¤ºç±»åˆ«è¯­ä¹‰å³å¯ã€‚æœ‰å…³ZSLçš„ä¸€äº›å…¶ä»–çš„æ¦‚å¿µè¿™é‡Œå°†æåˆ°ä¸€äº›ZSLæ¶‰åŠåˆ°çš„å…¶ä»–æ¦‚å¿µã€‚ï¼ˆ1ï¼‰ç›´æ¨å¼å­¦ä¹ ï¼ˆTransductive settingï¼‰è¿™é‡Œçš„ç›´æ¨å¼å­¦ä¹ å…¶å®æ˜¯æŒ‡åœ¨è®­ç»ƒæ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æµ‹è¯•é›†çš„æ•°æ®ï¼Œåªæ˜¯ä¸èƒ½æ‹¿åˆ°æµ‹è¯•é›†çš„æ ·æœ¬çš„æ ‡ç­¾ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æµ‹è¯•é›†æ•°æ®ï¼Œå¾—åˆ°ä¸€äº›æµ‹è¯•é›†ç±»åˆ«çš„å…ˆéªŒçŸ¥è¯†ã€‚è¿™ç§è®¾ç½®åœ¨è¿ç§»å­¦ä¹ ä¸­å¾ˆå¸¸è§ã€‚å›¾5 éç›´æ¨å¼ï¼ˆinductiveï¼‰å’Œç›´æ¨å¼å­¦ä¹ çš„åŒºåˆ«[16]ï¼ˆ2ï¼‰æ³›åŒ–çš„ZSLï¼ˆgeneralized ZSLï¼‰ä¸Šæ–‡ä¸­æåˆ°çš„ZSLï¼Œåœ¨æµ‹è¯•æ—¶ä½¿ç”¨K-NNè¿›è¡Œæ­£ç¡®ç‡çš„è¯„ä¼°æ—¶ï¼Œåªåœ¨æµ‹è¯•ç±»åˆ«ä¸­æ‰¾æœ€è¿‘é‚»çš„ç±»åˆ«ï¼Œä½†æ˜¯åœ¨ç°å®çš„é—®é¢˜ä¸­ï¼Œæ‹¿åˆ°çš„æ ·æœ¬ä¹Ÿå¯èƒ½å±äºè®­ç»ƒé›†ç±»åˆ«ï¼Œå› æ­¤åœ¨æµ‹è¯•æ—¶ï¼ŒåŒæ—¶åŠ å…¥è®­ç»ƒé›†ç±»åˆ«ã€‚[9]ç°åœ¨çš„å¾ˆå¤šæ–¹æ³•éƒ½å¼€å§‹æµ‹è¯•æ¨¡å‹åœ¨è¿™ç§è®¾ç½®ä¸‹çš„èƒ½åŠ›ã€‚æ¨èé˜…è¯»çš„è®ºæ–‡æˆ‘ä¸€ç›´ä¸æƒ³å†™ZSLçš„å‘å±•å²ï¼Œå› ä¸ºæ®æˆ‘çš„ç»éªŒï¼Œå†™äº†ä¸€å¤§æ®µå‘å±•å²ä¹‹åï¼Œå¾€å¾€å¤§å®¶çš„å…´è‡´ä¸é«˜ï¼Œè€Œä¸”çœ‹å®Œä¹‹åä¸€èˆ¬éƒ½ä¸ä¼šæœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰ï¼ŒåŸºæœ¬ä¹Ÿè®°ä¸å¾—ä»€ä¹ˆä¸œè¥¿ã€‚æ‰€ä»¥å€’ä¸å¦‚ç»™å¤§å®¶æ¨èä¸€äº›è®ºæ–‡ï¼Œä»æœ€æ—©çš„åˆ°ç›®å‰æœ€æ–°çš„ï¼Œä½¿å¾—å¤§å®¶åœ¨çŸ­æ—¶é—´å†…èƒ½å¯¹ZSLçš„å‘å±•æœ‰ä¸€ä¸ªå¤§æ¦‚çš„æ¦‚å¿µã€‚ï¼ˆ1ï¼‰Learning To Detect Unseen Object Classes by Between-Class Attribute Transfer[1]ZSLé—®é¢˜çš„å¼€åˆ›æ€§æ–‡ç« ï¼Œå½“ç„¶æ˜¯å¿…è¯»çš„å–½ï¼Œè€Œä¸”å¯ä»¥é¡ºä¾¿çœ‹çœ‹åˆ«äººæ˜¯å¦‚ä½•é˜è¿°ä¸€ä¸ªæ–°é—®é¢˜ï¼ˆæŒ–å‘ï¼‰çš„ã€‚ï¼ˆ2ï¼‰An embarrassingly simple approach to zero-shot learning[10]æœ‰ç€å¾ˆå¼ºçš„ç†è®ºåŸºç¡€ï¼Œç®—æ³•ç®€å•ã€æœ‰æ•ˆï¼Œè™½ç„¶å·²ç»è¿‡å»å¾ˆå¤šå¹´äº†ï¼Œä½†è¿˜æ˜¯ç›®å‰æ–°å·¥ä½œéœ€è¦è¿›è¡Œå¯¹æ¯”çš„æ–¹æ³•ä¹‹ä¸€ã€‚ï¼ˆ3ï¼‰Transductive Multi-View Zero-Shot Learning[2]ç¬¬ä¸€æ¬¡å®šä¹‰äº†domain shifté—®é¢˜ã€‚ï¼ˆ4ï¼‰Zero-shot recognition using dual visualsemantic mapping paths[11]è§£å†³semantic gapé—®é¢˜çš„ç®€å•åšæ³•ã€‚ï¼ˆ5ï¼‰Predicting visual exemplars of unseen classes for zero-shot learning[12]ä»æœ¬è´¨çš„è§’åº¦å‡ºå‘ï¼Œå°†ZSLé—®é¢˜ï¼Œçœ‹ä½œèšç±»é—®é¢˜ï¼Œç”¨æœ€ç®€å•çš„æ–¹æ³•ç›´æ¥å»ºç«‹æ˜ å°„ã€‚ï¼ˆ6ï¼‰Semantic Autoencoder for Zero-Shot Learning[7]å¼•å…¥è‡ªç¼–ç å™¨ç»“æ„çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œç›´æ¥å¯¼è‡´ç°åœ¨å‡ºç°çš„æ–°æ–¹æ³•å¤§éƒ½å…·æœ‰è¿™ç§ç»“æ„ã€‚ï¼ˆ7ï¼‰Zero-Shot Learning - A Comprehensive Evaluation of the Good, the Bad and the Ugly[14]ç»¼è¿°æ€§çš„æ–‡ç« ï¼Œæ€»ç»“äº†17å¹´åº•ä»¥å‰çš„æ–¹æ³•ï¼Œæå‡ºäº†æ–°çš„è¯„ä»·æ ‡å‡†ï¼Œå¯¹å½“æ—¶é¢†åŸŸå‘å±•æ¯”è¾ƒæ··ä¹±çš„åœ°æ–¹åšå‡ºäº†ä¸€äº›æ›´æ ‡å‡†çš„è¯„ä¼°ã€‚ï¼ˆ8ï¼‰Zero-Shot Learning via Class-Conditioned Deep Generative Models[6]å°†[7]æ”¹é€ ä¸ºæ·±åº¦æ¨¡å‹ï¼Œå¹¶åŠ ä¸Šä¸€äº›å…¶ä»–çš„çº¦æŸã€‚ï¼ˆ9ï¼‰Preserving Semantic Relations for Zero-Shot Learning[13]åœ¨è‡ªç¼–ç å™¨ç»“æ„çš„åŸºç¡€ä¸Šï¼Œæ˜¾ç¤ºåœ°åŠ å…¥è¯­ä¹‰ç±»åˆ«ä¹‹é—´çš„å…³ç³»çº¦æŸã€‚ï¼ˆ10ï¼‰Recent Advances in Zero-shot Recognition[15]ç»¼è¿°æ€§çš„æ–‡ç« ï¼Œè¯»èµ·æ¥å¾ˆé¡ºç•…ï¼Œå¯ä»¥çœ‹çœ‹åˆ«äººæ˜¯æ€ä¹ˆå†™ç»¼è¿°ï¼Œä¸­é¡¶åˆŠçš„ã€‚ä»¥ä¸Šå‡ ç¯‡æ–‡ç« ï¼Œæ˜¯æˆ‘è®¤ä¸ºè¾ƒæœ‰ä»£è¡¨æ€§ï¼Œæ¯”è¾ƒå€¼å¾—è¯»çš„å·¥ä½œã€‚ä»£ç æœ‰å¾ˆå¤šå·¥ä½œï¼Œä½œè€…éƒ½æ˜¯æä¾›ä»£ç çš„ï¼Œæˆ‘è‡ªå·±ä¹Ÿå®ç°äº†ä¸€äº›å·¥ä½œï¼Œå¦‚æœæœ‰æ—¶é—´æˆ‘ä¼šå°†å…¶æ•´ç†åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ã€‚æˆ‘è‡ªå·±çš„çœ‹æ³•æˆ‘å½“åˆåšè¿™ä¸ªè¯¾é¢˜ï¼Œçº¯ç²¹æ˜¯å› ä¸ºé¡¹ç›®çš„éœ€è¦ï¼Œå†åŠ ä¸Šå½“æ—¶å¹¶æ²¡æœ‰æƒ³æ¸…æ¥šè‡ªå·±è¦åšä»€ä¹ˆï¼Œæ‰€ä»¥å°±åšç€è¯•è¯•äº†ã€‚ç›®å‰è¿™ä¸ªé¢†åŸŸå±äºå¾ˆå¥½å‘è®ºæ–‡çš„é˜¶æ®µï¼Œè€Œä¸”å¹¶ä¸éœ€è¦ååˆ†æ·±åˆ»çš„ç†è§£ï¼Œå°±èƒ½å‘ä¸é”™ç­‰çº§çš„æ–‡ç« ï¼Œæ¯”è¾ƒå®¹æ˜“èƒ½å¤Ÿçœ‹åˆ°å®ƒçš„å‘å±•è¶‹åŠ¿åŠä¸‹ä¸€æ­¥å¤§å®¶æ‰å †çš„åœ°æ–¹ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯åœ¨æ‹¼é€Ÿåº¦ï¼Œè€Œä¸æ˜¯æ‹¼æƒ³æ³•ã€‚ä½†å¥½å‘è®ºæ–‡ï¼Œå¹¶ä¸ä»£è¡¨å®ƒå‘å±•è¿…é€Ÿï¼Œåœ¨æˆ‘çœ‹æ¥ï¼ŒçœŸæ­£æœ‰è´¡çŒ®çš„å·¥ä½œå°‘ä¹‹åˆå°‘ï¼Œä¸”å…¶å¯¹æœ¬è´¨çš„ç ”ç©¶å‘å±•ç¼“æ…¢ã€‚å¹¶ä¸”ï¼Œè¯¥é—®é¢˜ç¦»å®é™…åº”ç”¨è¿˜å¤ªè¿œï¼Œå¾ˆå¯èƒ½å¹¶ä¸å±äºè¿™ä¸ªæ—¶ä»£ã€‚åŸºäºè¿™äº›åŸå› ï¼Œä¹‹å‰æœ‰ä¸€æ®µæ—¶é—´å¾ˆä¸æƒ³å†ç»§ç»­è¿™ä¸ªè¯¾é¢˜ã€‚ã€‚ã€‚æ€»ç»“ç¨å¾®æ€»ç»“ä¸€ä¸‹ï¼Œå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“è¦æ€»ç»“ä»€ä¹ˆï¼Œåªæ˜¯ä¹ æƒ¯äº†æ¯ç¯‡æ–‡ç« æœ€åéƒ½è¦å†™ä¸ªæ€»ç»“ã€‚èŠ±äº†å¤§æ¦‚ä¸€å¤©çš„æ—¶é—´ï¼Œå†™äº†è¿™ç¯‡ZSLå…¥é—¨æ–‡ç« ã€‚å†™å®ƒä¸€æ–¹é¢æ˜¯å› ä¸ºå¸Œæœ›èƒ½å¤Ÿæœ‰ä¸€ç¯‡ZSLçš„å…¥é—¨æ€§è´¨çš„è¯»ç‰©ï¼Œä¸ºå¤§å®¶æä¾›ä¾¿åˆ©ï¼›å¦ä¸€æ–¹é¢å°±æ˜¯è¿‘æœŸç§‘ç ”ä¸é¡ºï¼Œæ€»æ˜¯æ€€ç–‘è‡ªå·±ä¸æ˜¯è¯»ä¹¦çš„æ–™ï¼Œå†™å†™æ–‡ç« è®©è‡ªå·±å¿ƒæƒ…å¥½äº›ã€‚å¸Œæœ›å¤§å®¶é˜…è¯»ä¹‹åï¼Œèƒ½å¤Ÿå¾—åˆ°ä¸€å®šçš„å¸®åŠ©å§ï¼å…¶ä»–æ–‡ç« ä»“ä¿ƒä¹‹ä¸‹å†™çš„ï¼Œæ²¡æœ‰ç»è¿‡ä»€ä¹ˆæ„æ€ï¼Œå°±æ˜¯æƒ³åˆ°å“ªï¼Œå†™åˆ°å“ªã€‚åé¢æˆ‘åº”è¯¥è¿˜ä¼šä¿®æ”¹ï¼Œæ·»åŠ ä¸€äº›å…¶ä»–çš„å†…å®¹ï¼Œå¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºæˆ–è€…ç§ä¿¡ã€‚ç¥å¤§å®¶ç§‘ç ”é¡ºåˆ©ï¼ä¸ºäººç±»ç†è§£è¿™ä¸ªä¸–ç•Œåšä¸€ç‚¹ç‚¹è´¡çŒ®ï¼å‚è€ƒæ–‡çŒ®[1]Learning To Detect Unseen Object Classes by Between-Class Attribute Transfer[2]Transductive Multi-View Zero-Shot Learning.[3]Hubness and Pollution: Delving into Class-Space Mapping for Zero-Shot Learning.[4]Ridge Regression, Hubness, and Zero-Shot Learning.[5]Zero-Shot Visual Recognition using Semantics-Preserving Adversarial Embedding Network.[6]Zero-Shot Learning via Class-Conditioned Deep Generative Models.[7]Semantic Autoencoder for Zero-Shot Learning.[8]Zero-Shot Recognition using Dual Visual-Semantic Mapping Paths.[9]An Empirical Study and Analysis of Generalized Zero-Shot Learning for Object Recognition in the Wild.[10]An embarrassingly simple approach to zero-shot learning[11]Zero-shot recognition using dual visualsemantic mapping paths[12]Predicting visual exemplars of unseen classes for zero-shot learning[13]Preserving Semantic Relations for Zero-Shot Learning[14]Zero-Shot Learning - A Comprehensive Evaluation of the Good, the Bad and the Ugly[15]Recent Advances in Zero-shot Recognition[16]http://people.duke.edu/~ww107/material/ZSL.pdf[17]Attribute-Based Synthetic Network (ABS-Net): Learning More From Pseudo Feature Representation","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"è¿ç§»å­¦ä¹ ","slug":"è¿ç§»å­¦ä¹ ","permalink":"/tags/è¿ç§»å­¦ä¹ /"},{"name":"é›¶æ¬¡å­¦ä¹ ","slug":"é›¶æ¬¡å­¦ä¹ ","permalink":"/tags/é›¶æ¬¡å­¦ä¹ /"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]},{"title":"hexoéƒ¨ç½²åˆ°æœåŠ¡å™¨","slug":"hexoéƒ¨ç½²åˆ°æœåŠ¡å™¨","date":"2019-09-01T14:13:01.000Z","updated":"2019-09-01T14:19:19.615Z","comments":true,"path":"2019/09/01/hexoéƒ¨ç½²åˆ°æœåŠ¡å™¨/","link":"","permalink":"/2019/09/01/hexoéƒ¨ç½²åˆ°æœåŠ¡å™¨/","excerpt":"","text":"åŸæ¥æ˜¯éƒ¨ç½²åˆ° github å’Œ coding ä¸Šçš„ï¼Œè®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œå¹¶ä¸”å›¾åºŠ ä¸ƒç‰›äº‘ è‡ª 2018å¹´ 7æœˆèµ·ï¼Œæµ‹è¯•åŸŸåçš„ç”Ÿå‘½å‘¨æœŸåªæœ‰ 30ä¸ªè‡ªç„¶æ—¥ï¼Œè¿™è®©ç»´æŠ¤åšå®¢é€ æˆäº†å¾ˆå¤§çš„éº»çƒ¦ï¼Œäºæ˜¯ä¾¿å‡†å¤‡ä½¿ç”¨æœåŠ¡å™¨æ¥è¿›è¡Œéƒ¨ç½²äº†ã€‚éƒ¨ç½²ç¯å¢ƒæœ¬åœ°ç¯å¢ƒWindows10(64bit)ç¯å¢ƒï¼šgitï¼ŒNode.jsï¼Œhexoâ€¦ç”Ÿæˆæœ¬åœ°é™æ€ç½‘ç«™æœåŠ¡å™¨ç¯å¢ƒè…¾è®¯äº‘ä¸»æœº(CentOS 7.5 64bit)ç¯å¢ƒï¼šgitï¼ŒNginxï¼Œåˆ›å»º git ç”¨æˆ·ä½¿ç”¨ git è‡ªåŠ¨åŒ–éƒ¨ç½²å‘å¸ƒæœåŠ¡å™¨é…ç½®1. å®‰è£… Git (æºç åŒ…å®‰è£…)å› ä¸º yum æºä»“åº“çš„ Git ç‰ˆæœ¬æ›´æ–°ä¸åŠæ—¶ï¼Œæ‰€ä»¥é‡‡ç”¨æºç åŒ…è¿›è¡Œå®‰è£…ã€‚1.1 å®‰è£…ä¾èµ–åŒ…yum install curl-devel expat-devel gettext-devel openssl-devel zlib-develyum install gcc perl-ExtUtils-MakeMaker12é€šè¿‡å‘½ä»¤ git â€“version å¯ä»¥çœ‹åˆ°ï¼ŒGit å½“å‰çš„ç‰ˆæœ¬å·ä¸º 1.8.3.1ï¼Œå¤ªè¿‡äºé™ˆæ—§ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŠŠå®ƒç§»é™¤äº†ã€‚1.2 å¸è½½æ—§ç‰ˆæœ¬çš„ Gityum remove git11.3 ä¸‹è½½å¹¶è§£å‹cd /usr/local/src // é€‰æ‹©æ–‡ä»¶ä¿å­˜ä½ç½®wget https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.19.0.tar.gz // ä¸‹è½½é“¾æ¥tar -zxvf git-2.19.0.tar.gz // è§£å‹123git-2.19.0.tar.gz æ˜¯ç›®å‰æœ€æ–°ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬ä»¥åŠä¹‹åç‰ˆæœ¬å¯åˆ°æ­¤è¿›è¡ŒæŸ¥çœ‹ã€‚è§£å‹åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåä¸º git-2.19.0 çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å°±æ˜¯è§£å‹å‡ºæ¥çš„æ–‡ä»¶ã€‚å¯é€šè¿‡å‘½ä»¤ ls è¿›è¡ŒæŸ¥çœ‹ã€‚1.4 ç¼–è¯‘å®‰è£…cd git-2.19.0 // è¿›å…¥æ–‡ä»¶å¤¹make prefix=/usr/local/git all // ç¼–è¯‘æºç make prefix=/usr/local/git install // å®‰è£…è‡³ /usr/local/git è·¯å¾„123ç¼–è¯‘æ—¶ï¼Œç”±æœºå™¨é…ç½®å†³å®šé€Ÿåº¦ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚æ‰“å¼€ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ã€‚vim /etc/profile1åœ¨æ–‡ä»¶åº•éƒ¨æ·»åŠ ä»¥ä¸‹é…ç½®ã€‚PATH=$PATH:/usr/local/git/bin // git çš„ç›®å½•export PATH12ä¸¤ä¸ªè¯­å¥éƒ½è¦åŠ ä¸Šã€‚åˆ·æ–°ç¯å¢ƒå˜é‡ã€‚source /etc/profile1æœ€åå†ä½¿ç”¨ git â€“version æŸ¥çœ‹ç‰ˆæœ¬å·ï¼Œå·²ç»ä¸º 2.19.0ã€‚2. git æ–°ç”¨æˆ·åŠé…ç½®2.1 åˆ›å»º git ç”¨æˆ·adduser gitpasswd gitchmod 740 /etc/sudoersvim /etc/sudoers1234æ‰¾åˆ°ä»¥ä¸‹å†…å®¹ã€‚## Allow root to run any commands anywhereroot ALL=(ALL) ALL12åœ¨å®ƒä¸‹é¢æ·»åŠ ä¸€è¡Œã€‚git ALL=(ALL) ALL1ä¿å­˜å¹¶é€€å‡ºï¼Œå°†æƒé™ä¿®æ”¹å›æ¥ã€‚chmod 400 /etc/sudoers12.2 å¯†é’¥é…ç½®æœ¬åœ°ä¸­ï¼Œä½¿ç”¨ Git Bash åˆ›å»ºå¯†é’¥ã€‚# æœ¬åœ° windows gitBashssh-keygen -t rsa12ä¸€è·¯å›è½¦ï¼Œç›´è‡³å¦‚ä¸‹å›¾ï¼Œå³å¯ã€‚åˆ‡æ¢è‡³ git ç”¨æˆ·ï¼Œåˆ›å»º .ssh æ–‡ä»¶å¤¹ä»¥åŠ authorized_keys æ–‡ä»¶å¹¶å°†æœ¬åœ°çš„ id_rsa.pub æ–‡ä»¶å†…å®¹ç²˜è´´åˆ°é‡Œé¢ã€‚su gitmkdir ~/.sshvim ~/.ssh/authorized_keys123ä¿®æ”¹æƒé™ã€‚cd ~chmod 600 .ssh/authorzied_keyschmod 700 .ssh1232.3 æµ‹è¯•åœ¨æœ¬åœ° Windows ä¸Šï¼Œä½¿ç”¨ Git Bash æµ‹è¯•æ˜¯å¦èƒ½è¿æ¥ä¸ŠæœåŠ¡å™¨ã€‚ssh -v git@SERVER1å…¶ä¸­ SERVER ä¸ºæœåŠ¡å™¨ ip åœ°å€ã€‚è‹¥å‡ºç°ä»¥ä¸‹é”™è¯¯æç¤ºï¼Œæ£€æŸ¥æœ¬åœ°å¯†é’¥ä½ç½®æ˜¯å¦å­˜åœ¨ known_hosts æ–‡ä»¶ï¼Œå°†å…¶åˆ é™¤é‡æ–°æµ‹è¯•ã€‚æµ‹è¯•ç»“æœä¸ºï¼Œä¸éœ€è¦å¯†ç ç›´æ¥è¿›å…¥ã€‚é”™è¯¯æç¤ºï¼š2.4 åˆ›å»ºç½‘ç«™ç›®å½•åˆ›å»ºä¸€ä¸ªç›®å½•ç”¨äºä½œä¸ºç½‘ç«™çš„æ ¹ç›®å½•ã€‚su rootmkdir /home/hexo # æ­¤ç›®å½•ä¸ºç½‘ç«™çš„æ ¹ç›®å½•12èµ‹äºˆæƒé™ã€‚chown git:git -R /home/hexo13. å®‰è£…é…ç½® Nginxæ³¨æ„éœ€è¦ root æƒé™yum install -y nginx // å®‰è£…systemctl start nginx.service // å¯åŠ¨æœåŠ¡12ä½¿ç”¨ yum å®‰è£…çš„ nginx åœ¨æ–°ç‰ˆçš„ CentOS ä¸­ï¼Œéœ€è¦ä½¿ç”¨ systemctlï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ service start nginxæ­¤æ—¶é€šè¿‡æœåŠ¡å™¨çš„å…¬ç½‘ IP åœ°å€è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ° nginx çš„æ¬¢è¿é¡µé¢ï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸï¼Œå¦‚ä¸‹å›¾:3.2 é…ç½® Nginxä½¿ç”¨ nginx -t å‘½ä»¤æŸ¥çœ‹ä½ç½®ï¼Œä¸€èˆ¬ä¸º /etc/nginx/nginx.confã€‚ä½¿ç”¨ vim /etc/nginx/nginx.conf å‘½ä»¤è¿›è¡Œç¼–è¾‘ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼šserver { listen 80 default_server; listen [::]:80 default_server; server_name staunchkai.com; # ä¿®æ”¹ä¸ºè‡ªå·±çš„åŸŸå root /home/hexo; # ä¿®æ”¹ä¸ºç½‘ç«™çš„æ ¹ç›®å½• # Load configuration files for the default server block. include /etc/nginx/default.d/*.conf; location / { } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { }}1234567891011121314151617181920root å¤„çš„ç½‘ç«™ç›®å½•ï¼Œéœ€è¦è‡ªå·±åˆ›å»ºï¼Œä¹Ÿå°±æ˜¯éƒ¨ç½²ä¸Šä¼ çš„ä½ç½®ã€‚æ³¨æ„ä½¿ç”¨ nginx -t å‘½ä»¤æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•æ˜¯å¦å‡ºé”™ã€‚ç„¶åä½¿ç”¨ systemctl restart nginx.service å‘½ä»¤é‡å¯æœåŠ¡å³å¯ã€‚4. è‡ªåŠ¨åŒ–éƒ¨ç½²4.1 å»ºç«‹ git è£¸åº“åˆ›å»ºä¸€ä¸ªè£¸ä»“åº“ï¼Œè£¸ä»“åº“å°±æ˜¯åªä¿å­˜ git ä¿¡æ¯çš„ Repository, é¦–å…ˆåˆ‡æ¢åˆ° git ç”¨æˆ·ç¡®ä¿ git ç”¨æˆ·æ‹¥æœ‰ä»“åº“æ‰€æœ‰æƒï¼Œä¸€å®šè¦åŠ  â€“bareï¼Œè¿™æ ·æ‰æ˜¯ä¸€ä¸ªè£¸åº“ã€‚su rootcd /home/git # åœ¨ git ç”¨æˆ·ç›®å½•ä¸‹åˆ›å»ºgit init â€“bare blog.git123è¿™æ—¶ï¼Œgit ç”¨æˆ·çš„ ~ ç›®å½•ä¸‹å°±å­˜åœ¨ä¸€ä¸ª blog.git æ–‡ä»¶å¤¹ï¼Œå¯ä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ã€‚å†ä¿®æ”¹ blog.git çš„æƒé™ã€‚chown git:git -R blog.git14.2 ä½¿ç”¨ git-hooks åŒæ­¥ç½‘ç«™æ ¹ç›®å½•åœ¨è¿™ä½¿ç”¨çš„æ˜¯ post-receive è¿™ä¸ªé’©å­ï¼Œå½“ git æœ‰æ”¶å‘çš„æ—¶å€™å°±ä¼šè°ƒç”¨è¿™ä¸ªé’©å­ã€‚ åœ¨ blog.git è£¸åº“çš„ hooks æ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»º post-receive æ–‡ä»¶ã€‚vim blog.git/hooks/post-receive1å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼Œå…¶ä¸­ /home/hexo ä¸ºç½‘ç«™ç›®å½•ï¼Œæ ¹æ®è‡ªå·±çš„å¡«å…¥,ä¿å­˜é€€å‡ºã€‚#!/bin/shgit â€“work-tree=/home/hexo â€“git-dir=/home/git/blog.git checkout -f12ä¿å­˜åï¼Œè¦èµ‹äºˆè¿™ä¸ªæ–‡ä»¶å¯æ‰§è¡Œæƒé™ã€‚chmod +x /home/git/blog.git/hooks/post-receive1æœ¬åœ°é…ç½®åœ¨æœ¬åœ°ä¸­ï¼Œå’Œéƒ¨ç½²åˆ° pages æœåŠ¡ä¸€æ ·ï¼Œéœ€è¦å…ˆ hexo g å‘½ä»¤ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œé€šè¿‡ hexo s å‘½ä»¤èƒ½å¤Ÿæ­£å¸¸è¿›è¡Œæœ¬åœ°è®¿é—®ï¼Œå¹¶ä¸”ç¡®ä¿å·²ç»å®‰è£…äº† hexo-deployer-gitã€‚é…ç½® _config.ymlhexo æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œæ‰¾åˆ° deployã€‚deploy: type: git repo: git@SERVER:/home/git/blog.git # repository url branch: master # åˆ†æ”¯1234ä¹‹åæŒ‰ç…§æ­£å¸¸çš„æµç¨‹è¿›è¡Œéƒ¨ç½²å³å¯ã€‚hexo cleanhexo ghexo d123å¸¸è§é”™è¯¯git-receive-pack: æœªæ‰¾åˆ°å‘½ä»¤hexo dbash: git-receive-pack: command not foundfatal: Could not read from remote repository.123è§£å†³åŠæ³•ï¼šsudo ln -s /usr/local/git/bin/git-receive-pack /usr/bin/git-receive-pack1git-upload-pack: æœªæ‰¾åˆ°å‘½ä»¤æ­£å…‹éš†åˆ° â€˜blogâ€™â€¦bash: git-upload-pack: command not foundfatal: Could not read from remote repository.123è§£å†³åŠæ³•ï¼šsudo ln -s /usr/local/git/bin/git-upload-pack /usr/bin/git-upload-pack1ä¸æ˜¯ä¸€ä¸ª git ä»“åº“fatal: â€˜XXXX/blog.gitâ€™ does not appear to be a git repositoryfatal: Could not read from remote repository.12è§£å†³åŠæ³•ï¼šç¡®ä¿ _config.yml æ–‡ä»¶ä¸­ deploy å¤„çš„ repo è·¯å¾„å¡«å†™æ­£ç¡®ã€‚","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"},{"name":"hexo","slug":"hexo","permalink":"/tags/hexo/"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]},{"title":"æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•","slug":"æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•","date":"2019-08-28T07:36:47.000Z","updated":"2019-09-01T13:15:40.167Z","comments":true,"path":"2019/08/28/æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•/","link":"","permalink":"/2019/08/28/æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•/","excerpt":"","text":"è½¬è‡ªçŸ¥ä¹-åœ¨é«˜ä¸­çš„å­¦ä¹ ä¸­ï¼Œæœ‰å“ªä¸€ç¬é—´ä½ è§‰å¾—è‡ªå·±çœŸæ­£æ‡‚äº†ä¸€ä¸ªå¯¹é«˜è€ƒå·è§£é¢˜æœ‰å¤§ç”¨çš„ä¸œè¥¿ï¼Ÿ 14.è‹¥å®æ•°xï¼Œyæ»¡è¶³ï¼Œåˆ™å½“å–å¾—æœ€å¤§å€¼æ—¶ï¼Œçš„æœ€å¤§å€¼ä¸º_ã€è§£æã€‘é¦–å…ˆæˆ‘ä»¬è®¾ä¸€ä¸ªä¹˜æ•°Î»ï¼Œè®¾å‡½æ•°.è¿™æ˜¯ä¸€ä¸ªäºŒå…ƒå‡½æ•°ï¼Œä½†å¦‚æœæˆ‘ä»¬å¯ä»¥æŠŠyçœ‹ä½œå¸¸æ•°ï¼Œxçœ‹ä½œè‡ªå˜é‡ï¼Œæ±‚å¯¼ï¼Œå¹¶ä»¤å¯¼æ•°ç­‰äº0ï¼šâ€¦â€¦â‘ åŒç†ï¼Œæˆ‘ä»¬æŠŠxçœ‹ä½œå¸¸æ•°ï¼Œyçœ‹ä½œè‡ªå˜é‡ï¼Œæ±‚å¯¼ï¼šâ€¦â€¦â‘¡è§‚å¯Ÿè¿™ä¸¤ä¸ªå¼å­ï¼Œè®©æˆ‘ä»¬æŠŠä¹˜æ•°Î»æ¶ˆæ‰ï¼šâ‘ â‘¡å¾—ï¼Œå¦‚æœæˆ‘ä»¬æŠŠå¸¦å…¥ï¼ŒåŒæ ·èƒ½å¾—åˆ°ï¼›å› æ­¤ï¼Œ.ï¼ˆå·å·çœ‹äº†ä¸€ä¸‹ç­”æ¡ˆï¼Œå—¯ï¼Œæ²¡ç®—é”™ï¼‰ç†è®ºä¸Šæ˜¯è¦æ£€éªŒå­˜åœ¨æ€§ï¼Œä½†æ˜¯é«˜è€ƒå¡«ç©ºé¢˜ç­”æ¡ˆæ˜¾ç„¶ä¸å¯èƒ½ä¸å­˜åœ¨ã€‚ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼Œé‚£æ˜¯è€å¸ˆå‡ºé”™é¢˜ç›®äº†ï¼‰","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"/tags/æ•°å­¦/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"/tags/æœºå™¨å­¦ä¹ /"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]},{"title":"æœ´ç´ è´å¶æ–¯ä¸ºä½•â€œæœ´ç´ â€ï¼Ÿ","slug":"æœ´ç´ è´å¶æ–¯ä¸ºä½•_æœ´ç´ __","date":"2019-08-28T07:36:47.000Z","updated":"2019-09-01T13:14:24.072Z","comments":true,"path":"2019/08/28/æœ´ç´ è´å¶æ–¯ä¸ºä½•_æœ´ç´ __/","link":"","permalink":"/2019/08/28/æœ´ç´ è´å¶æ–¯ä¸ºä½•_æœ´ç´ __/","excerpt":"","text":"æœ´ç´ è´å¶æ–¯ï¼ˆnaive Bayes classifiersï¼‰æ˜¯ä¸€ç§åˆ†ç±»å™¨ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚ç›¸ä¿¡å¾ˆå¤šäººçŸ¥é“è´å¶æ–¯å®šç†,å³&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€ç»„äº‹ä»¶ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡è¿™ç»„äº‹ä»¶å»ä¼°è®¡ä¸€ä¸ªäº‹ä»¶Cå‘ç”Ÿçš„æ¦‚ç‡ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³ä¼°è®¡æ°´æœçš„ç§ç±»ï¼Œå¦‚æœæœ‰ä¸€ç»„äº‹ä»¶åˆ†åˆ« é»„ï¼Œé•¿ï¼Œå¼¯â€¦é‚£æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªé¦™è•‰ã€‚ å°½ç®¡é»„ï¼Œé•¿ï¼Œå¼¯å‡ ä¸ªäº‹ä»¶ä¹‹é—´å¯èƒ½ä¼šç›¸äº’ä¾èµ–ï¼Œä½†æ˜¯åœ¨æœ´ç´ è´å¶æ–¯æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å®ƒä»¬ç›¸äº’ç‹¬ç«‹ï¼Œè¿™å°±æ˜¯ä»–çš„æœ´ç´ ä¹‹å¤„ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„æœ´ç´ å¯¹åº”è‹±è¯­å•è¯naiveï¼Œå•çº¯çš„æ„æ€ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£ä¸ºå¾ˆå¤©çœŸå•çº¯çš„ä¼°è®¡ï¼ˆæŠŠæ•°æ®ä¸­çš„æ¯ä¸ªç‰¹å¾çœ‹ä½œç‹¬ç«‹åˆ†å¸ƒï¼‰ã€‚&nbsp;OKï¼Œç°åœ¨æˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹æœ´ç´ è´å¶æ–¯çš„æ¦‚ç‡æ¨¡å‹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡çš„æ¨¡å‹ï¼Œåœ¨å‘ç”Ÿçš„æ¡ä»¶ä¸‹å»ä¼°è®¡äº‹ä»¶Cçš„æ¦‚ç‡ï¼Œå³è®¡ç®—&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;æ ¹æ®è´å¶æ–¯å®šç†ï¼Œæˆ‘ä»¬æœ‰&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, å¦‚æœæ¯ä¸ªç‰¹å¾Fçš„å–å€¼è‡³å°‘æœ‰ä¸¤ä¸ªï¼Œç„¶åæœ‰100ä¸ªç‰¹å¾ï¼Œé‚£ç»™å®šä¸€ç»„æ•°æ®åï¼Œæƒ³è¦è®¡ç®—æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ï¼Œå› ä¸ºä½ çš„è”åˆåˆ†å¸ƒä¸­æœ‰ç§å¯èƒ½ï¼Œè¿™æ ·è®¡ç®—æœºæ˜¯æ— æ³•æ‰«æå®Œæ‰€æœ‰çš„æ¦‚ç‡ç©ºé—´çš„ï¼Œå³ä½¿å¯ä»¥ï¼Œåœ¨ä¼šå‡ºç°å¤§é‡çš„0ï¼ˆå³ä¸å­˜åœ¨çš„æŸç§ç»„åˆï¼‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰ç‰¹å¾Fä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„ç­‰å¼ï¼Œå³å¯å†™æˆ&nbsp; &nbsp; è¿™æ ·å³å¯ç®—å‡ºæˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"/tags/æ•°å­¦/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"/tags/æœºå™¨å­¦ä¹ /"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DDPO","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DPPO","date":"2019-08-24T13:24:02.000Z","updated":"2019-09-01T13:14:41.104Z","comments":true,"path":"2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DPPO/","link":"","permalink":"/2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DPPO/","excerpt":"","text":"æœ¬æ–‡è½¬è½½è‡ªè«çƒ¦-å¼ºåŒ–å­¦ä¹ -DPPOOpenAI:PPO è®ºæ–‡ Proximal Policy OptimizationGoogle DeepMind :DPPO è®ºæ–‡ Emergence of Locomotion Behaviours in Rich Environments è¦ç‚¹æ ¹æ® OpenAI çš„å®˜æ–¹åšå®¢, PPO å·²ç»æˆä¸ºä»–ä»¬åœ¨å¼ºåŒ–å­¦ä¹ ä¸Šçš„é»˜è®¤ç®—æ³•. å¦‚æœä¸€å¥è¯æ¦‚æ‹¬ PPO: OpenAI æå‡ºçš„ä¸€ç§è§£å†³ Policy Gradient ä¸å¥½ç¡®å®š Learning rate (æˆ–è€… Step size) çš„é—®é¢˜. å› ä¸ºå¦‚æœ step size è¿‡å¤§, å­¦å‡ºæ¥çš„ Policy ä¼šä¸€ç›´ä¹±åŠ¨, ä¸ä¼šæ”¶æ•›, ä½†å¦‚æœ Step Size å¤ªå°, å¯¹äºå®Œæˆè®­ç»ƒ, æˆ‘ä»¬ä¼šç­‰åˆ°ç»æœ›. PPO åˆ©ç”¨ New Policy å’Œ Old Policy çš„æ¯”ä¾‹, é™åˆ¶äº† New Policy çš„æ›´æ–°å¹…åº¦, è®© Policy Gradient å¯¹ç¨å¾®å¤§ç‚¹çš„ Step size ä¸é‚£ä¹ˆæ•æ„Ÿ. ç®—æ³•PPO çš„å‰ç”Ÿæ˜¯ OpenAI å‘è¡¨çš„ Trust Region Policy Optimization, ä½†æ˜¯ Google DeepMind çœ‹è¿‡ OpenAI å…³äº Trust Region Policy Optimization çš„ conference å, å´æŠ¢åœ¨ OpenAI å‰é¢ (2017å¹´7æœˆ7å·) æŠŠ Distributed PPOç»™å…ˆå‘å¸ƒäº†. æˆ‘è§‰å¾— DeepMind æœ‰ç‚¹æŠ¢, è¿™è®© OpenAI æœ‰ç‚¹éš¾å ª. ä¸è¿‡ OpenAI è¿˜æ˜¯åœ¨ 2017å¹´7æœˆ20å· å‘è¡¨äº†ä¸€ä»½æ‹¿å¾—å‡ºæ‰‹çš„ PPO è®ºæ–‡ (ä¼°è®¡æ˜¯çªç„¶çœ‹åˆ°äº† Google æŠ¢äº†è‡ªå·±çš„ä¸œè¥¿, æ‰€ä»¥èµ¶ç´§æŠŠè‡ªå·±çš„ä¹Ÿå‘äº†). OpenAI PPO è®ºæ–‡é‡Œç»™å‡ºçš„ç®—æ³•â€¦ å†™å¾—ä¹Ÿå¤ªç®€å•äº† (æ³¨æ„ä»–ä»¬è¿™ä¸ª PPO ç®—æ³•åº”è¯¥ç®—æ˜¯å•çº¿ç¨‹çš„):çœ‹äº†ä¸Šé¢çš„ä¸»ç»“æ„, è§‰å¾—å°‘äº†å¾ˆå¤šä¸œè¥¿. è¿™è®©æˆ‘ç›´æ¥è·‘å» DeepMind çš„ Paper çœ‹ä»–ä»¬æ€»ç»“ OpenAI conference ä¸Šçš„ PPO çš„ä»£ç :æ€»çš„æ¥è¯´ PPO æ˜¯ä¸€å¥— Actor-Critic ç»“æ„, Actor æƒ³æœ€å¤§åŒ– J_PPO, Critic æƒ³æœ€å°åŒ– L_BL. Critic çš„ loss å¥½è¯´, å°±æ˜¯å‡å° TD error. è€Œ Actor çš„å°±æ˜¯åœ¨ old Policy ä¸Šæ ¹æ® Advantage (TD error) ä¿®æ”¹ new Policy, advantage å¤§çš„æ—¶å€™, ä¿®æ”¹å¹…åº¦å¤§, è®© new Policy æ›´å¯èƒ½å‘ç”Ÿ. è€Œä¸”ä»–ä»¬é™„åŠ äº†ä¸€ä¸ª KL Penalty (æƒ©ç½šé¡¹, ä¸æ‡‚çš„åŒå­¦æœä¸€ä¸‹ KL divergence), ç®€å•æ¥è¯´, å¦‚æœ new Policy å’Œ old Policy å·®å¤ªå¤š, é‚£ KL divergence ä¹Ÿè¶Šå¤§, æˆ‘ä»¬ä¸å¸Œæœ› new Policy æ¯” old Policy å·®å¤ªå¤š, å¦‚æœä¼šå·®å¤ªå¤š, å°±ç›¸å½“äºç”¨äº†ä¸€ä¸ªå¤§çš„ Learning rate, è¿™æ ·æ˜¯ä¸å¥½çš„, éš¾æ”¶æ•›. å…³äº DeepMind åœ¨è¿™ç¯‡ paper ä¸­æå‡ºçš„ DPPO ç®—æ³•, å’Œæ€ä¹ˆæ ·æŠŠ OpenAI çš„ PPO å¤šçº¿ç¨‹. æˆ‘ä»¬ä¹‹ååœ¨ä¸‹é¢ç»†è¯´, æˆ‘ä»¬å…ˆæŠŠç®€å•çš„ PPO ç®—æ³•ç»™å®ç°. ç®€å• PPO çš„ä¸»ç»“æ„æˆ‘ä»¬ç”¨ Tensorflow æ­å»ºç¥ç»ç½‘ç»œ, tensorboard ä¸­å¯ä»¥çœ‹æ¸…æ™°çš„çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦‚æœæ­å»ºçš„:å›¾ä¸­çš„ pi å°±æ˜¯æˆ‘ä»¬çš„ Actor äº†. æ¯æ¬¡è¦è¿›è¡Œ PPO æ›´æ–° Actor å’Œ Critic çš„æ—¶å€™, æˆ‘ä»¬æœ‰éœ€è¦å°† pi çš„å‚æ•°å¤åˆ¶ç»™ oldpi. è¿™å°±æ˜¯ update_oldpi è¿™ä¸ª operation åœ¨åšçš„äº‹. Critic å’Œ Actor çš„å†…éƒ¨ç»“æ„, æˆ‘ä»¬ä¸ä¼šæ‰“å¼€ç»†è¯´äº†. å› ä¸ºå°±æ˜¯ä¸€å †çš„ç¥ç»ç½‘ç»œè€Œå·². è¿™é‡Œçš„ Actor ä½¿ç”¨äº† normal distribution æ­£æ€åˆ†å¸ƒè¾“å‡ºåŠ¨ä½œ. è¿™ä¸ª PPO æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª Python çš„ class ä»£æ›¿ï¼š class PPO(object): def __init__(self): # å»º Actor Critic ç½‘ç»œ # æ­è®¡ç®—å›¾çº¸ graph def update(self, s, a, r): # æ›´æ–° PPO def choose_action(self, s): # é€‰åŠ¨ä½œ def get_v(self, s): # ç®— state value è€Œè¿™ä¸ª PPO å’Œ env ç¯å¢ƒçš„äº’åŠ¨å¯ä»¥ç®€åŒ–æˆè¿™æ ·. ppo = PPO()for ep in range(EP_MAX): s = env.reset() buffer_s, buffer_a, buffer_r = [], [], [] for t in range(EP_LEN): env.render() a = ppo.choose_action(s) s_, r, done, _ = env.step(a) buffer_s.append(s) buffer_a.append(a) buffer_r.append((r+8)/8) # normalize reward, å‘ç°æœ‰å¸®åŠ© s = s_ # å¦‚æœ buffer æ”¶é›†ä¸€ä¸ª batch äº†æˆ–è€… episode å®Œäº† if (t+1) % BATCH == 0 or t == EP_LEN-1: # è®¡ç®— discounted reward v_s_ = ppo.get_v(s_) discounted_r = [] for r in buffer_r[::-1]: v_s_ = r + GAMMA * v_s_ discounted_r.append(v_s_) discounted_r.reverse() bs, ba, br = batch(buffer_s, buffer_a, discounted_r) # æ¸…ç©º buffer buffer_s, buffer_a, buffer_r = [], [], [] ppo.update(bs, ba, br) # æ›´æ–° PPO äº†è§£äº†è¿™äº›æ›´æ–°æ­¥éª¤, æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•æ›´æ–°æˆ‘ä»¬çš„ PPO. æˆ‘ä»¬æ›´æ–° Critic çš„æ—¶å€™æ˜¯æ ¹æ® åˆšåˆšè®¡ç®—çš„ discounted_r å’Œè‡ªå·±åˆ†æå‡ºæ¥çš„ state value è¿™ä¸¤è€…çš„å·® (advantage). ç„¶åæœ€å°åŒ–è¿™ä¸ªå·®å€¼ï¼š class PPO: def __init__(self): self.advantage = self.tfdc_r - self.v # discounted reward - Critic å‡ºæ¥çš„ state value self.closs = tf.reduce_mean(tf.square(self.advantage)) self.ctrain_op = tf.train.AdamOptimizer(C_LR).minimize(self.closs) åœ¨æ›´æ–° Actor çš„æ—¶å€™, å…¶å®æœ‰ä¸¤ç§æ–¹å¼, ä¸€ç§æ˜¯ç”¨ä¹‹å‰æåˆ°çš„ KL penalty æ¥æ›´æ–°.æˆ‘åœ¨ä»£ç ä¸­ä¹Ÿå†™ä¸Šçš„è¿™ç§æ–¹å¼çš„è®¡ç®—å›¾çº¸è¦æ€ä¹ˆæ­, ä¸è¿‡è¿˜æœ‰ä¸€ç§æ˜¯ OpenAI åœ¨ PPO è¿™ç¯‡ paper ä¸­æåˆ°çš„ clipped surrogate objective, surrogate objective å°±æ˜¯è¿™ä¸ª surrogate. ä»–ä»¬å®éªŒä¸­å¾—å‡ºçš„ç»“è®ºè¯´: clipped surrogate objective è¦æ¯” KL penalty å½¢å¼å¥½. é‚£ clipped surrogate objective åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢? å…¶å®å°±æ˜¯é™åˆ¶äº† surrogate çš„å˜åŒ–å¹…åº¦, å’Œ KL çš„è§„åˆ™å·®ä¸å¤š.è¿™é‡Œçš„ r(theta) æ˜¯ (New Policy/Old Policy) çš„æ¯”ä¾‹, å’Œå‰é¢çš„å…¬å¼ä¸€æ ·. class PPO: def __init__(self): self.tfa = tf.placeholder(tf.float32, [None, A_DIM], &apos;action&apos;) self.tfadv = tf.placeholder(tf.float32, [None, 1], &apos;advantage&apos;) with tf.variable_scope(&apos;loss&apos;): with tf.variable_scope(&apos;surrogate&apos;): ratio = pi.prob(self.tfa) / oldpi.prob(self.tfa) surr = ratio * self.tfadv # surrogate objective if METHOD[&apos;name&apos;] == &apos;kl_pen&apos;: # å¦‚æœç”¨ KL penatily self.tflam = tf.placeholder(tf.float32, None, &apos;lambda&apos;) kl = kl_divergence(oldpi, pi) self.kl_mean = tf.reduce_mean(kl) self.aloss = -(tf.reduce_mean(surr - self.tflam * kl)) else: # å¦‚æœç”¨ clipping çš„æ–¹å¼ self.aloss = -tf.reduce_mean(tf.minimum( surr, tf.clip_by_value(ratio, 1.-METHOD[&apos;epsilon&apos;], 1.+METHOD[&apos;epsilon&apos;])*self.tfadv)) with tf.variable_scope(&apos;atrain&apos;): self.atrain_op = tf.train.AdamOptimizer(A_LR).minimize(self.aloss) å¥½äº†, æ¥ä¸‹æ¥å°±æ˜¯æœ€é‡è¦çš„æ›´æ–° PPO æ—¶é—´äº†.æ³¨æ„çš„æ˜¯, è¿™ä¸ª update çš„æ­¥éª¤é‡Œ, æˆ‘ä»¬ç”¨ for loop æ›´æ–°äº†å¾ˆå¤šé Actor å’Œ Critic, åœ¨ loop ä¹‹å‰, pi å’Œ old pi æ˜¯ä¸€æ ·çš„, æ¯æ¬¡ loop çš„ä¹‹å, pi ä¼šå˜åŠ¨, è€Œ old pi ä¸å˜, è¿™æ ·è¿™ä¸ª surrogate å°±ä¼šå¼€å§‹å˜åŠ¨äº†. è¿™å°±æ˜¯ PPO çš„ç²¾è¾Ÿ. class PPO: def update(self, s, a, r): # å…ˆè¦å°† oldpi é‡Œçš„å‚æ•°æ›´æ–° pi ä¸­çš„ self.sess.run(self.update_oldpi_op) # æ›´æ–° Actor æ—¶, kl penalty å’Œ clipping æ–¹å¼æ˜¯ä¸åŒçš„ if METHOD[&apos;name&apos;] == &apos;kl_pen&apos;: # å¦‚æœç”¨ KL penalty for _ in range(A_UPDATE_STEPS): _, kl = self.sess.run( [self.atrain_op, self.kl_mean], &#123;self.tfs: s, self.tfa: a, self.tfadv: adv, self.tflam: METHOD[&apos;lam&apos;]&#125;) # ä¹‹åæ ¹æ® kl çš„å€¼, è°ƒæ•´ METHOD[&apos;lam&apos;] è¿™ä¸ªå‚æ•° else: # å¦‚æœç”¨ clipping çš„æ–¹æ³• [self.sess.run(self.atrain_op, &#123;self.tfs: s, self.tfa: a, self.tfadv: adv&#125;) for _ in range(A_UPDATE_STEPS)] # æ›´æ–° Critic çš„æ—¶å€™, ä»–ä»¬æ˜¯ä¸€æ ·çš„ [self.sess.run(self.ctrain_op, &#123;self.tfs: s, self.tfdc_r: r&#125;) for _ in range(C_UPDATE_STEPS)] æœ€åæˆ‘ä»¬çœ‹ä¸€å¼ å­¦ä¹ çš„æ•ˆæœå›¾ï¼šæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹æ€ä¹ˆæ ·æŠŠè¿™ä¸ªå•çº¿ç¨‹çš„ PPO å˜åˆ°å¤šçº¿ç¨‹å» (Distributed PPO). Distributed PPOGoogle DeepMind æå‡ºæ¥äº†ä¸€å¥—å’Œ A3Cç±»ä¼¼çš„å¹¶è¡Œ PPO ç®—æ³•. çœ‹äº†ä»–ä»¬ paper ä¸­çš„è¿™ä¸ª DPPO ç®—æ³•å, æˆ‘è§‰å¾—â€¦.ä¸å¥½ç¼–! å–è€Œä»£ä¹‹, æˆ‘è§‰å¾—å¦‚æœé‡‡ç”¨ OpenAI çš„æ€è·¯, ç”¨ä»–é‚£ä¸ª â€œç®€é™‹â€ ä¼ªä»£ç , ä½†æ˜¯å¼„æˆå¹¶è¡Œè®¡ç®—å€’æ˜¯å¥½å¼„ç‚¹. æ‰€ä»¥æˆ‘å°±ç»“åˆäº† DeepMind å’Œ OpenAI, å–ä»–ä»¬çš„ç²¾å, å†™ä¸‹äº†è¿™ä»½ DPPO çš„ä»£ç . æ€»ç»“ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆå†™çš„. ç”¨ OpenAI æå‡ºçš„ Clipped Surrogate Objective ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ (workers) å¹³è¡Œåœ¨ä¸åŒçš„ç¯å¢ƒä¸­æ”¶é›†æ•°æ® workers å…±äº«ä¸€ä¸ª Global PPO workers ä¸ä¼šè‡ªå·±ç®— PPO çš„ gradients, ä¸ä¼šåƒ A3C é‚£æ ·æ¨é€ Gradients ç»™ Global net workers åªæ¨é€è‡ªå·±é‡‡é›†çš„æ•°æ®ç»™ Global PPO Global PPO æ‹¿åˆ°å¤šä¸ª workers ä¸€å®šæ‰¹é‡çš„æ•°æ®åè¿›è¡Œæ›´æ–° (æ›´æ–°æ—¶ worker åœæ­¢é‡‡é›†) æ›´æ–°å®Œå, workers ç”¨æœ€æ–°çš„ Policy é‡‡é›†æ•°æ® ä¸è¿‡æœ‰äº›ç»†èŠ‚æˆ‘æƒ³æå‰æä¸€ä¸‹, æ–¹ä¾¿ä½ ä»¬ çœ‹ä»£ç ï¼š æˆ‘ç”¨åˆ°äº† python threading å½“ä¸­çš„ Event åŠŸèƒ½, ç”¨æ¥æ§åˆ¶ PPO çš„æ›´æ–°æ—¶é—´å’Œ worker åœæ­¢å·¥ä½œçš„æ—¶é—´ ä½¿ç”¨äº† threading ä¸­çš„ Queue æ¥å­˜æ”¾ worker æ”¶é›†çš„æ•°æ®, å‘ç°ç”¨ python çš„åˆ—è¡¨ä¹Ÿå¯ä»¥è¾¾åˆ°ä¸€æ ·æ•ˆæœ, è®¡ç®—æ—¶é—´ä¸Šæ²¡å¤ªå¤šå·®åˆ«. æ›´æ–° PPO çš„æ—¶å€™, æˆ‘é‡‡ç”¨çš„æ˜¯ DeepMind çš„ for loop å½¢å¼.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -A3C","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -A3C","date":"2019-08-24T13:24:02.000Z","updated":"2019-09-01T13:14:02.483Z","comments":true,"path":"2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -A3C/","link":"","permalink":"/2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -A3C/","excerpt":"","text":"æœ¬æ–‡è½¬è½½è‡ªè«çƒ¦-å¼ºåŒ–å­¦ä¹ -A3Cç›¸å…³è®ºæ–‡ï¼šAsynchronous Methods for Deep Reinforcement Learning ä»Šå¤©æˆ‘ä»¬ä¼šæ¥è¯´è¯´å¼ºåŒ–å­¦ä¹ ä¸­çš„ä¸€ç§æœ‰æ•ˆåˆ©ç”¨è®¡ç®—èµ„æº, å¹¶ä¸”èƒ½æå‡è®­ç»ƒæ•ˆç”¨çš„ç®—æ³•, Asynchronous Advantage Actor-Critic, ç®€ç§° A3C. ä»€ä¹ˆæ˜¯ Asynchronous Advantage Actor-Critic (A3C)å¹³è¡Œå®‡å®™æˆ‘ä»¬å…ˆè¯´è¯´æ²¡ä»€ä¹ˆå…³ç³»çš„,å¤§å®¶çŸ¥é“å¹³è¡Œå®‡å®™è¿™å›äº‹. æƒ³åƒç°åœ¨æœ‰ä¸‰ä¸ªå¹³è¡Œå®‡å®™, é‚£ä¹ˆå°±æ„å‘³ç€è¿™3ä¸ªå¹³è¡Œå®‡å®™ä¸Šå­˜åœ¨3ä¸ªä½ , è€Œä½ å¯èƒ½åœ¨ç”µè„‘å‰å‘†äº†å¾ˆä¹…, å¯¹, è¯´çš„å°±æ˜¯ä½ ! ç„¶åä½ ä¼šè¢«æˆ‘å‚¬ä¿ƒèµ·æ¥åšè¿åŠ¨~ æ¥ç€ä½  å’Œ ä½  è¿˜æœ‰ ä½ , å°±æ— å¥ˆåœ°åœ¨åšç€ä¸åŒçš„è¿åŠ¨, æ²¹~ æˆ‘æ‰ä¸æƒ³çŸ¥é“ä½ åœ¨åšä»€ä¹ˆæ ·çš„è¿åŠ¨å‘¢. ä¸è¿‡è¿™3ä¸ªä½  éƒ½å¼€å§‹æ´»åŠ¨èƒ«éª¨å•¦. å‡è®¾3ä¸ªä½ éƒ½èƒ½äº’ç›¸é€šä¿¡, å‘Šè¯‰å¯¹æ–¹, â€œæˆ‘è¿™ä¸ªåŠ¨ä½œå¯ä»¥æœ‰æ•ˆç¼“è§£æˆ‘çš„é¢ˆæ¤ç—…â€, â€œæˆ‘åšé‚£ä¸ªåŠ¨ä½œå, è…°å°±ä¸ç—›äº† â€œ, â€œæˆ‘æ´»åŠ¨äº†æ‰‹è‡‚, è‚©è†€å°±ä¸ç—›äº†â€. è¿™æ ·ä½ æ˜¯ä¸æ˜¯å°±åŒæ—¶å­¦åˆ°äº†å¯¹èº«ä½“å¥½çš„ä¸‰æ‹›. è¿™æ ·æ˜¯ä¸æ˜¯æ„Ÿè§‰ç‰¹åˆ«æœ‰æ•ˆç‡. è®©ä½ çœ‹çœ‹æ›´æœ‰æ•ˆç‡çš„, é‚£å°±æƒ³æƒ³3ä¸ªä½ åŒæ—¶åœ¨å†™ä½œä¸š, ä¸€å…±3é¢˜, æ¯äººåšä¸€é¢˜, åªç”¨äº†1/3 çš„æ—¶é—´å°±æŠŠä½œä¸šåšå®Œäº†. æ„Ÿè§‰æ£’æ£’çš„. å“ˆ, ä½ çœ‹å‡ºæ¥äº†, å¦‚æœæŠŠè¿™ç§æ–¹æ³•ç”¨åˆ°å¼ºåŒ–å­¦ä¹ , å²‚ä¸æ˜¯ â€œç‰›é€¼lityâ€.å¹³è¡Œè®­ç»ƒè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„ A3C.A3C å…¶å®åªæ˜¯è¿™ç§å¹³è¡Œæ–¹å¼çš„ä¸€ç§è€Œå·², å®ƒé‡‡ç”¨çš„æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ Actor-Critic çš„å½¢å¼. ä¸ºäº†è®­ç»ƒä¸€å¯¹ Actor å’Œ Critic, æˆ‘ä»¬å°†å®ƒå¤åˆ¶å¤šä»½çº¢è‰²çš„, ç„¶ååŒæ—¶æ”¾åœ¨ä¸åŒçš„å¹³è¡Œå®‡å®™å½“ä¸­, è®©ä»–ä»¬å„è‡ªç©å„çš„. ç„¶åæ¯ä¸ªçº¢è‰²å‰¯æœ¬éƒ½æ‚„æ‚„å‘Šè¯‰é»‘è‰²çš„ Actor-Critic è‡ªå·±åœ¨é‚£è¾¹çš„ä¸–ç•Œç©å¾—æ€ä¹ˆæ ·, æœ‰å“ªäº›ç»éªŒå€¼å¾—åˆ†äº«. ç„¶åè¿˜èƒ½ä»é»‘è‰²çš„ Actor-Critic è¿™è¾¹å†æ¬¡è·å–ç»¼åˆè€ƒé‡æ‰€æœ‰å‰¯æœ¬ç»éªŒåçš„é€šå…³ç§˜ç±. è¿™æ ·ä¸€æ¥ä¸€å›, å½¢æˆäº†ä¸€ç§æœ‰æ•ˆç‡çš„å¼ºåŒ–å­¦ä¹ æ–¹å¼.å¤šæ ¸è®­ç»ƒæˆ‘ä»¬çŸ¥é“ç›®å‰çš„è®¡ç®—æœºå¤šåŠæ˜¯æœ‰åŒæ ¸, 4æ ¸, ç”šè‡³ 6æ ¸, 8æ ¸. ä¸€èˆ¬çš„å­¦ä¹ æ–¹æ³•, æˆ‘ä»¬åªèƒ½è®©æœºå™¨äººåœ¨ä¸€ä¸ªæ ¸ä¸Šé¢ç©è€. ä½†æ˜¯å¦‚æœä½¿ç”¨ A3C çš„æ–¹æ³•, æˆ‘ä»¬å¯ä»¥ç»™ä»–ä»¬å®‰æ’å»ä¸åŒçš„æ ¸, å¹¶è¡Œè¿ç®—. å®éªŒç»“æœå°±æ˜¯, è¿™æ ·çš„è®¡ç®—æ–¹å¼å¾€å¾€æ¯”ä¼ ç»Ÿçš„æ–¹å¼å¿«ä¸Šå¥½å¤šå€. é‚£æˆ‘ä»¬ä¹Ÿå¤šç”¨ç”¨è¿™æ ·çš„çº¢åˆ©å§. A3Cä¸€å¥è¯æ¦‚æ‹¬ A3C: Google DeepMind æå‡ºçš„ä¸€ç§è§£å†³ Actor-Critic ä¸æ”¶æ•›é—®é¢˜çš„ç®—æ³•. å®ƒä¼šåˆ›å»ºå¤šä¸ªå¹¶è¡Œçš„ç¯å¢ƒ, è®©å¤šä¸ªæ‹¥æœ‰å‰¯ç»“æ„çš„ agent åŒæ—¶åœ¨è¿™äº›å¹¶è¡Œç¯å¢ƒä¸Šæ›´æ–°ä¸»ç»“æ„ä¸­çš„å‚æ•°. å¹¶è¡Œä¸­çš„ agent ä»¬äº’ä¸å¹²æ‰°, è€Œä¸»ç»“æ„çš„å‚æ•°æ›´æ–°å—åˆ°å‰¯ç»“æ„æäº¤æ›´æ–°çš„ä¸è¿ç»­æ€§å¹²æ‰°, æ‰€ä»¥æ›´æ–°çš„ç›¸å…³æ€§è¢«é™ä½, æ”¶æ•›æ€§æé«˜. ç®—æ³•A3C çš„ç®—æ³•å®é™…ä¸Šå°±æ˜¯å°† Actor-Critic æ”¾åœ¨äº†å¤šä¸ªçº¿ç¨‹ä¸­è¿›è¡ŒåŒæ­¥è®­ç»ƒ. å¯ä»¥æƒ³è±¡æˆå‡ ä¸ªäººåŒæ—¶åœ¨ç©ä¸€æ ·çš„æ¸¸æˆ, è€Œä»–ä»¬ç©æ¸¸æˆçš„ç»éªŒéƒ½ä¼šåŒæ­¥ä¸Šä¼ åˆ°ä¸€ä¸ªä¸­å¤®å¤§è„‘. ç„¶åä»–ä»¬åˆä»ä¸­å¤®å¤§è„‘ä¸­è·å–æœ€æ–°çš„ç©æ¸¸æˆæ–¹æ³•. è¿™æ ·, å¯¹äºè¿™å‡ ä¸ªäºº, ä»–ä»¬çš„å¥½å¤„æ˜¯: ä¸­å¤®å¤§è„‘æ±‡é›†äº†æ‰€æœ‰äººçš„ç»éªŒ, æ˜¯æœ€ä¼šç©æ¸¸æˆçš„ä¸€ä¸ª, ä»–ä»¬èƒ½æ—¶ä¸æ—¶è·å–åˆ°ä¸­å¤®å¤§è„‘çš„å¿…æ€æ‹›, ç”¨åœ¨è‡ªå·±çš„åœºæ™¯ä¸­. å¯¹äºä¸­å¤®å¤§è„‘çš„å¥½å¤„æ˜¯: ä¸­å¤®å¤§è„‘æœ€æ€•ä¸€ä¸ªäººçš„è¿ç»­æ€§æ›´æ–°, ä¸åªåŸºäºä¸€ä¸ªäººæ¨é€æ›´æ–°è¿™ç§æ–¹å¼èƒ½æ‰“æ¶ˆè¿™ç§è¿ç»­æ€§. ä½¿ä¸­å¤®å¤§è„‘ä¸å¿…æœ‰ç”¨åƒ DQN, DDPG é‚£æ ·çš„è®°å¿†åº“ä¹Ÿèƒ½å¾ˆå¥½çš„æ›´æ–°. ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„, æˆ‘ä»¬è¦æœ‰ä¸¤å¥—ä½“ç³», å¯ä»¥çœ‹ä½œä¸­å¤®å¤§è„‘æ‹¥æœ‰ global net å’Œä»–çš„å‚æ•°, æ¯ä½ç©å®¶æœ‰ä¸€ä¸ª global net çš„å‰¯æœ¬ local net, å¯ä»¥å®šæ—¶å‘ global net æ¨é€æ›´æ–°, ç„¶åå®šæ—¶ä» global net é‚£è·å–ç»¼åˆç‰ˆçš„æ›´æ–°.å¦‚æœåœ¨ tensorboard ä¸­æŸ¥çœ‹æˆ‘ä»¬ä»Šå¤©è¦å»ºç«‹çš„ä½“ç³», è¿™å°±æ˜¯ä½ ä¼šçœ‹åˆ°çš„.W_0 å°±æ˜¯ç¬¬0ä¸ª worker, æ¯ä¸ª worker éƒ½å¯ä»¥åˆ†äº« global_net.å¦‚æœæˆ‘ä»¬è°ƒç”¨ sync ä¸­çš„ pull, è¿™ä¸ª worker å°±ä¼šä» global_net ä¸­è·å–åˆ°æœ€æ–°çš„å‚æ•°.å¦‚æœæˆ‘ä»¬è°ƒç”¨ sync ä¸­çš„ push, è¿™ä¸ª worker å°±ä¼šå°†è‡ªå·±çš„ä¸ªäººæ›´æ–°æ¨é€å» global_net. ä¸»ç»“æ„æˆ‘ä»¬ç”¨ Tensorflow æ­å»ºç¥ç»ç½‘ç»œ, å¯¹äºæˆ‘ä»¬çš„ Actor, tensorboard ä¸­å¯ä»¥çœ‹æ¸…æ™°çš„çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦‚æœæ­å»ºçš„:æˆ‘ä»¬ä½¿ç”¨äº† Normal distribution æ¥é€‰æ‹©åŠ¨ä½œ, æ‰€ä»¥åœ¨æ­å»ºç¥ç»ç½‘ç»œçš„æ—¶å€™, actor è¿™è¾¹è¦è¾“å‡ºåŠ¨ä½œçš„å‡å€¼å’Œæ–¹å·®. ç„¶åæ”¾å…¥ Normal distribution å»é€‰æ‹©åŠ¨ä½œ. è®¡ç®— actor loss çš„æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨åˆ° critic æä¾›çš„ TD error ä½œä¸º gradient ascent çš„å¯¼å‘. critic å¾ˆç®€å•å•¦, åªéœ€è¦å¾—åˆ°ä»–å¯¹äº state çš„ä»·å€¼å°±å¥½äº†. ç”¨äºè®¡ç®— TD error. Actor Critic ç½‘ç»œå…¶æ­å»ºçš„ä»£ç éƒ¨åˆ†åœ¨è¿™ï¼šè¿™äº›åªæ˜¯åœ¨åˆ›å»ºç½‘ç»œè€Œå·², worker è¿˜æœ‰å±äºè‡ªå·±çš„ class, ç”¨æ¥æ‰§è¡Œåœ¨æ¯ä¸ªçº¿ç¨‹é‡Œçš„å·¥ä½œ.# è¿™ä¸ª class å¯ä»¥è¢«è°ƒç”¨ç”Ÿæˆä¸€ä¸ª global net.# ä¹Ÿèƒ½è¢«è°ƒç”¨ç”Ÿæˆä¸€ä¸ª worker çš„ net, å› ä¸ºä»–ä»¬çš„ç»“æ„æ˜¯ä¸€æ ·çš„,# æ‰€ä»¥è¿™ä¸ª class å¯ä»¥è¢«é‡å¤åˆ©ç”¨.class ACNet(object): def __init__(self, globalAC=None): # å½“åˆ›å»º worker ç½‘ç»œçš„æ—¶å€™, æˆ‘ä»¬ä¼ å…¥ä¹‹å‰åˆ›å»ºçš„ globalAC ç»™è¿™ä¸ª worker if è¿™æ˜¯ global: # åˆ¤æ–­å½“ä¸‹å»ºç«‹çš„ç½‘ç»œæ˜¯ local è¿˜æ˜¯ global with tf.variable_scope(&apos;Global_Net&apos;): self._build_net() else: with tf.variable_scope(&apos;worker&apos;): self._build_net() # æ¥ç€è®¡ç®— critic loss å’Œ actor loss # ç”¨è¿™ä¸¤ä¸ª loss è®¡ç®—è¦æ¨é€çš„ gradients with tf.name_scope(&apos;sync&apos;): # åŒæ­¥ with tf.name_scope(&apos;pull&apos;): # æ›´æ–°å» global with tf.name_scope(&apos;push&apos;): # è·å– global å‚æ•° def _build_net(self): # åœ¨è¿™é‡Œæ­å»º Actor å’Œ Critic çš„ç½‘ç»œ return å‡å€¼, æ–¹å·®, state_value def update_global(self, feed_dict): # è¿›è¡Œ push æ“ä½œ def pull_global(self): # è¿›è¡Œ pull æ“ä½œ def choose_action(self, s): # æ ¹æ® s é€‰åŠ¨ä½œ Workeræ¯ä¸ª worker æœ‰è‡ªå·±çš„ class, class é‡Œé¢æœ‰ä»–çš„å·¥ä½œå†…å®¹ work. class Worker(object): def __init__(self, name, globalAC): self.env = gym.make(GAME).unwrapped # åˆ›å»ºè‡ªå·±çš„ç¯å¢ƒ self.name = name # è‡ªå·±çš„åå­— self.AC = ACNet(name, globalAC) # è‡ªå·±çš„ local net, å¹¶ç»‘å®šä¸Š globalAC def work(self): # s, a, r çš„ç¼“å­˜, ç”¨äº n_steps æ›´æ–° buffer_s, buffer_a, buffer_r = [], [], [] while not COORD.should_stop() and GLOBAL_EP &lt; MAX_GLOBAL_EP: s = self.env.reset() for ep_t in range(MAX_EP_STEP): a = self.AC.choose_action(s) s_, r, done, info = self.env.step(a) buffer_s.append(s) # æ·»åŠ å„ç§ç¼“å­˜ buffer_a.append(a) buffer_r.append(r) # æ¯ UPDATE_GLOBAL_ITER æ­¥ æˆ–è€…å›åˆå®Œäº†, è¿›è¡Œ sync æ“ä½œ if total_step % UPDATE_GLOBAL_ITER == 0 or done: # è·å¾—ç”¨äºè®¡ç®— TD error çš„ ä¸‹ä¸€ state çš„ value if done: v_s_ = 0 # terminal else: v_s_ = SESS.run(self.AC.v, &#123;self.AC.s: s_[np.newaxis, :]&#125;)[0, 0] buffer_v_target = [] # ä¸‹ state value çš„ç¼“å­˜, ç”¨äºç®— TD for r in buffer_r[::-1]: # è¿›è¡Œ n_steps forward view v_s_ = r + GAMMA * v_s_ buffer_v_target.append(v_s_) buffer_v_target.reverse() buffer_s, buffer_a, buffer_v_target = np.vstack(buffer_s), np.vstack(buffer_a), np.vstack(buffer_v_target) feed_dict = &#123; self.AC.s: buffer_s, self.AC.a_his: buffer_a, self.AC.v_target: buffer_v_target, &#125; self.AC.update_global(feed_dict) # æ¨é€æ›´æ–°å» globalAC buffer_s, buffer_a, buffer_r = [], [], [] # æ¸…ç©ºç¼“å­˜ self.AC.pull_global() # è·å– globalAC çš„æœ€æ–°å‚æ•° s = s_ if done: GLOBAL_EP += 1 # åŠ ä¸€å›åˆ break # ç»“æŸè¿™å›åˆ Worker å¹¶è¡Œå·¥ä½œè¿™é‡Œæ‰æ˜¯çœŸæ­£çš„é‡ç‚¹! Worker çš„å¹¶è¡Œè®¡ç®—.with tf.device(&quot;/cpu:0&quot;): GLOBAL_AC = ACNet(GLOBAL_NET_SCOPE) # å»ºç«‹ Global AC workers = [] for i in range(N_WORKERS): # åˆ›å»º worker, ä¹‹ååœ¨å¹¶è¡Œ workers.append(Worker(GLOBAL_AC)) # æ¯ä¸ª worker éƒ½æœ‰å…±äº«è¿™ä¸ª global ACCOORD = tf.train.Coordinator() # Tensorflow ç”¨äºå¹¶è¡Œçš„å·¥å…·worker_threads = []for worker in workers: job = lambda: worker.work() t = threading.Thread(target=job) # æ·»åŠ ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ t.start() worker_threads.append(t)COORD.join(worker_threads) # tf çš„çº¿ç¨‹è°ƒåº¦ æˆ‘çš„ç”µè„‘é‡Œå¯ä»¥å»ºç«‹ 4ä¸ª worker, ä¹Ÿå°±å¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨4ä¸ªçº¿ç¨‹ä¸­å¹¶è¡Œæ¢ç´¢æ›´æ–°. æœ€åçš„å­¦ä¹ ç»“æœå¯ä»¥ç”¨è¿™ä¸ªè·å– moving average çš„ reward çš„å›¾æ¥æ¦‚æ‹¬. multiprocessing + A3Cé™¤æ­¤ä¹‹å¤–, æˆ‘å¿ƒé‡Œä¸€ç›´æœ‰ä¸€ä¸ªç–™ç˜©, å› ä¸ºè¿™ä¸ª A3C ä¸­, æˆ‘ç”¨çš„æ˜¯ python çš„ threading, æ‡‚ python çš„æœ‹å‹çŸ¥é“, threading æœ‰ GIL, è¿ç®—é€Ÿåº¦æ˜¯é—®é¢˜, æˆ‘çš„ CPU éƒ½ä¸æ˜¯æ»¡æ ¼çš„. æˆ‘ä¸€ç›´æƒ³æŠŠè¿™ä¸ª A3C ä»£ç ç§»æ¤å» multiprocessing, æé«˜æ•ˆç‡. ä½†æ˜¯ Tensorflow çš„ session å°±æ˜¯å’Œ multiprocessing ä¸å…¼å®¹, Global Net åšä¸å¥½. æ€ä¹ˆåŠ? Distributed Tensorflow æ˜¯ä¸€ä¸ªå¤‡é€‰æ–¹æ¡ˆ. ä½†æ˜¯è¿™ä¸ªè¦æ±‚ä½ æ˜¯åœ¨è®¡ç®—æœºé›†ç¾¤ä¸Šåš, ä¸ç„¶é€Ÿåº¦ä¸Šè¿˜ä¸å¦‚è¿™ä¸ª threading çš„ A3C. è¿™æ—¶, æˆ‘ä¸çˆ½äº†, åˆ°åœ¨çŸ¥ä¹ä¸ŠæŠ±æ€¨äº†ä¸€ç•ª. å’ŒçŸ¥å‹ä»¬èŠäº†ä¼š, ç„¶åæˆ‘æƒ³å‡ºäº†ä¸‹é¢è¿™ä¸ªæ–¹æ¡ˆ. å’Œ Tensorflow ä¸€æ ·, æˆ‘åšè¿‡ä¸€äº› Pytorch çš„æ•™ç¨‹, pytorch ä¹Ÿæ˜¯åšç¥ç»ç½‘ç»œçš„. ä½†æ˜¯å®ƒæ˜¯æ”¯æŒ multiprocessing çš„. æˆ‘ä¸“é—¨å¼€äº†ä¸€ä¸ª repo, æŠŠ Pytorch + multiprocessing çš„ä»£ç åˆ†äº«äº†å‡ºæ¥. è¿™ä¼šå„¿, CPU æ»¡æ ¼, å¿ƒæƒ…èˆ’ç•…å¤šäº†~","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Actor Critic","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Actor Critic","date":"2019-08-24T12:39:03.000Z","updated":"2019-09-01T13:14:37.732Z","comments":true,"path":"2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Actor Critic/","link":"","permalink":"/2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Actor Critic/","excerpt":"","text":"Actor Criticæœ¬æ–‡è½¬è½½è‡ªè«çƒ¦-å¼ºåŒ–å­¦ä¹ -Actor Criticä»Šå¤©æˆ‘ä»¬ä¼šæ¥è¯´è¯´å¼ºåŒ–å­¦ä¹ ä¸­çš„ä¸€ç§ç»“åˆä½“ Actor Critic (æ¼”å‘˜è¯„åˆ¤å®¶), å®ƒåˆå¹¶äº† ä»¥å€¼ä¸ºåŸºç¡€ (æ¯”å¦‚ Q learning) å’Œ ä»¥åŠ¨ä½œæ¦‚ç‡ä¸ºåŸºç¡€ (æ¯”å¦‚ Policy Gradients) ä¸¤ç±»å¼ºåŒ–å­¦ä¹ ç®—æ³•. ä¸ºä»€ä¹ˆè¦æœ‰Actorå’ŒCriticï¼Ÿæˆ‘ä»¬æœ‰äº†åƒ Q-learning è¿™ä¹ˆä¼Ÿå¤§çš„ç®—æ³•, ä¸ºä»€ä¹ˆè¿˜è¦çæŠ˜è…¾å‡ºä¸€ä¸ª Actor-Critic? åŸæ¥ Actor-Critic çš„ Actor çš„å‰ç”Ÿæ˜¯ Policy Gradients, è¿™èƒ½è®©å®ƒæ¯«ä¸è´¹åŠ›åœ°åœ¨è¿ç»­åŠ¨ä½œä¸­é€‰å–åˆé€‚çš„åŠ¨ä½œ, è€Œ Q-learning åšè¿™ä»¶äº‹ä¼šç˜«ç—ª. é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ Policy Gradients å‘¢? åŸæ¥ Actor Critic ä¸­çš„ Critic çš„å‰ç”Ÿæ˜¯ Q-learning æˆ–è€…å…¶ä»–çš„ ä»¥å€¼ä¸ºåŸºç¡€çš„å­¦ä¹ æ³• , èƒ½è¿›è¡Œå•æ­¥æ›´æ–°, è€Œä¼ ç»Ÿçš„ Policy Gradients åˆ™æ˜¯å›åˆæ›´æ–°, è¿™é™ä½äº†å­¦ä¹ æ•ˆç‡. Actorå’ŒCriticçš„åˆ†å·¥ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤å¥—ä¸åŒçš„ä½“ç³», Actor å’Œ Critic, ä»–ä»¬éƒ½èƒ½ç”¨ä¸åŒçš„ç¥ç»ç½‘ç»œæ¥ä»£æ›¿ . åœ¨ Policy Gradients çš„å½±ç‰‡ä¸­æåˆ°è¿‡, ç°å®ä¸­çš„å¥–æƒ©ä¼šå·¦å³ Actor çš„æ›´æ–°æƒ…å†µ. Policy Gradients ä¹Ÿæ˜¯é ç€è¿™ä¸ªæ¥è·å–é€‚å®œçš„æ›´æ–°. é‚£ä¹ˆä½•æ—¶ä¼šæœ‰å¥–æƒ©è¿™ç§ä¿¡æ¯èƒ½ä¸èƒ½è¢«å­¦ä¹ å‘¢? è¿™çœ‹èµ·æ¥ä¸å°±æ˜¯ ä»¥å€¼ä¸ºåŸºç¡€çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•åšè¿‡çš„äº‹å—. é‚£æˆ‘ä»¬å°±æ‹¿ä¸€ä¸ª Critic å»å­¦ä¹ è¿™äº›å¥–æƒ©æœºåˆ¶, å­¦ä¹ å®Œäº†ä»¥å. ç”± Actor æ¥æŒ‡æ‰‹ç”»è„š, ç”± Critic æ¥å‘Šè¯‰ Actor ä½ çš„é‚£äº›æŒ‡æ‰‹ç”»è„šå“ªäº›æŒ‡å¾—å¥½, å“ªäº›æŒ‡å¾—å·®, Critic é€šè¿‡å­¦ä¹ ç¯å¢ƒå’Œå¥–åŠ±ä¹‹é—´çš„å…³ç³», èƒ½çœ‹åˆ°ç°åœ¨æ‰€å¤„çŠ¶æ€çš„æ½œåœ¨å¥–åŠ±, æ‰€ä»¥ç”¨å®ƒæ¥æŒ‡ç‚¹ Actor ä¾¿èƒ½ä½¿ Actor æ¯ä¸€æ­¥éƒ½åœ¨æ›´æ–°, å¦‚æœä½¿ç”¨å•çº¯çš„ Policy Gradients, Actor åªèƒ½ç­‰åˆ°å›åˆç»“æŸæ‰èƒ½å¼€å§‹æ›´æ–°.ä½†æ˜¯äº‹ç‰©ç»ˆæœ‰å®ƒåçš„ä¸€é¢, Actor-Critic æ¶‰åŠåˆ°äº†ä¸¤ä¸ªç¥ç»ç½‘ç»œ, è€Œä¸”æ¯æ¬¡éƒ½æ˜¯åœ¨è¿ç»­çŠ¶æ€ä¸­æ›´æ–°å‚æ•°, æ¯æ¬¡å‚æ•°æ›´æ–°å‰åéƒ½å­˜åœ¨ç›¸å…³æ€§, å¯¼è‡´ç¥ç»ç½‘ç»œåªèƒ½ç‰‡é¢çš„çœ‹å¾…é—®é¢˜, ç”šè‡³å¯¼è‡´ç¥ç»ç½‘ç»œå­¦ä¸åˆ°ä¸œè¥¿. Google DeepMind ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, ä¿®æ”¹äº† Actor Critic çš„ç®—æ³•. æ”¹è¿›ç‰ˆ Deep Deterministic Policy Gradient (DDPG)å°†ä¹‹å‰åœ¨ç”µåŠ¨æ¸¸æˆ Atari ä¸Šè·å¾—æˆåŠŸçš„ DQN ç½‘ç»œåŠ å…¥è¿› Actor Critic ç³»ç»Ÿä¸­, è¿™ç§æ–°ç®—æ³•å«åš Deep Deterministic Policy Gradient, æˆåŠŸçš„è§£å†³çš„åœ¨è¿ç»­åŠ¨ä½œé¢„æµ‹ä¸Šçš„å­¦ä¸åˆ°ä¸œè¥¿é—®é¢˜. æ‰€ä»¥ä¹‹å, æˆ‘ä»¬å†æ¥è¯´è¯´ä»€ä¹ˆæ˜¯è¿™ç§é«˜çº§ç‰ˆæœ¬çš„ Deep Deterministic Policy Gradient å§. ä¸€å¥è¯æ¦‚æ‹¬ Actor Critic æ–¹æ³•:ç»“åˆäº† Policy Gradient (Actor) å’Œ Function Approximation (Critic) çš„æ–¹æ³•. Actor åŸºäºæ¦‚ç‡é€‰è¡Œä¸º, Critic åŸºäº Actor çš„è¡Œä¸ºè¯„åˆ¤è¡Œä¸ºçš„å¾—åˆ†, Actor æ ¹æ® Critic çš„è¯„åˆ†ä¿®æ”¹é€‰è¡Œä¸ºçš„æ¦‚ç‡. Actor Critic æ–¹æ³•çš„ä¼˜åŠ¿: å¯ä»¥è¿›è¡Œå•æ­¥æ›´æ–°, æ¯”ä¼ ç»Ÿçš„ Policy Gradient è¦å¿«. Actor Critic æ–¹æ³•çš„åŠ£åŠ¿:å–å†³äº Critic çš„ä»·å€¼åˆ¤æ–­, ä½†æ˜¯ Critic éš¾æ”¶æ•›, å†åŠ ä¸Š Actor çš„æ›´æ–°, å°±æ›´éš¾æ”¶æ•›. ä¸ºäº†è§£å†³æ”¶æ•›é—®é¢˜, Google Deepmind æå‡ºäº† Actor Critic å‡çº§ç‰ˆ Deep Deterministic Policy Gradient. åè€…èåˆäº† DQN çš„ä¼˜åŠ¿, è§£å†³äº†æ”¶æ•›éš¾çš„é—®é¢˜. æˆ‘ä»¬ä¹‹åä¹Ÿä¼šè¦è®²åˆ° Deep Deterministic Policy Gradient. ä¸è¿‡é‚£ä¸ªæ˜¯è¦ä»¥ Actor Critic ä¸ºåŸºç¡€, æ‡‚äº† Actor Critic, åé¢é‚£ä¸ªå°±å¥½æ‡‚äº†. ç®—æ³•è¿™å¥—ç®—æ³•æ˜¯åœ¨æ™®é€šçš„ Policy gradient ç®—æ³•ä¸Šé¢ä¿®æ”¹çš„, å¯¹è¿™å¥—ç®—æ³•æ‰“ä¸ªæ¯”æ–¹å¦‚ä¸‹:Actor ä¿®æ”¹è¡Œä¸ºæ—¶å°±åƒè’™ç€çœ¼ç›ä¸€ç›´å‘å‰å¼€è½¦, Critic å°±æ˜¯é‚£ä¸ªæ‰¶æ–¹å‘ç›˜æ”¹å˜ Actor å¼€è½¦æ–¹å‘çš„.æˆ–è€…è¯´è¯¦ç»†ç‚¹, å°±æ˜¯ Actor åœ¨è¿ç”¨ Policy Gradient çš„æ–¹æ³•è¿›è¡Œ Gradient ascent çš„æ—¶å€™, ç”± Critic æ¥å‘Šè¯‰ä»–, è¿™æ¬¡çš„ Gradient ascent æ˜¯ä¸æ˜¯ä¸€æ¬¡æ­£ç¡®çš„ ascent, å¦‚æœè¿™æ¬¡çš„å¾—åˆ†ä¸å¥½, é‚£ä¹ˆå°±ä¸è¦ ascent é‚£ä¹ˆå¤š. ä»£ç ä¸‹é¢æ˜¯Actorç¥ç»ç½‘ç»œçš„ç»“æ„æ¥ä¸‹æ¥æ˜¯Actorçš„ä»£ç ç»“æ„ï¼šclass Actor(object): def __init__(self, sess, n_features, n_actions, lr=0.001): # ç”¨ tensorflow å»ºç«‹ Actor ç¥ç»ç½‘ç»œ, # æ­å»ºå¥½è®­ç»ƒçš„ Graph. def learn(self, s, a, td): # s, a ç”¨äºäº§ç”Ÿ Gradient ascent çš„æ–¹å‘, # td æ¥è‡ª Critic, ç”¨äºå‘Šè¯‰ Actor è¿™æ–¹å‘å¯¹ä¸å¯¹. def choose_action(self, s): # æ ¹æ® s é€‰ è¡Œä¸º a ä¸‹é¢æ˜¯Criticç¥ç»ç½‘ç»œçš„ç»“æ„ï¼šä¸‹é¢æ˜¯Criticçš„ä»£ç ç»“æ„ï¼š class Critic(object): def __init__(self, sess, n_features, lr=0.01): # ç”¨ tensorflow å»ºç«‹ Critic ç¥ç»ç½‘ç»œ, # æ­å»ºå¥½è®­ç»ƒçš„ Graph. def learn(self, s, r, s_): # å­¦ä¹  çŠ¶æ€çš„ä»·å€¼ (state value), ä¸æ˜¯è¡Œä¸ºçš„ä»·å€¼ (action value), # è®¡ç®— TD_error = (r + v_) - v, # ç”¨ TD_error è¯„åˆ¤è¿™ä¸€æ­¥çš„è¡Œä¸ºæœ‰æ²¡æœ‰å¸¦æ¥æ¯”å¹³æ—¶æ›´å¥½çš„ç»“æœ, # å¯ä»¥æŠŠå®ƒçœ‹åš Advantage return # å­¦ä¹ æ—¶äº§ç”Ÿçš„ TD_error Actorå’ŒCriticçš„å­¦ä¹ æ–¹å¼Actor æƒ³è¦æœ€å¤§åŒ–æœŸæœ›çš„ reward, åœ¨ Actor Critic ç®—æ³•ä¸­, æˆ‘ä»¬ç”¨ â€œæ¯”å¹³æ—¶å¥½å¤šå°‘â€ (TD error) æ¥å½“åš reward, æ‰€ä»¥å°±æ˜¯: with tf.variable_scope(&apos;exp_v&apos;): log_prob = tf.log(self.acts_prob[0, self.a]) # log åŠ¨ä½œæ¦‚ç‡ self.exp_v = tf.reduce_mean(log_prob * self.td_error) # log æ¦‚ç‡ * TD æ–¹å‘with tf.variable_scope(&apos;train&apos;): # å› ä¸ºæˆ‘ä»¬æƒ³ä¸æ–­å¢åŠ è¿™ä¸ª exp_v (åŠ¨ä½œå¸¦æ¥çš„é¢å¤–ä»·å€¼), # æ‰€ä»¥æˆ‘ä»¬ç”¨è¿‡ minimize(-exp_v) çš„æ–¹å¼è¾¾åˆ° # maximize(exp_v) çš„ç›®çš„ self.train_op = tf.train.AdamOptimizer(lr).minimize(-self.exp_v) Critic çš„æ›´æ–°å¾ˆç®€å•, å°±æ˜¯åƒ Q learning é‚£æ ·æ›´æ–°ç°å®å’Œä¼°è®¡çš„è¯¯å·® (TD error) å°±å¥½äº†.with tf.variable_scope(&apos;squared_TD_error&apos;): self.td_error = self.r + GAMMA * self.v_ - self.v self.loss = tf.square(self.td_error) # TD_error = (r+gamma*V_next) - V_evalwith tf.variable_scope(&apos;train&apos;): self.train_op = tf.train.AdamOptimizer(lr).minimize(self.loss) æ¯å›åˆç®—æ³•for i_episode in range(MAX_EPISODE): s = env.reset() t = 0 track_r = [] # æ¯å›åˆçš„æ‰€æœ‰å¥–åŠ± while True: if RENDER: env.render() a = actor.choose_action(s) s_, r, done, info = env.step(a) if done: r = -20 # å›åˆç»“æŸçš„æƒ©ç½š track_r.append(r) td_error = critic.learn(s, r, s_) # Critic å­¦ä¹  gradient=grad[r+gamma*V(s_)-V(s)] actor.learn(s, a, td_error) # Actor å­¦ä¹  true_gradient=grad[logP(s,a)*td_error] s = s_ t += 1 if done or t &gt;= MAX_EP_STEPS: # å›åˆç»“æŸ, æ‰“å°å›åˆç´¯ç§¯å¥–åŠ± ep_rs_sum = sum(track_r) if &apos;running_reward&apos; not in globals(): running_reward = ep_rs_sum else: running_reward = running_reward * 0.95 + ep_rs_sum * 0.05 if running_reward &gt; DISPLAY_REWARD_THRESHOLD: RENDER = True # rendering print(&quot;episode:&quot;, i_episode, &quot; reward:&quot;, int(running_reward)) break","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Policy Gradients","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Policy Gradients","date":"2019-08-24T12:00:05.000Z","updated":"2019-09-01T13:14:46.808Z","comments":true,"path":"2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Policy Gradients/","link":"","permalink":"/2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Policy Gradients/","excerpt":"","text":"æœ¬æ–‡è½¬è½½è‡ªè«çƒ¦-å¼ºåŒ–å­¦ä¹ ç³»åˆ—-Policy Gradientså¼ºåŒ–å­¦ä¹ æ˜¯ä¸€ä¸ªé€šè¿‡å¥–æƒ©æ¥å­¦ä¹ æ­£ç¡®è¡Œä¸ºçš„æœºåˆ¶. å®¶æ—ä¸­æœ‰å¾ˆå¤šç§ä¸ä¸€æ ·çš„æˆå‘˜, æœ‰å­¦ä¹ å¥–æƒ©å€¼, æ ¹æ®è‡ªå·±è®¤ä¸ºçš„é«˜ä»·å€¼é€‰è¡Œä¸º, æ¯”å¦‚ Q learning, Deep Q Network, ä¹Ÿæœ‰ä¸é€šè¿‡åˆ†æå¥–åŠ±å€¼, ç›´æ¥è¾“å‡ºè¡Œä¸ºçš„æ–¹æ³•, è¿™å°±æ˜¯ä»Šå¤©è¦è¯´çš„ Policy Gradients äº†. ç”šè‡³æˆ‘ä»¬å¯ä»¥ä¸º Policy Gradients åŠ ä¸Šä¸€ä¸ªç¥ç»ç½‘ç»œæ¥è¾“å‡ºé¢„æµ‹çš„åŠ¨ä½œ. å¯¹æ¯”èµ·ä»¥å€¼ä¸ºåŸºç¡€çš„æ–¹æ³•, Policy Gradients ç›´æ¥è¾“å‡ºåŠ¨ä½œçš„æœ€å¤§å¥½å¤„å°±æ˜¯, å®ƒèƒ½åœ¨ä¸€ä¸ªè¿ç»­åŒºé—´å†…æŒ‘é€‰åŠ¨ä½œ, è€ŒåŸºäºå€¼çš„, æ¯”å¦‚ Q-learning, å®ƒå¦‚æœåœ¨æ— ç©·å¤šçš„åŠ¨ä½œä¸­è®¡ç®—ä»·å€¼, ä»è€Œé€‰æ‹©è¡Œä¸º, è¿™, å®ƒå¯åƒä¸æ¶ˆ. æ›´æ–°çš„ä¸åŒä¹‹å¤„æœ‰äº†ç¥ç»ç½‘ç»œå½“ç„¶æ–¹ä¾¿, ä½†æ˜¯, æˆ‘ä»¬æ€ä¹ˆè¿›è¡Œç¥ç»ç½‘ç»œçš„è¯¯å·®åå‘ä¼ é€’å‘¢? Policy Gradients çš„è¯¯å·®åˆæ˜¯ä»€ä¹ˆå‘¢? ç­”æ¡ˆæ˜¯! å“ˆå“ˆ, æ²¡æœ‰è¯¯å·®! ä½†æ˜¯ä»–çš„ç¡®æ˜¯åœ¨è¿›è¡ŒæŸä¸€ç§çš„åå‘ä¼ é€’. è¿™ç§åå‘ä¼ é€’çš„ç›®çš„æ˜¯è®©è¿™æ¬¡è¢«é€‰ä¸­çš„è¡Œä¸ºæ›´æœ‰å¯èƒ½åœ¨ä¸‹æ¬¡å‘ç”Ÿ. ä½†æ˜¯æˆ‘ä»¬è¦æ€ä¹ˆç¡®å®šè¿™ä¸ªè¡Œä¸ºæ˜¯ä¸æ˜¯åº”å½“è¢«å¢åŠ è¢«é€‰çš„æ¦‚ç‡å‘¢? è¿™æ—¶å€™æˆ‘ä»¬çš„è€æœ‹å‹, reward å¥–æƒ©æ­£å¯ä»¥åœ¨è¿™æ—¶å€™æ´¾ä¸Šç”¨åœº. å…·ä½“æ›´æ–°æ­¥éª¤ç°åœ¨æˆ‘ä»¬æ¥æ¼”ç¤ºä¸€é, è§‚æµ‹çš„ä¿¡æ¯é€šè¿‡ç¥ç»ç½‘ç»œåˆ†æ, é€‰å‡ºäº†å·¦è¾¹çš„è¡Œä¸º, æˆ‘ä»¬ç›´æ¥è¿›è¡Œåå‘ä¼ é€’, ä½¿ä¹‹ä¸‹æ¬¡è¢«é€‰çš„å¯èƒ½æ€§å¢åŠ , ä½†æ˜¯å¥–æƒ©ä¿¡æ¯å´å‘Šè¯‰æˆ‘ä»¬, è¿™æ¬¡çš„è¡Œä¸ºæ˜¯ä¸å¥½çš„, é‚£æˆ‘ä»¬çš„åŠ¨ä½œå¯èƒ½æ€§å¢åŠ çš„å¹…åº¦éšä¹‹è¢«å‡ä½. è¿™æ ·å°±èƒ½é å¥–åŠ±æ¥å·¦å³æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œåå‘ä¼ é€’. æˆ‘ä»¬å†æ¥ä¸¾ä¸ªä¾‹å­, å‡å¦‚è¿™æ¬¡çš„è§‚æµ‹ä¿¡æ¯è®©ç¥ç»ç½‘ç»œé€‰æ‹©äº†å³è¾¹çš„è¡Œä¸º, å³è¾¹çš„è¡Œä¸ºéšä¹‹æƒ³è¦è¿›è¡Œåå‘ä¼ é€’, ä½¿å³è¾¹çš„è¡Œä¸ºä¸‹æ¬¡è¢«å¤šé€‰ä¸€ç‚¹, è¿™æ—¶, å¥–æƒ©ä¿¡æ¯ä¹Ÿæ¥äº†, å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯å¥½è¡Œä¸º, é‚£æˆ‘ä»¬å°±åœ¨è¿™æ¬¡åå‘ä¼ é€’çš„æ—¶å€™åŠ å¤§åŠ›åº¦, è®©å®ƒä¸‹æ¬¡è¢«å¤šé€‰çš„å¹…åº¦æ›´çŒ›çƒˆ! è¿™å°±æ˜¯ Policy Gradients çš„æ ¸å¿ƒæ€æƒ³äº†. å¾ˆç®€å•å§. ç®—æ³•æ›´æ–°æˆ‘ä»¬ä»‹ç»çš„ policy gradient çš„ç¬¬ä¸€ä¸ªç®—æ³•æ˜¯ä¸€ç§åŸºäº æ•´æ¡å›åˆæ•°æ® çš„æ›´æ–°, ä¹Ÿå« REINFORCE æ–¹æ³•. è¿™ç§æ–¹æ³•æ˜¯ policy gradient çš„æœ€åŸºæœ¬æ–¹æ³•, æœ‰äº†è¿™ä¸ªçš„åŸºç¡€, æˆ‘ä»¬å†æ¥åšæ›´é«˜çº§çš„.delta(log(Policy(s,a))*V) è¡¨ç¤ºåœ¨ çŠ¶æ€ s å¯¹æ‰€é€‰åŠ¨ä½œ a çš„åƒæƒŠåº¦, å¦‚æœ Policy(s,a) æ¦‚ç‡è¶Šå°, åå‘çš„ log(Policy(s,a)) (å³ -log(P)) åè€Œè¶Šå¤§. å¦‚æœåœ¨ Policy(s,a) å¾ˆå°çš„æƒ…å†µä¸‹, æ‹¿åˆ°äº†ä¸€ä¸ª å¤§çš„ R, ä¹Ÿå°±æ˜¯ å¤§çš„ V, é‚£ -delta(log(Policy(s, a))*V) å°±æ›´å¤§, è¡¨ç¤ºæ›´åƒæƒŠ, (æˆ‘é€‰äº†ä¸€ä¸ªä¸å¸¸é€‰çš„åŠ¨ä½œ, å´å‘ç°åŸæ¥å®ƒèƒ½å¾—åˆ°äº†ä¸€ä¸ªå¥½çš„ reward, é‚£æˆ‘å°±å¾—å¯¹æˆ‘è¿™æ¬¡çš„å‚æ•°è¿›è¡Œä¸€ä¸ªå¤§å¹…ä¿®æ”¹). è¿™å°±æ˜¯åƒæƒŠåº¦çš„ç‰©ç†æ„ä¹‰å•¦. ä»£ç ç†è§£å› ä¸ºè¿™æ˜¯å¼ºåŒ–å­¦ä¹ , æ‰€ä»¥ç¥ç»ç½‘ç»œä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬ç†ŸçŸ¥çš„ç›‘ç£å­¦ä¹ ä¸­çš„ y label. å–è€Œä»£ä¹‹çš„æ˜¯æˆ‘ä»¬é€‰çš„ action. class PolicyGradient: def __init__(self, n_actions, n_features, learning_rate=0.01, reward_decay=0.95, output_graph=False): ... def _build_net(self): with tf.name_scope(&apos;inputs&apos;): self.tf_obs = tf.placeholder(tf.float32, [None, self.n_features], name=&quot;observations&quot;) # æ¥æ”¶ observation self.tf_acts = tf.placeholder(tf.int32, [None, ], name=&quot;actions_num&quot;) # æ¥æ”¶æˆ‘ä»¬åœ¨è¿™ä¸ªå›åˆä¸­é€‰è¿‡çš„ actions self.tf_vt = tf.placeholder(tf.float32, [None, ], name=&quot;actions_value&quot;) # æ¥æ”¶æ¯ä¸ª state-action æ‰€å¯¹åº”çš„ value (é€šè¿‡ reward è®¡ç®—) # fc1 layer = tf.layers.dense( inputs=self.tf_obs, units=10, # è¾“å‡ºä¸ªæ•° activation=tf.nn.tanh, # æ¿€åŠ±å‡½æ•° kernel_initializer=tf.random_normal_initializer(mean=0, stddev=0.3), bias_initializer=tf.constant_initializer(0.1), name=&apos;fc1&apos; ) # fc2 all_act = tf.layers.dense( inputs=layer, units=self.n_actions, # è¾“å‡ºä¸ªæ•° activation=None, # ä¹‹åå†åŠ  Softmax kernel_initializer=tf.random_normal_initializer(mean=0, stddev=0.3), bias_initializer=tf.constant_initializer(0.1), name=&apos;fc2&apos; ) self.all_act_prob = tf.nn.softmax(all_act, name=&apos;act_prob&apos;) # æ¿€åŠ±å‡½æ•° softmax å‡ºæ¦‚ç‡ with tf.name_scope(&apos;loss&apos;): # æœ€å¤§åŒ– æ€»ä½“ reward (log_p * R) å°±æ˜¯åœ¨æœ€å°åŒ– -(log_p * R), è€Œ tf çš„åŠŸèƒ½é‡Œåªæœ‰æœ€å°åŒ– loss neg_log_prob = tf.nn.sparse_softmax_cross_entropy_with_logits(logits=all_act, labels=self.tf_acts) # æ‰€é€‰ action çš„æ¦‚ç‡ -log å€¼ # ä¸‹é¢çš„æ–¹å¼æ˜¯ä¸€æ ·çš„: # neg_log_prob = tf.reduce_sum(-tf.log(self.all_act_prob)*tf.one_hot(self.tf_acts, self.n_actions), axis=1) loss = tf.reduce_mean(neg_log_prob * self.tf_vt) # (vt = æœ¬reward + è¡°å‡çš„æœªæ¥reward) å¼•å¯¼å‚æ•°çš„æ¢¯åº¦ä¸‹é™ with tf.name_scope(&apos;train&apos;): self.train_op = tf.train.AdamOptimizer(self.lr).minimize(loss) è¿™é‡Œæœ‰å¿…è¦è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨çš„loss= -log(prob)*vtå½“åš loss, å› ä¸ºä¸‹é¢æœ‰å¾ˆå¤šè¯„è®ºè¯´è¿™é‡Œä¸ç†è§£. ç®€å•æ¥è¯´, ä¸Šé¢æåˆ°äº†ä¸¤ç§å½¢å¼æ¥è®¡ç®— neg_log_prob, è¿™ä¸¤ç§å½¢å¼æ˜¯ä¸€æ¨¡ä¸€æ ·çš„, åªæ˜¯ç¬¬äºŒä¸ªæ˜¯ç¬¬ä¸€ä¸ªçš„å±•å¼€å½¢å¼. å¦‚æœä½ ä»”ç»†çœ‹ç¬¬ä¸€ä¸ªå½¢å¼, è¿™ä¸å°±æ˜¯åœ¨ç¥ç»ç½‘ç»œåˆ†ç±»é—®é¢˜ä¸­çš„ cross-entropy å˜›! ä½¿ç”¨ softmax å’Œç¥ç»ç½‘ç»œçš„æœ€åä¸€å±‚ logits è¾“å‡ºå’ŒçœŸå®æ ‡ç­¾ (self.tf_acts) å¯¹æ¯”çš„è¯¯å·®. å¹¶å°†ç¥ç»ç½‘ç»œçš„å‚æ•°æŒ‰ç…§è¿™ä¸ªçœŸå®æ ‡ç­¾æ”¹è¿›. è¿™æ˜¾ç„¶å’Œä¸€ä¸ªåˆ†ç±»é—®é¢˜æ²¡æœ‰å¤ªå¤šåŒºåˆ«. æˆ‘ä»¬èƒ½å°†è¿™ä¸ª neg_log_prob ç†è§£æˆ cross-entropy çš„åˆ†ç±»è¯¯å·®. åˆ†ç±»é—®é¢˜ä¸­çš„æ ‡ç­¾æ˜¯çœŸå® x å¯¹åº”çš„ y, è€Œæˆ‘ä»¬ Policy gradient ä¸­, x æ˜¯ state, y å°±æ˜¯å®ƒæŒ‰ç…§è¿™ä¸ª x æ‰€åšçš„åŠ¨ä½œå·ç . æ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£æˆ, å®ƒæŒ‰ç…§ x åšçš„åŠ¨ä½œæ°¸è¿œæ˜¯å¯¹çš„ (å‡ºæ¥çš„åŠ¨ä½œæ°¸è¿œæ˜¯æ­£ç¡®æ ‡ç­¾), å®ƒä¹Ÿæ°¸è¿œä¼šæŒ‰ç…§è¿™ä¸ª â€œæ­£ç¡®æ ‡ç­¾â€ ä¿®æ”¹è‡ªå·±çš„å‚æ•°. å¯æ˜¯äº‹å®å´ä¸æ˜¯è¿™æ ·, ä»–çš„åŠ¨ä½œä¸ä¸€å®šéƒ½æ˜¯ â€œæ­£ç¡®æ ‡ç­¾â€, è¿™å°±æ˜¯å¼ºåŒ–å­¦ä¹ (Policy gradient)å’Œç›‘ç£å­¦ä¹ (classification)çš„ä¸åŒ. ä¸ºäº†ç¡®ä¿è¿™ä¸ªåŠ¨ä½œçœŸçš„æ˜¯ â€œæ­£ç¡®æ ‡ç­¾â€, æˆ‘ä»¬çš„ loss åœ¨åŸæœ¬çš„ cross-entropy å½¢å¼ä¸Šä¹˜ä»¥ vt, ç”¨ vt æ¥å‘Šè¯‰è¿™ä¸ª cross-entropy ç®—å‡ºæ¥çš„æ¢¯åº¦æ˜¯ä¸æ˜¯ä¸€ä¸ªå€¼å¾—ä¿¡ä»»çš„æ¢¯åº¦. å¦‚æœ vt å°, æˆ–è€…æ˜¯è´Ÿçš„, å°±è¯´æ˜è¿™ä¸ªæ¢¯åº¦ä¸‹é™æ˜¯ä¸€ä¸ªé”™è¯¯çš„æ–¹å‘, æˆ‘ä»¬åº”è¯¥å‘ç€å¦ä¸€ä¸ªæ–¹å‘æ›´æ–°å‚æ•°, å¦‚æœè¿™ä¸ª vt æ˜¯æ­£çš„, æˆ–å¾ˆå¤§, vt å°±ä¼šç§°èµ cross-entropy å‡ºæ¥çš„æ¢¯åº¦, å¹¶æœç€è¿™ä¸ªæ–¹å‘æ¢¯åº¦ä¸‹é™. ä¸‹é¢æœ‰ä¸€å¼ ä» karpathy å¤§ç¥ ç½‘é¡µä¸Šæ‰£ä¸‹æ¥çš„å›¾, ä¹Ÿæ­£æ˜¯é˜è¿°çš„è¿™ä¸ªæ€æƒ³.è€Œä¸æ˜ç™½ä¸ºä»€ä¹ˆæ˜¯ loss=-log(prob)*vt è€Œä¸æ˜¯ loss=-prob*vt çš„æœ‹å‹ä»¬, ä¸‹é¢ç•™è¨€æœ‰å¾ˆå¤šé—®é“è¿™ä¸ªé—®é¢˜. åŸå› æ˜¯è¿™é‡Œçš„ prob æ˜¯ä» softmax å‡ºæ¥çš„, è€Œè®¡ç®—ç¥ç»ç½‘ç»œé‡Œçš„æ‰€æœ‰å‚æ•°æ¢¯åº¦, ä½¿ç”¨åˆ°çš„å°±æ˜¯ cross-entropy, ç„¶åå°†è¿™ä¸ªæ¢¯åº¦ä¹˜ä»¥ vt æ¥æ§åˆ¶æ¢¯åº¦ä¸‹é™çš„æ–¹å‘å’ŒåŠ›åº¦. è€Œæˆ‘ä¸Šé¢ä½¿ç”¨ neg_log_prob è¿™ä¸ªåå­—åªæ˜¯ä¸ºäº†åŒºåˆ†è¿™ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ cross-entropy, å› ä¸ºæ ‡ç­¾ä¸æ˜¯çœŸæ ‡ç­¾. æˆ‘åœ¨ä¸‹é¢æä¾›ä¸€äº›æ‰©å±•é“¾æ¥. Loss çš„å®šä¹‰ karpathy å¤§ç¥çš„ PG ç®—æ³•è¯´æ˜ David Silver çš„ PG è¯¾ä»¶ é€‰è¡Œä¸ºè¿™ä¸ªè¡Œä¸ºä¸å†æ˜¯ç”¨ Q value æ¥é€‰å®šçš„, è€Œæ˜¯ç”¨æ¦‚ç‡æ¥é€‰å®š. å³ä½¿ä¸ç”¨ epsilon-greedy, ä¹Ÿå…·æœ‰ä¸€å®šçš„éšæœºæ€§. class PolicyGradient: def __init__(self, n_actions, n_features, learning_rate=0.01, reward_decay=0.95, output_graph=False): ... def _build_net(self): ... def choose_action(self, observation): prob_weights = self.sess.run(self.all_act_prob, feed_dict=&#123;self.tf_obs: observation[np.newaxis, :]&#125;) # æ‰€æœ‰ action çš„æ¦‚ç‡ action = np.random.choice(range(prob_weights.shape[1]), p=prob_weights.ravel()) # æ ¹æ®æ¦‚ç‡æ¥é€‰ action return action å­˜å‚¨è¡Œä¸ºè¿™ä¸€éƒ¨å¾ˆç®€å•, å°±æ˜¯å°†è¿™ä¸€æ­¥çš„ observation, action, reward åŠ åˆ°åˆ—è¡¨ä¸­å». å› ä¸ºæœ¬å›åˆå®Œæ¯•ä¹‹åè¦æ¸…ç©ºåˆ—è¡¨, ç„¶åå­˜å‚¨ä¸‹ä¸€å›åˆçš„æ•°æ®, æ‰€ä»¥æˆ‘ä»¬ä¼šåœ¨ learn() å½“ä¸­è¿›è¡Œæ¸…ç©ºåˆ—è¡¨çš„åŠ¨ä½œ. class PolicyGradient: def __init__(self, n_actions, n_features, learning_rate=0.01, reward_decay=0.95, output_graph=False): ... def _build_net(self): ... def choose_action(self, observation): ... def store_transition(self, s, a, r): self.ep_obs.append(s) self.ep_as.append(a) self.ep_rs.append(r) å­¦ä¹ æœ¬èŠ‚çš„ learn() å¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬è¦å¯¹è¿™å›åˆçš„æ‰€æœ‰ reward åŠ¨åŠ¨æ‰‹è„š, ä½¿ä»–å˜å¾—æ›´é€‚åˆè¢«å­¦ä¹ . ç¬¬ä¸€å°±æ˜¯éšç€æ—¶é—´æ¨è¿›, ç”¨ gamma è¡°å‡æœªæ¥çš„ reward, ç„¶åä¸ºäº†ä¸€å®šç¨‹åº¦ä¸Šå‡å° policy gradient å›åˆ variance, æˆ‘ä»¬æ ‡å‡†åŒ–å›åˆçš„ state-action value ä¾æ®åœ¨ Andrej Karpathy çš„ blog. class PolicyGradient: def __init__(self, n_actions, n_features, learning_rate=0.01, reward_decay=0.95, output_graph=False): ... def _build_net(self): ... def choose_action(self, observation): ... def store_transition(self, s, a, r): ... def learn(self): # è¡°å‡, å¹¶æ ‡å‡†åŒ–è¿™å›åˆçš„ reward discounted_ep_rs_norm = self._discount_and_norm_rewards() # åŠŸèƒ½å†é¢ # train on episode self.sess.run(self.train_op, feed_dict=&#123; self.tf_obs: np.vstack(self.ep_obs), # shape=[None, n_obs] self.tf_acts: np.array(self.ep_as), # shape=[None, ] self.tf_vt: discounted_ep_rs_norm, # shape=[None, ] &#125;) self.ep_obs, self.ep_as, self.ep_rs = [], [], [] # æ¸…ç©ºå›åˆ data return discounted_ep_rs_norm # è¿”å›è¿™ä¸€å›åˆçš„ state-action value æˆ‘ä»¬å†æ¥çœ‹çœ‹è¿™ä¸ª discounted_ep_rs_norm åˆ°åº•é•¿ä»€ä¹ˆæ ·, ä¸çŸ¥é“å¤§å®¶è¿˜è®°ä¸è®°å¾—ä¸ŠèŠ‚å†…å®¹çš„è¿™ä¸€æ®µ: vt = RL.learn() # å­¦ä¹ , è¾“å‡º vt, æˆ‘ä»¬ä¸‹èŠ‚è¯¾è®²è¿™ä¸ª vt çš„ä½œç”¨if i_episode == 0: plt.plot(vt) # plot è¿™ä¸ªå›åˆçš„ vt plt.xlabel(&apos;episode steps&apos;) plt.ylabel(&apos;normalized state-action value&apos;) plt.show() æˆ‘ä»¬çœ‹çœ‹è¿™ä¸€æ®µçš„è¾“å‡º, vt ä¹Ÿå°±æ˜¯ discounted_ep_rs_norm, çœ‹ä»–æ˜¯æ€ä¹ˆæ ·è¯±å¯¼æˆ‘ä»¬çš„ gradient descent.å¯ä»¥çœ‹å‡º, å·¦è¾¹ä¸€æ®µçš„ vt æœ‰è¾ƒé«˜çš„å€¼, å³è¾¹è¾ƒä½, è¿™å°±æ˜¯ vt åœ¨è¯´: â€œè¯·é‡è§†æˆ‘è¿™å›åˆå¼€å§‹æ—¶çš„ä¸€ç³»åˆ—åŠ¨ä½œ, å› ä¸ºå‰é¢ä¸€æ®µæ—¶é—´æ†å­è¿˜æ²¡æœ‰æ‰ä¸‹æ¥. è€Œä¸”è¯·æƒ©ç½šæˆ‘ä¹‹åçš„ä¸€ç³»åˆ—åŠ¨ä½œ, å› ä¸ºåé¢çš„åŠ¨ä½œè®©æ†å­æ‰ä¸‹æ¥äº†â€ æˆ–è€…æ˜¯ â€œæˆ‘æ¯æ¬¡éƒ½æƒ³è®©è¿™ä¸ªåŠ¨ä½œåœ¨ä¸‹ä¸€æ¬¡å¢åŠ è¢«åšçš„å¯èƒ½æ€§ (grad(log(Policy))), ä½†æ˜¯å¢åŠ å¯èƒ½æ€§çš„è¿™ç§åšæ³•æ˜¯å¥½è¿˜æ˜¯åå‘¢? è¿™å°±è¦ç”± vt å‘Šè¯‰æˆ‘äº†, æ‰€ä»¥åæ®µæ—¶é—´çš„ *â€œå¢åŠ å¯èƒ½æ€§â€ åšæ³•å¹¶æ²¡æœ‰è¢«æå€¡, è€Œå‰æ®µæ—¶é—´çš„ â€œå¢åŠ å¯èƒ½æ€§â€* åšæ³•æ˜¯è¢«æå€¡çš„.â€ è¿™æ · vt å°±èƒ½åœ¨è¿™é‡Œ loss = tf.reduce_mean(log_prob * self.tf_vt) è¯±å¯¼ gradient descent æœç€æ­£ç¡®çš„æ–¹å‘å‘å±•äº†. å¦‚æœä½ ç©äº†ä¸‹ MountainCar çš„æ¨¡æ‹Ÿç¨‹åº, ä½ ä¼šå‘ç° MountainCar æ¨¡æ‹Ÿç¨‹åºä¸­çš„ vt é•¿è¿™æ ·:è¿™å¼ å›¾åœ¨è¯´: â€œè¯·é‡è§†æˆ‘è¿™å›åˆæœ€åçš„ä¸€ç³»åˆ—åŠ¨ä½œ, å› ä¸ºè¿™ä¸€ç³»åˆ—åŠ¨ä½œè®©æˆ‘çˆ¬ä¸Šäº†å±±. è€Œä¸”è¯·æƒ©ç½šæˆ‘å¼€å§‹çš„ä¸€ç³»åˆ—åŠ¨ä½œ, å› ä¸ºè¿™äº›åŠ¨ä½œæ²¡èƒ½è®©æˆ‘çˆ¬ä¸Šå±±â€. ä¹Ÿæ˜¯é€šè¿‡è¿™äº› vt æ¥è¯±å¯¼æ¢¯åº¦ä¸‹é™çš„æ–¹å‘. æœ€åæ˜¯å¦‚ä½•ç”¨ç®—æ³•å®ç°å¯¹æœªæ¥ reward çš„è¡°å‡. class PolicyGradient: def __init__(self, n_actions, n_features, learning_rate=0.01, reward_decay=0.95, output_graph=False): ... def _build_net(self): ... def choose_action(self, observation): ... def store_transition(self, s, a, r): ... def learn(self): ... def _discount_and_norm_rewards(self): # discount episode rewards discounted_ep_rs = np.zeros_like(self.ep_rs) running_add = 0 for t in reversed(range(0, len(self.ep_rs))): running_add = running_add * self.gamma + self.ep_rs[t] discounted_ep_rs[t] = running_add # normalize episode rewards discounted_ep_rs -= np.mean(discounted_ep_rs) discounted_ep_rs /= np.std(discounted_ep_rs) return discounted_ep_rs","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DQN","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DQN","date":"2019-08-24T07:31:07.000Z","updated":"2019-09-01T13:14:43.874Z","comments":true,"path":"2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DQN/","link":"","permalink":"/2019/08/24/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -DQN/","excerpt":"","text":"(æœ¬æ–‡ä¸ºè«çƒ¦å¼ºåŒ–å­¦ä¹ ç³»åˆ—çš„è½¬è½½ï¼ŒåŸé“¾æ¥) ä»€ä¹ˆæ˜¯DQN?DQNå³æ·±åº¦ç¥ç»ç½‘ç»œ+Q-Learningå½“æ•°æ®é‡å¤§èµ·æ¥ä¹‹åå­˜è¡¨å’ŒæŸ¥æ‰¾éƒ½ä¼šå˜å¾—ç›¸å½“æ…¢ï¼Œè¿™æ—¶å¯ä»¥è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œè¯»å–è¾“å…¥çŠ¶æ€ï¼Œé¢„æµ‹ç›¸åº”çš„åŠ¨ä½œ Experience replayï¼šéšæœºæŠ½å–ä¹‹å‰çš„ç»å†è¿›è¡Œå­¦ä¹ ï¼Œæ‰“ä¹±äº†ç»å†ä¹‹é—´çš„ç›¸å…³æ€§Fixed Q-targetsï¼šè¿™æ ·å°±ä¼šç”¨åˆ°ä¸¤ä¸ªç¥ç»ç½‘ç»œï¼Œä¸€ä¸ªæ˜¯è¿‡å»çš„ç¥ç»ç½‘ç»œQâ€™ï¼Œä¸€ä¸ªæ˜¯æœ€æ–°çš„ç¥ç»ç½‘ç»œ DQNä¼ªä»£ç æ•´ä¸ªç®—æ³•ä¹çœ‹èµ·æ¥å¾ˆå¤æ‚, ä¸è¿‡æˆ‘ä»¬æ‹†åˆ†ä¸€ä¸‹, å°±å˜ç®€å•äº†. ä¹Ÿå°±æ˜¯ä¸ª Q learning ä¸»æ¡†æ¶ä¸ŠåŠ äº†äº›è£…é¥°.è¿™äº›è£…é¥°åŒ…æ‹¬: è®°å¿†åº“ (ç”¨äºé‡å¤å­¦ä¹ ) ç¥ç»ç½‘ç»œè®¡ç®— Q å€¼ æš‚æ—¶å†»ç»“ q_target å‚æ•° (åˆ‡æ–­ç›¸å…³æ€§) P17ä»£ç å¾…ç†è§£Double DQNæˆ‘ä»¬çŸ¥é“ DQN çš„ç¥ç»ç½‘ç»œéƒ¨åˆ†å¯ä»¥çœ‹æˆä¸€ä¸ª æœ€æ–°çš„ç¥ç»ç½‘ç»œ + è€ç¥ç»ç½‘ç»œ, ä»–ä»¬æœ‰ç›¸åŒçš„ç»“æ„, ä½†å†…éƒ¨çš„å‚æ•°æ›´æ–°å´æœ‰æ—¶å·®. è€Œå®ƒçš„ Qç°å® éƒ¨åˆ†æ˜¯è¿™æ ·çš„:å› ä¸ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œé¢„æµ‹ Qmax æœ¬æ¥å°±æœ‰è¯¯å·®, æ¯æ¬¡ä¹Ÿå‘ç€æœ€å¤§è¯¯å·®çš„ Qç°å® æ”¹è¿›ç¥ç»ç½‘ç»œ, å°±æ˜¯å› ä¸ºè¿™ä¸ª Qmax å¯¼è‡´äº† overestimate. æ‰€ä»¥ Double DQN çš„æƒ³æ³•å°±æ˜¯å¼•å…¥å¦ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥æ‰“æ¶ˆä¸€äº›æœ€å¤§è¯¯å·®çš„å½±å“. è€Œ DQN ä¸­æœ¬æ¥å°±æœ‰ä¸¤ä¸ªç¥ç»ç½‘ç»œ, æˆ‘ä»¬ä½•ä¸åˆ©ç”¨ä¸€ä¸‹è¿™ä¸ªä¼˜åŠ¿å‘¢. æ‰€ä»¥, æˆ‘ä»¬ç”¨ Qä¼°è®¡ çš„ç¥ç»ç½‘ç»œä¼°è®¡ Qç°å® ä¸­ Qmax(sâ€™, aâ€™) çš„æœ€å¤§åŠ¨ä½œå€¼. ç„¶åç”¨è¿™ä¸ªè¢« Qä¼°è®¡ ä¼°è®¡å‡ºæ¥çš„åŠ¨ä½œæ¥é€‰æ‹© Qç°å® ä¸­çš„ Q(sâ€™).æ€»ç»“ä¸€ä¸‹:æœ‰ä¸¤ä¸ªç¥ç»ç½‘ç»œ: Q_eval (Qä¼°è®¡ä¸­çš„), Q_next (Qç°å®ä¸­çš„).åŸæœ¬çš„ Q_next = max(Q_next(sâ€™, a_all)).Double DQN ä¸­çš„ Q_next = Q_next(sâ€™, argmax(Q_eval(sâ€™, a_all))). ä¹Ÿå¯ä»¥è¡¨è¾¾æˆä¸‹é¢é‚£æ ·. Prioritized replay DQNè¿™ä¸€æ¬¡è¿˜æ˜¯ä½¿ç”¨ MountainCar æ¥è¿›è¡Œå®éªŒ, å› ä¸ºè¿™æ¬¡æˆ‘ä»¬ä¸éœ€è¦é‡åº¦æ”¹å˜ä»–çš„ reward äº†. æ‰€ä»¥åªè¦æ˜¯æ²¡æœ‰æ‹¿åˆ°å°æ——å­, reward=-1, æ‹¿åˆ°å°æ——å­æ—¶, æˆ‘ä»¬å®šä¹‰å®ƒè·å¾—äº† +10 çš„ reward. æ¯”èµ·ä¹‹å‰ DQN ä¸­, è¿™ä¸ª reward å®šä¹‰æ›´åŠ å‡†ç¡®. å¦‚æœä½¿ç”¨è¿™ç§ reward å®šä¹‰æ–¹å¼, å¯ä»¥æƒ³è±¡ Natural DQN ä¼šèŠ±å¾ˆä¹…çš„æ—¶é—´å­¦ä¹ , å› ä¸ºè®°å¿†åº“ä¸­åªæœ‰å¾ˆå°‘å¾ˆå°‘çš„ +10 reward å¯ä»¥å­¦ä¹ . æ­£è´Ÿæ ·æœ¬ä¸ä¸€æ ·. è€Œä½¿ç”¨ Prioritized replay, å°±ä¼šé‡è§†è¿™ç§å°‘é‡çš„, ä½†å€¼å¾—å­¦ä¹ çš„æ ·æœ¬. ä¼ªä»£ç è¿™ä¸€å¥—ç®—æ³•é‡ç‚¹å°±åœ¨æˆ‘ä»¬ batch æŠ½æ ·çš„æ—¶å€™å¹¶ä¸æ˜¯éšæœºæŠ½æ ·, è€Œæ˜¯æŒ‰ç…§ Memory ä¸­çš„æ ·æœ¬ä¼˜å…ˆçº§æ¥æŠ½. æ‰€ä»¥è¿™èƒ½æ›´æœ‰æ•ˆåœ°æ‰¾åˆ°æˆ‘ä»¬éœ€è¦å­¦ä¹ çš„æ ·æœ¬. é‚£ä¹ˆæ ·æœ¬çš„ä¼˜å…ˆçº§æ˜¯æ€ä¹ˆå®šçš„å‘¢? åŸæ¥æˆ‘ä»¬å¯ä»¥ç”¨åˆ° TD-error, ä¹Ÿå°±æ˜¯ Qç°å® - Qä¼°è®¡ æ¥è§„å®šä¼˜å…ˆå­¦ä¹ çš„ç¨‹åº¦. å¦‚æœ TD-error è¶Šå¤§, å°±ä»£è¡¨æˆ‘ä»¬çš„é¢„æµ‹ç²¾åº¦è¿˜æœ‰å¾ˆå¤šä¸Šå‡ç©ºé—´, é‚£ä¹ˆè¿™ä¸ªæ ·æœ¬å°±è¶Šéœ€è¦è¢«å­¦ä¹ , ä¹Ÿå°±æ˜¯ä¼˜å…ˆçº§ p è¶Šé«˜. æœ‰äº† TD-error å°±æœ‰äº†ä¼˜å…ˆçº§ p, é‚£æˆ‘ä»¬å¦‚ä½•æœ‰æ•ˆåœ°æ ¹æ® p æ¥æŠ½æ ·å‘¢? å¦‚æœæ¯æ¬¡æŠ½æ ·éƒ½éœ€è¦é’ˆå¯¹ p å¯¹æ‰€æœ‰æ ·æœ¬æ’åº, è¿™å°†ä¼šæ˜¯ä¸€ä»¶éå¸¸æ¶ˆè€—è®¡ç®—èƒ½åŠ›çš„äº‹. å¥½åœ¨æˆ‘ä»¬è¿˜æœ‰å…¶ä»–æ–¹æ³•, è¿™ç§æ–¹æ³•ä¸ä¼šå¯¹å¾—åˆ°çš„æ ·æœ¬è¿›è¡Œæ’åº. è¿™å°±æ˜¯è¿™ç¯‡ paper ä¸­æåˆ°çš„ SumTree. SumTree æ˜¯ä¸€ç§æ ‘å½¢ç»“æ„, æ¯ç‰‡æ ‘å¶å­˜å‚¨æ¯ä¸ªæ ·æœ¬çš„ä¼˜å…ˆçº§ p, æ¯ä¸ªæ ‘æèŠ‚ç‚¹åªæœ‰ä¸¤ä¸ªåˆ†å‰, èŠ‚ç‚¹çš„å€¼æ˜¯ä¸¤ä¸ªåˆ†å‰çš„åˆ, æ‰€ä»¥ SumTree çš„é¡¶ç«¯å°±æ˜¯æ‰€æœ‰ p çš„åˆ. æ­£å¦‚ä¸‹é¢å›¾ç‰‡(æ¥è‡ªJaromÃ­r Janisch), æœ€ä¸‹é¢ä¸€å±‚æ ‘å¶å­˜å‚¨æ ·æœ¬çš„ p, å¶å­ä¸Šä¸€å±‚æœ€å·¦è¾¹çš„ 13 = 3 + 10, æŒ‰è¿™ä¸ªè§„å¾‹ç›¸åŠ , é¡¶å±‚çš„ root å°±æ˜¯å…¨éƒ¨ p çš„åˆäº†.æŠ½æ ·æ—¶, æˆ‘ä»¬ä¼šå°† p çš„æ€»åˆ é™¤ä»¥ batch size, åˆ†æˆ batch size é‚£ä¹ˆå¤šåŒºé—´, (n=sum(p)/batch_size). å¦‚æœå°†æ‰€æœ‰ node çš„ priority åŠ èµ·æ¥æ˜¯42çš„è¯, æˆ‘ä»¬å¦‚æœæŠ½6ä¸ªæ ·æœ¬, è¿™æ—¶çš„åŒºé—´æ‹¥æœ‰çš„ priority å¯èƒ½æ˜¯è¿™æ ·.[0-7], [7-14], [14-21], [21-28], [28-35], [35-42] ç„¶ååœ¨æ¯ä¸ªåŒºé—´é‡Œéšæœºé€‰å–ä¸€ä¸ªæ•°. æ¯”å¦‚åœ¨ç¬¬åŒºé—´ [21-28] é‡Œé€‰åˆ°äº†24, å°±æŒ‰ç…§è¿™ä¸ª 24 ä»æœ€é¡¶ä¸Šçš„42å¼€å§‹å‘ä¸‹æœç´¢. é¦–å…ˆçœ‹åˆ°æœ€é¡¶ä¸Š 42 ä¸‹é¢æœ‰ä¸¤ä¸ª child nodes, æ‹¿ç€æ‰‹ä¸­çš„24å¯¹æ¯”å·¦è¾¹çš„ child 29, å¦‚æœ å·¦è¾¹çš„ child æ¯”è‡ªå·±æ‰‹ä¸­çš„å€¼å¤§, é‚£æˆ‘ä»¬å°±èµ°å·¦è¾¹è¿™æ¡è·¯, æ¥ç€å†å¯¹æ¯” 29 ä¸‹é¢çš„å·¦è¾¹é‚£ä¸ªç‚¹ 13, è¿™æ—¶, æ‰‹ä¸­çš„ 24 æ¯” 13 å¤§, é‚£æˆ‘ä»¬å°±èµ°å³è¾¹çš„è·¯, å¹¶ä¸”å°†æ‰‹ä¸­çš„å€¼æ ¹æ® 13 ä¿®æ”¹ä¸€ä¸‹, å˜æˆ 24-13 = 11. æ¥ç€æ‹¿ç€ 11 å’Œ 13 å·¦ä¸‹è§’çš„ 12 æ¯”, ç»“æœ 12 æ¯” 11 å¤§, é‚£æˆ‘ä»¬å°±é€‰ 12 å½“åšè¿™æ¬¡é€‰åˆ°çš„ priority, å¹¶ä¸”ä¹Ÿé€‰æ‹© 12 å¯¹åº”çš„æ•°æ®. å¯ä»¥çœ‹åˆ°Prioritized-Replayå¯ä»¥æœ‰æ•ˆå‡å°‘trainningçš„æ—¶é—´ Dueling DQNè½¬è½½è‡ªè«çƒ¦-Dueling DQNåªè¦ç¨ç¨ä¿®æ”¹ DQN ä¸­ç¥ç»ç½‘ç»œçš„ç»“æ„, å°±èƒ½å¤§å¹…æå‡å­¦ä¹ æ•ˆæœ, åŠ é€Ÿæ”¶æ•›. è¿™ç§æ–°æ–¹æ³•å«åš Dueling DQN. ç”¨ä¸€å¥è¯æ¥æ¦‚æ‹¬ Dueling DQN å°±æ˜¯. å®ƒå°†æ¯ä¸ªåŠ¨ä½œçš„ Q æ‹†åˆ†æˆäº† state çš„ Value åŠ ä¸Š æ¯ä¸ªåŠ¨ä½œçš„ Advantage. ä¸Šä¸€ä¸ª Paper ä¸­çš„ç»å…¸è§£é‡Šå›¾ç‰‡, ä¸Šè€…æ˜¯ä¸€èˆ¬çš„ DQN çš„ Qå€¼ ç¥ç»ç½‘ç»œ. ä¸‹è€…å°±æ˜¯ Dueling DQN ä¸­çš„ Qå€¼ ç¥ç»ç½‘ç»œäº†. é‚£å…·ä½“æ˜¯å“ªé‡Œä¸åŒäº†å‘¢?ä¸‹é¢è¿™ä¸ªå…¬å¼è§£é‡Šäº†ä¸åŒä¹‹å¤„. åŸæ¥ DQN ç¥ç»ç½‘ç»œç›´æ¥è¾“å‡ºçš„æ˜¯æ¯ç§åŠ¨ä½œçš„ Qå€¼, è€Œ Dueling DQN æ¯ä¸ªåŠ¨ä½œçš„ Qå€¼ æ˜¯æœ‰ä¸‹é¢çš„å…¬å¼ç¡®å®šçš„.å®ƒåˆ†æˆäº†è¿™ä¸ª state çš„å€¼, åŠ ä¸Šæ¯ä¸ªåŠ¨ä½œåœ¨è¿™ä¸ª state ä¸Šçš„ advantage. å› ä¸ºæœ‰æ—¶å€™åœ¨æŸç§ state, æ— è®ºåšä»€ä¹ˆåŠ¨ä½œ, å¯¹ä¸‹ä¸€ä¸ª state éƒ½æ²¡æœ‰å¤šå¤§å½±å“. æ¯”å¦‚ paper ä¸­çš„è¿™å¼ å›¾.è¿™æ˜¯å¼€è½¦çš„æ¸¸æˆ, å·¦è¾¹æ˜¯ state value, å‘çº¢çš„éƒ¨åˆ†è¯æ˜äº† state value å’Œå‰é¢çš„è·¯çº¿æœ‰å…³, å³è¾¹æ˜¯ advantage, å‘çº¢çš„éƒ¨åˆ†è¯´æ˜äº† advantage å¾ˆåœ¨ä¹æ—è¾¹è¦é è¿‘çš„è½¦å­, è¿™æ—¶çš„åŠ¨ä½œä¼šå—æ›´å¤š advantage çš„å½±å“. å‘çº¢çš„åœ°æ–¹å·¦å³äº†è‡ªå·±è½¦å­çš„ç§»åŠ¨åŸåˆ™.DQNå’ŒDueling DQNçš„ç½‘ç»œç»“æ„å·®å¼‚ï¼š ç»“æœå¯¹æ¯”è¿™æ¬¡æˆ‘ä»¬çœ‹çœ‹ç´¯ç§¯å¥–åŠ± reward, æ†å­ç«‹èµ·æ¥çš„æ—¶å€™å¥–åŠ± = 0, å…¶ä»–æ—¶å€™éƒ½æ˜¯è´Ÿå€¼, æ‰€ä»¥å½“ç´¯ç§¯å¥–åŠ±æ²¡æœ‰åœ¨é™ä½æ—¶, è¯´æ˜æ†å­å·²ç»è¢«æˆåŠŸç«‹äº†å¾ˆä¹…äº†.æˆ‘ä»¬å‘ç°å½“å¯ç”¨åŠ¨ä½œè¶Šé«˜, å­¦ä¹ éš¾åº¦å°±è¶Šå¤§, ä¸è¿‡ Dueling DQN è¿˜æ˜¯ä¼šæ¯” Natural DQN å­¦ä¹ å¾—æ›´å¿«. æ”¶æ•›æ•ˆæœæ›´å¥½.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Q-Learningå’ŒSarsa","slug":"è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Q-Learningå’ŒSarsa","date":"2019-08-23T08:34:19.000Z","updated":"2019-09-01T13:14:49.663Z","comments":true,"path":"2019/08/23/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Q-Learningå’ŒSarsa/","link":"","permalink":"/2019/08/23/è«çƒ¦-å¼ºåŒ–å­¦ä¹ -Q-Learningå’ŒSarsa/","excerpt":"","text":"P2: å¼ºåŒ–å­¦ä¹ åˆ†ç±»ä¸ç†è§£ç¯å¢ƒ Model-Freeç†è§£ç¯å¢ƒ Model-Based å…ˆå¯¹ç°å®ä¸–ç•Œå»ºæ¨¡åŸºäºæ¦‚ç‡æ¯ä¸ªéƒ½æœ‰ä¸€å®šæ¦‚ç‡è¢«é€‰ä¸­ ä¼˜åŠ¿æ˜¯å¯ä»¥å¤„ç†è¿ç»­åŠ¨ä½œ åŸºäºä»·å€¼é€‰æ‹©æœ€é«˜ä»·å€¼ å¯¹è¿ç»­åŠ¨ä½œæ— èƒ½ä¸ºåŠ› å›åˆæ›´æ–°(Monte-Carlo update)å•æ­¥æ›´æ–°(Temporal-Difference update)åœ¨çº¿å­¦ä¹  On-Policyæœ¬äººè¾¹ç©è¾¹å­¦ä¹  ç¦»çº¿å­¦ä¹  Off-Policyå¯ä»¥è‡ªå·±ç©ï¼Œä¹Ÿå¯ä»¥çœ‹ç€åˆ«äººç©(ç»éªŒ)ï¼Œæˆ–è€…å…ˆç©ï¼Œå†å­¦ä¹  p9: Q-Learningå’ŒSarsaQ-Learningï¼šå–maxQä»£è¡¨åˆ°äº†s2çš„æ—¶å€™æƒ³è±¡è‡ªå·±çš„è¡Œä¸º Q(s1,a2)ç°å®ï¼šR+Î³*maxQ(s2) Q(s1,a2)ä¼°è®¡ï¼šQ(s1,a2) å·®è·=ç°å®-ä¼°è®¡ æ–°Q(s1,a2)=è€Q(s1,a2)+Î±*å·®è· Î±æ˜¯å­¦ä¹ æ•ˆç‡æ³¨æ„è¿™é‡Œæ›´æ–°çš„æ˜¯s1çš„Qè¡¨ï¼Œå°½ç®¡ç°åœ¨å·²ç»æ˜¯s2Sarsaç®—æ³•ï¼šåŒæ ·, æˆ‘ä»¬ä¼šç»å†æ­£åœ¨å†™ä½œä¸šçš„çŠ¶æ€ s1, ç„¶åå†æŒ‘é€‰ä¸€ä¸ªå¸¦æ¥æœ€å¤§æ½œåœ¨å¥–åŠ±çš„åŠ¨ä½œ a2, è¿™æ ·æˆ‘ä»¬å°±åˆ°è¾¾äº† ç»§ç»­å†™ä½œä¸šçŠ¶æ€ s2, è€Œåœ¨è¿™ä¸€æ­¥, å¦‚æœä½ ç”¨çš„æ˜¯ Q learning, ä½ ä¼šè§‚çœ‹ä¸€ä¸‹åœ¨ s2 ä¸Šé€‰å–å“ªä¸€ä¸ªåŠ¨ä½œä¼šå¸¦æ¥æœ€å¤§çš„å¥–åŠ±, ä½†æ˜¯åœ¨çœŸæ­£è¦åšå†³å®šæ—¶, å´ä¸ä¸€å®šä¼šé€‰å–åˆ°é‚£ä¸ªå¸¦æ¥æœ€å¤§å¥–åŠ±çš„åŠ¨ä½œ, Q-learning åœ¨è¿™ä¸€æ­¥åªæ˜¯ä¼°è®¡äº†ä¸€ä¸‹æ¥ä¸‹æ¥çš„åŠ¨ä½œå€¼. è€Œ Sarsa æ˜¯å®è·µæ´¾, ä»–è¯´åˆ°åšåˆ°, åœ¨ s2 è¿™ä¸€æ­¥ä¼°ç®—çš„åŠ¨ä½œä¹Ÿæ˜¯æ¥ä¸‹æ¥è¦åšçš„åŠ¨ä½œ. æ‰€ä»¥ Q(s1, a2) ç°å®çš„è®¡ç®—å€¼, æˆ‘ä»¬ä¹Ÿä¼šç¨ç¨æ”¹åŠ¨, å»æ‰maxQ, å–è€Œä»£ä¹‹çš„æ˜¯åœ¨ s2 ä¸Šæˆ‘ä»¬å®å®åœ¨åœ¨é€‰å–çš„ a2 çš„ Q å€¼. æœ€ååƒ Q learning ä¸€æ ·, æ±‚å‡ºç°å®å’Œä¼°è®¡çš„å·®è· å¹¶æ›´æ–° Q è¡¨é‡Œçš„ Q(s1, a2). Q-Learningå’ŒSarsaçš„åŒºåˆ«Q-Learningé¢„é€‰ä¸€ä¸ªaï¼Œä½†æ˜¯ä¸ä¸€å®šè¿™æ ·æ‰§è¡Œ(Qè¡¨æ”¹å˜äº†)ï¼Œä½†Sarsaæ˜¯è¡ŒåŠ¨æ´¾ï¼Œä»–ä¸€å®šæ‰§è¡Œaã€‚ä½†Sarsaæ¯”è¾ƒèƒ†å°ï¼Œä¼šé€‰æ‹©æ¯”è¾ƒå®‰å…¨çš„è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯åŸå…ˆçš„Qè¡¨é‡Œå¥–åŠ±è¾ƒé«˜çš„è¡Œä¸ºã€‚ Sarsa(Î»)Sarsa(0)ç›¸å½“äºå•æ­¥æ›´æ–°ï¼Œä¸‹å›¾è®¤ä¸ºåªæœ‰ç¦»å®è—æœ€è¿‘çš„è„šå°æ‰æ˜¯éœ€è¦æ›´æ–°çš„Sarsa(1)ç›¸å½“äºå›åˆæ›´æ–°ï¼Œè®¤ä¸ºæ‰€æœ‰çš„è„šå°éƒ½éœ€è¦è¢«æ›´æ–°Sarsa(Î»)åˆ™è®¤ä¸ºç¦»å®è—è¶Šè¿‘çš„è„šå°æ¯”ç¦»å®è—è¶Šè¿œè„šå°æ›´é‡è¦ Sarsa(Î»)ä¼ªä»£ç ä¸‹å›¾æ˜¯é’ˆå¯¹äºä¸€ä¸ªstate-actionå€¼æŒ‰ç»å†æ¬¡æ•°çš„å˜åŒ–å›¾ã€‚æœ€ä¸Šé¢æ˜¯ç»å†state-actionçš„æ—¶é—´ç‚¹ï¼Œç¬¬äºŒå¼ å›¾æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼æ‰€å¸¦æ¥çš„ â€œä¸å¯æˆ–ç¼ºæ€§å€¼â€: self.eligibility_trace.ix[s, a] += 1 ä¸‹é¢å›¾æ˜¯ä½¿ç”¨è¿™ç§æ–¹æ³•å¸¦æ¥çš„ â€œä¸å¯æˆ–ç¼ºæ€§å€¼â€: self.eligibility_trace.ix[s, :] *= 0; self.eligibility_trace.ix[s, a] = 1","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼ºåŒ–å­¦ä¹ ","slug":"å¼ºåŒ–å­¦ä¹ ","permalink":"/tags/å¼ºåŒ–å­¦ä¹ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Markdownè¯­æ³•ç¤ºä¾‹","slug":"MarkDownè¯­æ³•ç¤ºä¾‹","date":"2019-08-20T02:28:13.000Z","updated":"2019-09-01T13:01:09.463Z","comments":true,"path":"2019/08/20/MarkDownè¯­æ³•ç¤ºä¾‹/","link":"","permalink":"/2019/08/20/MarkDownè¯­æ³•ç¤ºä¾‹/","excerpt":"","text":"åºå· é»„ç“œ ç‰ç±³ èŒ„å­ é»„ç“œ ç‰ç±³ èŒ„å­ é»„ç“œ ç‰ç±³ èŒ„å­ é»„ç“œ ç‰ç±³ èŒ„å­ å¦‚æœåœ¨å•ä¸€åˆ—è¡¨é¡¹ä¸­åŒ…å«äº†å¤šä¸ªæ®µè½,ä¸ºäº†ä¿è¯æ¸²æŸ“æ­£å¸¸ï¼Œ*ä¸æ®µè½é¦–å­—æ¯ä¹‹é—´å¿…é¡»ä¿ç•™å››ä¸ªç©ºæ ¼ æ®µè½ä¸€ å°æ®µä¸€ æ®µè½äºŒ å°æ®µäºŒ å¦å¤–ï¼Œå¦‚æœåœ¨åˆ—è¡¨ä¸­åŠ å…¥äº†åŒºå—å¼•ç”¨ï¼ŒåŒºåŸŸå¼•ç”¨æ ‡è®°ç¬¦ä¹Ÿéœ€è¦ç¼©è¿›4ä¸ªç©ºæ ¼ æ®µè½ä¸€ åŒºå—æ ‡è®°ä¸€ æ®µè½äºŒ åŒºå—æ ‡è®°äºŒ è¿™é‡Œæ˜¯æ–œä½“è¿™é‡Œæ˜¯æ–œä½“ è¿™é‡Œæ˜¯åŠ ç²—è¿™é‡Œæ˜¯åŠ ç²— ###æ’å…¥ä»£ç æ®µ###åå¼•å·ï¼ˆEscé”®ä¸‹æ–¹ï¼‰ åŒ…è£¹åœ¨ä¸€å¯¹```ä¹‹é—´å³ä»£ç æ®µfun (x: Int, y: Int): Int &#123; return x + y&#125; è¡¨å¤´ æ¡ç›®ä¸€ æ¡ç›®äºŒ é¡¹ç›® é¡¹ç›®ä¸€ é¡¹ç›®äºŒ æ³¨ï¼šä¸‰ä¸ªçŸ­æ–œæ å·¦å³çš„å†’å·ç”¨äºæ§åˆ¶å¯¹é½æ–¹å¼ï¼Œåªæ”¾ç½®å·¦è¾¹å†’å·è¡¨ç¤ºæ–‡å­—å±…å·¦ï¼Œåªæ”¾ç½®å³è¾¹å†’å·è¡¨ç¤ºæ–‡å­—å±…å³ï¼Œå¦‚æœä¸¤è¾¹éƒ½æ”¾ç½®å†’å·è¡¨ç¤ºæ–‡å­—å±…ä¸­ã€‚ Markdownä½¿ç”¨åæ–œæ \\æ’å…¥è¯­æ³•ä¸­ç”¨åˆ°çš„ç‰¹æ®Šç¬¦å·ã€‚åœ¨Markdownä¸­ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ç‰¹æ®Šç¬¦å·éœ€è¦å¤„ç†ï¼š\\\\ åæ–œçº¿\\` åå¼•å·\\* æ˜Ÿå·\\_ åº•çº¿\\&#123;\\&#125; èŠ±æ‹¬å·[\\\\] æ–¹æ‹¬å·\\(\\) æ‹¬å¼§\\# äº•å­—å·\\+ åŠ å·\\- å‡å·\\. è‹±æ–‡å¥ç‚¹\\! æƒŠå¹å· å¦‚ä½•ç»™æ–‡å­—ä¸Šè‰²æ­¤å¤„ç”¨#ä½¿ç”¨æ ‡é¢˜æ ¼å¼ æ’å…¥å›¾ç‰‡æˆ–é“¾æ¥[ç‚¹å‡»è·³è½¬è‡³ç™¾åº¦](http://www.baidu.com)![å›¾ç‰‡](https://upload-images.jianshu.io/upload_images/703764-605e3cc2ecb664f6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)![](6.jpg) ç‚¹å‡»è·³è½¬è‡³ç™¾åº¦ ###æ–‡å­—###&lt;font color=#0099ff size=5 face=&quot;é»‘ä½“&quot;&gt;color=#0099ff size=5 face=&quot;é»‘ä½“&quot;&lt;/font&gt;&lt;table&gt;&lt;tr&gt;&lt;td bgcolor=#FF4500&gt;è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šOrangeRedï¼Œ åå…­è¿›åˆ¶é¢œè‰²å€¼ï¼š#FF4500ï¼Œ rgb(255, 69, 0)&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; color=#0099ff size=5 face=â€é»‘ä½“â€ è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šOrangeRedï¼Œ åå…­è¿›åˆ¶é¢œè‰²å€¼ï¼š#FF4500ï¼Œ rgb(255, 69, 0)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"},{"name":"hexo","slug":"hexo","permalink":"/tags/hexo/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Linuxçš„å¸¸ç”¨å‘½ä»¤","slug":"linuxå¸¸ç”¨å‘½ä»¤(é•¿æœŸæ›´æ–°)","date":"2019-08-20T02:28:13.000Z","updated":"2019-09-01T13:01:03.543Z","comments":true,"path":"2019/08/20/linuxå¸¸ç”¨å‘½ä»¤(é•¿æœŸæ›´æ–°)/","link":"","permalink":"/2019/08/20/linuxå¸¸ç”¨å‘½ä»¤(é•¿æœŸæ›´æ–°)/","excerpt":"","text":"cd / æ ¹ç›®å½•rm C -r åˆ é™¤Cè¿™ä¸ªéç©ºç›®å½•rmdir C åˆ é™¤ç©ºç›®å½• ä»£ç äº¤å‰è·³è½¬ï¼š åœ¨ç¨‹åºæ ¹ç›®å½•ä¸‹ctags-Rï¼Œctrl+]å³å¯å®ç°è·³è½¬,ctrl+Tè·³è½¬å›å» ç»Ÿè®¡å½“å‰æ–‡ä»¶å¤¹æ–‡ä»¶æ•°ï¼šls -l|grep â€œ^-â€œ| wc -lgrep â€œ^dâ€è¡¨ç¤ºç›®å½•ï¼Œâ€^-â€œè¡¨ç¤ºæ–‡ä»¶ è™šæ‹ŸæœºæŒ‚è½½ç›®å½•ï¼š å¼€æœºæ‰‹åŠ¨æŒ‚è½½ï¼šmount -t vboxsf shares /mnt/Share puttyï¼š åˆ©ç”¨puttyä¼ è¾“æ–‡ä»¶ï¼špscp svd_parse.py 974102371@172.31.111.23:2017133026 è¿œç¨‹è®­ç»ƒï¼šhttps://www.cnblogs.com/godarrow/p/7771839.html nohup python3 -u main.py â€“input_height 96 â€“output_height 48 â€“dataset faces â€“crop True â€“train True â€“epoch 10 &amp;&gt;nohup.out&amp; nohup python3 -u word2vec_parse3.py &amp;&gt; word2vec_parse3.out&amp; æŒ‡å®šGPU: os.environ[â€˜CUDA_VISIBLE_DEVICESâ€™] = â€˜1â€™ æœåŠ¡å™¨æ ¡å›­ç½‘ç™»å½•ï¼š curl -d â€œDDDDD=296375&amp;upass=***&amp;0MKKey=â€ https://drcom.szu.edu.cn condaï¼š conda create -n law python=3.6 åˆ›å»ºä¸€ä¸ªåä¸ºtfçš„py3.6ç¯å¢ƒconda activate tfconda deactivatesource activate python2 åˆ‡æ¢ç¯å¢ƒconda install â€“yes â€“file requirements.txt æŸ¥çœ‹GPUä¿¡æ¯ï¼š nvidia-smi æŸ¥çœ‹gpuç‰ˆæœ¬ä¿¡æ¯cat /usr/local/cuda/version.txt æŸ¥çœ‹cudaç‰ˆæœ¬ä¿¡æ¯https://tensorflow.google.cn/install/source æŸ¥çœ‹gpuç‰ˆæœ¬å¯¹åº”","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•ï¼Ÿ","slug":"å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•","date":"2019-08-20T02:28:13.000Z","updated":"2019-09-01T13:03:31.484Z","comments":true,"path":"2019/08/20/å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•/","link":"","permalink":"/2019/08/20/å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•/","excerpt":"å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•ï¼Ÿ","text":"å¦‚ä½•æ„Ÿæ€§åœ°ç†è§£EMç®—æ³•ï¼Ÿ å¦‚æœä½¿ç”¨åŸºäºæœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„æ¨¡å‹ï¼Œæ¨¡å‹ä¸­å­˜åœ¨éšå˜é‡ï¼Œå°±è¦ç”¨EMç®—æ³•åšå‚æ•°ä¼°è®¡ã€‚ä¸ªäººè®¤ä¸ºï¼Œç†è§£EMç®—æ³•èƒŒåçš„ideaï¼Œè¿œæ¯”çœ‹æ‡‚å®ƒçš„æ•°å­¦æ¨å¯¼é‡è¦ã€‚ideaä¼šè®©ä½ æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ï¼Œä»è€Œæ˜ç™½ç®—æ³•çš„åˆç†æ€§ï¼Œæ•°å­¦æ¨å¯¼åªæ˜¯å°†è¿™ç§åˆç†æ€§ç”¨æ›´åŠ ä¸¥è°¨çš„è¯­è¨€è¡¨è¾¾å‡ºæ¥è€Œå·²ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œä¸€ä¸ªæ¢¨å¾ˆç”œï¼Œç”¨æ•°å­¦çš„è¯­è¨€å¯ä»¥è¡¨è¿°ä¸ºç³–åˆ†å«é‡90%ï¼Œä½†åªæœ‰äº²è‡ªå’¬ä¸€å£ï¼Œä½ æ‰èƒ½çœŸæ­£æ„Ÿè§‰åˆ°è¿™ä¸ªæ¢¨æœ‰å¤šç”œï¼Œä¹Ÿæ‰èƒ½çœŸæ­£ç†è§£æ•°å­¦ä¸Šçš„90%çš„ç³–åˆ†ç©¶ç«Ÿæ˜¯æ€ä¹ˆæ ·çš„ã€‚å¦‚æœEMæ˜¯ä¸ªæ¢¨ï¼Œæœ¬æ–‡çš„ç›®çš„å°±æ˜¯å¸¦é¢†å¤§å®¶å’¬ä¸€å£ã€‚001ã€ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­å‡è®¾ç°åœ¨æœ‰ä¸¤æšç¡¬å¸1å’Œ2ï¼Œ,éšæœºæŠ›æ·åæ­£é¢æœä¸Šæ¦‚ç‡åˆ†åˆ«ä¸ºP1ï¼ŒP2ã€‚ä¸ºäº†ä¼°è®¡è¿™ä¸¤ä¸ªæ¦‚ç‡ï¼Œåšå®éªŒï¼Œæ¯æ¬¡å–ä¸€æšç¡¬å¸ï¼Œè¿æ·5ä¸‹ï¼Œè®°å½•ä¸‹ç»“æœï¼Œå¦‚ä¸‹ï¼šç¡¬å¸ç»“æœç»Ÿè®¡1æ­£æ­£åæ­£å3æ­£-2å2ååæ­£æ­£å2æ­£-3å1æ­£åååå1æ­£-4å2æ­£ååæ­£æ­£3æ­£-2å1åæ­£æ­£åå2æ­£-3åå¯ä»¥å¾ˆå®¹æ˜“åœ°ä¼°è®¡å‡ºP1å’ŒP2ï¼Œå¦‚ä¸‹ï¼šP1 = ï¼ˆ3+1+2ï¼‰/ 15 = 0.4P2= ï¼ˆ2+3ï¼‰/10 = 0.5åˆ°è¿™é‡Œï¼Œä¸€åˆ‡ä¼¼ä¹å¾ˆç¾å¥½ï¼Œä¸‹é¢æˆ‘ä»¬åŠ å¤§éš¾åº¦ã€‚010ã€åŠ å…¥éšå˜é‡zè¿˜æ˜¯ä¸Šé¢çš„é—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬æŠ¹å»æ¯è½®æŠ•æ·æ—¶ä½¿ç”¨çš„ç¡¬å¸æ ‡è®°ï¼Œå¦‚ä¸‹ï¼šç¡¬å¸ç»“æœç»Ÿè®¡Unknownæ­£æ­£åæ­£å3æ­£-2åUnknownååæ­£æ­£å2æ­£-3åUnknownæ­£åååå1æ­£-4åUnknownæ­£ååæ­£æ­£3æ­£-2åUnknownåæ­£æ­£åå2æ­£-3åå¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ²¡å˜ï¼Œè¿˜æ˜¯ä¼°è®¡P1å’ŒP2ï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å¤šäº†ä¸€ä¸ªéšå˜é‡zï¼Œå¯ä»¥æŠŠå®ƒè®¤ä¸ºæ˜¯ä¸€ä¸ª5ç»´çš„å‘é‡ï¼ˆz1,z2,z3,z4,z5)ï¼Œä»£è¡¨æ¯æ¬¡æŠ•æ·æ—¶æ‰€ä½¿ç”¨çš„ç¡¬å¸ï¼Œæ¯”å¦‚z1ï¼Œå°±ä»£è¡¨ç¬¬ä¸€è½®æŠ•æ·æ—¶ä½¿ç”¨çš„ç¡¬å¸æ˜¯1è¿˜æ˜¯2ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå˜é‡zä¸çŸ¥é“ï¼Œå°±æ— æ³•å»ä¼°è®¡P1å’ŒP2ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆä¼°è®¡å‡ºzï¼Œç„¶åæ‰èƒ½è¿›ä¸€æ­¥ä¼°è®¡P1å’ŒP2ã€‚ä½†è¦ä¼°è®¡zï¼Œæˆ‘ä»¬åˆå¾—çŸ¥é“P1å’ŒP2ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½ç”¨æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™å»ä¼°è®¡zï¼Œè¿™ä¸æ˜¯é¸¡ç”Ÿè›‹å’Œè›‹ç”Ÿé¸¡çš„é—®é¢˜å—ï¼Œå¦‚ä½•ç ´ï¼Ÿç­”æ¡ˆå°±æ˜¯å…ˆéšæœºåˆå§‹åŒ–ä¸€ä¸ªP1å’ŒP2ï¼Œç”¨å®ƒæ¥ä¼°è®¡zï¼Œç„¶ååŸºäºzï¼Œè¿˜æ˜¯æŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™å»ä¼°è®¡æ–°çš„P1å’ŒP2ï¼Œå¦‚æœæ–°çš„P1å’ŒP2å’Œæˆ‘ä»¬åˆå§‹åŒ–çš„P1å’ŒP2ä¸€æ ·ï¼Œè¯·é—®è¿™è¯´æ˜äº†ä»€ä¹ˆï¼Ÿï¼ˆæ­¤å¤„æ€è€ƒ1åˆ†é’Ÿï¼‰è¿™è¯´æ˜æˆ‘ä»¬åˆå§‹åŒ–çš„P1å’ŒP2æ˜¯ä¸€ä¸ªç›¸å½“é è°±çš„ä¼°è®¡ï¼å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åˆå§‹åŒ–çš„P1å’ŒP2ï¼ŒæŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡å°±å¯ä»¥ä¼°è®¡å‡ºzï¼Œç„¶ååŸºäºzï¼ŒæŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡å¯ä»¥åè¿‡æ¥ä¼°è®¡å‡ºP1å’ŒP2ï¼Œå½“ä¸æˆ‘ä»¬åˆå§‹åŒ–çš„P1å’ŒP2ä¸€æ ·æ—¶ï¼Œè¯´æ˜æ˜¯P1å’ŒP2å¾ˆæœ‰å¯èƒ½å°±æ˜¯çœŸå®çš„å€¼ã€‚è¿™é‡Œé¢åŒ…å«äº†ä¸¤ä¸ªäº¤äº’çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚å¦‚æœæ–°ä¼°è®¡å‡ºæ¥çš„P1å’ŒP2å’Œæˆ‘ä»¬åˆå§‹åŒ–çš„å€¼å·®åˆ«å¾ˆå¤§ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå°±æ˜¯ç»§ç»­ç”¨æ–°çš„P1å’ŒP2è¿­ä»£ï¼Œç›´è‡³æ”¶æ•›ã€‚è¿™å°±æ˜¯ä¸‹é¢çš„EMåˆçº§ç‰ˆã€‚011ã€EMåˆçº§ç‰ˆæˆ‘ä»¬ä¸å¦¨è¿™æ ·ï¼Œå…ˆéšä¾¿ç»™P1å’ŒP2èµ‹ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚ï¼šP1 = 0.2P2 = 0.7ç„¶åï¼Œæˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€è½®æŠ›æ·æœ€å¯èƒ½æ˜¯å“ªä¸ªç¡¬å¸ã€‚å¦‚æœæ˜¯ç¡¬å¸1ï¼Œå¾—å‡º3æ­£2åçš„æ¦‚ç‡ä¸º 0.20.20.20.80.8 = 0.00512å¦‚æœæ˜¯ç¡¬å¸2ï¼Œå¾—å‡º3æ­£2åçš„æ¦‚ç‡ä¸º0.70.70.70.30.3=0.03087ç„¶åä¾æ¬¡æ±‚å‡ºå…¶ä»–4è½®ä¸­çš„ç›¸åº”æ¦‚ç‡ã€‚åšæˆè¡¨æ ¼å¦‚ä¸‹ï¼šè½®æ•°è‹¥æ˜¯ç¡¬å¸1è‹¥æ˜¯ç¡¬å¸210.005120.0308720.020480.0132330.081920.0056740.005120.0308750.020480.01323æŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ³•åˆ™ï¼šç¬¬1è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸2ç¬¬2è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸1ç¬¬3è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸1ç¬¬4è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸2ç¬¬5è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸1æˆ‘ä»¬å°±æŠŠä¸Šé¢çš„å€¼ä½œä¸ºzçš„ä¼°è®¡å€¼ã€‚ç„¶åæŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™æ¥ä¼°è®¡æ–°çš„P1å’ŒP2ã€‚P1 = ï¼ˆ2+1+2ï¼‰/15 = 0.33P2=ï¼ˆ3+3ï¼‰/10 = 0.6è®¾æƒ³æˆ‘ä»¬æ˜¯å…¨çŸ¥çš„ç¥ï¼ŒçŸ¥é“æ¯è½®æŠ›æ·æ—¶çš„ç¡¬å¸å°±æ˜¯å¦‚æœ¬æ–‡ç¬¬001éƒ¨åˆ†æ ‡ç¤ºçš„é‚£æ ·ï¼Œé‚£ä¹ˆï¼ŒP1å’ŒP2çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å°±æ˜¯0.4å’Œ0.5ï¼ˆä¸‹æ–‡ä¸­å°†è¿™ä¸¤ä¸ªå€¼ç§°ä¸ºP1å’ŒP2çš„çœŸå®å€¼ï¼‰ã€‚é‚£ä¹ˆå¯¹æ¯”ä¸‹æˆ‘ä»¬åˆå§‹åŒ–çš„P1å’ŒP2å’Œæ–°ä¼°è®¡å‡ºçš„P1å’ŒP2ï¼šåˆå§‹åŒ–çš„P1ä¼°è®¡å‡ºçš„P1çœŸå®çš„P1åˆå§‹åŒ–çš„P2ä¼°è®¡å‡ºçš„P2çœŸå®çš„P20.20.330.40.70.60.5çœ‹åˆ°æ²¡ï¼Ÿæˆ‘ä»¬ä¼°è®¡çš„P1å’ŒP2ç›¸æ¯”äºå®ƒä»¬çš„åˆå§‹å€¼ï¼Œæ›´æ¥è¿‘å®ƒä»¬çš„çœŸå®å€¼äº†ï¼å¯ä»¥æœŸå¾…ï¼Œæˆ‘ä»¬ç»§ç»­æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œç”¨ä¼°è®¡å‡ºçš„P1å’ŒP2å†æ¥ä¼°è®¡zï¼Œå†ç”¨zæ¥ä¼°è®¡æ–°çš„P1å’ŒP2ï¼Œåå¤è¿­ä»£ä¸‹å»ï¼Œå°±å¯ä»¥æœ€ç»ˆå¾—åˆ°P1 = 0.4ï¼ŒP2=0.5ï¼Œæ­¤æ—¶æ— è®ºæ€æ ·è¿­ä»£ï¼ŒP1å’ŒP2çš„å€¼éƒ½ä¼šä¿æŒ0.4å’Œ0.5ä¸å˜ï¼Œäºæ˜¯ä¹ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†P1å’ŒP2çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š1ã€æ–°ä¼°è®¡å‡ºçš„P1å’ŒP2ä¸€å®šä¼šæ›´æ¥è¿‘çœŸå®çš„P1å’ŒP2ï¼Ÿç­”æ¡ˆæ˜¯ï¼šæ²¡é”™ï¼Œä¸€å®šä¼šæ›´æ¥è¿‘çœŸå®çš„P1å’ŒP2ï¼Œæ•°å­¦å¯ä»¥è¯æ˜ï¼Œä½†è¿™è¶…å‡ºäº†æœ¬æ–‡çš„ä¸»é¢˜ï¼Œè¯·å‚é˜…å…¶ä»–ä¹¦ç±æˆ–æ–‡ç« ã€‚2ã€è¿­ä»£ä¸€å®šä¼šæ”¶æ•›åˆ°çœŸå®çš„P1å’ŒP2å—ï¼Ÿç­”æ¡ˆæ˜¯ï¼šä¸ä¸€å®šï¼Œå–å†³äºP1å’ŒP2çš„åˆå§‹åŒ–å€¼ï¼Œä¸Šé¢æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½æ”¶æ•›åˆ°P1å’ŒP2ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¹¸è¿åœ°æ‰¾åˆ°äº†å¥½çš„åˆå§‹åŒ–å€¼ã€‚100ã€EMè¿›é˜¶ç‰ˆä¸‹é¢ï¼Œæˆ‘ä»¬æ€è€ƒä¸‹ï¼Œä¸Šé¢çš„æ–¹æ³•è¿˜æœ‰æ²¡æœ‰æ”¹è¿›çš„ä½™åœ°ï¼Ÿæˆ‘ä»¬æ˜¯ç”¨æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™ä¼°è®¡å‡ºçš„zå€¼ï¼Œç„¶åå†ç”¨zå€¼æŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™ä¼°è®¡æ–°çš„P1å’ŒP2ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæœ€å¯èƒ½çš„zå€¼ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å¯èƒ½çš„zå€¼ã€‚å¦‚æœè€ƒè™‘æ‰€æœ‰å¯èƒ½çš„zå€¼ï¼Œå¯¹æ¯ä¸€ä¸ªzå€¼éƒ½ä¼°è®¡å‡ºä¸€ä¸ªæ–°çš„P1å’ŒP2ï¼Œå°†æ¯ä¸€ä¸ªzå€¼æ¦‚ç‡å¤§å°ä½œä¸ºæƒé‡ï¼Œå°†æ‰€æœ‰æ–°çš„P1å’ŒP2åˆ†åˆ«åŠ æƒç›¸åŠ ï¼Œè¿™æ ·çš„P1å’ŒP2åº”è¯¥ä¼šæ›´å¥½ä¸€äº›ã€‚æ‰€æœ‰çš„zå€¼æœ‰å¤šå°‘ä¸ªå‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæœ‰2^5=32ç§ï¼Œéœ€è¦æˆ‘ä»¬è¿›è¡Œ32æ¬¡ä¼°å€¼ï¼Ÿï¼Ÿä¸éœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æœŸæœ›æ¥ç®€åŒ–è¿ç®—ã€‚è½®æ•°è‹¥æ˜¯ç¡¬å¸1è‹¥æ˜¯ç¡¬å¸210.005120.0308720.020480.0132330.081920.0056740.005120.0308750.020480.01323åˆ©ç”¨ä¸Šé¢è¿™ä¸ªè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºæ¯è½®æŠ›æ·ä¸­ä½¿ç”¨ç¡¬å¸1æˆ–è€…ä½¿ç”¨ç¡¬å¸2çš„æ¦‚ç‡ã€‚æ¯”å¦‚ç¬¬1è½®ï¼Œä½¿ç”¨ç¡¬å¸1çš„æ¦‚ç‡æ˜¯ï¼š0.00512/(0.00512+0.03087)=0.14ä½¿ç”¨ç¡¬å¸2çš„æ¦‚ç‡æ˜¯1-0.14=0.86ä¾æ¬¡å¯ä»¥ç®—å‡ºå…¶ä»–4è½®çš„æ¦‚ç‡ï¼Œå¦‚ä¸‹ï¼šè½®æ•°z_i=ç¡¬å¸1z_i=ç¡¬å¸210.140.8620.610.3930.940.0640.140.8650.610.39ä¸Šè¡¨ä¸­çš„å³ä¸¤åˆ—è¡¨ç¤ºæœŸæœ›å€¼ã€‚çœ‹ç¬¬ä¸€è¡Œï¼Œ0.86è¡¨ç¤ºï¼Œä»æœŸæœ›çš„è§’åº¦çœ‹ï¼Œè¿™è½®æŠ›æ·ä½¿ç”¨ç¡¬å¸2çš„æ¦‚ç‡æ˜¯0.86ã€‚ç›¸æ¯”äºå‰é¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ¦‚ç‡ï¼Œç›´æ¥å°†ç¬¬1è½®ä¼°è®¡ä¸ºç”¨çš„ç¡¬å¸2ï¼Œæ­¤æ—¶çš„æˆ‘ä»¬æ›´åŠ è°¨æ…ï¼Œæˆ‘ä»¬åªè¯´ï¼Œæœ‰0.14çš„æ¦‚ç‡æ˜¯ç¡¬å¸1ï¼Œæœ‰0.86çš„æ¦‚ç‡æ˜¯ç¡¬å¸2ï¼Œä¸å†æ˜¯éæ­¤å³å½¼ã€‚è¿™æ ·æˆ‘ä»¬åœ¨ä¼°è®¡P1æˆ–è€…P2æ—¶ï¼Œå°±å¯ä»¥ç”¨ä¸Šå…¨éƒ¨çš„æ•°æ®ï¼Œè€Œä¸æ˜¯éƒ¨åˆ†çš„æ•°æ®ï¼Œæ˜¾ç„¶è¿™æ ·ä¼šæ›´å¥½ä¸€äº›ã€‚è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯ä¼°è®¡å‡ºäº†zçš„æ¦‚ç‡åˆ†å¸ƒï¼Œè¿™æ­¥è¢«ç§°ä½œEæ­¥ã€‚ç»“åˆä¸‹è¡¨ï¼šç¡¬å¸ç»“æœç»Ÿè®¡Unknownæ­£æ­£åæ­£å3æ­£-2åUnknownååæ­£æ­£å2æ­£-3åUnknownæ­£åååå1æ­£-4åUnknownæ­£ååæ­£æ­£3æ­£-2åUnknownåæ­£æ­£åå2æ­£-3åæˆ‘ä»¬æŒ‰ç…§æœŸæœ›æœ€å¤§ä¼¼ç„¶æ¦‚ç‡çš„æ³•åˆ™æ¥ä¼°è®¡æ–°çš„P1å’ŒP2ï¼šä»¥P1ä¼°è®¡ä¸ºä¾‹ï¼Œç¬¬1è½®çš„3æ­£2åç›¸å½“äº0.143=0.42æ­£0.142=0.28åä¾æ¬¡ç®—å‡ºå…¶ä»–å››è½®ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼šè½®æ•°æ­£é¢åé¢10.420.2821.221.8330.943.7640.420.2851.221.83æ€»è®¡4.227.98P1=4.22/(4.22+7.98)=0.35å¯ä»¥çœ‹åˆ°ï¼Œæ”¹å˜äº†zå€¼çš„ä¼°è®¡æ–¹æ³•åï¼Œæ–°ä¼°è®¡å‡ºçš„P1è¦æ›´åŠ æ¥è¿‘0.4ã€‚åŸå› å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨äº†æ‰€æœ‰æŠ›æ·çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä¹‹å‰åªä½¿ç”¨äº†éƒ¨åˆ†çš„æ•°æ®ã€‚è¿™æ­¥ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®Eæ­¥ä¸­æ±‚å‡ºçš„zçš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¾æ®æœ€å¤§ä¼¼ç„¶æ¦‚ç‡æ³•åˆ™å»ä¼°è®¡P1å’ŒP2ï¼Œè¢«ç§°ä½œMæ­¥ã€‚101ã€æ€»ç»“ä»¥ä¸Šï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå®é™…çš„å°ä¾‹å­ï¼Œæ¥å®é™…æ¼”ç¤ºäº†EMç®—æ³•èƒŒåçš„ideaï¼Œå…±æ€§å­˜äºä¸ªæ€§ä¹‹ä¸­ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹EMç®—æ³•ç©¶ç«Ÿåœ¨å¹²ä»€ä¹ˆæœ‰ä¸€ä¸ªæ·±åˆ»æ„Ÿæ€§çš„è®¤è¯†ï¼ŒæŒæ¡EMç®—æ³•çš„æ€æƒ³ç²¾é«“ã€‚Reference:http://pan.baidu.com/s/1i4NfvP7","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"/tags/æ•°å­¦/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"/tags/æœºå™¨å­¦ä¹ /"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]},{"title":"Gitçš„åŸºæœ¬ä½¿ç”¨","slug":"Gitçš„åŸºæœ¬ä½¿ç”¨","date":"2019-07-25T15:38:23.000Z","updated":"2019-09-01T13:00:19.809Z","comments":true,"path":"2019/07/25/Gitçš„åŸºæœ¬ä½¿ç”¨/","link":"","permalink":"/2019/07/25/Gitçš„åŸºæœ¬ä½¿ç”¨/","excerpt":"","text":"æœ¬åœ°ä»“åº“git initï¼šåˆ›å»ºç©ºçš„ç‰ˆæœ¬åº“(.gitç›®å½•ä¸è¦ä¿®æ”¹ï¼ï¼ï¼) git add 1.pyï¼šæŠŠæ–‡ä»¶æ·»åŠ åˆ°ä»“åº“ git commit -m â€œæ³¨é‡Šä¿¡æ¯â€ git statusï¼šæŸ¥çœ‹ä»“åº“å½“å‰çŠ¶æ€ git diffï¼šæŸ¥çœ‹ä¿®æ”¹çš„å†…å®¹ git logï¼šæŸ¥çœ‹æ‰€æœ‰æäº¤æ—¥å¿— git log â€“pretty=onelineï¼šæŸ¥çœ‹æ‰€æœ‰æäº¤æ—¥å¿—(åªæœ‰ç¼–å·å’Œæ³¨é‡Šä¿¡æ¯) git reset â€“hard HEAD^ï¼šå›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ git reset â€“hard HEAD^^ï¼šå›é€€åˆ°ä¸Šä¸Šä¸ªç‰ˆæœ¬ git reset â€“hard HEAD~100ï¼šå›é€€åˆ°å‰100ä¸ªç‰ˆæœ¬ git reset â€“hard å…·ä½“ç‰ˆæœ¬å·ï¼šå›é€€åˆ°æŸä¸€ä¸ªç‰ˆæœ¬ git reflogï¼šè®°å½•æ‰€æœ‰å‘½ä»¤ git checkout â€“ fileNameï¼šæ’¤é”€ï¼Œå°±æ˜¯è®©è¿™ä¸ªfileNameå›é€€åˆ°æœ€åä¸€æ¬¡commitæˆ–addçš„çŠ¶æ€ è¿œç¨‹ä»“åº“1.åˆ›å»ºssh keyï¼šssh-keygen -t rsa -C â€œGithubè´¦å·â€ï¼Œè®°ä¸‹.sshçš„ç›®å½•ï¼Œç„¶åä¸€ç›´å›è½¦ 2.è¿›å…¥åˆ°.sshçš„ç›®å½•","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django06-çˆ±é²œèœ‚(æœªå®Œ)","slug":"Django06-çˆ±é²œèœ‚(æœªå®Œ)","date":"2019-07-25T14:35:23.000Z","updated":"2019-09-01T13:00:23.153Z","comments":true,"path":"2019/07/25/Django06-çˆ±é²œèœ‚(æœªå®Œ)/","link":"","permalink":"/2019/07/25/Django06-çˆ±é²œèœ‚(æœªå®Œ)/","excerpt":"","text":"python manage.py runserver 8001 //è®¾ç½®8001ç«¯å£å¯åŠ¨","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django03-è§†å›¾","slug":"Django03-è§†å›¾","date":"2019-07-22T01:14:50.000Z","updated":"2019-09-01T13:00:30.230Z","comments":true,"path":"2019/07/22/Django03-è§†å›¾/","link":"","permalink":"/2019/07/22/Django03-è§†å›¾/","excerpt":"","text":"å“åº”åŒ…æ‹¬ç½‘é¡µå’ŒJSONæ•°æ®ï¼Œè€Œç½‘é¡µåˆåŒ…æ‹¬é‡å®šå‘å’Œé”™è¯¯è§†å›¾ã€‚ urlé…ç½®é…ç½®æµç¨‹ï¼š 1.åˆ¶å®šæ ¹çº§urlé…ç½®æ–‡ä»¶(setting.pyæ–‡ä»¶ä¸­çš„ROOT_URLCONF = â€˜project.urlsâ€™,ä¸€èˆ¬ä¸ç”¨ä¿®æ”¹) 2.urlpatterns(ä¸€ä¸ªurlå®ä¾‹åˆ—è¡¨å’Œurlå¯¹è±¡(æ­£åˆ™è¡¨è¾¾å¼ã€è§†å›¾åç§°ã€åç§°)) åŒ¹é…æ­£åˆ™çš„æ³¨æ„äº‹é¡¹ï¼š 1.å¦‚æœæƒ³è¦ä»urlä¸­è·å–ä¸€ä¸ªå€¼ï¼Œéœ€è¦å¯¹æ­£åˆ™åŠ å°æ‹¬å· 2.åŒ¹é…æ­£åˆ™å‰ä¸éœ€è¦åŠ åæ–œæ† 3.æ­£åˆ™å‰è¦åŠ rè¡¨ç¤ºå­—ç¬¦ä¸²ä¸è½¬ä¹‰ å¼•å…¥å…¶ä»–urlé…ç½®ï¼š åœ¨åº”ç”¨ç›®å½•ä¸­åˆ›å»ºurls.pyæ–‡ä»¶ï¼Œå®šä¹‰æœ¬åº”ç”¨çš„urlé…ç½®ï¼Œåœ¨å·¥ç¨‹ç›®å½•ä¸‹çš„urls.pyæ–‡ä»¶ä¸­ä½¿ç”¨include()æ–¹æ³• urlpatterns = [ url(r'^admin/', admin.site.urls), url(r'^',include('myapp.urls'))] urlåå‘è§£æï¼š æ¦‚è¿°ï¼šå¦‚æœåœ¨è§†å›¾ã€æ¨¡æ¿ä¸­ä½¿ç”¨äº†ç¡¬ç¼–ç é“¾æ¥ï¼Œåœ¨urlé…ç½®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒåŠ¨æ€ç”Ÿæˆé“¾æ¥çš„åœ°å€ è§£å†³ï¼šåœ¨ä½¿ç”¨é“¾æ¥æ—¶ï¼Œé€šè¿‡urlé…ç½®çš„åç§°ï¼ŒåŠ¨æ€ç”Ÿæˆurlåœ°å€ ä½œç”¨ï¼šä½¿ç”¨urlæ¨¡æ¿ è§†å›¾å‡½æ•°å®šä¹‰è§†å›¾ï¼š è§†å›¾çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•° è§†å›¾å‚æ•°ï¼š1.ä¸€ä¸ªHttpRequestçš„å®ä¾‹(æµè§ˆå™¨å‘é€çš„å†…å®¹) 2.é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è·å–çš„å‚æ•° ä½ç½®ï¼šä¸€èˆ¬åœ¨views.pyæ–‡ä»¶ä¸‹å®šä¹‰ é”™è¯¯è§†å›¾ï¼š404è§†å›¾(æ‰¾ä¸åˆ°ç½‘é¡µæ—¶è¿”å›å³urlåŒ¹é…ä¸æˆåŠŸï¼Œåœ¨templatesç›®å½•ä¸‹å®šä¹‰404.html request_pathæ˜¯å¯¼è‡´é”™è¯¯çš„ç½‘å€)ã€400è§†å›¾(é”™è¯¯å‡ºç°åœ¨å®¢æˆ·çš„æ“ä½œ çˆ¬è™« cookieç­‰)ã€500è§†å›¾(åœ¨è§†å›¾ä»£ç ä¸­å‡ºç°é”™è¯¯(æœåŠ¡å™¨diamante))ç­‰ é…ç½®settings.pyï¼š DEBUG = True #ä¸ºTrueè¡¨ç¤ºæ°¸è¿œä¸ä¼šè°ƒç”¨404.htmlé¡µé¢ 404.htmlä¸€å®šè¦å†™åœ¨templatesç›®å½•ä¸‹è€Œä¸æ˜¯myappç›®å½•ä¸‹ALLOWED_HOSTS = ['*'] HTTPRequestå¯¹è±¡æ¦‚è¿°ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°htppè¯·æ±‚åä¼šæ ¹æ®æŠ¥æ–‡åˆ›å»ºHTTPRequesttå¯¹è±¡ï¼Œè§†å›¾çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯HttpRequestå¯¹è±¡ï¼Œæ˜¯ç”±Djangoåˆ›å»ºçš„ï¼Œä¹‹åè°ƒç”¨è§†å›¾æ—¶ä¼ é€’ç»™è§†å›¾ å±æ€§ï¼š pathï¼šè¯·æ±‚çš„å®Œæ•´è·¯å¾„(ä½†ä¸åŒ…æ‹¬åŸŸåå’Œç«¯å£) methodï¼šè¯·æ±‚çš„æ–¹å¼ï¼Œå¸¸ç”¨çš„æœ‰GETã€POST encodingï¼šæµè§ˆå™¨æäº¤çš„æ•°æ®ç¼–ç æ–¹å¼ GETï¼šç±»ä¼¼äºå­—å…¸çš„å¯¹è±¡ï¼ŒåŒ…å«äº†getè¯·æ±‚çš„æ‰€æœ‰å‚æ•°(å…¶å®å°±æ˜¯?a=45&amp;b=dsafé‚£äº›) POSTï¼šç±»ä¼¼å­—å…¸çš„å¯¹è±¡ï¼ŒåŒ…å«äº†postè¯·æ±‚çš„æ‰€æœ‰å‚æ•°(è¡¨å•æ•°æ®) FILESï¼šç±»ä¼¼å­—å…¸çš„å¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¸Šä¼ çš„æ–‡ä»¶ COOKIESï¼šå­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„cookie sessionï¼šç±»ä¼¼å­—å…¸çš„å¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰ä¼šè¯ æ–¹æ³•ï¼šis_ajax()ï¼šå¦‚æœæ˜¯é€šè¿‡XMLHTTPRequestå‘èµ·çš„ï¼Œè¿”å›True å¦‚æœæ˜¯ajaxï¼Œä¸€èˆ¬è¿”å›çš„æ˜¯jsonæ•°æ® QueryDictå¯¹è±¡requestå¯¹è±¡ä¸­çš„GETã€POSTéƒ½å±äºQueryDictå¯¹è±¡ æ–¹æ³•ï¼š get()ï¼šæ ¹æ®é”®è·å–å€¼ï¼Œåªèƒ½è·å–ä¸€ä¸ªå€¼ getlist()ï¼šå°†é”®çš„å€¼ä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›ï¼Œå¯ä»¥è·å–å¤šä¸ªå€¼ GETå±æ€§#urls.pyurl(r'^get1',views.get1)url(r'^get2',views.get2)#views.pydef get1(request): a=request.GET.get('a') b=request.GET.get('b') c=request.GET.get('c') return HttpResponse(a+\" \"+b+\" \"+c)def get2(request): a = request.GET.getlist('a') a0=a[0] a1=a[1] c = request.GET.get('c') return HttpResponse(a0 + \" \" + a1 + \" \" + c) POSTå±æ€§//regist.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;æ³¨å†Œ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action=\"regist/\" method=\"post\"&gt; å§“åï¼š&lt;input type=\"text\" name=\"name\" value=\"\"/&gt; &lt;hr/&gt; æ€§åˆ«ï¼š&lt;input type=\"radio\" name=\"gender\" value=\"1\"/&gt;ç”· &lt;input type=\"radio\" name=\"gender\" value=\"0\"/&gt;å¥³ &lt;hr/&gt; å¹´é¾„ï¼š&lt;input type=\"text\" name=\"age\" value=\"\"/&gt; &lt;hr/&gt; çˆ±å¥½ï¼š&lt;input type=\"checkbox\" name=\"hobby\" value=\"money\"/&gt;é‡‘é’± &lt;input type=\"checkbox\" name=\"hobby\" value=\"girl\"/&gt;ç¾å¥³ &lt;hr/&gt; &lt;input type=\"submit\" value=\"æ³¨å†Œ\"&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; #å…³é—­csrf å³æ³¨é‡Šæ‰ å¦åˆ™ç‚¹å‡»æ³¨å†Œåä¼šå› ä¸ºè·¨ç«™æ”»å‡»æ·»åŠ çš„ç½‘å€å†…å®¹ä½ç½®ä¸æ­£ç¡®#è§†é¢‘ä¼¼ä¹æœ‰é”™è¯¯ å¹¶æ²¡æœ‰è§£å†³é—®é¢˜1MIDDLEWARE = [ 'django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', #'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware',] #POSTdef showregist(request): return render(request,'myapp/regist.html')def regist(request): name=request.POST.get(\"name\") gender=request.POST.get(\"gender\") age=request.POST.get(\"age\") hobby=request.POST.getlist(\"hobby\") print(name) print(gender) print(age) print(hobby) return HttpResponse(\"post\") HttpResponseå¯¹è±¡renderæ–¹æ³•ï¼š åŸå‹ï¼šrender(request,templateName,[,context]) å±æ€§ï¼š contentï¼šè¡¨ç¤ºè¿”å›çš„å†…å®¹ charsetï¼šç¼–ç æ ¼å¼ status_codeï¼šå“åº”çŠ¶æ€ç  content-typeï¼šæŒ‡å®šè¾“å‡ºçš„MIMEç±»å‹ æ–¹æ³•ï¼š initï¼šä½¿ç”¨é¡µé¢å†…å®¹å®ä¾‹åŒ–HttpResponseå¯¹è±¡ writeï¼šä»¥æ–‡ä»¶å½¢å¼å†™å…¥ flushï¼šä»¥æ–‡ä»¶å½¢å¼è¾“å‡ºç¼“å†²åŒº set_cookie(key,value=â€™â€™,max_age=None,expirses=None)ï¼šè®¾ç½®cookie delete_cookie(key)ï¼šåˆ é™¤cookie å¦‚æœåˆ é™¤ä¸å­˜åœ¨çš„keyï¼Œå°±å½“ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿ å­ç±»HttpResponseRedirect#views.py#é‡å®šå‘ è¾“å…¥1çš„æ—¶å€™è·³è½¬åˆ°2çš„é¡µé¢from django.http import HttpResponseRedirectdef redirect1(request): return HttpResponseRedirect('/redirect2')def redirect2(request): return HttpResponse(\"æˆ‘æ˜¯é‡å®šå‘åçš„è§†å›¾\")#ç®€å†™ redirectæ–¹æ³•from django.shortcuts import redirectdef redirect1(request): return redirect('/redirect2')def redirect2(request): return HttpResponse(\"æˆ‘æ˜¯é‡å®šå‘åçš„è§†å›¾\") å­ç±»JsonResponseè¿”å›jsonæ•°æ®ï¼Œä¸€èˆ¬ç”¨äºå¼‚æ­¥è¯·æ±‚(ajax) dataï¼šå­—å…¸å¯¹è±¡ æ³¨æ„ï¼šContent-typeç±»å‹ä¸ºapplication/json çŠ¶æ€ä¿æŒæ¦‚è¿°ï¼šhttpåè®®æ˜¯æ— çŠ¶æ€åè®®ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ä¸€æ¬¡æ–°çš„è¯·æ±‚ï¼Œä¸è®°å¾—ä»¥å‰çš„è¯·æ±‚(ç™»å½•çŠ¶æ€æ²¡æœ‰è®°å½•)ï¼›å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„ä¸€æ¬¡é€šä¿¡å°±æ˜¯ä¸€æ¬¡ä¼šè¯ï¼›å®ç°çŠ¶æ€ä¿æŒï¼Œåœ¨å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ç«¯å­˜å‚¨æœ‰å…³ä¼šè¯çš„æ•°æ®ï¼› å­˜å‚¨æ–¹å¼ï¼šcookie(ä¸é€‚ç”¨cookieåŸå› ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œä¸è¦å­˜æ•æ„Ÿçš„æ•°æ®)æˆ–session(æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œåœ¨å®¢æˆ·ç«¯ç”¨cookieå­˜å‚¨session_idï¼Œå¯¹åº”çš„å€¼å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯) ç›®çš„ï¼šåœ¨ä¸€æ®µæ—¶é—´å†…è·Ÿè¸ªè¯·æ±‚è€…çš„çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨è·¨é¡µé¢è®¿é—®å½“å‰è¯·æ±‚è€…çš„æ•°æ® æ³¨æ„ï¼šä¸åŒçš„è¯·æ±‚è€…ä¹‹é—´ä¸ä¼šå…±äº«è¿™ä¸ªæ•°æ®ï¼Œä¸è¯·æ±‚è€…ä¸€ä¸€å¯¹åº” å¯ç”¨sessionï¼šé»˜è®¤å¯ç”¨ #settings.pyMIDDLEWARE = [ ... 'django.contrib.sessions.middleware.SessionMiddleware', ...] ä½¿ç”¨sessionï¼š å¯ç”¨sessionåï¼Œæ¯ä¸ªHTTPRequestå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªsessionå±æ€§ï¼Œå°±æ˜¯ä¸€ä¸ªç±»ä¼¼å­—å…¸çš„å¯¹è±¡ get(key,default=None)ï¼šæ ¹æ®é”®è·å–sessionå€¼ clear()ï¼šæ¸…ç©ºæ‰€æœ‰ä¼šè¯ flush()ï¼šåˆ é™¤å½“å‰ä¼šè¯å¹¶åˆ é™¤ä¼šè¯çš„cookie //login.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action=\"/showmain/\" method=\"post\"&gt; &lt;input type=\"text\" name=\"username\"/&gt; &lt;input type=\"submit\" value=\"ç™»å½•\"&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ç”¨åˆ°çš„æ•°æ®ï¼š insert into myapp_grades(gname,gdate,ggirlnum,gboynum,isDelete) values(â€œpython01â€,â€2017-2-4â€,10,50,0),(â€œpython02â€,â€2017-5-4â€,10,20,0),(â€œpython03â€,â€2018-8-5â€,50,50,0),(â€œpython04â€,â€2018-6-15â€,10,42,0); insert into myapp_students(sname,sgender,scontend,isDelete,sgrade_id,sage) values(â€œè”¡å¾å¤â€,0,â€æˆ‘å«è”¡å¾å¤â€,0,4,20), (â€œåˆ˜å¾·åâ€,0,â€æˆ‘å«åˆ˜å¾·åâ€,0,1,25), (â€œé™ˆç‘è±ªâ€,0,â€æˆ‘å«é™ˆç‘è±ªâ€,0,3,18), (â€œé»‘é›ªå§¬â€,1,â€æˆ‘å«é»‘é›ªå§¬â€,0,2,14), (â€œæœ‰ç”°æ˜¥é›ªâ€,0,â€æˆ‘å«æœ‰ç”°æ˜¥é›ªâ€,0,2,13);","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django04-æ¨¡æ¿","slug":"Django04-æ¨¡æ¿","date":"2019-07-22T01:14:50.000Z","updated":"2019-09-01T13:00:29.079Z","comments":true,"path":"2019/07/22/Django04-æ¨¡æ¿/","link":"","permalink":"/2019/07/22/Django04-æ¨¡æ¿/","excerpt":"","text":"æ¯æ¬¡åˆ æ‰0001_initial.pyï¼Œç„¶åä¿®æ”¹settings.pyä¸­çš„æ•°æ®åº“ï¼Œé‡æ–°æ‰§è¡Œè¿ç§»ã€‚ å˜é‡è§†å›¾ä¼ é€’ç»™æ¨¡æ¿çš„æ•°æ®ï¼›è¦éµå®ˆæ ‡è¯†ç¬¦è§„åˆ™ï¼›è¯­æ³•ï¼š æ³¨æ„ï¼š 1.å¦‚æœä½¿ç”¨çš„å˜é‡ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥çš„æ˜¯ç©ºå­—ç¬¦ä¸² 2.åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ç‚¹è¯­æ³•(stu.sname) å­—å…¸æŸ¥è¯¢ å±æ€§æˆ–è€…æ–¹æ³• æ•°å­—ç´¢å¼• 3.åœ¨æ¨¡æ¿ä¸­ä¸èƒ½ä¼ é€’å‚æ•°(stu.getname) æ ‡ç­¾è¯­æ³•ï¼š&#123;% tag %&#125; ä½œç”¨ï¼š 1.åœ¨è¾“å‡ºä¸­åˆ›å»ºæ–‡æœ¬ 2.æ§åˆ¶é€»è¾‘å’Œå¾ªç¯ ifï¼šè¯­å¥3 forï¼š forloop.counterï¼šå¾ªç¯è¿›è¡Œçš„æ¬¡æ•° emptyï¼šè¡¨ç¤ºåˆ—è¡¨ä¸ºç©ºçš„æƒ…å†µ //students.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;å­¦ç”Ÿåˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;å­¦ç”Ÿåˆ—è¡¨&lt;/h1&gt; &lt;ul&gt; &#123;% for stu in students %&#125; &lt;li&gt; &#123;&#123;forloop.counter&#125;&#125;--&#123;&#123;stu.sname&#125;&#125;--&#123;&#123;stu.sgrade&#125;&#125; &lt;/li&gt; &#123;% empty %&#125; &lt;li&gt;ç›®å‰æ²¡æœ‰å­¦ç”Ÿ&lt;/li&gt; &#123;% endfor%&#125; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt; commentï¼šæ³¨é‡Š &#123;% comment %&#125; å¤šè¡Œæ³¨é‡Š&#123;% endcomment %&#125;&#123;# å•è¡Œæ³¨é‡Š #&#125; ifequal/ifnotequalï¼š &#123;% ifequal å€¼1 å€¼2 %&#125; å€¼1==å€¼2&#123;% endifequal %&#125; includeï¼šæ¶å­å•Šæ¨¡æ¿å¹¶ä»¥æ ‡ç­¾å†…çš„å‚æ•°æ¸²æŸ“ &#123;% include æ¨¡æ¿ç›®å½• å‚æ•°1 å‚æ•°2 %&#125; urlï¼šåå‘è§£æ &#123;% url &apos;namespace:name&apos; å‚æ•°1 å‚æ•°2 %&#125; csrf_tokenï¼šç”¨äºè·¨ç«™è¯·æ±‚ä¼ªé€ ä¿æŠ¤ &#123;% csrf_token %&#125; block/extendsï¼šç”¨äºæ¨¡æ¿çš„ç»§æ‰¿ autoescapeï¼šç”¨äºHTMLçš„è½¬ä¹‰ è¿‡æ»¤å™¨è¯­æ³•ï¼š&#123;&#123;% var|è¿‡æ»¤å™¨%&#125;&#125; ä½œç”¨ï¼šåœ¨å˜é‡è¢«æ˜¾ç¤ºå‰ä¿®æ”¹å®ƒ &lt;h1&gt;&#123;&#123;str|upper&#125;&#125;&lt;/h1&gt; //å¯ä»¥è®©strçš„å­—æ¯è½¬æˆå¤§å†™å†æ˜¾ç¤º è¿‡æ»¤å™¨å¯ä»¥ä¼ é€’å‚æ•°ï¼Œå‚æ•°ç”¨å¼•å·å¼•èµ·æ¥ &lt;h1&gt;&#123;&#123;list|join:'#'&#125;&#125;&lt;/h1&gt; å¦‚æœä¸€ä¸ªæ²¡æœ‰è¢«æä¾›ï¼Œæˆ–è€…å€¼ä¸ºfalseã€ç©ºï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ &#123;&#123; var|default:'æ²¡æœ‰' &#125;&#125; æ ¹æ®ç»™å®šæ ¼å¼è½¬æ¢æ—¥æœŸä¸ºå­—ç¬¦ä¸²ï¼š &#123;&#123; datevalue|date:'y-m-d' &#125;&#125; HTMLè½¬ä¹‰ï¼šescape åŠ å‡ä¹˜é™¤å–æ¨¡ï¼š &#123;&#123; num|add:10 &#125;&#125;&#123;&#123; num|add:-5 &#125;&#125;&lt;!--num/1*5--&gt;&#123;&#123;% widthratio: num 1 5%&#125;&#125;&lt;!--num/5*1--&gt;&#123;&#123;% widthratio: num 5 1%&#125;&#125;&lt;!--num%2--&gt;&#123;&#123;% num|divisibleby:2 %&#125;&#125; åå‘è§£æ#project/urls.pyurl(r'^sunck/',include('myapp.urls',namespace='app'))#myapp/urls.pyurl(r'^good/(\\d+)$',views.good,name='good')#index.html&lt;a href=\"&#123;% url 'app:good' 1 %&#125;\"&gt;é“¾æ¥&lt;/a&gt;#å…¶å®åå‘è§£æç›¸å½“äºæŠŠsunck/ä»£è¿›appï¼ŒæŠŠgood/ä»£è¿›goodï¼Œç„¶åæ­£åˆ™åŒ¹é…çš„(/d+)åœ¨è¿™é‡Œå¯¹åº”1 æ¨¡æ¿ç»§æ‰¿ä½œç”¨ï¼šå¯ä»¥å‡å°‘é¡µé¢å†…å®¹çš„é‡å¤å®šä¹‰ï¼Œå®ç°é¡µé¢çš„é‡ç”¨ blockæ ‡ç­¾ï¼šåœ¨çˆ¶æ¨¡æ¿ä¸­é¢„ç•™åŒºåŸŸï¼Œå­æ¨¡æ¿å»å¡«å…… è¯­æ³•ï¼š&#123;% block æ ‡ç­¾å %&#125; &#123;% endblock æ ‡ç­¾å %&#125; extendsæ ‡ç­¾ï¼šç»§æ‰¿æ¨¡æ¿ï¼Œéœ€è¦å†™åœ¨æ¨¡æ¿æ–‡ä»¶çš„ç¬¬ä¸€è¡Œ è¯­æ³•ï¼š&#123;% extends çˆ¶æ¨¡æ¿è·¯å¾„ %&#125; //base.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;style&gt; #header&#123; width:100%; height:100px; background-color:red; &#125; #footer&#123; width:100%; height:100px; background-color:blue; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=\"header\"&gt;header&lt;/div&gt; &lt;div id=\"main\"&gt; &#123;% block main%&#125; &#123;% endblock main%&#125; &lt;/div&gt; &lt;div id=\"footer\"&gt;footer&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; //main.html&#123;% extends 'myapp/base.html'%&#125;&#123;% block main %&#125; &lt;h1&gt;sunck is a good man&lt;/h1&gt;&#123;% endblock main %&#125; HTMLè½¬ä¹‰return render(request,'myapp/index.html', &#123;\"stu\":student,\"str\":\"hello world\", \"list\":[\"good\",\"nice\",\"handsome\"], 'code':'&lt;h1&gt;sunck is a very good man&lt;/h1&gt;'&#125;)&#123;&#123;code&#125;&#125; //æ­¤å¤„çš„codeè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²æ¸²æŸ“&#123;&#123;code|safe&#125;&#125; //æ­¤å¤„çš„codeè¢«å½“ä½œhtmlæ¸²æŸ“&#123;% autoescape off %&#125; &#123;&#123;code&#125;&#125; //æ­¤å¤„çš„codeè¢«å½“ä½œhtmlæ¸²æŸ“&#123;% endautoescape %&#125;&#123;% autoescape on %&#125; &#123;&#123;code&#125;&#125; //æ­¤å¤„çš„codeè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²æ¸²æŸ“&#123;% endautoescape %&#125; CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ æ¦‚è¿°ï¼šæŸäº›æ¶æ„ç½‘ç«™åŒ…å«é“¾æ¥ã€è¡¨å•ã€æŒ‰é’®ã€jsåˆ©ç”¨ç™»å½•ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è®¤è¯ï¼Œä»è€Œæ”»å‡»æœåŠ¡å™¨(å¦‚ä¸‹é¢çš„å®ä¾‹ä¸­,æ”»å‡»è€…æ‹·è´ç½‘é¡µæºä»£ç ï¼Œç„¶åå°†æ”¹ä¸ºå³å¯è¿›è¡Œæ¶æ„æ”»å‡») é˜²æ­¢CSRF:1.åœ¨settings.pyæ–‡ä»¶ä¸­çš„MDIILEWAREå¢åŠ &apos;django.middleware.csrf.CsrfViewMiddleware&apos;2.åœ¨è¡¨å•ä¸­å¢åŠ &#123;% csrf_token%&#125;ï¼Œå…¶å®å°±æ˜¯åŠ äº†éªŒè¯ï¼Œå¹¶æ²¡æœ‰ç»å¯¹çš„å®‰å…¨ï¼Œéœ€è¦éšè— //postfile.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action=\"/showinfo/\" method=\"post\"&gt; &#123;% csrf_token %&#125; å§“åï¼š&lt;input type=\"text\" name=\"username\"/&gt; &lt;hr/&gt; å¯†ç ï¼š&lt;input type=\"password\" name=\"passwd\"/&gt; &lt;hr/&gt; &lt;input type=\"submit\" value=\"ç™»å½•\"/&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; //showinfo.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;name:&#123;&#123;username&#125;&#125;&lt;/h1&gt; &lt;h1&gt;password:&#123;&#123;passwd&#125;&#125;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; #views.pydef postfile(request): return render(request,'myapp/postfile.html')def showinfo(request): name=request.POST.get('username') pwd = request.POST.get('passwd') return render(request,'myapp/showinfo.html', &#123;\"username\":name, \"passwd\":pwd&#125;) éªŒè¯ç ä½œç”¨ï¼š 1.é˜²æ­¢æš´åŠ›è¯·æ±‚ 2.é˜²æ­¢csrfçš„ä¸€ç§æ–¹å¼ ç”¨åˆ°çš„æ•°æ®ï¼š insert into myapp_grades(gname,gdate,ggirlnum,gboynum,isDelete) values(â€œpython01â€,â€2017-2-4â€,10,50,0),(â€œpython02â€,â€2017-5-4â€,10,20,0),(â€œpython03â€,â€2018-8-5â€,50,50,0),(â€œpython04â€,â€2018-6-15â€,10,42,0); insert into myapp_students(sname,sgender,scontend,isDelete,sgrade_id,sage) values(â€œè”¡å¾å¤â€,0,â€æˆ‘å«è”¡å¾å¤â€,0,4,20), (â€œåˆ˜å¾·åâ€,0,â€æˆ‘å«åˆ˜å¾·åâ€,0,1,25), (â€œé™ˆç‘è±ªâ€,0,â€æˆ‘å«é™ˆç‘è±ªâ€,0,3,18), (â€œé»‘é›ªå§¬â€,1,â€æˆ‘å«é»‘é›ªå§¬â€,0,2,14), (â€œæœ‰ç”°æ˜¥é›ªâ€,0,â€æˆ‘å«æœ‰ç”°æ˜¥é›ªâ€,0,2,13);","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django05-é«˜çº§æ‰©å±•(celeryæœªè®²å®Œ)","slug":"Django05-é«˜çº§æ‰©å±•(celeryæœªè®²å®Œ)","date":"2019-07-22T01:14:50.000Z","updated":"2019-09-01T13:00:27.233Z","comments":true,"path":"2019/07/22/Django05-é«˜çº§æ‰©å±•(celeryæœªè®²å®Œ)/","link":"","permalink":"/2019/07/22/Django05-é«˜çº§æ‰©å±•(celeryæœªè®²å®Œ)/","excerpt":"","text":"é™æ€æ–‡ä»¶cssã€jsã€å›¾ç‰‡ã€jsonæ–‡ä»¶ã€å­—ä½“æ–‡ä»¶ç­‰ staticç›®å½•æ˜¯åˆ›å»ºåœ¨æœ€å¤–å±‚çš„projectä¸‹çš„ï¼Œä¹Ÿå°±æ˜¯å’Œtemplatesæ˜¯åŒçº§çš„ é…ç½®settings.pyï¼š STATIC_URL = '/static/'STATICFILES_DIRS = [ os.path.join(BASE_DIR, \"static\")] &#123;% load static from staticfiles %&#125;&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/static/myapp/css/style.css\"/&gt; &lt;script type=\"text/javascript\" src=\"/static/myapp/js/sunck.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;sunck is a good man&lt;/h1&gt; &lt;img src=\"/static/myapp/img/56464486_p0.png\"/&gt; &lt;img src=\"&#123;% static 'myapp/img/56464486_p0.png' %&#125;\"&gt; //staticæ‹¿åˆ°çš„æ˜¯STATIC_URL&lt;/body&gt;&lt;/html&gt; ä¸­é—´ä»¶æ¦‚è¿°ï¼šä¸€ä¸ªè½»é‡çº§ã€åº•å±‚çš„æ’ä»¶ï¼Œå¯ä»¥ä»‹å…¥Djangoçš„è¯·æ±‚å’Œå“åº” æ–¹æ³•ï¼š __init__ï¼šä¸éœ€è¦ä¼ å‚ï¼ŒæœåŠ¡å™¨å“åº”ç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºç¡®å®šæ˜¯å¦å¯ç”¨è¯¥ä¸­é—´ä»¶ process_request(self,request)ï¼šåœ¨æ‰§è¡Œè§†å›¾ä¹‹å‰è¢«è°ƒç”¨(åˆ†é…urlåŒ¹é…è§†å›¾å‰)ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šè°ƒç”¨ï¼Œè¿”å›Noneæˆ–è€…HttpResponseå¯¹è±¡ process_view(self,request,view_func,view_args,view_kwargs)ï¼šè°ƒç”¨è§†å›¾ä¹‹å‰ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šè°ƒç”¨ï¼Œè¿”å›Noneæˆ–è€…HttpREsponseå¯¹è±¡ process_template_response(self,request,response)ï¼šåœ¨è§†å›¾åˆšå¥½æ‰§è¡Œå®Œåè°ƒç”¨ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šè°ƒç”¨ï¼Œè¿”å›Noneæˆ–è€…HttpREsponseå¯¹è±¡ï¼›ä½¿ç”¨render process_reponse(self,request,response)ï¼šæ‰€æœ‰å“åº”è¿”å›æµè§ˆå™¨å‰è°ƒç”¨ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šè°ƒç”¨ï¼Œè¿”å›HttpREsponseå¯¹è±¡ process_exception(self,request,exception)ï¼šå½“è§†å›¾æŠ›å‡ºå¼‚å¸¸æ—¶è°ƒç”¨ï¼Œè¿”å›HttpREsponseå¯¹è±¡ è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼šåœ¨å·¥ç¨‹ç›®å½•projectä¸‹åˆ›å»ºmiddlewareç›®å½•ï¼Œå†åˆ›å»ºmyappç›®å½• #settings.py MIDDLEMAREä¸­æ·»åŠ æˆ‘ä»¬å®šä¹‰çš„ä¸­é—´ä»¶MIDDLEWARE = [ ... 'middleware.myapp.mymiddle.MyMiddle'] #mymiddle.pyfrom django.utils.deprecation import MiddlewareMixinclass MyMiddle(MiddlewareMixin): def process_request(self,request): print(\"getå‚æ•°ä¸ºï¼š\",request.GET.get(\"a\")) ä¸Šä¼ å›¾ç‰‡æ¦‚è¿°ï¼šæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œæ–‡ä»¶æ•°æ®å­˜å‚¨åœ¨request.FILESå±æ€§ä¸­ å­˜å‚¨è·¯å¾„ï¼šåœ¨staticç›®å½•ä¸‹åˆ›å»ºupfileç›®å½• æ³¨æ„ï¼šformè¡¨å•è¦ä¸Šçˆ±åƒæ–‡ä»¶éœ€è¦åŠ ä¸Šenctype=â€multipart/form-dataâ€;ä¸Šä¼ æ–‡ä»¶å¿…é¡»æ˜¯POSTè¯·æ±‚ #é…ç½®settings.py ä¸Šä¼ æ–‡ä»¶ç›®å½•MEDIA_ROOT=os.path.join(BASE_DIR,r'static\\upfile') #upfile.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form method=\"post\" action=\"/savefile/\" enctype=\"multipart/form-data\"&gt; &#123;%csrf_token%&#125; &lt;input type=\"file\" name=\"file1\"&gt; &lt;input type=\"submit\" value=\"ä¸Šä¼ \"&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; #views.pydef upfile(request): return render(request,'myapp/upfile.html')def savefile(request): if request.method==\"POST\": f=request.FILES[\"file1\"] #æ–‡ä»¶åœ¨æœåŠ¡å™¨ç«¯çš„è·¯å¾„ filePath=os.path.join(settings.MEDIA_ROOT,f.name) with open(filePath,'wb') as fp: for info in f.chunks(): #å¦‚æœæ–‡ä»¶å¤ªå¤§ fp.write(info) return HttpResponse(\"ä¸Šä¼ æˆåŠŸ\") else: return HttpResponse(\"ä¸Šä¼ å¤±è´¥\") åˆ†é¡µPaginatorå¯¹è±¡ï¼š åˆ›å»ºå¯¹è±¡ï¼š æ ¼å¼ï¼šPaginator(åˆ—è¡¨,æ¯é¡µä¸ªæ•°) è¿”å›å€¼ï¼šè¿”å›åˆ†é¡µå¯¹è±¡ å±æ€§ï¼š countï¼šå¯¹è±¡æ€»æ•° num_pagesï¼šé¡µé¢æ€»æ•° page_rangesï¼šé¡µç åˆ—è¡¨(é¡µç ä»1å¼€å§‹) æ–¹æ³•ï¼š page(num)ï¼šè·å¾—ä¸€ä¸ªPageå¯¹è±¡ï¼Œå¦‚æœæä¾›çš„é¡µç ä¸å­˜åœ¨ä¼šæŠ›å‡ºâ€InvalidPageâ€å¼‚å¸¸ å¼‚å¸¸ï¼š InvalidPageï¼šæ— æ•ˆé¡µç  PageNotAnIntegerï¼špage()ä¼ é€’çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ªæ•´æ•° EmptyPageï¼šå½“page()ä¼ é€’æœ‰æ•ˆå€¼ä½†è¯¥é¡µé¢æ²¡æœ‰æ•°æ®è¾“å‡ºæ—¶ Pageå¯¹è±¡ï¼š å±æ€§ï¼š object_listï¼šå½“å‰é¡µä¸Šæ‰€æœ‰çš„æ•°æ®åˆ—è¡¨ numberï¼šå½“å‰é¡µçš„é¡µç å€¼ paginatorï¼šå½“å‰pageå¯¹è±¡å…³è”çš„paginatorå¯¹è±¡ æ–¹æ³•ï¼š has_next()ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ has_previous()ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ä¸Šä¸€é¡µ has_other_pages()ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ä¸Šä¸€é¡µæˆ–ä¸‹ä¸€é¡µ next_page_number()ï¼šè¿”å›ä¸‹ä¸€é¡µçš„é¡µç ï¼Œå¦‚æœä¸‹ä¸€é¡µä¸å­˜åœ¨æŠ›å‡ºInvalidPageå¼‚å¸¸ previous_page_number()ï¼šè¿”å›ä¸Šä¸€é¡µçš„é¡µç ï¼Œå¦‚æœä¸‹ä¸€é¡µä¸å­˜åœ¨æŠ›å‡ºInvalidPageå¼‚å¸¸ len()ï¼šè¿”å›å½“å‰é¡µçš„æ•°æ®ä¸ªæ•° #views.pyfrom .models import Studentsfrom django.core.paginator import Paginatordef studentpage(request,pageid): allList=Students.objects.all() paginator=Paginator(allList,2) page=paginator.page(pageid) return render(request,'myapp/studentpage.html', &#123;\"students\":page&#125;) #studentpage.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;å­¦ç”Ÿåˆ†é¡µæ˜¾ç¤º&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;ul&gt; &#123;% for stu in students %&#125; &lt;li&gt; &#123;&#123;stu.sname&#125;&#125;--&#123;&#123;stu.sgrade&#125;&#125; &lt;/li&gt; &#123;% endfor %&#125; &lt;/ul&gt; &lt;ul&gt; &#123;% for index in students.paginator.page_range %&#125; &#123;% ifequal index students.number %&#125; &lt;li&gt; &#123;&#123;index&#125;&#125; &lt;/li&gt; &#123;% else %&#125; &lt;li&gt; &lt;a href=\"/studentpage/&#123;&#123;index&#125;&#125;/\"&gt;&#123;&#123;index&#125;&#125;&lt;/a&gt; &lt;/li&gt; &#123;% endifequal %&#125; &#123;% endfor%&#125; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt; Ajax#sunck.js$(document).ready(function()&#123; document.getElementById(\"btn\").onclick= function()&#123; $.ajax(&#123; type:\"get\", url:\"/studentsinfo/\", dataType:\"json\", success:function(data,status)&#123; console.log(data) var d=data[\"data\"] for(var i=0;i&lt;d.length;i++)&#123; document.write('&lt;p&gt;'+d[i][0]+'&lt;/p&gt;') &#125; &#125; &#125;) &#125;&#125;) #ajaxstudents.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Title&lt;/title&gt; &lt;script type=\"text/javascript\" src=\"/static/myapp/js/jquery-3.1.1.min.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;å­¦ç”Ÿä¿¡æ¯åˆ—è¡¨&lt;/h1&gt; &lt;button id=\"btn\"&gt;æ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯&lt;/button&gt; &lt;script type=\"text/javascript\" src=\"/static/myapp/js/sunck.js\"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; #views.pydef ajaxstudents(request): return render(request, 'myapp/ajaxstudents.html')from django.http import JsonResponsedef studentsinfo(request): stus=Students.objects.all() list=[] for stu in stus: list.append([stu.sname,stu.sage]) return JsonResponse(&#123;\"data\":list&#125;)#urls.pyurl(r'^studentsinfo/$',views.studentsinfo) å¯Œæ–‡æœ¬é¦–å…ˆå®‰è£…django-tinymce,é…ç½®å®Œåéœ€è¦é‡æ–°æ‰§è¡Œè¿ç§» 1.åœ¨adminç«™ç‚¹ä¸­ä½¿ç”¨ï¼š é…ç½®settings.py #settings.pyINSTALLED_APPS = [ ... 'tinymce']#å¯Œæ–‡æœ¬ æ–‡å­—åŠ ç²—ç­‰TINYMCE_DEFAULT_CONFIG=&#123; 'theme':'advanced', 'width':600, 'height':400,&#125; #model.pyfrom tinymce.models import HTMLFieldclass Text(models.Model): str=HTMLField() #admin.pyfrom .models import Textadmin.site.register(Text) 2.åœ¨è‡ªå®šä¹‰è§†å›¾ä¸­ä½¿ç”¨ #edit.html&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;å¯Œæ–‡æœ¬&lt;/title&gt; &lt;script type=\"text/javascript\" src=\"/static/tiny_mce/tiny_mce.js\"&gt;&lt;/script&gt; //è¿™é‡Œä¼šè‡ªåŠ¨æ·»åŠ  ä¸éœ€è¦è‡ªå·±æ‰‹åŠ¨æ·»åŠ jsæ–‡ä»¶ &lt;script type=\"text/javascript\"&gt; tinyMCE.init(&#123; 'mode':'textareas', 'theme':'advanced', 'width':800, 'height':600 &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;form action=\"/saveedit/\" method=\"post\"&gt; &lt;textarea name=\"str\"&gt;sunck is a good man&lt;/textarea&gt; &lt;input type=\"submit\" value=\"æäº¤\"/&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; #views.pydef edit(request): return render(request,'myapp/edit.html') celeryé—®é¢˜ï¼š 1.ç”¨æˆ·å‘èµ·requestï¼Œå¹¶ä¸”è¦ç­‰å¾…responseè¿”å›ï¼Œä½†æ˜¯è§†å›¾ä¸­æœ‰ä¸€äº›å¾ˆè€—æ—¶çš„æ“ä½œ(å¦‚å‘é‚®ä»¶)ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒå¾ˆå·® 2.æ¯éš”ä¸€æ®µæ—¶é—´è¦åŒæ­¥ä¸€æ¬¡æ•°æ®ï¼Œä½†httpè¯·æ±‚æ˜¯éœ€è¦è§¦å‘çš„ è§£å†³ï¼š 1.å°†è€—æ—¶çš„æ“ä½œæ”¾åˆ°celeryä¸­æ‰§è¡Œ 2.ä½¿ç”¨celeryå®šæ—¶æ‰§è¡Œ celeryï¼š ä»»åŠ¡ï¼šå°†è€—æ—¶æ“ä½œå°è£…æˆä¸€ä¸ªå‡½æ•° é˜Ÿåˆ—ï¼šå°†è¦æ‰§è¡Œçš„ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ— å·¥äººï¼šè´Ÿè´£æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ ä»£ç†ï¼šè´Ÿè´£è°ƒåº¦ï¼Œåœ¨æ­¥æ•°ç¯å¢ƒä¸­ä½¿ç”¨redis é…ç½®ç¯å¢ƒï¼š pip install celerypip install celery-with-redispip install django-celery é…ç½®settings.py #settings.pyINSTALLED_APPS = [ ... 'djcelery']#celeryimport djcelerydjcelery.setup_loader() #åˆå§‹åŒ–BROKER_URL='redis://123456@127.0.0.1:6379/0' #BROKER:ä»£ç†å¯†ç  ä¸»æœºåœ°å€ redisçš„ç¬¬0ä¸ªåº“CELERY_IMPORTS='myapp.task' ç„¶åå†project/myappç›®å½•ä¸‹åˆ›å»ºtask.pyæ–‡ä»¶ï¼Œç„¶åç›´æ¥è¿ç§»(ä¸ç”¨ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼Œå³ç›´æ¥migrate) åœ¨å·¥ç¨‹æ–‡ä»¶projectç›®å½•ä¸­çš„projectç›®å½•ä¸‹(å’Œsettings.pyåŒç›®å½•)åˆ›å»ºcelery.pyæ–‡ä»¶ #celery.pyimport osfrom celery import Celeryfrom django.conf import settingsos.environ.setdefault('DJANGO_SETTINGS_MODULE','whthas_home.settings')app=Celery('portal')app.config_from_object('django.conf:settings')app.autodiscover_tasks(lambda:settings.INSTALLED_APPS)@app.task(bind=True)def def_task(self): print('Request:&#123;0!r&#125;'.format(self.request)) #project/project/__init__.pyä¸­æ·»åŠ from .celery import app as celery_app","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django02-æ¨¡å‹","slug":"Django02-æ¨¡å‹","date":"2019-07-21T13:20:01.000Z","updated":"2019-09-01T13:14:54.832Z","comments":true,"path":"2019/07/21/Django02-æ¨¡å‹/","link":"","permalink":"/2019/07/21/Django02-æ¨¡å‹/","excerpt":"","text":"æ¨¡å‹ã€å±æ€§ã€è¡¨ã€å­—æ®µä¹‹é—´çš„å…³ç³»ï¼šä¸€ä¸ªæ¨¡å‹ç±»åœ¨æ•°æ®åº“ä¸­å¯¹åº”ä¸€å¼ è¡¨ï¼Œåœ¨æ¨¡å‹ç±»ä¸­å®šä¹‰çš„å±æ€§ï¼Œå¯¹åº”è¯¥æ¨¡å‹å¯¹ç…§è¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µ å±æ€§å®šä¹‰å±æ€§æ—¶ï¼Œéœ€è¦çš„å­—æ®µç±»å‹ï¼Œéƒ½è¢«å®šä¹‰åœ¨django.db.models.fieldsç›®å½•ä¸‹ï¼Œä¸ºæ–¹ä¾¿ä½¿ç”¨ï¼Œå¯¼å…¥åˆ°django.db.models é€»è¾‘åˆ é™¤å¯¹äºé‡è¦çš„æ•°æ®ä½œé€»è¾‘åˆ é™¤ï¼Œä¸åšç‰©ç†åˆ é™¤ï¼Œå®ç°æ–¹æ³•æ˜¯å®šä¹‰isdDeleteå±æ€§ï¼Œç±»å‹ä¸ºBooleanField,é»˜è®¤å€¼ä¸ºFalse å­—æ®µç±»å‹AutoFieldï¼š ä¸€ä¸ªæ ¹æ®å®é™…IDè‡ªåŠ¨å¢é•¿çš„IntegerFieldï¼Œé€šå¸¸ä¸æŒ‡å®šï¼Œå¦‚æœä¸æŒ‡å®šï¼Œä¸€ä¸ªä¸»é”®å­—æ®µå°†è‡ªåŠ¨æ·»åŠ åˆ°æ¨¡å‹ä¸­ CharField(max_length=å­—ç¬¦é•¿åº¦): å­—ç¬¦ä¸²ï¼Œé»˜è®¤çš„è¡¨å•æ ·å¼æ˜¯TextInput TextField: å¤§æ–‡æœ¬å­—æ®µï¼Œä¸€èˆ¬è¶…è¿‡4000ä½¿ç”¨ï¼Œé»˜è®¤çš„è¡¨å•æ§ä»¶æ˜¯Textarea IntegerFieldï¼š æ•´æ•°å­—æ®µ DecimalField(max_digits=None,decimal_places=None)ï¼š ä½¿ç”¨pythonçš„Decimalå®ä¾‹è¡¨ç¤ºçš„åè¿›åˆ¶æµ®ç‚¹æ•°ï¼Œmax_digitsè¡¨ç¤ºä½æ•°æ€»æ•°ï¼Œdecimal_placesè¡¨ç¤ºå°æ•°ç‚¹åçš„æ•°å­—ä½æ•° FloatFieldï¼š ä½¿ç”¨pythonçš„floatå®ä¾‹æ¥è¡¨ç¤ºæµ®ç‚¹æ•° BooleanFieldï¼š True/Flase,é»˜è®¤è¡¨å•æ§åˆ¶æ˜¯CheckboxInput NullBooleanFieldï¼š æ”¯æŒnullã€Trueã€Flaseä¸‰ç§å€¼ DateField(auto_now=False,auto_now_add=False): ä½¿ç”¨pythonä¸­çš„datetime.dateå®ä¾‹è¡¨ç¤ºçš„æ—¥æœŸï¼Œauto_nowè¡¨ç¤ºæ¯æ¬¡ä¿å­˜å¯¹è±¡æ—¶ï¼Œè‡ªåŠ¨è®¾ç½®è¯¥å­—æ®µä¸ºå½“å‰æ—¶é—´ï¼Œç”¨äºâ€œæœ€åä¸€æ¬¡ä¿®æ”¹â€çš„æ—¶é—´æˆ³ï¼Œå®ƒæ€»æ˜¯å½“å‰æ—¥æœŸã€‚auto_now_addè¡¨ç¤ºå½“å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶è‡ªåŠ¨è®¾ç½®å½“å‰æ—¶é—´ï¼Œç”¨äºåˆ›å»ºæ—¶çš„æ—¶é—´æˆ³ï¼Œå®ƒæ€»æ˜¯ä½¿ç”¨å½“å‰æ—¥æœŸã€‚ TimeFieldã€DateTimeFieldã€FileFieldã€ImageField sage = models.IntegerField(db_column='age') #db_columnä¿®æ”¹å­—æ®µåç§°ï¼Œå¦‚æœä¸è®¾ç½®åˆ™é»˜è®¤æ˜¯å±æ€§åç§°#null:å¦‚æœä¸ºTrueï¼ŒDjangoå°†ç©ºå€¼ä»¥NULLå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œé»˜è®¤å€¼ä¸ºFalse#blankeï¼šå¦‚æœä¸ºTrueï¼Œåˆ™è¯¥å­—æ®µå…è®¸ä¸ºç©ºç™½ï¼Œé»˜è®¤å€¼ä¸ºFalse nullæ˜¯æ•°æ®åº“èŒƒç•´çš„æ¦‚å¿µï¼Œblankæ˜¯è¡¨å•éªŒè¯èŒƒç•´çš„#db_column:å­—æ®µçš„åç§°#db_index:è‹¥å€¼ä¸ºTrueï¼Œåˆ™è¡¨ä¸­ä¼šä¸ºæ­¤å­—æ®µåˆ›å»ºç´¢å¼•#default:é»˜è®¤å€¼#primary_key:è‹¥ä¸ºTrueï¼Œåˆ™è¯¥å­—æ®µä¼šæˆä¸ºæ¨¡å‹çš„ä¸»é”®å­—æ®µ#unique:å¦‚æœä¸ºTrueï¼Œè¯¥å­—æ®µåœ¨è¡¨ä¸­å¿…é¡»æœ‰å”¯ä¸€å€¼ å…ƒé€‰é¡¹åœ¨æ¨¡å‹ç±»ä¸­å®šä¹‰Metaç±»ï¼Œç”¨äºè®¾ç½®å…ƒä¿¡æ¯ class Students(models.Model): ... ... class Meta: db_table=\"students\" #å®šä¹‰æ•°æ®è¡¨åï¼Œæ¨èä½¿ç”¨å°å†™å­—æ¯ï¼Œæ•°æ®è¡¨åé»˜è®¤ä¸ºé¡¹ç›®åå°å†™_ç±»åå°å†™ ordering=['id'] #å¯¹è±¡çš„é»˜è®¤æ’åºå­—æ®µï¼Œè·å–å¯¹è±¡åˆ—è¡¨æ—¶ä½¿ç”¨ ['-id']ä»£è¡¨é™åº æ’å…¥æ•°æ®#cmd mysqlinsert into grades(gname,gdate,ggirlnum,gboyuym,isDelete) values(&quot;python01&quot;,&quot;2017-2-4&quot;,10,50,0),values(&quot;python01&quot;,&quot;2017-2-4&quot;,10,50,0); #æŸ¥çœ‹æŸæ¡æ•°æ®select *from students limit2; è‡ªå®šä¹‰æ¨¡å‹ç®¡ç†å™¨å¦‚æœå®šä¹‰æ¨¡å‹ç±»æ²¡æœ‰æŒ‡å®šï¼Œåˆ™é»˜è®¤æ˜¯objects stuObj=models.Mangaer();#æœ‰äº†ä¸Šé¢çš„å®šä¹‰ï¼Œåˆ™åŸStudents.objects.get(pk=1)-&gt;Students.stuObj.get(pk=1),æ­¤æ—¶objectså°±ä¸å­˜åœ¨äº† è‡ªå®šä¹‰ç®¡ç†å™¨Managerç±»æ¨¡å‹ç®¡ç†å™¨æ˜¯Djangoçš„æ¨¡å‹è¿›è¡Œä¸æ•°æ®åº“è¿›è¡Œäº¤äº’çš„æ¥å£ï¼Œä¸€ä¸ªæ¨¡å‹å¯ä»¥æœ‰å¤šä¸ªæ¨¡å‹ç®¡ç†å™¨ ä½œç”¨:å‘ç®¡ç†å™¨ç±»ä¸­æ·»åŠ é¢å¤–çš„æ–¹æ³•ï¼›ä¿®æ”¹ç®¡ç†å™¨è¿”å›çš„åŸå§‹æŸ¥è¯¢é›†(é‡å†™get_queryset()æ–¹æ³•) class StudentsManager(models.Manager): def get_queryset(self): return super(StudentsManager,self).get_queryset().filter(isDelete=False) #super(StudentsManager,self).get_queryset()å¾—åˆ°åŸæ¥çš„å…¨é›† åˆ›å»ºå¯¹è±¡#æ–¹æ³•1#models.py@classmethod def createStudent(cls,name,age,gender,contend,grade, lastT,createT,isD=False): stu=cls(sname=name,sage=age,sgender=gender, scontend=contend,sgrade=grade,lastTime=lastT, createTime=createT,isDelete=isD) return stu #views.pydef addstudent(request): grade=Grades.objects.get(pk=1) stu=Students.createStudent(\"åˆ˜å¾·å\",34,True,\"Hello\",grade,\"2017-8-10\",\"2017-8-11\") stu.save() return HttpResponse(\"æ·»åŠ æˆåŠŸ\") #æ–¹æ³•2#models.pyclass StudentsManager(models.Manager): def get_queryset(self): return super(StudentsManager, self).get_queryset(). filter(isDelete=False) def createStudent(self,name,age,gender,contend,grade, lastT,createT,isD=False): stu=self.model() stu.sname=name stu.sage=age stu.sgender=gender stu.scontend=contend stu.lastTime=lastT stu.createTime=createT return stu#views.pydef addstudent2(request): grade=Grades.objects.get(pk=1) stu=Students.stuObj2.createStudent(\"åˆ˜å¾·å\",34,True,\"Hello\", grade,\"2017-8-10\",\"2017-8-11\") stu.save() return HttpResponse(\"æ·»åŠ æˆåŠŸ\") æ¨¡å‹æŸ¥è¯¢æŸ¥è¯¢é›†è¡¨ç¤ºä»æ•°æ®åº“ä¸­è·å–çš„å¯¹è±¡é›†åˆï¼ŒæŸ¥è¯¢é›†å¯ä»¥æœ‰å¤šä¸ªè¿‡æ»¤å™¨ï¼Œè¿‡æ»¤å™¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŸºäºæ‰€ç»™çš„å‚æ•°é™åˆ¶æŸ¥è¯¢é›†ç»“æœï¼Œä»sqlè§’åº¦æ¥è¯´ï¼ŒæŸ¥è¯¢é›†åˆselectè¯­å¥ç­‰ä»·ï¼Œè¿‡æ»¤å™¨å°±åƒwhereæ¡ä»¶ åœ¨ç®¡ç†å™¨ä¸Šè°ƒç”¨è¿‡æ»¤å™¨æ–¹æ³•è¿”å›æŸ¥è¯¢é›†ï¼ŒæŸ¥è¯¢é›†ç»è¿‡è¿‡æ»¤å™¨ç­›é€‰åè¿”å›æ–°çš„æŸ¥è¯¢é›†ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆé“¾å¼è°ƒç”¨ï¼› æƒ°æ€§æ‰§è¡Œï¼šåˆ›å»ºæŸ¥è¯¢é›†ä¸ä¼šå¸¦æ¥ä»»ä½•æ•°æ®çš„è®¿é—®ï¼Œç›´åˆ°è°ƒç”¨æ•°æ®æ—¶ï¼Œæ‰ä¼šè®¿é—®æ•°æ® è¿”å›æŸ¥è¯¢é›†çš„æ–¹æ³•(è¿‡æ»¤å™¨):all(),filter(key=value).filter(key=value)â€¦,exclude()è¿‡æ»¤æ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®,order_by()æ’åº,values()ä¸€æ¡æ•°æ®å°±æ˜¯ä¸€ä¸ªå¯¹è±¡(å­—å…¸)ï¼Œå¤šæ¡æ•°æ®å°±æ˜¯ä¸€ä¸ªåˆ—è¡¨ è¿”å›å•ä¸ªæ•°æ®:get(),count(),first(),last(),exists() get()æ²¡æ‰¾åˆ°æˆ–è€…æœ‰å¤šä¸ªå¯¹è±¡éƒ½ä¼šå¼•å‘å¼‚å¸¸ count()è¿”å›æŸ¥è¯¢é›†ä¸­çš„å¯¹è±¡ä¸ªæ•° first()/last()è¿”å›æŸ¥è¯¢é›†ç¬¬ä¸€/æœ€åä¸€ä¸ªå¯¹è±¡ exists()åˆ¤æ–­æŸ¥è¯¢é›†ä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰æ•°æ®è¿”å›True é™åˆ¶æŸ¥è¯¢é›†ï¼š #è¿”å›å‰5æ¡studentList=Students.stuObj2.all()[0:5] #æ³¨æ„ï¼šè¿™é‡Œçš„ä¸‹æ ‡ä¸èƒ½æ˜¯è´Ÿæ•° #urls.pyurl(r'^stu/(\\d+)/$',views.stupage)#views.py#åˆ†é¡µæ˜¾ç¤ºdef stupage(request,page): page=int(page) studentList=Students.stuObj2.all()[(page-1)*5:page*5] return render(request,'myapp/students.html', &#123;'students':studentList&#125;) æŸ¥è¯¢é›†çš„ç¼“å­˜ï¼š æ¦‚è¿°ï¼šæ¯ä¸ªæŸ¥è¯¢é›†éƒ½åŒ…å«ä¸€ä¸ªç¼“å­˜ï¼Œæ¥æœ€å°åŒ–çš„å¯¹æ•°æ®åº“è®¿é—® å­—æ®µæŸ¥è¯¢ï¼š æ¦‚è¿°ï¼šå®ç°äº†sqlä¸­çš„whereï¼Œä½œä¸ºæ–¹æ³•filter()ã€exclude()ã€get()çš„å‚æ•° è¯­æ³•ï¼šå±æ€§åç§°_æ¯”è¾ƒè¿ç®—ç¬¦=å€¼ å¤–é”®ï¼šå±æ€§å_id è½¬ä¹‰ï¼šç±»ä¼¼sqlä¸­çš„likeè¯­å¥ï¼Œlikeè¯­å¥ä¸­ä½¿ç”¨%æ˜¯ä¸ºäº†åŒ¹é…å ä½ å¦‚æœè¦åŒ¹é…æ•°æ®ä¸­çš„%(where like â€˜\\%â€™) æ¯”è¾ƒè¿ç®—ç¬¦ï¼š exactï¼šåˆ¤æ–­ï¼Œå¤§å°å†™æ•æ„Ÿ containsï¼šæ˜¯å¦åŒ…å«ï¼Œå¤§å°å†™æ•æ„Ÿ #views.py#åå­—ä¸­åŒ…å«å­™çš„def studentsearch(request): studentsList=Students.stuObj.filter(sname__contains=\"å­™\") return render(request,\"myapp/students.html\",&#123;\"student\":studentsList&#125;) startwithã€endwith:ä»¥valueå¼€å¤´æˆ–ç»“å°¾ï¼Œå¤§å°å†™æ•æ„Ÿ ä»¥ä¸Š4ä¸ªåœ¨å‰é¢åŠ ä¸Šiå°±è¡¨ç¤ºå¤§å°å†™ä¸æ•æ„Ÿï¼Œiexactã€icontainsâ€¦ isnullã€isnotnullï¼šæ˜¯å¦ä¸ºç©º/éç©º inï¼šæ˜¯å¦åŒ…å«åœ¨èŒƒå›´å†… pk__in=[2,4,6,8,10] gtã€gteã€ltã€lteï¼šå¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äº yearã€monthã€dayã€week_dayã€hourã€minuteã€second è·¨å…³è”æŸ¥è¯¢ï¼š(è§†é¢‘ä¸­æš‚æ—¶å‡ºé”™) å¤„ç†joinæŸ¥è¯¢ï¼šæ¨¡å‹ç±»å__å±æ€§å__æ¯”è¾ƒè¿ç®—ç¬¦ gradeList=Grades.stuObj2.all().filter(students__contend__contains='åˆ˜å¾·å') #Grades-ç­çº§é‡Œçš„ students__contend__contains-å­¦ç”Ÿcontendä¸­åŒ…å«#å­¦ç”Ÿæè¿°ä¸­åŒ…å«æœ‰â€œåˆ˜å¾·åâ€è¿™ä¸‰ä¸ªå­—çš„æ•°æ®æ˜¯å±äºå“ªä¸ªç­çº§çš„ æŸ¥è¯¢å¿«æ·ï¼špk ä»£è¡¨çš„ä¸»é”® èšåˆå‡½æ•°éœ€è¦å…ˆå¯¼å…¥ç›¸åº”çš„å‡½æ•° from django.db.models import Max ä½¿ç”¨aggregate()å‡½æ•°è¿”å›èšåˆå‡½æ•°çš„å€¼ Avgã€Countã€Maxã€Minã€Sum maxAge=Students.stuObj2.aggregate(Max('age')) #æ‹¿åˆ°çš„æ˜¯æœ€å¤§å€¼è€Œä¸æ˜¯æ•°æ® Få¯¹è±¡ã€Qå¯¹è±¡Få¯¹è±¡ï¼šå¯ä»¥ä½¿ç”¨æ¨¡å‹çš„Aå±æ€§ä¸Bå±æ€§è¿›è¡Œæ¯”è¾ƒ from django.db.models import F,Qdef grades(request): Grades.objects.filter(ggirlnum__gt=F('gboynum')+20) Qå¯¹è±¡ï¼š æ¦‚è¿°ï¼šè¿‡æ»¤å™¨æ–¹æ³•ä¸­çš„å…³é”®å­—å‚æ•°ï¼Œæ¡ä»¶ä¸ºandæ¨¡å¼ éœ€æ±‚ï¼šè¿›è¡ŒoræŸ¥è¯¢ è§£å†³ï¼šä½¿ç”¨Qå¯¹è±¡ from django.db.models import F,Qdef grades(request): Grades.objects.filter(Q(pk__lte=3) | Q(sage_gt=50))) #pkå°äºç­‰äº3æˆ–è€…å¹´é¾„å¤§äº50çš„ #Grades.objects.filter(~Q(pk__lte=3)) pkå¤§äº3çš„","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Django01-åŸºæœ¬æµç¨‹","slug":"Django01-åŸºæœ¬æµç¨‹","date":"2019-07-21T11:16:01.000Z","updated":"2019-09-01T13:00:33.422Z","comments":true,"path":"2019/07/21/Django01-åŸºæœ¬æµç¨‹/","link":"","permalink":"/2019/07/21/Django01-åŸºæœ¬æµç¨‹/","excerpt":"","text":"åˆ›å»ºæ•°æ®åº“è¿›å…¥æ•°æ®åº“(ç³»ç»Ÿæƒé™cmd) mysql -u root -p create DATABASE Django1; é…ç½®æ•°æ®åº“é¦–å…ˆåœ¨__init__.pyä¸‹æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š import pymysqlpymysql.install_as_MySQLdb() _settings\\_.pyä¸‹ä¿®æ”¹ä»¥ä¸‹ä»£ç ï¼š DATABASES = &#123; 'default': &#123; 'ENGINE': 'django.db.backends.mysql', 'NAME': æ•°æ®åº“å, 'USER': , 'PASSWORD': , 'HOST': 'localhost', #æ•°æ®åº“æœåŠ¡å™¨ip 'PORT': â€˜3306â€™, &#125;&#125; åˆ›å»ºåº”ç”¨è¿›å…¥djangoé¡¹ç›®ç›®å½• python manage.py startapp myapp ç›®å½•è¯´æ˜ï¼š admin.py:ç«™ç‚¹é…ç½® models.py:æ¨¡å‹ views.py:è§†å›¾ åœ¨settings.pyæ–‡ä»¶ä¸­å°†myappåº”ç”¨åŠ å…¥åˆ°INSTALLED_APPSé€‰é¡¹ä¸­ å®šä¹‰æ¨¡å‹æ¦‚è¿°ï¼šä¸€ä¸ªæ•°æ®è¡¨å¯¹åº”ä¸€ä¸ªæ¨¡å‹ åœ¨myappä¸‹çš„models.pyä¸­åˆ›å»º from django.db import models# Create your models here.#ä¸è¦å†™initæ–¹æ³•class Grades(models.Model): gname = models.CharField(max_length=20) gdate = models.DateTimeField() ggirlnum = models.IntegerField() gboynum = models.IntegerField() isDelete = models.BooleanField(default=False)class Students(models.Model): sname =models.CharField(max_length=20) sgender = models.BooleanField(default=True) sage = models.IntegerField() scontend = models.CharField(max_length=20) isDelete = models.BooleanField(default=False) #å…³è”å¤–é”® sgrade = models.ForeignKey(\"Grades\") #ç±»å åœ¨æ•°æ®åº“ä¸­ç”Ÿæˆæ•°æ®è¡¨ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼šåœ¨migrationsç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªè¿ç§»æ–‡ä»¶ï¼Œæ­¤æ—¶æ•°æ®åº“ä¸­è¿˜æ²¡æœ‰ç”Ÿæˆæ•°æ®è¡¨ python manage.py makemigrations æ‰§è¡Œè¿ç§»ï¼šç›¸å½“äºæ‰§è¡Œmysqlè¯­å¥åˆ›å»ºæ•°æ®è¡¨ python manage.py migrate æŸ¥çœ‹æ•°æ®è¡¨ï¼š use django1show tables;desc myapp_grades; æµ‹è¯•æ•°æ®æ“ä½œï¼š python manage.py shellfrom myapp.models import Grades,Studentsfrom django.utils import timezonefrom datetime import * æ•°æ®æ“ä½œï¼š Grades.object.all() #ç±»å.object.all()grade1.gname=\"pythonname\"...grade1.save() #ä¿å­˜åˆ°æ•°æ®åº“ #é‡å†™__str__()æ–¹æ³•æ–¹ä¾¿æŸ¥çœ‹ç»“æœdef __str__(self): return \"%s-%d-%d\"%(self.gname,self.ggirlnum,self.gboynum)#æŸ¥è¯¢æŸä¸ªå¯¹è±¡Grades.object.get(pk=2) #id=2çš„å¯¹è±¡ primary key#åˆ é™¤å¯¹è±¡grade1.delete() å…³è”å¯¹è±¡è·å¾—å…³è”å¯¹è±¡çš„é›†åˆï¼š #è·å–python04ç­çº§æ‰€æœ‰å­¦ç”Ÿ#å¯¹è±¡å.å…³è”ç±»åå°å†™_set.all()grades1.students_set.all() åˆ›å»ºå¯¹è±¡ stu3=grade1.students_set.create(sname=&apos;&apos;,...) éœ€æ±‚ï¼šåœ¨åˆ›å»ºç­çº§æ—¶ç›´æ¥åˆ›å»ºå¤šä¸ªå­¦ç”Ÿ class StudentsInfo(admin.TabularInline): #admin.StackedInline ä¸¤è€…åªæ˜¯æ˜¾ç¤ºæ–¹å¼ä¸ä¸€æ · model = Students extra = 2 #åŒæ—¶åœ¨GradeAdminæ·»åŠ class GradeAdmin(admin.ModelAdmin): inlines = [StudentsInfo] æœåŠ¡å™¨å¯åŠ¨æœåŠ¡å™¨ï¼š python manage.py runserver ip:port #ipå¯æœ‰ä¸å†™ï¼Œä¸å†™ä»£è¡¨æœ¬æœºip ç«¯å£å·é»˜è®¤8000 åˆ›å»ºç”¨æˆ·ï¼š python manage.py createsuperuser#ç„¶åæŒ‰ç…§æç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç  è¿›å…¥http://127.0.0.1:8000/admin/ æ±‰åŒ–ï¼š æŠŠsettings.pyä¸­çš„LANGUAGE_CODE=â€™zh_Hansâ€™ TIME_ZONE=â€™Asia/Shanghaiâ€™ ç®¡ç†æ•°æ®è¡¨ä¿®æ”¹admin.py from django.contrib import admin# Register your models here.from .models import Grades,Students#æ³¨å†Œclass GradeAdmin(admin.ModelAdmin): #åˆ—è¡¨é¡µå±æ€§ list_display = ['pk','gname','gdate','ggirl'] #æ˜¾ç¤ºçš„æ•°æ®å­—æ®µ list_filter = ['gname'] #è¿‡æ»¤å­—æ®µ search_fields = ['gname'] #æœç´¢å­—æ®µ list_per_page = 5 #åˆ†é¡µ #æ·»åŠ  ä¿®æ”¹é¡µå±æ€§ fields = [] #æ·»åŠ é¡µå„å­—æ®µæ˜¾ç¤ºçš„é¡ºåº fieldsets = [ (\"num\",&#123;\"fields\":[\"ggirlnum\",\"gboynum\"]&#125;), (\"base\", &#123;\"fields\": [\"gname\",\"gdate\",\"isDelete\"]&#125;), ] #ç»™å±æ€§åˆ†ç»„ å’ŒfieldsåŒæ—¶ä½¿ç”¨admin.site.register(Grades,GradeAdmin)admin.site.register(Students) å¸ƒå°”å€¼çš„æ˜¾ç¤ºclass StudentsAdmin(admin.ModelAdmin): def gender(self): #å†™å®Œè¯¥å‡½æ•°ï¼Œè¦å°†list_displayåˆ—è¡¨ä¸­çš„sgenderä¿®æ”¹ä¸ºå½“å‰çš„å‡½æ•°å if self.sgender: return \"ç”·\" else: return \"å¥³\" gender.short_description = \"æ€§åˆ«\" #ä¿®æ”¹å­—æ®µçš„æè¿° æ‰§è¡ŒåŠ¨ä½œé—®é¢˜#æ‰§è¡ŒåŠ¨ä½œçš„ä½ç½®actions_on_top = Falseactions_on_bottom = True ä½¿ç”¨è£…é¥°å™¨å®Œæˆæ³¨å†Œå°†admin.site.register(Students,StudentsAdmin)æ³¨é‡Šæ‰ï¼Œç„¶åå†ç›¸åº”çš„ç±»ä¸Šé¢(è¿™é‡Œæ˜¯Students)æ·»åŠ @admin.register(Students) å®šä¹‰è§†å›¾#views.pyfrom django.shortcuts import render# Create your views here.from django.http import HttpResponsedef index(request): return HttpResponse(\"Hello World!\") é…ç½®urlï¼š ä¿®æ”¹projectç›®å½•ä¸‹çš„urls.pyæ–‡ä»¶ from django.conf.urls import url,includefrom django.contrib import adminurlpatterns = [ url(r'^admin/', admin.site.urls), url(r'^',include('myapp.urls'))] åœ¨myappç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªurls.py from django.conf.urls import urlfrom . import viewsurlpatterns = [ url(r'^$',views.index) #ä»€ä¹ˆåç¼€éƒ½æ²¡æœ‰ï¼ˆå³http://127.0.0.1:8000ï¼‰ è¿™é‡Œçš„æ„æ€å³æ˜¯å¯¹åº”åˆ°views.pyä¸­çš„indexå‡½æ•°] ä½†æ­¤æ—¶å¦‚æœhttp://127.0.0.1:8000/2ä¼šæ²¡æœ‰å¯¹åº”çš„å“åº”é¡µé¢ #myapp\\urls.py#æ·»åŠ å¯¹åº”çš„åç¼€åŒ¹é…url(r'^(\\d+)$',views.detail) #(\\d+)çš„æ‹¬å·æ˜¯ç»„çš„æ¦‚å¿µï¼Œç”¨äºä¼ é€’å‚æ•°num#views.pydef detail(request,num): return HttpResponse(\"detail-%s\"%num) æ¨¡æ¿çš„åŸºæœ¬ä½¿ç”¨æ¦‚è¿°ï¼šæ¨¡æ¿æ˜¯htmlé¡µé¢ï¼Œå¯ä»¥æ ¹æ®è§†å›¾ä¸­ä¼ é€’è¿‡æ¥çš„æ•°æ®è¿›è¡Œå¡«å…… åˆ›å»ºæ¨¡æ¿ç›®å½•ï¼š åœ¨æœ€å¤–å±‚çš„projectç›®å½•ä¸‹åˆ›å»ºtemplatesç›®å½•ï¼Œå†åœ¨ç›®å½•ä¸‹åˆ›å»ºå¯¹åº”é¡¹ç›®çš„ç›®å½•æ¨¡æ¿(project/templates/myapp) é…ç½®æ¨¡æ¿è·¯å¾„ï¼š ä¿®æ”¹settings.pyæ–‡ä»¶ä¸‹çš„TEMPLATES 'DIRS': [os.path.join(BASE_DIR,'templates')] å®šä¹‰è§†å›¾æ¨¡æ¿æ–‡ä»¶ï¼š æ¨¡æ¿è¯­æ³•ï¼š1.è¾“å‡ºå€¼ï¼Œå¯ä»¥æ˜¯å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡.å±æ€§2.&#123;%æ‰§è¡Œä»£ç æ®µ%&#125; &lt;ul&gt; &#123;%for grade in grades%&#125; //è¿™é‡Œè¢«ä¼ å…¥äº†gradesList &lt;li&gt; &lt;a href=\"&#123;&#123;grade.id&#125;&#125;\"&gt;&#123;&#123;grade.gname&#125;&#125;&lt;/a&gt; &lt;/li&gt; &#123;%endfor%&#125;&lt;/ul&gt; #views.pyfrom .models import Gradesdef grades(request): #å»æ¨¡æ¿é‡Œå–æ•°æ® gradesList=Grades.objects.all() #å°†æ•°æ®ä¼ é€’ç»™æ¨¡æ¿,æ¨¡æ¿å†æ¸²æŸ“é¡µé¢ï¼Œå°†æ¸²æŸ“å¥½çš„é¡µé¢è¿”å›æµè§ˆå™¨ return render(request,'myapp/grades.html',&#123;\"grades\":gradesList&#125;)def gradesStudents(request,num): grade=Grades.objects.get(pk=num) studentsList=grade.students_set.all() return render(request,'myapp/students.html',&#123;\"students\",studentsList&#125;)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Django","slug":"Django","permalink":"/tags/Django/"},{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/tags/æŠ€æœ¯/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Hexo-Theme-Sakura","slug":"Hexo-Theme-Sakura","date":"2018-12-12T14:16:01.000Z","updated":"2019-10-07T14:54:29.321Z","comments":true,"path":"2018/12/12/Hexo-Theme-Sakura/","link":"","permalink":"/2018/12/12/Hexo-Theme-Sakura/","excerpt":"","text":"hexo-theme-sakuraä¸»é¢˜ English document åŸºäºWordPressä¸»é¢˜Sakuraä¿®æ”¹æˆHexoçš„ä¸»é¢˜ã€‚ demoé¢„è§ˆ æ­£åœ¨å¼€å‘ä¸­â€¦â€¦ äº¤æµç¾¤è‹¥ä½ æ˜¯ä½¿ç”¨è€…ï¼ŒåŠ ç¾¤QQ: 801511924 è‹¥ä½ æ˜¯åˆ›ä½œè€…ï¼ŒåŠ ç¾¤QQ: 194472590 ä¸»é¢˜ç‰¹æ€§ é¦–é¡µå¤§å±è§†é¢‘ é¦–é¡µéšæœºå°é¢ å›¾ç‰‡æ‡’åŠ è½½ valineè¯„è®º fancy-boxç›¸å†Œ pjaxæ”¯æŒï¼ŒéŸ³ä¹ä¸é—´æ–­ aplayeréŸ³ä¹æ’­æ”¾å™¨ å¤šçº§å¯¼èˆªèœå•ï¼ˆæŒ‰ç°åœ¨å¤§éƒ¨åˆ†hexoä¸»é¢˜æ¥è¯´ï¼Œè¿™ä¹Ÿç®—æ˜¯ä¸ªç‰¹æ€§äº†ï¼‰ èµèµä½œè€…å¦‚æœå–œæ¬¢hexo-theme-sakuraä¸»é¢˜ï¼Œå¯ä»¥è€ƒè™‘èµ„åŠ©ä¸€ä¸‹å“¦~éå¸¸æ„Ÿæ¿€ï¼ paypal | Alipay æ”¯ä»˜å® | WeChat Pay å¾®ä¿¡æ”¯ä»˜ æœªå®Œå–„çš„ä½¿ç”¨æ•™ç¨‹é‚£å•¥ï¼Ÿè€å®è¯´æˆ‘ç›®å‰ä¹Ÿä¸æ˜¯å¾ˆæœ‰æ¡ç†233333333~ 1ã€ä¸»é¢˜ä¸‹è½½å®‰è£…hexo-theme-sakuraå»ºè®®ä¸‹è½½å‹ç¼©åŒ…æ ¼å¼ï¼Œå› ä¸ºé™¤äº†ä¸»é¢˜å†…å®¹è¿˜æœ‰äº›sourceçš„é…ç½®å¯¹æ–°æ‰‹æ¥è¯´æ¯”è¾ƒå¤ªéº»çƒ¦ï¼Œç›´æ¥ä¸‹è½½è§£å‹å°±çœå»è¿™äº›éº»çƒ¦å’¯ã€‚ ä¸‹è½½å¥½åè§£å‹åˆ°åšå®¢æ ¹ç›®å½•ï¼ˆä¸æ˜¯ä¸»é¢˜ç›®å½•å“¦ï¼Œé‡å¤çš„é€‰æ‹©æ›¿æ¢ï¼‰ã€‚æ¥ç€åœ¨å‘½ä»¤è¡Œï¼ˆcmdã€bashï¼‰è¿è¡Œnpm iå®‰è£…ä¾èµ–ã€‚ 2ã€ä¸»é¢˜é…ç½®åšå®¢æ ¹ç›®å½•ä¸‹çš„_configé…ç½®ç«™ç‚¹# Sitetitle: ä½ çš„ç«™ç‚¹åsubtitle:description: ç«™ç‚¹ç®€ä»‹keywords:author: ä½œè€…ålanguage: zh-cntimezone: éƒ¨ç½²deploy: type: git repo: github: ä½ çš„githubä»“åº“åœ°å€ # coding: ä½ çš„codingä»“åº“åœ°å€ branch: master å¤‡ä»½ ï¼ˆä½¿ç”¨hexo bå‘å¸ƒå¤‡ä»½åˆ°è¿œç¨‹ä»“åº“ï¼‰backup: type: git message: backup my blog of https://honjun.github.io/ repository: # ä½ çš„githubä»“åº“åœ°å€,å¤‡ä»½åˆ†æ”¯å ï¼ˆå»ºè®®æ–°å»ºbackupåˆ†æ”¯ï¼‰ github: https://github.com/honjun/honjun.github.io.git,backup # coding: https://git.coding.net/hojun/hojun.git,backup ä¸»é¢˜ç›®å½•ä¸‹çš„_configé…ç½®å…¶ä¸­æ ‡æ˜ã€æ”¹ã€‘çš„æ˜¯éœ€è¦ä¿®æ”¹éƒ¨é—¨ï¼Œæ ‡æ˜ã€é€‰ã€‘æ˜¯å¯æ”¹å¯ä¸æ”¹ï¼Œæ ‡æ˜ã€éã€‘æ˜¯ä¸ç”¨æ”¹çš„éƒ¨åˆ†# site name# ç«™ç‚¹å ã€æ”¹ã€‘prefixName: ã•ãã‚‰è˜ãã®siteName: hojun# favicon and site master avatar# ç«™ç‚¹çš„faviconå’Œå¤´åƒ è¾“å…¥å›¾ç‰‡è·¯å¾„ï¼ˆä¸‹é¢çš„é…ç½®æ˜¯éƒ½æ˜¯cdnçš„ç›¸å¯¹è·¯å¾„ï¼Œæ²¡æœ‰cdnè¯·å¡«å†™å®Œæ•´è·¯å¾„ï¼Œå»ºè®®ä½¿ç”¨jsdeliveræ­å»ºä¸€ä¸ªcdnå•¦ï¼Œå…ˆå»ä¸‹è½½æˆ‘çš„cdnæ›¿æ¢ä¸‹å›¾ç‰‡å°±è¡Œäº†ï¼Œç®€å•æ–¹ä¾¿~ï¼‰ã€æ”¹ã€‘favicon: /images/favicon.icoavatar: /img/custom/avatar.jpg# ç«™ç‚¹url ã€æ”¹ã€‘url: https://sakura.hojun.cn# ç«™ç‚¹ä»‹ç»ï¼ˆæˆ–è€…è¯´æ˜¯ä¸ªäººç­¾åï¼‰ã€æ”¹ã€‘description: Live your life with passion! With some drive!# ç«™ç‚¹cdnï¼Œæ²¡æœ‰å°±ä¸ºç©º ã€æ”¹ã€‘ è‹¥æ˜¯cdnä¸ºç©ºï¼Œä¸€äº›å›¾ç‰‡åœ°å€å°±è¦å¡«å®Œæ•´åœ°å€äº†ï¼Œæ¯”å¦‚ä¹‹å‰avatarå°±è¦å¡«https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/custom/avatar.jpgcdn: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6# å¼€å¯pjax ã€é€‰ã€‘pjax: 1# ç«™ç‚¹é¦–é¡µçš„å…¬å‘Šä¿¡æ¯ ã€æ”¹ã€‘notice: hexo-Sakuraä¸»é¢˜å·²ç»å¼€æºï¼Œç›®å‰æ­£åœ¨å¼€å‘ä¸­...# æ‡’åŠ è½½çš„åŠ è½½ä¸­å›¾ç‰‡ ã€é€‰ã€‘lazyloadImg: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg# ç«™ç‚¹èœå•é…ç½® ã€é€‰ã€‘menus: é¦–é¡µ: &#123; path: /, fa: fa-fort-awesome faa-shake &#125; å½’æ¡£: &#123; path: /archives, fa: fa-archive faa-shake, submenus: &#123; æŠ€æœ¯: &#123;path: /categories/æŠ€æœ¯/, fa: fa-code &#125;, ç”Ÿæ´»: &#123;path: /categories/ç”Ÿæ´»/, fa: fa-file-text-o &#125;, èµ„æº: &#123;path: /categories/èµ„æº/, fa: fa-cloud-download &#125;, éšæƒ³: &#123;path: /categories/éšæƒ³/, fa: fa-commenting-o &#125;, è½¬è½½: &#123;path: /categories/è½¬è½½/, fa: fa-book &#125; &#125; &#125; æ¸…å•: &#123; path: javascript:;, fa: fa-list-ul faa-vertical, submenus: &#123; ä¹¦å•: &#123;path: /tags/æ‚¦è¯»/, fa: fa-th-list faa-bounce &#125;, ç•ªç»„: &#123;path: /bangumi/, fa: fa-film faa-vertical &#125;, æ­Œå•: &#123;path: /music/, fa: fa-headphones &#125;, å›¾é›†: &#123;path: /tags/å›¾é›†/, fa: fa-photo &#125; &#125; &#125; ç•™è¨€æ¿: &#123; path: /comment/, fa: fa-pencil-square-o faa-tada &#125; å‹äººå¸: &#123; path: /links/, fa: fa-link faa-shake &#125; èµèµ: &#123; path: /donate/, fa: fa-heart faa-pulse &#125; å…³äº: &#123; path: /, fa: fa-leaf faa-wrench , submenus: &#123; æˆ‘ï¼Ÿ: &#123;path: /about/, fa: fa-meetup&#125;, ä¸»é¢˜: &#123;path: /theme-sakura/, fa: iconfont icon-sakura &#125;, Lab: &#123;path: /lab/, fa: fa-cogs &#125;, &#125; &#125; å®¢æˆ·ç«¯: &#123; path: /client/, fa: fa-android faa-vertical &#125; RSS: &#123; path: /atom.xml, fa: fa-rss faa-pulse &#125;# Home page sort type: -1: newer firstï¼Œ1: older first. ã€éã€‘homePageSortType: -1# Home page article shown number) ã€éã€‘homeArticleShown: 10# èƒŒæ™¯å›¾ç‰‡ ã€é€‰ã€‘bgn: 8# startdashé¢æ¿ url, title, desc img ã€æ”¹ã€‘startdash: - &#123;url: /theme-sakura/, title: Sakura, desc: æœ¬ç«™ hexo ä¸»é¢˜, img: /img/startdash/sakura.md.png&#125; - &#123;url: http://space.bilibili.com/271849279, title: Bilibili, desc: åšä¸»çš„bç«™è§†é¢‘, img: /img/startdash/bilibili.jpg&#125; - &#123;url: /, title: hojunçš„ä¸‡äº‹å±‹, desc: æŠ€æœ¯æœåŠ¡, img: /img/startdash/wangshiwu.jpg&#125;# your site build time or founded date# ä½ çš„ç«™ç‚¹å»ºç«‹æ—¥æœŸ ã€æ”¹ã€‘siteBuildingTime: 07/17/2018# ç¤¾äº¤æŒ‰é’®(social) url, img PCç«¯é…ç½® ã€æ”¹ã€‘social: github: &#123;url: http://github.com/honjun, img: /img/social/github.png&#125; sina: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/sina.png&#125; wangyiyun: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/wangyiyun.png&#125; zhihu: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/zhihu.png&#125; email: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/email.svg&#125; wechat: &#123;url: /#, qrcode: /img/custom/wechat.jpg, img: /img/social/wechat.png&#125;# ç¤¾äº¤æŒ‰é’®(msocial) url, img ç§»åŠ¨ç«¯é…ç½® ã€æ”¹ã€‘msocial: github: &#123;url: http://github.com/honjun, fa: fa-github, color: 333&#125; weibo: &#123;url: http://weibo.com/mashirozx?is_all=1, fa: fa-weibo, color: dd4b39&#125; qq: &#123;url: https://wpa.qq.com/msgrd?v=3&amp;uin=954655431&amp;site=qq&amp;menu=yes, fa: fa-qq, color: 25c6fe&#125;# èµèµäºŒç»´ç ï¼ˆå…¶ä¸­wechatSQæ˜¯èµèµå•é¡µé¢çš„èµèµç å›¾ç‰‡ï¼‰ã€æ”¹ã€‘donate: alipay: /img/custom/donate/AliPayQR.jpg wechat: /img/custom/donate/WeChanQR.jpg wechatSQ: /img/custom/donate/WeChanSQ.jpg# é¦–é¡µè§†é¢‘åœ°å€ä¸ºhttps://cdn.jsdelivr.net/gh/honjun/hojun@1.2/Unbroken.mp4ï¼Œé…ç½®å¦‚ä¸‹ ã€æ”¹ã€‘movies: url: https://cdn.jsdelivr.net/gh/honjun/hojun@1.2 # å¤šä¸ªè§†é¢‘ç”¨é€—å·éš”å¼€ï¼Œéšæœºè·å–ã€‚æ”¯æŒçš„æ ¼å¼ç›®å‰å·²çŸ¥MP4,Flvã€‚å…¶ä»–çš„å¯ä»¥è¯•ä¸‹ï¼Œä¸ä¿è¯æœ‰ç”¨ name: Unbroken.mp4# å·¦ä¸‹è§’aplayeræ’­æ”¾å™¨é…ç½® ä¸»è¦æ”¹idå’Œserverè¿™ä¸¤é¡¹ï¼Œä¿®æ”¹è¯¦è§[aplayeræ–‡æ¡£] ã€æ”¹ã€‘aplayer: id: 2660651585 server: netease type: playlist fixed: true mini: false autoplay: false loop: all order: random preload: auto volume: 0.7 mutex: true# Valineè¯„è®ºé…ç½®ã€æ”¹ã€‘valine: truev_appId: GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHszv_appKey: mgOpfzbkHYqU92CV4IDlAUHQ åˆ†ç±»é¡µå’Œæ ‡ç­¾é¡µé…ç½®åˆ†ç±»é¡µ æ ‡ç­¾é¡µ é…ç½®é¡¹åœ¨\\themes\\Sakura\\languages\\zh-cn.ymlé‡Œã€‚æ–°å¢ä¸€ä¸ªåˆ†ç±»æˆ–æ ‡ç­¾æœ€å¥½åŠ ä¸‹å“¦ï¼Œå½“ç„¶å«Œéº»çƒ¦å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€å¼ é»˜è®¤å›¾ç‰‡ï¼ˆå¯ä»¥æ”¹ä¸»é¢˜æˆ–è€…ç›´æ¥æŠŠ404å›¾ç‰‡æ›¿æ¢ä¸‹ï¼Œå¾æ±‚ä¸‹æ„è§è¦ä¸è¦ç»™è¿™ä¸ªåœ¨é…ç½®æ–‡ä»¶ä¸­åŠ ä¸ªå¼€å…³ï¼Œå¯ä»¥issueæˆ–ç¾¤é‡Œæå‡ºæ¥ï¼‰ï¼Œç°åœ¨æ˜¯æ²¡è®¾ç½®çš„è¯ä¼šä½¿ç”¨é‚£ç§å€’ç«‹å°ç‹—404å“¦ã€‚#category# æŒ‰åˆ†ç±»ååˆ›å»ºæŠ€æœ¯: #ä¸­æ–‡æ ‡é¢˜ zh: é‡ç”ŸæŠ€æœ¯åä¼š # è‹±æ–‡æ ‡é¢˜ en: Geek â€“ Only for Love # å°é¢å›¾ç‰‡ img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/coding.jpgç”Ÿæ´»: zh: ç”Ÿæ´» en: live img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/writing.jpg#tag# æ ‡ç­¾åå³æ˜¯æ ‡é¢˜æ‚¦è¯»: # å°é¢å›¾ç‰‡ img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/reading.jpg å•é¡µé¢å°é¢é…ç½®å¦‚ç•™è¨€æ¿é¡µé¢é¡µé¢ï¼Œä½äºsourceä¸‹çš„commentä¸‹ï¼Œæ‰“å¼€index.mdå¦‚ä¸‹ï¼š---title: commentdate: 2018-12-20 23:13:48keywords: ç•™è¨€æ¿description: comments: true# åœ¨è¿™é‡Œé…ç½®å•é¡µé¢å¤´éƒ¨å›¾ç‰‡ï¼Œè‡ªå®šä¹‰æ›¿æ¢å“¦~photos: https://cdn.jsdelivr.net/gh/honjun/cdn@1.4/img/banner/comment.jpg--- å•é¡µé¢é…ç½®ç•ªç»„è®¡åˆ’é¡µ ï¼ˆè¯·ç›´æ¥åœ¨ä¸‹è½½åçš„æ–‡ä»¶ä¸­æ”¹ï¼Œä¸‹é¢çš„æ·»åŠ äº†æ³¨é‡Šå¯èƒ½ä¼šæœ‰äº›å½±å“ï¼‰ ---layout: bangumititle: bangumicomments: falsedate: 2019-02-10 21:32:48keywords:description:bangumis: # ç•ªç»„å›¾ç‰‡ - img: https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg # ç•ªç»„å title: æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ± # è¿½ç•ªçŠ¶æ€ ï¼ˆè¿½ç•ªing/å·²è¿½å®Œï¼‰ status: å·²è¿½å®Œ # è¿½ç•ªè¿›åº¦ progress: 100 # ç•ªå‰§æ—¥æ–‡åç§° jp: ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã† # æ”¾é€æ—¶é—´ time: æ”¾é€æ—¶é—´: 2018-02-24 SUN. # ç•ªå‰§ä»‹ç» desc: ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚ - img: https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg title: æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ± status: å·²è¿½å®Œ progress: 50 jp: ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã† time: æ”¾é€æ—¶é—´: 2018-02-24 SUN. desc: ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚--- å‹é“¾é¡µ ï¼ˆè¯·ç›´æ¥åœ¨ä¸‹è½½åçš„æ–‡ä»¶ä¸­æ”¹ï¼Œä¸‹é¢çš„æ·»åŠ äº†æ³¨é‡Šå¯èƒ½ä¼šæœ‰äº›å½±å“ï¼‰ ---layout: linkstitle: links# åˆ›å»ºæ—¥æœŸï¼Œå¯ä»¥æ”¹ä¸‹date: 2018-12-19 23:11:06 # å›¾ç‰‡ä¸Šçš„æ ‡é¢˜ï¼Œè‡ªå®šä¹‰ä¿®æ”¹keywords: å‹äººå¸ description: # true/false å¼€å¯/å…³é—­è¯„è®ºcomments: true # é¡µé¢å¤´éƒ¨å›¾ç‰‡ï¼Œè‡ªå®šä¹‰ä¿®æ”¹photos: https://cdn.jsdelivr.net/gh/honjun/cdn@1.4/img/banner/links.jpg # å‹é“¾é…ç½®links: # ç±»å‹åˆ†ç»„ - group: ä¸ªäººé¡¹ç›® # ç±»å‹ç®€ä»‹ desc: å……åˆ†è¯´æ˜è¿™å®¶ä¼™æ˜¯æ¡å’¸é±¼ &lt; (ï¿£ï¸¶ï¿£)&gt; items: # å‹é“¾é“¾æ¥ - url: https://shino.cc/fgvf # å‹é“¾å¤´åƒ img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg # å‹é“¾ç«™ç‚¹å name: Google # å‹é“¾ä»‹ç» ä¸‹é¢é›·åŒ desc: Google é•œåƒ - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ # ç±»å‹åˆ†ç»„... - group: å°ä¼™ä¼´ä»¬ desc: æ¬¢è¿äº¤æ¢å‹é“¾ ê‰‚(ËŠá—œË‹) items: - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ--- å†™æ–‡ç« é…ç½®ä¸»é¢˜é›†æˆäº†ä¸ªäººæ’ä»¶hexo-tag-biliå’Œhexo-tag-fancybox_imgã€‚å…¶ä¸­hexo-tag-biliç”¨æ¥åœ¨æ–‡ç« æˆ–å•é¡µé¢ä¸­æ’å…¥Bç«™å¤–é“¾è§†é¢‘ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š&#123;% bili video_id [page] %&#125; è¯¦ç»†ä½¿ç”¨æ•™ç¨‹è¯¦è§hexo-tag-biliã€‚ hexo-tag-fancybox_imgç”¨æ¥åœ¨æ–‡ç« æˆ–å•é¡µé¢ä¸­å›¾ç‰‡ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š&#123;% fb_img src [caption] %&#125; è¯¦ç»†ä½¿ç”¨æ•™ç¨‹è¯¦è§hexo-tag-fancybox_img è¿˜æœ‰å•¥ï¼Œä¸€æ—¶æƒ³ä¸èµ·æ¥â€¦â€¦To be continuedâ€¦","categories":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}],"tags":[{"name":"hexo","slug":"hexo","permalink":"/tags/hexo/"},{"name":"åšå®¢","slug":"åšå®¢","permalink":"/tags/åšå®¢/"}],"keywords":[{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"/categories/è½¬è½½/"}]}]}